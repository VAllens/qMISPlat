{"version":3,"sources":["kendo.spreadsheet.js"],"names":["f","define","kendo","UndoRedoStack","Observable","extend","init","options","fn","call","this","clear","events","push","command","stack","slice","currentCommandIndex","undo","canUndo","trigger","redo","canRedo","length","deepExtend","util","amd","a1","a2","a3","$","objectKey","object","key","parts","sort","join","hashKey","str","i","hash","charCodeAt","zeroSize","width","height","baseline","measureText","text","style","measureBox","TextMetrics","current","measure","LRUCache","DEFAULT_OPTIONS","defaultMeasureBox","window","Class","size","_size","_length","_map","put","value","map","entry","_head","_tail","newer","older","get","baselineMarkerSize","document","createElement","cssText","_cache","box","styleKey","cacheKey","cachedResult","baselineMarker","_baselineMarker","cloneNode","textContent","appendChild","body","String","offsetWidth","offsetHeight","offsetTop","parentNode","removeChild","marker","jQuery","sqr","renderSize","renderPos","pos","result","toHyphens","split","arabicToRoman","n","literals","1","10","100","2","20","200","3","30","300","4","40","400","5","50","500","6","60","600","7","70","700","8","80","800","9","90","900","1000","values","roman","shift","romanToArabic","r","digits","prev","v","toLowerCase","x","l","c","d","m","charAt","memoize","cache","Object","create","id","arguments","apply","isUnicodeLetter","ch","RX_UNICODE_LETTER","test","now","Date","getTime","RegExp","CODE","out","UCS2","code","parse","data","callbacks","readChar","index","croak","msg","Error","readWhile","pred","a","readAsciiWhile","STRING","skipWhitespace","isWhitespace","eat","save","skip","isDigit","isHexDigit","isNameStart","isName","xmlComment","END_COMMENT","xmlTag","name","attrs","QUESTION_MARK","xmlDecl","START_COMMENT","xmlName","xmlAttrs","END_SHORT_TAG","GREATER_THAN","xmlContent","pop","END_TAG","START_CDATA","END_CDATA","LESS_THAN","AMPERSAND","xmlEntity","xmlString","quote","QUOTE","APOSTROPHE","SHARP","LOWERCASE_X","UPPERCASE_X","parseInt","isNaN","ENTITIES","undefined","SEMICOLON","END_DECLARATION","$tag","EQUAL","what","thing","arg1","arg2","is","selector","j","exit","EXIT","tmp","fromCharCode","amp","lt","gt","quot","apos","nbsp","parseXML","ex","copyToClipboard","html","textarea","addClass","val","appendTo","focus","select","execCommand","remove","Command","TargetValueCommand","PropertyChangeCommand","ApplyFilterCommand","DeleteCommand","AddCommand","NameCommand","support","browser","msie","version","spreadsheet","_workbook","workbook","_property","property","_state","range","_setRange","_range","exec","setState","getState","state","_forEachCell","callback","ref","_ref","forEach","sheet","toRangeRef","bind","_target","target","_value","ColumnWidthCommand","columnWidth","RowHeightCommand","rowHeight","HyperlinkCommand","_link","link","_prevLink","_prevUnderline","underline","_hasSetValue","GridLinesChangeCommand","showGridLines","prototype","skipHiddenCells","enable","ClearContentCommand","clearContent","EditCommand","rejectState","validationState","title","message","reason","type","input","wrap","_adjustRowHeight","_getValidationState","calc","ParseError","TextWrapCommand","forEachRow","topLeft","row","_rowHeight","AdjustDecimalsCommand","_decimals","decimals","formatting","batch","forEachCell","col","cell","format","adjustDecimals","BorderChangeCommand","_type","border","_style","noBorders","borderLeft","borderTop","borderRight","borderBottom","allBorders","leftBorder","leftColumn","rightBorder","rightColumn","topBorder","topRow","bottomBorder","bottomRow","outsideBorders","insideBorders","insideHorizontalBorders","insideVerticalBorders","MergeCellCommand","activate","activeCell","unmerge","cells","merge","horizontally","vertically","forEachColumn","FreezePanesCommand","_topLeft","panes","frozenColumns","frozenRows","rows","columns","unfreeze","PasteCommand","_clipboard","clipboard","_event","event","activeSheet","pasteRef","status","preventDefault","canPaste","selection","paste","menuInvoked","pasteOnMerged","overflow","pasteOnDisabled","AdjustRowHeightCommand","rowIndex","ToolbarPasteCommand","_view","CopyCommand","noop","canCopy","copy","multiSelection","ToolbarCopyCommand","CutCommand","cut","AutoFillCommand","origin","_origin","fillFrom","Range","FillError","ToolbarCutCommand","FilterCommand","filter","hasFilter","SortCommand","column","ascending","expandRange","cantSort","_sheetRef","clearFilter","filterRule","exists","valueFilter","ValueFilter","customFilter","CustomFilter","eq","element","ClearFilterCommand","HideLineCommand","axis","setAxisState","getAxisState","axisManager","hideSelectedRows","hideSelectedColumns","UnHideLineCommand","unhideSelectedRows","unhideSelectedColumns","DeleteRowCommand","deleteSelectedRows","DeleteColumnCommand","deleteSelectedColumns","AddColumnCommand","preventAddColumn","addColumnLeft","addColumnRight","AddRowCommand","preventAddRow","addRowAbove","addRowBelow","EditValidationCommand","validation","OpenCommand","cannotUndo","file","match","fromFile","then","errors","excelImportErrors","openDialog","SaveAsCommand","fileName","extension","saveAsExcel","saveAsPDF","pdf","_name","nameDefinition","recalc","DefineNameCommand","defineName","DeleteNameCommand","undefineName","classNames","FormulaBar","wrapper","ui","Widget","formulaInput","FormulaInput","destroy","isOpenParen","isCloseParen","isMatchingParen","close","open","touches","begin","end","knownFunction","runtime","FUNCS","isEqualToken","tok1","tok2","ns","keys","styles","KEY_NAMES","PRIVATE_FORMULA_CHECK","listWrapper","27","37","39","35","36","32","attr","css","autoScale","on","scale","_highlightedRefs","_staticTokens","_formulaSource","_formulaList","_popup","_tooltip","_keydown","_keyup","_blur","_input","_focus","_paste","filterOperator","scalePadding","minLength","removeAttr","toggleClass","getPos","lookup","lookupNode","loop","node","nodeType","firstChild","nextSibling","nodeValue","div","sel","getSelection","focusNode","focusOffset","b","anchorNode","anchorOffset","collapsed","setPos","differ","startOffset","endOffset","startContainer","endContainer","len","el","currentRange","eiv","createRange","setStart","setEnd","getRangeAt","removeAllRanges","addRange","home","toUpperCase","formulaSource","DataSource","list","StaticList","insertAfter","autoBind","selectable","change","_formulaListChange","dataSource","dataValueField","template","e","activeToken","completion","ctx","tokenCtx","_tokenContext","_mute","token","replace","nextToken","_replaceAt","popup","Popup","anchor","clearTimeout","_focusId","_isFormula","keyCode","_navigated","_move","_keyDownTimeout","setTimeout","_syntaxHighlight","view","visible","focusFirst","_focusTimeout","ev","clipboardData","getData","originalEvent","substr","DOWN","focusNext","UP","focusPrev","focusLast","ENTER","TAB","PAGEUP","PAGEDOWN","tokens","tok","point","tokenize","_sync","_editorToSync","isActive","_textContainer","computedStyles","getComputedStyles","position","visibility","whiteSpace","top","left","_span","_cellTooltip","tooltip","toggleTooltip","show","toggle","_activeElement","field","operator","hide","rectangle","resize","canInsertRef","isKeyboardAction","idx","_canInsertRef","afterPoint","canReplace","canInsertBetween","right","strictMode","refAtPoint","simplify","newValue","rest","syncWith","iehandler","self","eventName","handler","off","txt","innerText","highlightedRefs","refClasses","Pane","series","refIndex","parens","active","cls","colorClass","unshift","reverse","htmlEncode","substring","_setStaticTokens","insertNewline","eof","Mac","isAlphaNum","keyName","EventListener","13","38","33","34","46","113","navigator","platform","indexOf","observer","handlers","_handlers","_observer","keyDownProxy","keyDown","mouseProxy","mouse","threshold","_pressLocation","documentElement","handleEvent","rightClick","dx","dy","distance","which","button","pageX","y","pageY","Math","sqrt","catchAllHandler","eventKey","mod","metaKey","ctrlKey","altKey","shiftKey","passThrough","skew","level","temp","insert","NilNode","RangeTreeNode","start","diff","heir","intersecting","ranges","intersects","tree","root","RangeTree","RangeList","Iterator","SparseRangeList","findrange","clone","first","last","firstRange","lastRange","rangeValue","rangeStart","rangeEnd","expandedValues","rangeIndex","sortedIndices","valueComparer","indices","comparer","sourceStart","sourceEnd","targetStart","iterator","unique","at","lastRangeStart","ValueRange","toExcelFormat","Property","JsonProperty","ValueProperty","set","dst","JSON","stringify","formats","validations","dateToNumber","culture","calendar","patterns","PropertyBag","specs","sortable","serializable","depends","cellCount","defaultValues","properties","lists","spec","fromJSON","si","iterators","forEachProperty","ALL_PROPERTIES","columnName","colIndex","letter","floor","displaySheet","displayRef","rel","aa","isFinite","Ref","NULL","NameRef","CellRef","RangeRef","UnionRef","hasSheet","_hasSheet","setSheet","absolute","relative","adjust","toString","print","obj","intersect","isCell","toRow","toColumn","rangeAt","nextRangeIndex","previousRangeIndex","reference","refs1","refs2","r1","r2","bottomRight","single","refs","concat","replaceAt","forEachColumnIndex","forEachAxisIndex","forEachRowIndex","sorted","method","valid","renameSheet","oldSheetName","newSheetName","display","ret","trow","tcol","abs","arow","acol","forRow","delta","tl","br","endSheet","normalize","_containsRange","_containsCell","contains","Array","that","some","_intersectRange","a_left","a_top","a_right","a_bottom","b_left","b_top","b_right","b_bottom","max","min","c1","c2","rr1","rc1","rr2","rc2","changes","relTL","relBR","collapse","toCell","startRow","endRow","startCol","endCol","union","topLeftRow","topLeftCol","bottomRightRow","bottomRightCol","modified","num","limit","bottom","move","cols","tr","u","reduce","empty","theRef","newRefs","splice","NULLREF","SHEETREF","Infinity","FIRSTREF","AutoFillCalculator","grid","_grid","rectIsVertical","startRect","endRect","autoFillDest","cursor","quadrant","pivot","opposite","cornerResult","expanding","bottomLeft","topRight","lower","further","EdgeNavigator","SheetNavigator","rangeGetter","prevLeft","prevVisible","nextRight","nextVisible","nextLeft","prevRight","boundary","_sheet","_columns","autoFillCalculator","colEdge","columnRange","rowEdge","_rows","rowRange","_viewPortHeight","unionWithMerged","leftCol","rightCol","selectionIncludesMergedCells","_mergedCells","setSelectionValue","selectAll","mode","addToExisting","refForMode","rowRef","colRef","startSelection","startAutoFill","completeSelection","selectForContextMenu","modifySelection","action","scrollInto","newSelection","direction","determineDirection","viewPortHeight","originalSelection","currentOriginalSelectionRange","prevPage","nextPage","firstVisible","lastVisible","updateCurrentSelectionRange","moveActiveCell","originalActiveCell","navigateInSelection","currentNavigationRange","selTopLeft","selBottomRight","done","nextNavigationRange","previousNavigationRange","shouldSkip","singleCellSelection","extendSelection","resizeAutoFill","isMerged","forEachMergedCell","merged","hint","preview","props","_autoFillOrigin","dest","punch","_previewFillFrom","updateAutoFill","currentSelectionRange","leftMode","rightMode","topMode","bottomMode","originalSelect","selectionRangeIndex","subset","bottomCol","AxisManager","forEachSelectedColumn","layout","forEachSelectedRow","includesHiddenColumns","includesHidden","includesHiddenRows","selectionIncludesHiddenColumns","selectionIncludesHiddenRows","deleteColumn","deleteRow","hasRight","hasLeft","hideColumn","_count","isHiddenColumn","hasBottom","hasTop","hideRow","isHiddenRow","unhideColumn","unhideRow","insertColumn","rowCount","preventInsertRow","preventInsertColumn","insertRow","newState","mergedCells","foreign","origRef","setStateData","stripStyle","borderObject","color","cellState","getComputedStyle","borders","fontSize","background","italic","bold","textAlign","verticalAlign","parseHTML","table","find","each","td","ci","ri","rowspan","colspan","blankCell","after","address","parseTSV","Clipboard","_content","_externalContent","_internalContent","iframe","className","_uid","guid","intersectsMerged","plain","destination","originActiveCell","rowDelta","colDelta","triggerChange","external","isExternal","_isInternal","doc","contentWindow","write","internalHTML","internalPlain","partition","predicate","looksLikeANumber","getTextHeight","font-size","word-break","white-space","PROPERTIES","complement","skipHiddenRows","skipHiddenCols","add","_normalize","_set","noTrigger","_get","_resizedRef","_border","_collapsedBorder","collapsedBorderTop","collapsedBorderRight","collapsedBorderBottom","collapsedBorderLeft","formula","t1","t2","existingFormat","existingFormatType","compile","editorChange","isInEditMode","numberToDate","_","__","toJSON","_validation","_merge","mergedRef","vi","_properties","setProp","line","propName","propValue","clearAll","contentsOnly","formatOnly","clearFormat","isSortable","mc","primary","secondary","cant","_getMergedCells","hasMerged","_sortBy","isFilterable","clearFilters","_filterBy","_filter","intersectingMerged","propertyName","dr","dc","maxHeight","cellRange","totalWidth","hasValue","yesItHas","defStyle","_defaultCellStyle","flag","draw","CalcError","argmax","compileArgumentChecks","functionName","args","comp","allowError","isArray","arrayArgs","resolve","cond","force","canBeArrayArg","hasArrayArgs","typeCheck","forced","haveForced","forceNum","round","err","main","Function","roundFloatErrors","integer","decimal","maybeRoundFloatErrors","withErrorHandling","makeSyncFunction","check","doit","xargs","Matrix","arrays","makeAsyncFunction","count","makeCallback","defineFunction","func","log","console","kendoSpreadsheetArgs","argsAsync","dateToJulianDays","julianDaysToDate","jd","year","month","date","day","ord","ORDINAL_ADD_DAYS","isLeapYear","yr","daysInYear","daysInMonth","mo","DAYS_IN_MONTH","unpackDate","serial","BASE_DATE","packDate","unpackTime","ms","hours","minutes","seconds","frac","MS_IN_DAY","MS_IN_HOUR","MS_IN_MIN","milliseconds","serialToDate","t","packTime","hh","mm","ss","dateToSerial","time","getHours","getMinutes","getSeconds","getMilliseconds","getFullYear","getMonth","getDate","parseDate","binaryCompare","exports","Context","Formula","NUMBER_OR_ZERO","ARGS_NUMERIC","ARGS_ANYVALUE","parent","resolveCells","_resolve","error","asMatrix","onFormula","fetch","context","pending","formulas","getRefCells","cellValues","getRefData","fetchName","nameValue","ValidationFormulaContext","fname","bool","h","isRange","hiddenInfo","includeEmpty","eachRow","eachCol","mapRow","mapCol","transpose","unit","multiply","s","va","vb","adds","sign","determinant","C","L","k","inverse","imax","augment","printer","absrefs","onReady","forceRefs","lcsheet","parentContext","next","reset","affectedSheet","operation","formulaRow","formulaCol","formulaSheet","formulaMoves","newFormulaRow","newFormulaCol","co","th","comatrix","thmatrix","elmatrix","defineAlias","alias","orig","kendoSpreadsheetAliases","pow","compileValidation","validationHandler","parsedFromDate","parsedToDate","from","dataType","fromIsListValue","TRANSPOSE_FORMAT","DATE_FORMAT","fromIsDateValue","parseFormula","to","toIsDateValue","validationComparers","custom","comparerType","valueToCompare","toValue","to_value","allowNulls","from_value","_getListData","Validation","showButton","tooltipMessageTemplate","tooltipTitleTemplate","messageTemplate","titleTemplate","_formatMessages","fromFormula","toFormula","_setMessages","tooltipTitle","tooltipMessage","cube","array","_getOptions","compareValue","compareFormat","getValue","calculateFromCallBack","greaterThan","lessThan","between","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","notBetween","Selection","Sheet","_activeCell","currentOriginalNavigationRange","expanded","changeActiveCell","triggerSelect","_reinit","columnCount","headerHeight","headerWidth","defaultCellStyle","fontFamily","Axis","_frozenRows","_frozenColumns","_suspendChanges","_showGridLines","_gridLinesColor","Grid","_sorter","Sorter","_viewSelection","_editSelection","_formulaSelections","_selectionState","_inEdit","_navigator","_axisManager","_sheetName","accessor","_field","suspendChanges","setDataSource","dataSourceBinder","SheetDataSourceBinder","columnIndex","unhide","hidden","_copyRange","sourceRangeRef","targetRef","nextRefTopLeft","nextRefBottomRight","nextIndex","nextBottomIndex","targetIndex","_adjustReferences","_sheets","_forFormulas","_forValidations","adjustNames","selectedHeaders","allRows","allCols","nextRef","isEnabledRow","isEnabledColumn","gridLinesColor","numRows","numColumns","parseReference","cellRef","forEachFilterHeader","columnRef","doIt","startCellIndex","endCellIndex","startResizing","initialPosition","_initialPosition","_resizeInProgress","_autoFillInProgress","_autoFillDest","_autoFillPunch","_autoFillHint","_autoFillDirection","autoFillRef","autoFillPunch","autoFillInProgress","resizingInProgress","completeResizing","hintPosition","handlePosition","resizeHintPosition","resizeHandlePosition","_resizeHandlePosition","location","_resizeHintPosition","removeResizeHandle","positionResizeHandle","_selectionInProgress","operatingRange","selectionInProgress","expandedRef","selectionState","isAxis","trim","trims","activeCellSelection","maxRow","maxCol","rowSelection","colSelection","rowState","colState","all","isInEdit","_setFormulaSelections","_viewActiveCell","clearDefaultStyle","json","positions","viewSelection","hyperlinks","parseColor","toCss","_sort","activeCellRef","_compileFormula","_compileValidation","Filter","_refreshFilter","logToConsole","_refresh","cellRefIndex","resetFormulas","resetValidations","revalidate","_copyValuesInRange","suspended","sortBy","prepare","matches","filterColumn","filterRef","_clearFilter","ALL_REASONS","currentRef","outerWidth","DOT","EMPTYCHAR","sheetsBarClassNames","SheetsBar","_outerWidth","sheetsBarWrapper","sheetsBarSheetsWrapper","sheetsBarActive","sheetsBarInactive","sheetsBarAdd","sheetsBarRemove","sheetsBarItems","sheetsBarEditor","sheetsBarScrollable","sheetsBarNext","sheetsBarPrev","sheetsBarKItem","sheetsBarKActive","sheetsBarKTextbox","sheetsBarKLink","sheetsBarKIcon","sheetsBarKFontIcon","sheetsBarKButton","sheetsBarKButtonBare","sheetsBarKArrowW","sheetsBarKArrowE","sheetsBarKReset","sheetsBarKIconX","sheetsBarKSprite","sheetsBarKIconPlus","sheetsBarHintWrapper","sheetsBarKResetItems","_openDialog","_tree","dom","Tree","render","_addButton","_createSheetsWrapper","_toggleScrollEvents","_createSortable","_sortable","_onSheetReorderStart","_onSheetReorderEnd","_onSheetRemove","_onSheetSelect","_createEditor","_onAddSelect","scrollable","_editor","_renderSheets","_selectedIndex","_onEditorKeydown","_onEditorBlur","_destroyEditor","canceled","_onSheetRename","renderSheets","sheets","selectedIndex","wrapperOffsetWidth","sheetsGroupScrollWidth","sheetsWrapper","scrollPrevButton","scrollNextButton","gapWidth","addButton","addButtonWidth","scrollPrevButtonWidth","sheetsGroup","scrollNextButtonRight","_isRtl","isRtl","_renderHtml","_scrollableAllowed","_sheetsWrapper","children","_sheetsGroup","marginLeft","scrollWidth","ceil","parseFloat","_scrollableModeActive","_nowScrollingSheets","marginRight","_toggleScrollButtons","ul","scrollLeft","_scrollSheetsByDelta","renderScrollButtons","isSelectedSheet","elementContent","deleteIcon","sheetElements","maxlength","baseButtonClass","childrenElements","Sortable","container","animation","ignore","draggable","closest","oldIndex","newIndex","closeCallback","removedSheetName","dlg","sender","isConfirmed","confirmation","selectedSheetText","_scrollSheetsToItem","isAddButton","sheetIndex","item","currentScrollOffset","itemWidth","itemOffset","sheetsGroupWidth","sheetsGroupPadding","itemPosition","finish","animate","scrLeft","getcol","getrow","noThrow","stream","OUT","TokenStream","addReference","allowEOF","peek","parseExpression","commas","maybeBinary","maybeIntersect","parseAtom","parseSymbol","upper","TRUE","FALSE","parseFuncall","fixReference","exp","parseArray","op","maybePercent","my_prec","his_prec","OPERATORS","ast","parseNameDefinition","def","defAST","nameRef","makeFormula","makePrinter","prec","withParens","needParens","parenthesize","arg","makeClosure","toCPS","cps","cpsRef","cpsAtom","cpsUnary","cpsBinary","cpsFunc","cpsLambda","cpsMatrix","cpsNameRef","makeContinuation","cpsIf","thenK","gensym","elseK","vars","cpsAnd","cpsOr","cont","elements","isMatrix","GENSYM","js","jsArray","FORMULA_CACHE","identity","readNext","ahead","refRange3D","refCell3D","refSheetRange","refSheetCell","refRange","refCell","funcall","isFirst","forEditor","fixCell","g","space","addPos","RawTokenStream","InputStream","startToken","endToken","isIdStart","isId","isOpChar","isPunc","readNumber","has_dot","number","symbol","getRC","readSymbol","lookingAt","readString","readEscaped","readSheetName","readOperator","readPunc","EOF","forward","escaped","rx","parseSqref","getNumberRegexp","comma","dot","NUMBER_FORMAT_RX","repeat","FORMAT_PARSERS","registerFormatParser","ops","p","numberFormat","currency","rxnum","rxcur","suffix","has_currency","readExcel","deferred","reader","FileReader","onload","zip","JSZip","readWorkbook","readAsArrayBuffer","xl","progress","strings","relationships","theme","items","loading","ERROR_LOG","readStrings","readRelationships","readTheme","byType","readStyles","enter","tag","relId","dim","SEL_SHEET","byId","sheetDimensions","SEL_VIEW","activeTab","localSheetId","SEL_DEFINED_NAME","vbProcedure","withErrorLog","Deferred","notify","recalcSheets","loadSheets","ready","promise","insertSheet","queueSheet","readSheet","defaultColWidth","toColWidth","defaultRowHeight","toRowHeight","SEL_ROW","maximumDigitWidth","fraction","pts","formulaRange","formula1","formula2","customFilterLogic","customFilterCriteria","valueFilterBlanks","valueFilterValues","nCols","prevCellRef","relsFile","filters","styleIndex","stop","acRef","SEL_CELL","applyStyle","SEL_MERGE","SEL_COL","ht","SEL_SELECTION","SEL_PANE","xSplit","ySplit","SEL_SHEET_VIEW","SEL_HYPERLINK","colId","and","getCustomFilter","DynamicFilter","dynamicFilterType","TopFilter","getFilterVal","percent","blank","leave","failed","SEL_VALIDATION","sqref","showErrorMessage","MAP_EXCEL_OPERATOR","allowBlank","showDropDown","errorTitle","logic","criteria","blanks","SEL_VALUE","SEL_STRING","SEL_FORMULA","SEL_VALIDATION_FORMULA1","SEL_VALIDATION_FORMULA2","ourOp","equal","notEqual","greaterThanOrEqual","lessThanOrEqual","Q1","Q2","Q3","Q4","M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","setFormat","formatCode","setFill","setFont","setBorder","side","prop","BORDER_WIDTHS","shouldSet","applyName","xf","base","inlineStyles","xfId","namedStyles","fonts","fills","numFmts","DEFAULT_FORMATS","part","files","asUint8Array","SEL_SHARED_STRING","SEL_TEXT","entries","Id","Target","Type","getXf","addBool","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","getColor","themeColor","tint","rgb","toCSSColor","indexed","INDEXED_COLORS","colorScheme","toHSL","toCssRgba","font","fill","closed","SEL_NUM_FMT","SEL_FONT","SEL_FILL","patternType","SEL_BORDER","SEL_NAMED_STYLE","SEL_INLINE_STYLE","horizontal","vertical","wrapText","swap","arr","scheme","SEL_SCHEME_SYSCLR","SEL_SCHEME_RGBCLR","none","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantDashDot","0","11","12","14","15","16","17","18","19","21","22","45","47","48","49","_readSheet","_readStrings","_readStyles","_readTheme","_readWorkbook","sheetParamsFromJSON","or","Workbook","_sheetsSearchCache","undoRedoStack","_onUndoRedo","_context","FormulaContext","_validationContext","_names","unbind","_sheetChange","_sheetInsertRow","_sheetInsertColumn","_sheetDeleteRow","_sheetDeleteColumn","_sheetHideRow","_sheetHideColumn","_sheetUnhideRow","_sheetUnhideColumn","_sheetSelect","_sheetCommandRequest","_inputForRef","execute","commandOptions","editActiveCell","refresh","sheetByName","moveSheetToIndex","toIndex","fromIndex","sheetSelection","insertIndex","sheetName","getUniqueSheetName","sheetNameSuffix","_bindSheetEvents","sheetByIndex","forEachName","nameref","removeSheet","newSheet","_clearSheets","names","localName","reject","excel","ooxml","saveAs","dataURI","toDataURL","proxyURL","forceProxy","group","nameForRef","PDFMixin","_drawPDF","drawing","exportPDF","proxyTarget","fail","area","fsheet","frow","fcol","states","currentFormula","_formulaContextRefresh","toActionSelector","selectors","alphaNumRegExp","ACTIONS","ENTRY_ACTIONS","CONTAINER_EVENTS","CLIPBOARD_EVENTS","EDITOR_EVENTS","FORMULABAR_EVENTS","FORMULAINPUT_EVENTS","SELECTION_MODES","COMPOSITE_UNAVAILABLE_ACTION_SELECTORS","UNHIDE_ACTION_SELECTORS","ACTION_KEYS","SHIFT_ACTION_KEYS","ENTRY_ACTION_KEYS","Controller","up","down","ctrl+left","ctrl+right","ctrl+up","ctrl+down","ctrl+home","ctrl+end","pageup","pagedown","tab","shift+tab","shift+enter","delete","backspace","shift+:alphanum",":alphanum","ctrl+:alphanum","alt+ctrl+:alphanum",":edit","wheel","*+mousedown","contextmenu","*+mousedrag","*+mouseup","*+dblclick","mousemove","*+pageup","*+pagedown","mouseup","*+cut","*+paste","*+copy","esc","alt+enter","rowheader","columnheader","topcorner","autofill","clipboardElement","cellContextMenu","rowHeaderContextMenu","colHeaderContextMenu","scroller","tabstrip","sheetsbar","nameEditor","onNameEditorEnter","onNameEditorCancel","onNameEditorSelect","onNameEditorDelete","editor","onEditorChange","onEditorActivate","onEditorDeactivate","onEditorUpdate","onScroll","listener","_enableEditorEvents","onSheetBarSelect","onSheetBarReorder","onSheetBarRename","onSheetBarRemove","onContextMenuSelect","onCommandRequest","onDialogRequest","keyListener","barKeyListener","barElement","inputKeyListener","cellElement","_execute","editorClose","_preventNavigation","showError","activateEditor","_lastEditorValue","_activeTooltip","clientHeight","isEditorDisabled","onWheel","deltaX","deltaY","deltaMode","scrollWith","onAction","onPageUp","scrollDown","onPageDown","onEntryAction","shouldPrevent","disabled","onShiftAction","appendSelection","onMouseMove","objectAt","onMouseDown","pane","originFrame","onEditorEsc","openCustomEditor","_selectionMode","deactivate","openFilterMenu","onContextMenu","menu","isComposite","showUnhide","showUnmerge","prevent","constrainResize","resizeHandle","onMouseDrag","frame","clientX","clientY","startAutoScroll","selectToLocation","scrollTop","onMouseUp","stopAutoScroll","activeEditor","onDblClick","rect","activeCellRectangle","onCut","detach","append","clipBoardValue","onPaste","hasHTML","hasPlainText","DOMStringList","types","onCopy","scrollRight","getBoundingClientRect","cellLocation","lastKnownCellLocation","autoScroll","_autoScrollTarget","boundaries","scrollStep","finalLocation","viewObject","_scrollInterval","setInterval","clearInterval","filterMenu","createFilterMenu","openFor","onEditorBarFocus","onEditorCellFocus","resetEditorValue","onEditorBlur","isFiltered","onEditorAction","onEditorShiftAction","deactivateEditor","additionalOptions","pdfExport","excelExport","selectElementContents","selectNodeContents","cellBefore","trs","cellAbove","prevRow","cellBorder","asURL","drawCell","collection","hBorders","vBorders","showGrid","maybeLink","textDecoration","href","defaultBorder","shouldDrawCell","toHSV","backgroundColor","fontStyle","fontWeight","overflowWrap","wordWrap","__dataType","paneClassNames","addCell","sibling","wordBreak","borderRightColor","borderBottomColor","borderLeftColor","borderTopColor","within","RESIZE_HANDLE_WIDTH","viewClassNames","HtmlTable","CELL_CONTEXT_MENU","ROW_HEADER_CONTEXT_MENU","COL_HEADER_CONTEXT_MENU","VIEW_CONTENTS","View","fixedContainer","editContainer","viewSize","cellEditor","barEditor","topCorner","filterHeadersWrapper","filterRange","filterButton","filterButtonActive","horizontalResize","verticalResize","icon","iconFilterDefault","sheetsBar","messages","openUnsupported","shiftingNonblankCells","insertColumnWhenRowIsSelected","insertRowWhenColumnIsSelected","filterRangeContainingMerges","sortRangeContainingMerges","cantSortMultipleSelection","cantSortNullRef","cantSortMixedCells","validationError","cannotModifyDisabled","tabs","_height","_width","addColumn","addRow","Node","toDomTree","offset","ContextMenu","contextMenuConfig","scrollbar","_chrome","_dialogs","_formulaInput","clipboardContents","SheetEditor","_sheetsbar","showOn","clientWidth","enableClipboard","isClipboardDeactivated","_resize","outerHeight","_outerHeight","tabstripHeight","formulaBarHeight","formulaBar","sheetsBarHeight","quickAccessAdjust","prependTo","NameEditor","toolbar","_tabstrip","content","TabStrip","dataTextField","dataContentField","toolbarOptions","_executeCommand","cellRectangle","_rectangle","boundingRectangle","isColumnResizer","handleWidth","_headerWidth","isRowResizer","_headerHeight","isFilterIcon","theGrid","frozen","filterIconRect","isAutoFill","isEditButton","ed","activeCellCustomEditor","selecting","paneAt","containingPane","refreshTools","totalHeight","_pane","_destroyFilterMenu","_filterMenu","FilterMenu","selectClipBoardContents","scrollIntoView","willScroll","scrollBoundaries","scrollBottom","_destroyDialog","edit","dialog","dialogs","reopenEditor","dialogOptions","errorMessages","focusButton","ESC","onClose","_retry","registered","_filterMenuColumn","resizeDirection","renderResizeHint","renderClipboardContents","resizeHint","resizeHintVertical","resizeHintHandle","resizeHintMarker","selectionView","primaryMergedCells","secondaryMergedCells","rangeDimensions","mergedCell","vaxis","haxis","rowHeader","columnHeader","mergedCellsWrapper","selectionWrapper","autoFillWrapper","columnResizeHandle","rowResizeHandle","selectionHighlight","isVisible","paneClasses","_currentView","_currentRect","_selectedHeaders","renderData","renderSelection","renderAutoFill","renderEditorSelection","renderFilterHeaders","hasRowHeader","rowOffset","headerClassName","hasColumnHeader","columnOffset","renderResizeHandle","itemSelection","allHeaders","doLayout","forScreen","xCoords","borderColor","yCoords","hb","BUTTON_SIZE","BUTTON_OFFSET","Rectangle","filtered","classes","_addDiv","selections","activeCellClasses","selectionClasses","activeFormulaColor","_activeFormulaColor","_directionClasses","_addTable","cssClass","autoFillRectangle","toDiv","btn","activeFormulaSelection","colorClasses","cellClasses","mergedCellLeft","mergedCellTop","EDITORS","registerEditor","kendoCalendar","kendoPopup","getKendoCalendar","getKendoPopup","setOptions","Calendar","disableDates","kendoStaticList","getKendoStaticList","matrix","read","PaneGrid","sum","total","PaneAxis","rangeRef","headerSize","hasHeader","paneSegment","_viewSize","widthCompensation","defaultValue","heightCompensation","_hidden","scrollBarSize","pageSize","firstHidden","lastHidden","startIndex","endIndex","startSegment","endSegment","lastPage","_pixelValues","_axis","_start","quarter","sameYear","today","setFullYear","sameMonth","firstDayOfMonth","setMonth","sameWeek","firstWeek","secondWeek","dayOfWeek","constructor","_values","_dates","_blanks","dates","_logic","_criteria","expression","Query","filterExpr","_matches","criterionValue","criterionType","valueType","_predicate","_average","aboveAverage","belowAverage","tomorrow","addDays","isToday","yesterday","nextWeek","thisWeek","lastWeek","nextMonth","thisMonth","lastMonth","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","yearToDate","cultures","months","_lists","ascendingComparer","descendingComparer","li","typeA","typeB","localeCompare","maybeColor","RX_COLORS","maybeCondition","RX_CONDITION","readFormat","maybeFraction","sep","decimalPart","am","pm","readSection","sections","haveConditional","sec","printSection","printToken","fmt","padLeft","adjusted","restart","compileFormatPart","checkComma","scaleCount","hasDate","hasTime","hasAmpm","percentCount","separeThousands","declen","intFormat","decFormat","condition","preamble","CACHE","TEXT","calendars","standard","days","namesAbbr","ampm","fraclen","toFixed","eltime","formatInt","iv","chf","formatDec","span","textAndColor","_cosh","_sinh","_tanh","_gcd","_lcm","forIFS","chunks","parseCriteria","COL","_avg","numbers","_var_sp","divisor","avg","_stdev_sp","_percentrank","exc","nlt","ngt","found","_covariance","ax","ay","_percentile","rank","_percentile_inc","_percentile_exc","fetchValuesForAggregate","opt_ignore_hidden_rows","opt_ignore_errors","opt_use_aggregates","fetchValues","_binom_dist","cumulative","_combinations","weeksInYear","_days_360","d1","d2","Hyperlink","numericPredicate","descending","ARGS_COUNTIFS","ARGS_SUMIFS","ARGS_SUMIF","ARGS_PERCENTRANK","_fact","AGGREGATE_FUNCS","RX_NON_PRINTABLE","PI","rad","deg","cos","sin","atan","tan","mult","prod","coef","seen","m1","sumRange","nth","res","discard","bins","asc","variance","stddev","significance","fact","f1","f2","p1","p2","funcId","ignoreHidden","alpha","s2","approx","resultCol","areanum","colRange","cmp","resultRow","fw","sy","dow","wk","holidays","inc","random","rom","radix","minLen","dec","string","noCommas","newText","oldText","valueIfError","makeComparator","lc","compLT","compLTE","compGT","compGTE","compNE","compEQ","RXCACHE","ERF","S","an","f_abs","ERFC","GAMMALN","cof","ser","GAMMA","pi","BETALN","BETA","gamma_inc","g_series","g_contfrac","ap","gln","MAX_IT","EPS","FP_MIN","aj","bj","GAMMA_DIST","GAMMA_INV","M","ab","q","NORM_S_DIST","NORM_S_INV","plow","phigh","NORM_DIST","NORM_INV","betastd_pdf","betastd_cdf","beta_lentz","m2","del","qab","qap","qam","betastd_inv","BETADIST","BETA_DIST","cdf","BETA_INV","chisq_left","cds","chisq_right","chisq_left_inv","chisq_right_inv","chisq_test","obsv","expect","eij","expon","poisson","lnf","Fdist","Fdist_right","Finv_right","Finv","_mean","me","_var_sq","Ftest","arr1","arr2","n1","n2","va1","va2","fisher","fisherinv","e2","Tdist","Tdist_right","Tdist_2tail","Tdist_inv","Tdist_2tail_inv","Tdist_test","gr1","gr2","tail","t_st","df","md","v1","v2","u1","u2","q1","q2","confidence_t","confidence_norm","gauss","z","phi","lognorm_dist","lognorm_inv","prob","x_","p_","lw","slope","y_","mx","my","b1","b2","intercept","pearson","s1","s3","rsq","steyx","forecast","_mat_mean","Mat","_mat_devsq","mean","sq","linest","Y","X","konst","stats","Xt","B","line_1","Y1","y_y1","mp","SSreg","SSresid","line_5","R2","degfre","err_est","line_3","F_sta","line_4","SCP","line_2","logest","trend","W","growth","new_X","root_newton","guess","max_it","eps","f_d","FV","rate","nper","pmt","pv","h1","h2","PV","fv","PMT","NPER","RATE","xfd","IPMT","per","ipmt","PPMT","CUMPRINC","tn","ts","te","monthlyPayment","remainingBalanceAtStart","remainingBalanceAtEnd","CUMIPMT","cip","NPV","flows","npv","IRR","npv1","EFFECT","nominal_rate","npery","NOMINAL","effect_rate","XNPV","XIRR","ISPMT","DB","cost","salvage","life","period","db","DDB","factor","prior","dep","SLN","SYD","VDB","no_switch","_getGDA","gda","oldValue","interest","_interVDB","life1","term","remValue","intEnd","lia","vdb","nowLia","intStart","_edate","_daysBetween","basis","_borderCoupons","settlement","maturity","freq","sett","periods","_borderCoupons_fw","COUPDAYBS","frequency","COUPDAYS","settl","matur","COUPDAYSNC","COUPPCD","COUPNCD","COUPNUM","mat","ACCRINTM","issue","par","year_days","ACCRINT","_numCoupons","annual","brace","prev1","next1","nrc","accr","DISC","pr","redemption","INTRATE","investment","RECEIVED","discount","PRICE","yld","N","beg_settl","settl_end","beg_end","den","yf","PRICEDISC","dsm","COUPS_ARGS","ll","ac","withPreventDefault","BORDER_TYPES","BORDER_PALETTE_MESSAGES","ColorChooser","BorderPalette","borderPalette","customColor","cancel","_resetButton","_colorPalette","_customColorPalette","_customColorButton","resetButton","resetColor","customColorButton","colorPalette","flatColorPicker","_change","class","kendoColorPalette","palette","viewModel","kendoWindow","resizable","maximizable","modal","center","one","_hueSlider","kendoFlatColorPicker","observable","_borderTypePalette","_borderColorPalette","_click","colorChooser","buttons","_colorChange","currentTarget","ToolBar","MESSAGES","defaultTools","toolDefaults","SpreadsheetToolBar","DropDownTool","PopupTool","OverflowDialogButton","ColorPicker","ColorPickerButton","FONT_SIZES","DEFAULT_FONT_SIZE","FontSize","FontSizeButton","FONT_FAMILIES","DEFAULT_FONT_FAMILY","FontFamily","FontFamilyButton","defaultFormats","Format","FormatButton","BorderChangeTool","BorderChangeButton","AlignmentTool","AlignmentButton","MergeTool","MergeButton","FreezeTool","FreezeButton","Sort","SortButton","FilterButton","Open","alignment","alignmentButtons","justtifyLeft","justifyCenter","justifyRight","justifyFull","alignTop","alignMiddle","alignBottom","colorPicker","formatTypes","automatic","financial","dateTime","duration","moreFormats","formatDecreaseDecimal","formatIncreaseDecimal","freeze","freezeButtons","freezePanes","freezeRows","freezeColumns","mergeButtons","mergeCells","mergeHorizontally","mergeVertically","quickAccess","exportAs","toggleGridlines","sortAsc","sortDesc","sortButtons","sortSheetAsc","sortSheetDesc","sortRangeAsc","sortRangeDesc","textColor","textWrap","hyperlink","iconClass","dialogName","togglable","separator","formatCells","_expandTools","tools","toolbarName","handleClick","_addSeparators","click","groups","before","expandTool","toolName","isPlainObject","spriteCssClass","typeDefaults","showText","toolIcon","tool","attributes","menuButtons","commandType","checked","setToggle","update","_tools","isFunction","toArray","_getItem","instance","Item","dropDownList","kendoDropDownList","addUidAttr","addOverflowAttr","_open","data-command","data-property","listWidth","ddl","_listWidth","dataItem","popupName","registerComponent","ToolBarButton","_dialogName","OverflowButton","iconName","comboBox","kendoComboBox","_valueChange","clearButton","fontSizes","sizes","defaultSize","fontFamilies","defaultFont","_revertTitle","dataValuePrimitive","valueTemplate","sample","_borderPalette","_action","_commandPalette","removeClass","_title","_reset","_quickAccessButtons","toolbars","contentElements","_toolbar","quickAccessToolBar","hasOwnProperty","buttonTemplate","insertBefore","tabGroup","formattedValue","uniqueBy","inArray","basicErrorDialog","register","MessageDialog","messageId","ObservableObject","registry","SpreadsheetDialog","FormatCellsViewModel","FormatCellsDialog","ConfirmationDialog","ValidationErrorDialog","FontFamilyDialog","FontSizeDialog","BordersDialog","ColorPickerDialog","CustomColorDialog","AlignmentDialog","MergeDialog","FreezeDialog","ValidationViewModel","ValidationDialog","ExportAsDialog","ImportErrorDialog","UseKeyboardDialog","HyperlinkDialog","retry","revert","okText","formatCellsDialog","categories","fontFamilyDialog","fontSizeDialog","bordersDialog","alignmentDialog","mergeDialog","freezeDialog","confirmationDialog","validationDialog","hintMessage","hintTitle","any","comparers","comparerMessages","labels","onInvalidData","rejectInput","showWarning","showHint","ignoreBlank","showListButton","showCalendarButton","placeholders","typeTitle","typeMessage","exportAsDialog","fit","saveAsType","exportArea","paperSize","margins","orientation","guidelines","modifyMergedDialog","errorMessage","rangeDisabledDialog","incompatibleRangesDialog","noFillDirectionDialog","duplicateSheetNameDialog","overflowDialog","useKeyboardDialog","forCopy","forCut","forPaste","unsupportedSelectionDialog","linkDialog","url","removeLink","dialogClass","autoFocus","_dialog","_onDialogClose","_onDialogActivate","_onDialogDeactivate","useCategory","category","formatCurrency","currencies","allFormats","useFirstFormat","info","_currency","iso","convert","categoryFilter","pattern","abbr","defaultOptions","_generateFormats","calendarPatterns","currenciesFrom","numberFormats","dateFormats","currencyFilter","roleSelector","description","getter","confirm","_confirmed","_list","_colorPicker","ValidationCellsViewModel","criterion","setHintMessageTemplate","shouldBuild","buildMessages","hintTitleTemplate","hintMessageTemplate","setComparers","defaultHintTitle","text_comparers","defaultComparers","defaultHintMessage","isAny","isNumber","showToForNumber","showTo","showToForDate","isDate","isText","isList","isCustom","showRemove","fromValidationObject","useCustomMessages","toValidationObject","errorTemplate","validatable","Validator","validateOnBlur","validate","fileFormats","author","subject","keywords","creator","fitWidth","areas","paperSizes","margin","landscape","hCenter","vCenter","model","stopPropagation","o","_normalizeColumns","_dataSource","_header","_boundRowsCount","_sheetChangeHandler","_sheetDeleteRowHandler","_sheetInsertRowHandler","fields","getters","normalizedRef","_skipRebind","record","valueIndex","colValueIndex","_changeHandler","getterIdx","distinctValues","query","itemVisible","anyVisibleChildren","hasVisibleChildren","HierarchicalDataSource","uncheckAll","hasChildren","flattenOperators","operators","FILTERMENU_MESSAGES","Details","templates","FilterMenuViewModel","FilterMenuController","details","detailsSummary","detailsContent","iconCollapse","iconExpand","iconSearch","textbox","filterByCondition","filterByValue","valuesTreeViewWrapper","actionButtons","_summary","_toggle","_icon","_container","fx","expand","sortAscending","sortDescending","search","addToCurrent","operatorNone","doesnotcontain","startswith","endswith","doesnotmatch","neq","gte","lte","binders","spreadsheetFilterValue","Binder","bindings","proxy","widget","binding","menuItem","valuesChange","valuesDataSource","lastIndexOf","appendToSearch","valueSelect","hasActiveSearch","filterValues","operatorChange","isNone","isString","valuesTree","filterType","topValue","filterForColumn","allFilters","columnFilters","_filterInit","_filterByCondition","_filterByValue","_actionButtons","valuesTreeView","_active","activeFilter","copyAnchorStyles","dir","kendoMenu","_appendTemplate","compiledTemplate","_detailToggle","not","isExpanded","activeContainer","hasClass","oldRect","newRect","barInput","cellInput","_triggerUpdate","activeElement","_rect","inputType","linearRegression","findSeries","findStep","forEachSeries","formatType","getType","lst","findStringList","stringLists","strl","ERR_INCOMPATIBLE","ERR_NO_DIRECTION","srcRange","src","srcIdx","destRange","CLASS_NAMES","transport","success","combo","ignoreCase","_on_listChange","noDataTemplate","getKendoComboBox","_on_keyDown","_on_focus","_deleteItem","_prevValue","distributeCoords","heights","pageHeight","curr","pageWidth","scaleFactor","boxWidth","boxHeight","rowHeights","colWidths","nonEmpty","relrow","relcol","rh","cw","emptyCells","orlast","normalOrder","drawLayout","addPage","page","endbottom","endright","Group","clip","Path","fromRect","geo","Rect","multiplyCopy","translate","transform","moveTo","lineTo","stroke","GUIDELINE_WIDTH","ncols","nrows","r2d2","drawText","vtrans","text_group","CONT","boxSizing","padding","lineHeight","makeFontDef","createTextNode","drawDOM","paper","getPaperOptions","multiPage","geometry","NS","Spreadsheet","_controller","_autoRefresh","_bindWorkbookEvents","_resizeHandler","_workbookChange","_workbookCut","_workbookCopy","_workbookPaste","autoRefresh","blob","_workbookExcelExport","_workbookExcelImport","_initProgress","pb","kendoProgressBar","chunkCount","always","_workbookPdfExport","_workbookInsertSheet","_workbookRemoveSheet","_workbookSelectSheet","_workbookRenameSheet","_workbookInsertRow","_workbookInsertColumn","_workbookDeleteRow","_workbookDeleteColumn","_workbookHideRow","_workbookHideColumn","_workbookUnhideRow","_workbookUnhideColumn","_workbookSelect","_workbookChangeFormat","plugin"],"mappings":"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","file":"kendo.spreadsheet.min.js","sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function (f, define) {\n    define('util/undoredostack', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var UndoRedoStack = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.clear();\n            },\n            events: [\n                'undo',\n                'redo'\n            ],\n            push: function (command) {\n                this.stack = this.stack.slice(0, this.currentCommandIndex + 1);\n                this.currentCommandIndex = this.stack.push(command) - 1;\n            },\n            undo: function () {\n                if (this.canUndo()) {\n                    var command = this.stack[this.currentCommandIndex--];\n                    command.undo();\n                    this.trigger('undo', { command: command });\n                }\n            },\n            redo: function () {\n                if (this.canRedo()) {\n                    var command = this.stack[++this.currentCommandIndex];\n                    command.redo();\n                    this.trigger('redo', { command: command });\n                }\n            },\n            clear: function () {\n                this.stack = [];\n                this.currentCommandIndex = -1;\n            },\n            canUndo: function () {\n                return this.currentCommandIndex >= 0;\n            },\n            canRedo: function () {\n                return this.currentCommandIndex != this.stack.length - 1;\n            }\n        });\n        kendo.deepExtend(kendo, { util: { UndoRedoStack: UndoRedoStack } });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/text-metrics', ['kendo.core'], f);\n}(function () {\n    (function ($) {\n        window.kendo.util = window.kendo.util || {};\n        var LRUCache = kendo.Class.extend({\n            init: function (size) {\n                this._size = size;\n                this._length = 0;\n                this._map = {};\n            },\n            put: function (key, value) {\n                var map = this._map;\n                var entry = {\n                    key: key,\n                    value: value\n                };\n                map[key] = entry;\n                if (!this._head) {\n                    this._head = this._tail = entry;\n                } else {\n                    this._tail.newer = entry;\n                    entry.older = this._tail;\n                    this._tail = entry;\n                }\n                if (this._length >= this._size) {\n                    map[this._head.key] = null;\n                    this._head = this._head.newer;\n                    this._head.older = null;\n                } else {\n                    this._length++;\n                }\n            },\n            get: function (key) {\n                var entry = this._map[key];\n                if (entry) {\n                    if (entry === this._head && entry !== this._tail) {\n                        this._head = entry.newer;\n                        this._head.older = null;\n                    }\n                    if (entry !== this._tail) {\n                        if (entry.older) {\n                            entry.older.newer = entry.newer;\n                            entry.newer.older = entry.older;\n                        }\n                        entry.older = this._tail;\n                        entry.newer = null;\n                        this._tail.newer = entry;\n                        this._tail = entry;\n                    }\n                    return entry.value;\n                }\n            }\n        });\n        function objectKey(object) {\n            var parts = [];\n            for (var key in object) {\n                parts.push(key + object[key]);\n            }\n            return parts.sort().join('');\n        }\n        function hashKey(str) {\n            var hash = 2166136261;\n            for (var i = 0; i < str.length; ++i) {\n                hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);\n                hash ^= str.charCodeAt(i);\n            }\n            return hash >>> 0;\n        }\n        function zeroSize() {\n            return {\n                width: 0,\n                height: 0,\n                baseline: 0\n            };\n        }\n        var DEFAULT_OPTIONS = { baselineMarkerSize: 1 };\n        var defaultMeasureBox;\n        if (typeof document !== 'undefined') {\n            defaultMeasureBox = document.createElement('div');\n            defaultMeasureBox.style.cssText = 'position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;' + 'padding: 0 !important; margin: 0 !important; border: 0 !important;' + 'line-height: normal !important; visibility: hidden !important; white-space: nowrap!important;';\n        }\n        var TextMetrics = kendo.Class.extend({\n            init: function (options) {\n                this._cache = new LRUCache(1000);\n                this.options = $.extend({}, DEFAULT_OPTIONS, options);\n            },\n            measure: function (text, style, box) {\n                if (!text) {\n                    return zeroSize();\n                }\n                var styleKey = objectKey(style);\n                var cacheKey = hashKey(text + styleKey);\n                var cachedResult = this._cache.get(cacheKey);\n                if (cachedResult) {\n                    return cachedResult;\n                }\n                var size = zeroSize();\n                var measureBox = box || defaultMeasureBox;\n                var baselineMarker = this._baselineMarker().cloneNode(false);\n                for (var key in style) {\n                    var value = style[key];\n                    if (typeof value !== 'undefined') {\n                        measureBox.style[key] = value;\n                    }\n                }\n                measureBox.textContent = text;\n                measureBox.appendChild(baselineMarker);\n                document.body.appendChild(measureBox);\n                if (String(text).length) {\n                    size.width = measureBox.offsetWidth - this.options.baselineMarkerSize;\n                    size.height = measureBox.offsetHeight;\n                    size.baseline = baselineMarker.offsetTop + this.options.baselineMarkerSize;\n                }\n                if (size.width > 0 && size.height > 0) {\n                    this._cache.put(cacheKey, size);\n                }\n                measureBox.parentNode.removeChild(measureBox);\n                return size;\n            },\n            _baselineMarker: function () {\n                var marker = document.createElement('div');\n                marker.style.cssText = 'display: inline-block; vertical-align: baseline;width: ' + this.options.baselineMarkerSize + 'px; height: ' + this.options.baselineMarkerSize + 'px;overflow: hidden;';\n                return marker;\n            }\n        });\n        TextMetrics.current = new TextMetrics();\n        function measureText(text, style, measureBox) {\n            return TextMetrics.current.measure(text, style, measureBox);\n        }\n        kendo.deepExtend(kendo.util, {\n            LRUCache: LRUCache,\n            TextMetrics: TextMetrics,\n            measureText: measureText,\n            objectKey: objectKey,\n            hashKey: hashKey\n        });\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/main', ['kendo.core'], f);\n}(function () {\n    (function () {\n        var kendo = window.kendo, deepExtend = kendo.deepExtend;\n        function sqr(value) {\n            return value * value;\n        }\n        var now = Date.now;\n        if (!now) {\n            now = function () {\n                return new Date().getTime();\n            };\n        }\n        function renderSize(size) {\n            if (typeof size !== 'string') {\n                size += 'px';\n            }\n            return size;\n        }\n        function renderPos(pos) {\n            var result = [];\n            if (pos) {\n                var parts = kendo.toHyphens(pos).split('-');\n                for (var i = 0; i < parts.length; i++) {\n                    result.push('k-pos-' + parts[i]);\n                }\n            }\n            return result.join(' ');\n        }\n        function arabicToRoman(n) {\n            var literals = {\n                1: 'i',\n                10: 'x',\n                100: 'c',\n                2: 'ii',\n                20: 'xx',\n                200: 'cc',\n                3: 'iii',\n                30: 'xxx',\n                300: 'ccc',\n                4: 'iv',\n                40: 'xl',\n                400: 'cd',\n                5: 'v',\n                50: 'l',\n                500: 'd',\n                6: 'vi',\n                60: 'lx',\n                600: 'dc',\n                7: 'vii',\n                70: 'lxx',\n                700: 'dcc',\n                8: 'viii',\n                80: 'lxxx',\n                800: 'dccc',\n                9: 'ix',\n                90: 'xc',\n                900: 'cm',\n                1000: 'm'\n            };\n            var values = [\n                1000,\n                900,\n                800,\n                700,\n                600,\n                500,\n                400,\n                300,\n                200,\n                100,\n                90,\n                80,\n                70,\n                60,\n                50,\n                40,\n                30,\n                20,\n                10,\n                9,\n                8,\n                7,\n                6,\n                5,\n                4,\n                3,\n                2,\n                1\n            ];\n            var roman = '';\n            while (n > 0) {\n                if (n < values[0]) {\n                    values.shift();\n                } else {\n                    roman += literals[values[0]];\n                    n -= values[0];\n                }\n            }\n            return roman;\n        }\n        function romanToArabic(r) {\n            r = r.toLowerCase();\n            var digits = {\n                i: 1,\n                v: 5,\n                x: 10,\n                l: 50,\n                c: 100,\n                d: 500,\n                m: 1000\n            };\n            var value = 0, prev = 0;\n            for (var i = 0; i < r.length; ++i) {\n                var v = digits[r.charAt(i)];\n                if (!v) {\n                    return null;\n                }\n                value += v;\n                if (v > prev) {\n                    value -= 2 * prev;\n                }\n                prev = v;\n            }\n            return value;\n        }\n        function memoize(f) {\n            var cache = Object.create(null);\n            return function () {\n                var id = '';\n                for (var i = arguments.length; --i >= 0;) {\n                    id += ':' + arguments[i];\n                }\n                return id in cache ? cache[id] : cache[id] = f.apply(this, arguments);\n            };\n        }\n        function isUnicodeLetter(ch) {\n            return RX_UNICODE_LETTER.test(ch);\n        }\n        deepExtend(kendo, {\n            util: {\n                now: now,\n                renderPos: renderPos,\n                renderSize: renderSize,\n                sqr: sqr,\n                romanToArabic: romanToArabic,\n                arabicToRoman: arabicToRoman,\n                memoize: memoize,\n                isUnicodeLetter: isUnicodeLetter\n            }\n        });\n        var RX_UNICODE_LETTER = new RegExp('[\\\\u0041-\\\\u005A\\\\u0061-\\\\u007A\\\\u00AA\\\\u00B5\\\\u00BA\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02C1\\\\u02C6-\\\\u02D1\\\\u02E0-\\\\u02E4\\\\u02EC\\\\u02EE\\\\u0370-\\\\u0374\\\\u0376\\\\u0377\\\\u037A-\\\\u037D\\\\u037F\\\\u0386\\\\u0388-\\\\u038A\\\\u038C\\\\u038E-\\\\u03A1\\\\u03A3-\\\\u03F5\\\\u03F7-\\\\u0481\\\\u048A-\\\\u052F\\\\u0531-\\\\u0556\\\\u0559\\\\u0561-\\\\u0587\\\\u05D0-\\\\u05EA\\\\u05F0-\\\\u05F2\\\\u0620-\\\\u064A\\\\u066E\\\\u066F\\\\u0671-\\\\u06D3\\\\u06D5\\\\u06E5\\\\u06E6\\\\u06EE\\\\u06EF\\\\u06FA-\\\\u06FC\\\\u06FF\\\\u0710\\\\u0712-\\\\u072F\\\\u074D-\\\\u07A5\\\\u07B1\\\\u07CA-\\\\u07EA\\\\u07F4\\\\u07F5\\\\u07FA\\\\u0800-\\\\u0815\\\\u081A\\\\u0824\\\\u0828\\\\u0840-\\\\u0858\\\\u08A0-\\\\u08B2\\\\u0904-\\\\u0939\\\\u093D\\\\u0950\\\\u0958-\\\\u0961\\\\u0971-\\\\u0980\\\\u0985-\\\\u098C\\\\u098F\\\\u0990\\\\u0993-\\\\u09A8\\\\u09AA-\\\\u09B0\\\\u09B2\\\\u09B6-\\\\u09B9\\\\u09BD\\\\u09CE\\\\u09DC\\\\u09DD\\\\u09DF-\\\\u09E1\\\\u09F0\\\\u09F1\\\\u0A05-\\\\u0A0A\\\\u0A0F\\\\u0A10\\\\u0A13-\\\\u0A28\\\\u0A2A-\\\\u0A30\\\\u0A32\\\\u0A33\\\\u0A35\\\\u0A36\\\\u0A38\\\\u0A39\\\\u0A59-\\\\u0A5C\\\\u0A5E\\\\u0A72-\\\\u0A74\\\\u0A85-\\\\u0A8D\\\\u0A8F-\\\\u0A91\\\\u0A93-\\\\u0AA8\\\\u0AAA-\\\\u0AB0\\\\u0AB2\\\\u0AB3\\\\u0AB5-\\\\u0AB9\\\\u0ABD\\\\u0AD0\\\\u0AE0\\\\u0AE1\\\\u0B05-\\\\u0B0C\\\\u0B0F\\\\u0B10\\\\u0B13-\\\\u0B28\\\\u0B2A-\\\\u0B30\\\\u0B32\\\\u0B33\\\\u0B35-\\\\u0B39\\\\u0B3D\\\\u0B5C\\\\u0B5D\\\\u0B5F-\\\\u0B61\\\\u0B71\\\\u0B83\\\\u0B85-\\\\u0B8A\\\\u0B8E-\\\\u0B90\\\\u0B92-\\\\u0B95\\\\u0B99\\\\u0B9A\\\\u0B9C\\\\u0B9E\\\\u0B9F\\\\u0BA3\\\\u0BA4\\\\u0BA8-\\\\u0BAA\\\\u0BAE-\\\\u0BB9\\\\u0BD0\\\\u0C05-\\\\u0C0C\\\\u0C0E-\\\\u0C10\\\\u0C12-\\\\u0C28\\\\u0C2A-\\\\u0C39\\\\u0C3D\\\\u0C58\\\\u0C59\\\\u0C60\\\\u0C61\\\\u0C85-\\\\u0C8C\\\\u0C8E-\\\\u0C90\\\\u0C92-\\\\u0CA8\\\\u0CAA-\\\\u0CB3\\\\u0CB5-\\\\u0CB9\\\\u0CBD\\\\u0CDE\\\\u0CE0\\\\u0CE1\\\\u0CF1\\\\u0CF2\\\\u0D05-\\\\u0D0C\\\\u0D0E-\\\\u0D10\\\\u0D12-\\\\u0D3A\\\\u0D3D\\\\u0D4E\\\\u0D60\\\\u0D61\\\\u0D7A-\\\\u0D7F\\\\u0D85-\\\\u0D96\\\\u0D9A-\\\\u0DB1\\\\u0DB3-\\\\u0DBB\\\\u0DBD\\\\u0DC0-\\\\u0DC6\\\\u0E01-\\\\u0E30\\\\u0E32\\\\u0E33\\\\u0E40-\\\\u0E46\\\\u0E81\\\\u0E82\\\\u0E84\\\\u0E87\\\\u0E88\\\\u0E8A\\\\u0E8D\\\\u0E94-\\\\u0E97\\\\u0E99-\\\\u0E9F\\\\u0EA1-\\\\u0EA3\\\\u0EA5\\\\u0EA7\\\\u0EAA\\\\u0EAB\\\\u0EAD-\\\\u0EB0\\\\u0EB2\\\\u0EB3\\\\u0EBD\\\\u0EC0-\\\\u0EC4\\\\u0EC6\\\\u0EDC-\\\\u0EDF\\\\u0F00\\\\u0F40-\\\\u0F47\\\\u0F49-\\\\u0F6C\\\\u0F88-\\\\u0F8C\\\\u1000-\\\\u102A\\\\u103F\\\\u1050-\\\\u1055\\\\u105A-\\\\u105D\\\\u1061\\\\u1065\\\\u1066\\\\u106E-\\\\u1070\\\\u1075-\\\\u1081\\\\u108E\\\\u10A0-\\\\u10C5\\\\u10C7\\\\u10CD\\\\u10D0-\\\\u10FA\\\\u10FC-\\\\u1248\\\\u124A-\\\\u124D\\\\u1250-\\\\u1256\\\\u1258\\\\u125A-\\\\u125D\\\\u1260-\\\\u1288\\\\u128A-\\\\u128D\\\\u1290-\\\\u12B0\\\\u12B2-\\\\u12B5\\\\u12B8-\\\\u12BE\\\\u12C0\\\\u12C2-\\\\u12C5\\\\u12C8-\\\\u12D6\\\\u12D8-\\\\u1310\\\\u1312-\\\\u1315\\\\u1318-\\\\u135A\\\\u1380-\\\\u138F\\\\u13A0-\\\\u13F4\\\\u1401-\\\\u166C\\\\u166F-\\\\u167F\\\\u1681-\\\\u169A\\\\u16A0-\\\\u16EA\\\\u16EE-\\\\u16F8\\\\u1700-\\\\u170C\\\\u170E-\\\\u1711\\\\u1720-\\\\u1731\\\\u1740-\\\\u1751\\\\u1760-\\\\u176C\\\\u176E-\\\\u1770\\\\u1780-\\\\u17B3\\\\u17D7\\\\u17DC\\\\u1820-\\\\u1877\\\\u1880-\\\\u18A8\\\\u18AA\\\\u18B0-\\\\u18F5\\\\u1900-\\\\u191E\\\\u1950-\\\\u196D\\\\u1970-\\\\u1974\\\\u1980-\\\\u19AB\\\\u19C1-\\\\u19C7\\\\u1A00-\\\\u1A16\\\\u1A20-\\\\u1A54\\\\u1AA7\\\\u1B05-\\\\u1B33\\\\u1B45-\\\\u1B4B\\\\u1B83-\\\\u1BA0\\\\u1BAE\\\\u1BAF\\\\u1BBA-\\\\u1BE5\\\\u1C00-\\\\u1C23\\\\u1C4D-\\\\u1C4F\\\\u1C5A-\\\\u1C7D\\\\u1CE9-\\\\u1CEC\\\\u1CEE-\\\\u1CF1\\\\u1CF5\\\\u1CF6\\\\u1D00-\\\\u1DBF\\\\u1E00-\\\\u1F15\\\\u1F18-\\\\u1F1D\\\\u1F20-\\\\u1F45\\\\u1F48-\\\\u1F4D\\\\u1F50-\\\\u1F57\\\\u1F59\\\\u1F5B\\\\u1F5D\\\\u1F5F-\\\\u1F7D\\\\u1F80-\\\\u1FB4\\\\u1FB6-\\\\u1FBC\\\\u1FBE\\\\u1FC2-\\\\u1FC4\\\\u1FC6-\\\\u1FCC\\\\u1FD0-\\\\u1FD3\\\\u1FD6-\\\\u1FDB\\\\u1FE0-\\\\u1FEC\\\\u1FF2-\\\\u1FF4\\\\u1FF6-\\\\u1FFC\\\\u2071\\\\u207F\\\\u2090-\\\\u209C\\\\u2102\\\\u2107\\\\u210A-\\\\u2113\\\\u2115\\\\u2119-\\\\u211D\\\\u2124\\\\u2126\\\\u2128\\\\u212A-\\\\u212D\\\\u212F-\\\\u2139\\\\u213C-\\\\u213F\\\\u2145-\\\\u2149\\\\u214E\\\\u2160-\\\\u2188\\\\u2C00-\\\\u2C2E\\\\u2C30-\\\\u2C5E\\\\u2C60-\\\\u2CE4\\\\u2CEB-\\\\u2CEE\\\\u2CF2\\\\u2CF3\\\\u2D00-\\\\u2D25\\\\u2D27\\\\u2D2D\\\\u2D30-\\\\u2D67\\\\u2D6F\\\\u2D80-\\\\u2D96\\\\u2DA0-\\\\u2DA6\\\\u2DA8-\\\\u2DAE\\\\u2DB0-\\\\u2DB6\\\\u2DB8-\\\\u2DBE\\\\u2DC0-\\\\u2DC6\\\\u2DC8-\\\\u2DCE\\\\u2DD0-\\\\u2DD6\\\\u2DD8-\\\\u2DDE\\\\u2E2F\\\\u3005-\\\\u3007\\\\u3021-\\\\u3029\\\\u3031-\\\\u3035\\\\u3038-\\\\u303C\\\\u3041-\\\\u3096\\\\u309D-\\\\u309F\\\\u30A1-\\\\u30FA\\\\u30FC-\\\\u30FF\\\\u3105-\\\\u312D\\\\u3131-\\\\u318E\\\\u31A0-\\\\u31BA\\\\u31F0-\\\\u31FF\\\\u3400-\\\\u4DB5\\\\u4E00-\\\\u9FCC\\\\uA000-\\\\uA48C\\\\uA4D0-\\\\uA4FD\\\\uA500-\\\\uA60C\\\\uA610-\\\\uA61F\\\\uA62A\\\\uA62B\\\\uA640-\\\\uA66E\\\\uA67F-\\\\uA69D\\\\uA6A0-\\\\uA6EF\\\\uA717-\\\\uA71F\\\\uA722-\\\\uA788\\\\uA78B-\\\\uA78E\\\\uA790-\\\\uA7AD\\\\uA7B0\\\\uA7B1\\\\uA7F7-\\\\uA801\\\\uA803-\\\\uA805\\\\uA807-\\\\uA80A\\\\uA80C-\\\\uA822\\\\uA840-\\\\uA873\\\\uA882-\\\\uA8B3\\\\uA8F2-\\\\uA8F7\\\\uA8FB\\\\uA90A-\\\\uA925\\\\uA930-\\\\uA946\\\\uA960-\\\\uA97C\\\\uA984-\\\\uA9B2\\\\uA9CF\\\\uA9E0-\\\\uA9E4\\\\uA9E6-\\\\uA9EF\\\\uA9FA-\\\\uA9FE\\\\uAA00-\\\\uAA28\\\\uAA40-\\\\uAA42\\\\uAA44-\\\\uAA4B\\\\uAA60-\\\\uAA76\\\\uAA7A\\\\uAA7E-\\\\uAAAF\\\\uAAB1\\\\uAAB5\\\\uAAB6\\\\uAAB9-\\\\uAABD\\\\uAAC0\\\\uAAC2\\\\uAADB-\\\\uAADD\\\\uAAE0-\\\\uAAEA\\\\uAAF2-\\\\uAAF4\\\\uAB01-\\\\uAB06\\\\uAB09-\\\\uAB0E\\\\uAB11-\\\\uAB16\\\\uAB20-\\\\uAB26\\\\uAB28-\\\\uAB2E\\\\uAB30-\\\\uAB5A\\\\uAB5C-\\\\uAB5F\\\\uAB64\\\\uAB65\\\\uABC0-\\\\uABE2\\\\uAC00-\\\\uD7A3\\\\uD7B0-\\\\uD7C6\\\\uD7CB-\\\\uD7FB\\\\uF900-\\\\uFA6D\\\\uFA70-\\\\uFAD9\\\\uFB00-\\\\uFB06\\\\uFB13-\\\\uFB17\\\\uFB1D\\\\uFB1F-\\\\uFB28\\\\uFB2A-\\\\uFB36\\\\uFB38-\\\\uFB3C\\\\uFB3E\\\\uFB40\\\\uFB41\\\\uFB43\\\\uFB44\\\\uFB46-\\\\uFBB1\\\\uFBD3-\\\\uFD3D\\\\uFD50-\\\\uFD8F\\\\uFD92-\\\\uFDC7\\\\uFDF0-\\\\uFDFB\\\\uFE70-\\\\uFE74\\\\uFE76-\\\\uFEFC\\\\uFF21-\\\\uFF3A\\\\uFF41-\\\\uFF5A\\\\uFF66-\\\\uFFBE\\\\uFFC2-\\\\uFFC7\\\\uFFCA-\\\\uFFCF\\\\uFFD2-\\\\uFFD7\\\\uFFDA-\\\\uFFDC]');\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/parse-xml', [\n        'kendo.core',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    var STRING = String.fromCharCode;\n    var ENTITIES = {\n        'amp': 38,\n        'lt': 60,\n        'gt': 62,\n        'quot': 34,\n        'apos': 39,\n        'nbsp': 160\n    };\n    function CODE(str) {\n        var out = [];\n        for (var i = 0; i < str.length; ++i) {\n            out.push(str.charCodeAt(i));\n        }\n        return out;\n    }\n    function UCS2(out, code) {\n        if (code > 65535) {\n            code -= 65536;\n            out.push(code >>> 10 & 1023 | 55296, 56320 | code & 1023);\n        } else {\n            out.push(code);\n        }\n    }\n    var START_CDATA = CODE('<![CDATA[');\n    var END_CDATA = CODE(']]>');\n    var END_COMMENT = CODE('-->');\n    var START_COMMENT = CODE('!--');\n    var END_SHORT_TAG = CODE('/>');\n    var END_TAG = CODE('</');\n    var END_DECLARATION = CODE('?>');\n    var QUESTION_MARK = CODE('?');\n    var LESS_THAN = CODE('<');\n    var GREATER_THAN = CODE('>');\n    var SEMICOLON = CODE(';');\n    var EQUAL = CODE('=');\n    var AMPERSAND = CODE('&');\n    var QUOTE = CODE('\"');\n    var APOSTROPHE = CODE('\\'');\n    var SHARP = CODE('#');\n    var LOWERCASE_X = CODE('x');\n    var UPPERCASE_X = CODE('X');\n    var EXIT = {};\n    function parse(data, callbacks) {\n        var index = 0;\n        var stack = [];\n        var object = {\n            is: function (selector) {\n                var i = stack.length, j = selector.length;\n                while (--i >= 0 && --j >= 0) {\n                    if (stack[i].$tag != selector[j] && selector[j] != '*') {\n                        return false;\n                    }\n                }\n                return j < 0 ? stack[stack.length - 1] : null;\n            },\n            exit: function () {\n                throw EXIT;\n            },\n            stack: stack\n        };\n        function readChar(body) {\n            var code = data[index++];\n            if (!(code & 240 ^ 240)) {\n                UCS2(body, (code & 3) << 18 | (data[index++] & 63) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 224 ^ 224)) {\n                UCS2(body, (code & 15) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 192 ^ 192)) {\n                UCS2(body, (code & 31) << 6 | data[index++] & 63);\n            } else {\n                body.push(code);\n            }\n        }\n        function croak(msg) {\n            throw new Error(msg + ', at ' + index);\n        }\n        function readWhile(pred) {\n            var a = [];\n            while (index < data.length && pred(data[index])) {\n                a.push(data[index++]);\n            }\n            return a;\n        }\n        function readAsciiWhile(pred) {\n            return STRING.apply(0, readWhile(pred));\n        }\n        function skipWhitespace() {\n            readWhile(isWhitespace);\n        }\n        function eat(a) {\n            var save = index;\n            for (var i = 0; i < a.length; ++i) {\n                if (data[index++] != a[i]) {\n                    index = save;\n                    return false;\n                }\n            }\n            return a;\n        }\n        function skip(code) {\n            if (!eat(code)) {\n                croak('Expecting ' + code.join(', '));\n            }\n        }\n        function isWhitespace(code) {\n            return code == 9 || code == 10 || code == 13 || code == 32;\n        }\n        function isDigit(code) {\n            return code >= 48 && code <= 57;\n        }\n        function isHexDigit(code) {\n            return code >= 48 && code <= 57 || (code |= 32) >= 97 && code <= 102;\n        }\n        function isNameStart(code) {\n            return code == 58 || code == 95 || (code |= 32) >= 97 && code <= 122;\n        }\n        function isName(code) {\n            return code == 45 || isDigit(code) || isNameStart(code);\n        }\n        function xmlComment() {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_COMMENT)) {\n                    return call('comment', STRING.apply(0, body));\n                }\n                readChar(body);\n            }\n        }\n        function xmlTag() {\n            var name, attrs;\n            if (eat(QUESTION_MARK)) {\n                xmlDecl();\n            } else if (eat(START_COMMENT)) {\n                xmlComment();\n            } else {\n                name = xmlName();\n                attrs = xmlAttrs(name);\n                stack.push(attrs);\n                if (eat(END_SHORT_TAG)) {\n                    call('enter', name, attrs, true);\n                } else {\n                    skip(GREATER_THAN);\n                    call('enter', name, attrs);\n                    xmlContent(name);\n                    if (name != xmlName()) {\n                        croak('Bad closing tag');\n                    }\n                    call('leave', name, attrs);\n                    skipWhitespace();\n                    skip(GREATER_THAN);\n                }\n                stack.pop();\n            }\n        }\n        function xmlContent(name) {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_TAG)) {\n                    return body.length && call('text', STRING.apply(0, body));\n                } else if (eat(START_CDATA)) {\n                    while (index < data.length && !eat(END_CDATA)) {\n                        readChar(body);\n                    }\n                } else if (eat(LESS_THAN)) {\n                    if (body.length) {\n                        call('text', STRING.apply(0, body));\n                    }\n                    xmlTag();\n                    body = [];\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unclosed tag ' + name);\n        }\n        function xmlName() {\n            if (!isNameStart(data[index])) {\n                croak('Expecting XML name');\n            }\n            return readAsciiWhile(isName);\n        }\n        function xmlString() {\n            var quote = eat(QUOTE) || eat(APOSTROPHE);\n            if (!quote) {\n                croak('Expecting string');\n            }\n            var body = [];\n            while (index < data.length) {\n                if (eat(quote)) {\n                    return STRING.apply(0, body);\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unfinished string');\n        }\n        function xmlEntity(body) {\n            var code;\n            if (eat(SHARP)) {\n                if (eat(LOWERCASE_X) || eat(UPPERCASE_X)) {\n                    code = parseInt(readAsciiWhile(isHexDigit), 16);\n                } else {\n                    code = parseInt(readAsciiWhile(isDigit), 10);\n                }\n                if (isNaN(code)) {\n                    croak('Bad numeric entity');\n                }\n            } else {\n                var name = xmlName();\n                code = ENTITIES[name];\n                if (code === undefined) {\n                    croak('Unknown entity ' + name);\n                }\n            }\n            UCS2(body, code);\n            skip(SEMICOLON);\n        }\n        function xmlDecl() {\n            call('decl', xmlName(), xmlAttrs());\n            skip(END_DECLARATION);\n        }\n        function xmlAttrs(name) {\n            var map = { $tag: name };\n            while (index < data.length) {\n                skipWhitespace();\n                var code = data[index];\n                if (code == 63 || code == 62 || code == 47) {\n                    break;\n                }\n                map[xmlName()] = (skip(EQUAL), xmlString());\n            }\n            return map;\n        }\n        function call(what, thing, arg1, arg2) {\n            var f = callbacks && callbacks[what];\n            if (f) {\n                f.call(object, thing, arg1, arg2);\n            }\n        }\n        var tmp = [];\n        readChar(tmp);\n        if (tmp[0] != 65279) {\n            index = 0;\n        }\n        while (index < data.length) {\n            skipWhitespace();\n            skip(LESS_THAN);\n            xmlTag();\n            skipWhitespace();\n        }\n    }\n    kendo.util.parseXML = function parseXML() {\n        try {\n            return parse.apply(this, arguments);\n        } catch (ex) {\n            if (ex !== EXIT) {\n                throw ex;\n            }\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/commands', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.window',\n        'kendo.list',\n        'kendo.tabstrip'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Command = kendo.spreadsheet.Command = kendo.Class.extend({\n            init: function (options) {\n                this.options = options;\n                this._workbook = options.workbook;\n                this._property = options && options.property;\n                this._state = {};\n            },\n            range: function (range) {\n                if (range !== undefined) {\n                    this._setRange(range);\n                }\n                return this._range;\n            },\n            _setRange: function (range) {\n                this._range = range;\n            },\n            redo: function () {\n                this.exec();\n            },\n            undo: function () {\n                this.setState(this._state);\n            },\n            getState: function () {\n                this._state = this.range().getState(this._property);\n            },\n            setState: function (state) {\n                this.range().setState(state);\n            },\n            _forEachCell: function (callback) {\n                var range = this.range();\n                var ref = range._ref;\n                ref.forEach(function (ref) {\n                    range.sheet().forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            }\n        });\n        var TargetValueCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._target = options.target;\n                this._value = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this.setState(this._value);\n            }\n        });\n        kendo.spreadsheet.ColumnWidthCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this.range().sheet().columnWidth(this._target);\n            },\n            setState: function (state) {\n                this.range().sheet().columnWidth(this._target, state);\n            }\n        });\n        kendo.spreadsheet.RowHeightCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this.range().sheet().rowHeight(this._target);\n            },\n            setState: function (state) {\n                this.range().sheet().rowHeight(this._target, state);\n            }\n        });\n        kendo.spreadsheet.HyperlinkCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._link = options.link;\n            },\n            exec: function () {\n                var range = this.range();\n                this._prevLink = range.link();\n                this._prevUnderline = range.underline();\n                range.link(this._link);\n                range.underline(true);\n                if (range.value() == null) {\n                    this._hasSetValue = true;\n                    range.value(this._link);\n                }\n            },\n            undo: function () {\n                var range = this.range();\n                range.link(this._prevLink);\n                range.underline(this._prevUnderline);\n                if (this._hasSetValue) {\n                    range.value(null);\n                }\n            }\n        });\n        kendo.spreadsheet.GridLinesChangeCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this._range.sheet().showGridLines();\n            },\n            setState: function (v) {\n                this._range.sheet().showGridLines(v);\n            }\n        });\n        var PropertyChangeCommand = kendo.spreadsheet.PropertyChangeCommand = Command.extend({\n            _setRange: function (range) {\n                Command.prototype._setRange.call(this, range.skipHiddenCells());\n            },\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                var range = this.range();\n                if (range.enable()) {\n                    this.getState();\n                    if (this.options.property === 'format') {\n                        this._workbook.trigger('changeFormat', { range: range });\n                    }\n                    range[this._property](this._value);\n                }\n            }\n        });\n        kendo.spreadsheet.ClearContentCommand = Command.extend({\n            exec: function () {\n                this.getState();\n                this.range().clearContent();\n            }\n        });\n        kendo.spreadsheet.EditCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = options.property || 'input';\n                PropertyChangeCommand.fn.init.call(this, options);\n            },\n            rejectState: function (validationState) {\n                this.undo();\n                return {\n                    title: validationState.title,\n                    body: validationState.message,\n                    reason: 'error',\n                    type: 'validationError'\n                };\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            exec: function () {\n                var range = this.range();\n                if (!range.enable()) {\n                    return {\n                        reason: 'error',\n                        type: 'rangeDisabled'\n                    };\n                }\n                var value = this._value;\n                this.getState();\n                if (this._property == 'value') {\n                    range.value(value);\n                    return;\n                }\n                try {\n                    range.link(null);\n                    if (value === '') {\n                        range.value(null);\n                    } else {\n                        range.input(value);\n                        if (/\\n/.test(range.value())) {\n                            range.wrap(true);\n                        }\n                    }\n                    range._adjustRowHeight();\n                    var validationState = range._getValidationState();\n                    if (validationState) {\n                        return this.rejectState(validationState);\n                    }\n                } catch (ex) {\n                    if (ex instanceof kendo.spreadsheet.calc.ParseError) {\n                        return {\n                            title: 'Error in formula',\n                            body: ex + '',\n                            reason: 'error'\n                        };\n                    } else {\n                        throw ex;\n                    }\n                }\n            }\n        });\n        kendo.spreadsheet.TextWrapCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = 'wrap';\n                PropertyChangeCommand.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            getState: function () {\n                var rowHeight = {};\n                this.range().forEachRow(function (range) {\n                    var index = range.topLeft().row;\n                    rowHeight[index] = range.sheet().rowHeight(index);\n                });\n                this._state = this.range().getState(this._property);\n                this._rowHeight = rowHeight;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                var rowHeight = this._rowHeight;\n                this.range().setState(this._state);\n                for (var row in rowHeight) {\n                    sheet.rowHeight(row, rowHeight[row]);\n                }\n            }\n        });\n        kendo.spreadsheet.AdjustDecimalsCommand = Command.extend({\n            init: function (options) {\n                this._decimals = options.value;\n                options.property = 'format';\n                Command.fn.init.call(this, options);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                var decimals = this._decimals;\n                var formatting = kendo.spreadsheet.formatting;\n                this.getState();\n                sheet.batch(function () {\n                    this.range().forEachCell(function (row, col, cell) {\n                        var format = cell.format;\n                        if (format || decimals > 0) {\n                            format = formatting.adjustDecimals(format || '#', decimals);\n                            sheet.range(row, col).format(format);\n                        }\n                    });\n                }.bind(this));\n            }\n        });\n        kendo.spreadsheet.BorderChangeCommand = Command.extend({\n            init: function (options) {\n                options.property = 'border';\n                Command.fn.init.call(this, options);\n                this._type = options.border;\n                this._style = options.style;\n            },\n            exec: function () {\n                this.getState();\n                this[this._type](this._style);\n            },\n            noBorders: function () {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderLeft(null).borderTop(null).borderRight(null).borderBottom(null);\n                }.bind(this), {});\n            },\n            allBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderLeft(style).borderTop(style).borderRight(style).borderBottom(style);\n                }.bind(this), {});\n            },\n            leftBorder: function (style) {\n                this.range().leftColumn().borderLeft(style);\n            },\n            rightBorder: function (style) {\n                this.range().rightColumn().borderRight(style);\n            },\n            topBorder: function (style) {\n                this.range().topRow().borderTop(style);\n            },\n            bottomBorder: function (style) {\n                this.range().bottomRow().borderBottom(style);\n            },\n            outsideBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.leftColumn().borderLeft(style);\n                    range.topRow().borderTop(style);\n                    range.rightColumn().borderRight(style);\n                    range.bottomRow().borderBottom(style);\n                }.bind(this), {});\n            },\n            insideBorders: function (style) {\n                this.range().sheet().batch(function () {\n                    this.allBorders(style);\n                    this.outsideBorders(null);\n                }.bind(this), {});\n            },\n            insideHorizontalBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderBottom(style);\n                    range.bottomRow().borderBottom(null);\n                }.bind(this), {});\n            },\n            insideVerticalBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderRight(style);\n                    range.rightColumn().borderRight(null);\n                }.bind(this), {});\n            }\n        });\n        kendo.spreadsheet.MergeCellCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this[this._type]();\n            },\n            activate: function (ref) {\n                this.range().sheet().activeCell(ref);\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            undo: function () {\n                if (this._type !== 'unmerge') {\n                    this.range().unmerge();\n                    this.activate(this.range().topLeft());\n                }\n                this.range().setState(this._state);\n            },\n            cells: function () {\n                var range = this.range();\n                var ref = range._ref;\n                range.merge();\n                this.activate(ref);\n            },\n            horizontally: function () {\n                var ref = this.range().topRow()._ref;\n                this.range().forEachRow(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            vertically: function () {\n                var ref = this.range().leftColumn()._ref;\n                this.range().forEachColumn(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            unmerge: function () {\n                var range = this.range();\n                var ref = range._ref.topLeft;\n                range.unmerge();\n                this.activate(ref);\n            }\n        });\n        kendo.spreadsheet.FreezePanesCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this._topLeft = this.range().topLeft();\n                this[this._type]();\n            },\n            getState: function () {\n                this._state = this.range().sheet().getState();\n            },\n            undo: function () {\n                this.range().sheet().setState(this._state);\n            },\n            panes: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col).frozenRows(topLeft.row);\n            },\n            rows: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenRows(topLeft.row);\n            },\n            columns: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col);\n            },\n            unfreeze: function () {\n                var sheet = this.range().sheet();\n                sheet.frozenRows(0).frozenColumns(0);\n            }\n        });\n        kendo.spreadsheet.PasteCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._event = options.event;\n            },\n            getState: function () {\n                this._range = this._workbook.activeSheet().range(this._clipboard.pasteRef());\n                this._state = this._range.getState();\n            },\n            exec: function () {\n                this.getState();\n                this._clipboard.parse();\n                var status = this._clipboard.canPaste();\n                if (!status.canPaste) {\n                    if (status.menuInvoked) {\n                        return {\n                            reason: 'error',\n                            type: 'useKeyboard'\n                        };\n                    }\n                    if (status.pasteOnMerged) {\n                        return {\n                            reason: 'error',\n                            type: 'modifyMerged'\n                        };\n                    }\n                    if (status.overflow) {\n                        return {\n                            reason: 'error',\n                            type: 'overflow'\n                        };\n                    }\n                    if (status.pasteOnDisabled) {\n                        this._event.preventDefault();\n                        return {\n                            reason: 'error',\n                            type: 'cannotModifyDisabled'\n                        };\n                    }\n                    return { reason: 'error' };\n                }\n                var range = this._workbook.activeSheet().selection();\n                var preventDefault = this._workbook.trigger('paste', { range: range });\n                if (preventDefault) {\n                    this._event.preventDefault();\n                } else {\n                    this._clipboard.paste();\n                    range._adjustRowHeight();\n                }\n            }\n        });\n        kendo.spreadsheet.AdjustRowHeightCommand = Command.extend({\n            exec: function () {\n                var options = this.options;\n                var sheet = this._workbook.activeSheet();\n                var range = options.range || sheet.range(options.rowIndex);\n                range._adjustRowHeight();\n            }\n        });\n        kendo.spreadsheet.ToolbarPasteCommand = Command.extend({\n            exec: function () {\n                if (kendo.support.clipboard.paste) {\n                    this._workbook._view.clipboard.focus().select();\n                    document.execCommand('paste');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.CopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._event = options.event;\n            },\n            undo: $.noop,\n            exec: function () {\n                var status = this._clipboard.canCopy();\n                this._clipboard.menuInvoked = true;\n                if (!status.canCopy) {\n                    if (status.menuInvoked) {\n                        return {\n                            reason: 'error',\n                            type: 'useKeyboard'\n                        };\n                    } else if (status.multiSelection) {\n                        return {\n                            reason: 'error',\n                            type: 'unsupportedSelection'\n                        };\n                    }\n                    return;\n                }\n                var range = this._workbook.activeSheet().selection();\n                var preventDefault = this._workbook.trigger('copy', { range: range });\n                if (preventDefault) {\n                    this._event.preventDefault();\n                } else {\n                    this._clipboard.copy();\n                }\n            }\n        });\n        function copyToClipboard(html) {\n            var textarea = document.createElement('textarea');\n            $(textarea).addClass('k-spreadsheet-clipboard').val(html).appendTo(document.body).focus().select();\n            document.execCommand('copy');\n            $(textarea).remove();\n        }\n        kendo.spreadsheet.ToolbarCopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            undo: $.noop,\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    copyToClipboard(clipboard.html());\n                    clipboard.trigger('copy');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.CutCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._event = options.event;\n            },\n            exec: function () {\n                if (!(this.range().enable() && this._clipboard.canCopy())) {\n                    this._event.preventDefault();\n                    return {\n                        reason: 'error',\n                        type: 'cannotModifyDisabled'\n                    };\n                }\n                this.getState();\n                var range = this._workbook.activeSheet().selection();\n                var preventDefault = this._workbook.trigger('cut', { range: range });\n                if (preventDefault) {\n                    this._event.preventDefault();\n                    return;\n                }\n                this._clipboard.cut();\n            }\n        });\n        kendo.spreadsheet.AutoFillCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n            },\n            origin: function (origin) {\n                this._origin = origin;\n            },\n            exec: function () {\n                var range = this.range();\n                if (!range.enable()) {\n                    return {\n                        reason: 'error',\n                        type: 'rangeDisabled'\n                    };\n                }\n                this.getState();\n                try {\n                    range.fillFrom(this._origin);\n                } catch (ex) {\n                    if (ex instanceof kendo.spreadsheet.Range.FillError) {\n                        return {\n                            reason: 'error',\n                            type: ex.code\n                        };\n                    }\n                    throw ex;\n                }\n            }\n        });\n        kendo.spreadsheet.ToolbarCutCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    copyToClipboard(clipboard.html());\n                    clipboard.trigger('cut');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.FilterCommand = Command.extend({\n            undo: function () {\n                this.range().filter(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                this._state = range.hasFilter();\n                range.filter(!this._state);\n            }\n        });\n        kendo.spreadsheet.SortCommand = Command.extend({\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                var sheet = range.sheet();\n                var activeCell = sheet.activeCell();\n                var col = this.options.sheet ? activeCell.topLeft.col : this.options.column || 0;\n                var ascending = this.options.value === 'asc' ? true : false;\n                this._state = sheet.getState();\n                if (this.options.sheet) {\n                    range = this.expandRange();\n                }\n                var reason = range.cantSort();\n                if (reason) {\n                    return {\n                        reason: 'error',\n                        type: reason.code\n                    };\n                }\n                range.sort({\n                    column: col,\n                    ascending: ascending\n                });\n            },\n            expandRange: function () {\n                var sheet = this.range().sheet();\n                return new kendo.spreadsheet.Range(sheet._sheetRef, sheet);\n            }\n        });\n        var ApplyFilterCommand = kendo.spreadsheet.ApplyFilterCommand = Command.extend({\n            column: function () {\n                return this.options.column || 0;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.clearFilter(this.column());\n                if (this._state.length) {\n                    this.range().filter(this._state);\n                }\n            },\n            getState: function () {\n                var sheet = this.range().sheet();\n                var current = sheet.filter();\n                if (current) {\n                    this._state = current.columns.filter(function (c) {\n                        return c.index == this.column();\n                    }.bind(this));\n                }\n            },\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                var current = range.sheet().filter();\n                var options;\n                var filterRule;\n                var exists = false;\n                if (this.options.valueFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.ValueFilter(this.options.valueFilter)\n                    };\n                } else if (this.options.customFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.CustomFilter(this.options.customFilter)\n                    };\n                }\n                this.getState();\n                if (current && current.ref.eq(range._ref) && current.columns.length) {\n                    current.columns.forEach(function (element) {\n                        if (element.index === column) {\n                            exists = true;\n                        }\n                    });\n                    options = current.columns.map(function (element) {\n                        return element.index === column ? filterRule : {\n                            column: element.index,\n                            filter: element.filter\n                        };\n                    });\n                    if (!exists) {\n                        options.push(filterRule);\n                    }\n                } else {\n                    options = filterRule;\n                }\n                range.filter(options);\n            }\n        });\n        kendo.spreadsheet.ClearFilterCommand = ApplyFilterCommand.extend({\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                this.getState();\n                range.clearFilter(column);\n            }\n        });\n        kendo.spreadsheet.HideLineCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this.axis = options.axis;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setAxisState(this._state);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().hideSelectedRows();\n                } else {\n                    sheet.axisManager().hideSelectedColumns();\n                }\n            }\n        });\n        kendo.spreadsheet.UnHideLineCommand = kendo.spreadsheet.HideLineCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().unhideSelectedRows();\n                } else {\n                    sheet.axisManager().unhideSelectedColumns();\n                }\n            }\n        });\n        var DeleteCommand = kendo.spreadsheet.DeleteCommand = Command.extend({\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.DeleteRowCommand = DeleteCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                sheet.axisManager().deleteSelectedRows();\n            }\n        });\n        kendo.spreadsheet.DeleteColumnCommand = DeleteCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                sheet.axisManager().deleteSelectedColumns();\n            }\n        });\n        var AddCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.AddColumnCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                var result = sheet.axisManager().preventAddColumn();\n                if (result) {\n                    return result;\n                }\n                this._state = sheet.getState();\n                if (this._value === 'left') {\n                    sheet.axisManager().addColumnLeft();\n                } else {\n                    sheet.axisManager().addColumnRight();\n                }\n            }\n        });\n        kendo.spreadsheet.AddRowCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                var result = sheet.axisManager().preventAddRow();\n                if (result) {\n                    return result;\n                }\n                this._state = sheet.getState();\n                if (this._value === 'above') {\n                    sheet.axisManager().addRowAbove();\n                } else {\n                    sheet.axisManager().addRowBelow();\n                }\n            }\n        });\n        kendo.spreadsheet.EditValidationCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                this.range().validation(this._value);\n            }\n        });\n        kendo.spreadsheet.OpenCommand = Command.extend({\n            cannotUndo: true,\n            exec: function () {\n                var file = this.options.file;\n                if (file.name.match(/.xlsx$/i) === null) {\n                    return {\n                        reason: 'error',\n                        type: 'openUnsupported'\n                    };\n                }\n                var workbook = this.options.workbook;\n                workbook.fromFile(this.options.file).then(function () {\n                    var errors = workbook.excelImportErrors;\n                    if (errors && errors.length) {\n                        workbook._view.openDialog('importError', { errors: errors });\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.SaveAsCommand = Command.extend({\n            exec: function () {\n                var fileName = this.options.name + this.options.extension;\n                if (this.options.extension === '.xlsx') {\n                    this.options.workbook.saveAsExcel({ fileName: fileName });\n                } else if (this.options.extension === '.pdf') {\n                    this.options.workbook.saveAsPDF($.extend(this.options.pdf, {\n                        workbook: this.options.workbook,\n                        fileName: fileName\n                    }));\n                }\n            }\n        });\n        var NameCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._name = options.name;\n                this._value = options.value;\n            },\n            getState: function () {\n                this._state = this._workbook.nameDefinition(this._name);\n            },\n            setState: function () {\n                this._workbook.nameDefinition(this._name, this._state);\n                this._workbook.trigger('change', { recalc: true });\n            }\n        });\n        kendo.spreadsheet.DefineNameCommand = NameCommand.extend({\n            exec: function () {\n                this.getState();\n                try {\n                    this._workbook.defineName(this._name, this._value);\n                    this._workbook.trigger('change', { recalc: true });\n                } catch (ex) {\n                    return {\n                        title: 'Error',\n                        body: ex + '',\n                        reason: 'error'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.DeleteNameCommand = NameCommand.extend({\n            exec: function () {\n                this.getState();\n                this._workbook.undefineName(this._name);\n                this._workbook.trigger('change', { recalc: true });\n            }\n        });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulabar', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var classNames = { wrapper: 'k-spreadsheet-formula-bar' };\n        var FormulaBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element.addClass(FormulaBar.classNames.wrapper);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput($('<div/>').appendTo(element));\n            },\n            destroy: function () {\n                if (this.formulaInput) {\n                    this.formulaInput.destroy();\n                }\n                this.formulaInput = null;\n            }\n        });\n        kendo.spreadsheet.FormulaBar = FormulaBar;\n        $.extend(true, FormulaBar, { classNames: classNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulainput', ['kendo.core'], f);\n}(function () {\n    (function (kendo, window) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var ns = '.kendoFormulaInput';\n        var keys = kendo.keys;\n        var classNames = {\n            wrapper: 'k-spreadsheet-formula-input',\n            listWrapper: 'k-spreadsheet-formula-list'\n        };\n        var styles = [\n            'font-family',\n            'font-size',\n            'font-stretch',\n            'font-style',\n            'font-weight',\n            'letter-spacing',\n            'text-transform',\n            'line-height'\n        ];\n        var KEY_NAMES = {\n            27: 'esc',\n            37: 'left',\n            39: 'right',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar'\n        };\n        var PRIVATE_FORMULA_CHECK = /(^_|[^a-z0-9]$)/i;\n        var FormulaInput = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(FormulaInput.classNames.wrapper).attr('contenteditable', true).attr('spellcheck', false).css('white-space', 'pre');\n                if (this.options.autoScale) {\n                    element.on('input', this.scale.bind(this));\n                }\n                this._highlightedRefs = [];\n                this._staticTokens = [];\n                this._formulaSource();\n                this._formulaList();\n                this._popup();\n                this._tooltip();\n                element.on('keydown', this._keydown.bind(this)).on('keyup', this._keyup.bind(this)).on('blur', this._blur.bind(this)).on('input click', this._input.bind(this)).on('focus', this._focus.bind(this)).on('paste', this._paste.bind(this));\n            },\n            options: {\n                name: 'FormulaInput',\n                autoScale: false,\n                filterOperator: 'startswith',\n                scalePadding: 30,\n                minLength: 1\n            },\n            events: [\n                'keyup',\n                'focus'\n            ],\n            enable: function (enable) {\n                if (enable === undefined) {\n                    return this.element.attr('contenteditable') === 'true';\n                }\n                if (enable) {\n                    this.element.attr('contenteditable', enable);\n                } else {\n                    this.element.removeAttr('contenteditable');\n                }\n                this.element.toggleClass('k-state-disabled', !enable);\n            },\n            getPos: function () {\n                var div = this.element[0];\n                var sel = window.getSelection();\n                var a = lookup(sel.focusNode, sel.focusOffset);\n                var b = lookup(sel.anchorNode, sel.anchorOffset);\n                if (a != null && b != null) {\n                    if (a > b) {\n                        var tmp = a;\n                        a = b;\n                        b = tmp;\n                    }\n                    return {\n                        begin: a,\n                        end: b,\n                        collapsed: a == b\n                    };\n                }\n                function lookup(lookupNode, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node === lookupNode) {\n                                throw pos;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            } else if (node.nodeType == 3) {\n                                pos += node.nodeValue.length;\n                            }\n                        }(div));\n                    } catch (index) {\n                        return index;\n                    }\n                }\n            },\n            setPos: function (begin, end) {\n                var eiv = this.element[0];\n                begin = lookup(eiv, begin);\n                if (end != null) {\n                    end = lookup(eiv, end);\n                } else {\n                    end = begin;\n                }\n                if (begin && end) {\n                    var range = document.createRange();\n                    range.setStart(begin.node, begin.pos);\n                    range.setEnd(end.node, end.pos);\n                    var sel = window.getSelection();\n                    var currentRange = sel.getRangeAt(0);\n                    if (differ(range, currentRange)) {\n                        sel.removeAllRanges();\n                        sel.addRange(range);\n                    }\n                }\n                function differ(a, b) {\n                    return a.startOffset != b.startOffset || a.endOffset != b.endOffset || a.startContainer != b.endContainer || a.endContainer != b.endContainer;\n                }\n                function lookup(node, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node.nodeType == 3) {\n                                var len = node.nodeValue.length;\n                                if (len >= pos) {\n                                    throw node;\n                                }\n                                pos -= len;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            }\n                        }(node));\n                    } catch (el) {\n                        return {\n                            node: el,\n                            pos: pos\n                        };\n                    }\n                }\n            },\n            end: function () {\n                this.setPos(this.length());\n            },\n            home: function () {\n                this.setPos(0);\n            },\n            select: function () {\n                this.setPos(0, this.length());\n            },\n            length: function () {\n                return this.value().length;\n            },\n            _formulaSource: function () {\n                var result = [];\n                var value;\n                for (var key in kendo.spreadsheet.calc.runtime.FUNCS) {\n                    if (!PRIVATE_FORMULA_CHECK.test(key)) {\n                        value = key.toUpperCase();\n                        result.push({\n                            value: value,\n                            text: value\n                        });\n                    }\n                }\n                this.formulaSource = new kendo.data.DataSource({ data: result });\n            },\n            _formulaList: function () {\n                this.list = new kendo.ui.StaticList($('<ul />').addClass(FormulaInput.classNames.listWrapper).insertAfter(this.element), {\n                    autoBind: false,\n                    selectable: true,\n                    change: this._formulaListChange.bind(this),\n                    dataSource: this.formulaSource,\n                    dataValueField: 'value',\n                    template: '#:data.value#'\n                });\n                this.list.element.on('mousedown', function (e) {\n                    e.preventDefault();\n                });\n            },\n            _formulaListChange: function () {\n                var tokenCtx = this._tokenContext();\n                if (!tokenCtx || this._mute) {\n                    return;\n                }\n                var activeToken = tokenCtx.token;\n                var completion = this.list.value()[0];\n                var ctx = {\n                    replace: true,\n                    token: activeToken,\n                    end: activeToken.end\n                };\n                if (!tokenCtx.nextToken || tokenCtx.nextToken.value != '(') {\n                    completion += '(';\n                }\n                this._replaceAt(ctx, completion);\n                this.popup.close();\n            },\n            _popup: function () {\n                this.popup = new kendo.ui.Popup(this.list.element, { anchor: this.element });\n            },\n            _blur: function () {\n                this.popup.close();\n                clearTimeout(this._focusId);\n                this.trigger('blur');\n            },\n            _isFormula: function () {\n                return /^=/.test(this.value());\n            },\n            _keydown: function (e) {\n                var key = e.keyCode;\n                if (KEY_NAMES[key]) {\n                    this.popup.close();\n                    this._navigated = true;\n                } else if (this._move(key)) {\n                    this._navigated = true;\n                    e.preventDefault();\n                }\n                this._keyDownTimeout = setTimeout(this._syntaxHighlight.bind(this));\n            },\n            _keyup: function () {\n                var popup = this.popup;\n                var value;\n                if (this._isFormula() && !this._navigated) {\n                    value = ((this._tokenContext() || {}).token || {}).value;\n                    this.filter(value);\n                    if (!value || !this.formulaSource.view().length) {\n                        popup.close();\n                    } else {\n                        popup[popup.visible() ? 'position' : 'open']();\n                        this.list.focusFirst();\n                    }\n                }\n                this._navigated = false;\n                this._syntaxHighlight();\n                this.trigger('keyup');\n            },\n            _input: function () {\n                this._syntaxHighlight();\n            },\n            _focus: function () {\n                this._focusTimeout = setTimeout(this._syntaxHighlight.bind(this));\n                this.trigger('focus');\n            },\n            _paste: function (ev) {\n                ev.preventDefault();\n                var pos = this.getPos();\n                var text;\n                if (kendo.support.browser.msie) {\n                    text = window.clipboardData.getData('Text');\n                } else {\n                    text = ev.originalEvent.clipboardData.getData('text/plain');\n                }\n                var val = this.value();\n                val = val.substr(0, pos.begin) + text + val.substr(pos.end);\n                this.value(val);\n                this.setPos(pos.begin + text.length);\n                this.scale();\n            },\n            _move: function (key) {\n                var list = this.list;\n                var popup = this.popup;\n                if (popup.visible()) {\n                    if (key === keys.DOWN) {\n                        list.focusNext();\n                        if (!list.focus()) {\n                            list.focusFirst();\n                        }\n                        return true;\n                    }\n                    if (key === keys.UP) {\n                        list.focusPrev();\n                        if (!list.focus()) {\n                            list.focusLast();\n                        }\n                        return true;\n                    }\n                    if (key === keys.ENTER) {\n                        list.select(list.focus());\n                        popup.close();\n                        return true;\n                    }\n                    if (key === keys.TAB) {\n                        list.select(list.focus());\n                        popup.close();\n                        return true;\n                    }\n                    if (key === keys.PAGEUP) {\n                        list.focusFirst();\n                        return true;\n                    }\n                    if (key === keys.PAGEDOWN) {\n                        list.focusLast();\n                        return true;\n                    }\n                }\n                return key === keys.ENTER || key === keys.TAB;\n            },\n            _tokenContext: function () {\n                var point = this.getPos();\n                var value = this.value();\n                if (!value || !point || !point.collapsed) {\n                    return null;\n                }\n                var tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                var tok;\n                for (var i = 0; i < tokens.length; ++i) {\n                    tok = tokens[i];\n                    if (touches(tok, point) && /^(?:str|sym|func)$/.test(tok.type)) {\n                        return {\n                            token: tok,\n                            nextToken: tokens[i + 1]\n                        };\n                    }\n                }\n                return null;\n            },\n            _sync: function () {\n                if (this._editorToSync && this.isActive()) {\n                    this._editorToSync.value(this.value());\n                }\n            },\n            _textContainer: function () {\n                var computedStyles = kendo.getComputedStyles(this.element[0], styles);\n                computedStyles.position = 'absolute';\n                computedStyles.visibility = 'hidden';\n                computedStyles.whiteSpace = 'pre';\n                computedStyles.top = -3333;\n                computedStyles.left = -3333;\n                this._span = $('<span style=\\'white-space: pre\\'/>').css(computedStyles).insertAfter(this.element);\n            },\n            _tooltip: function () {\n                this._cellTooltip = $('<div class=\"k-widget k-tooltip\" style=\"position:absolute; display:none\">A1</div>').insertAfter(this.element);\n            },\n            tooltip: function (value) {\n                this._cellTooltip.text(value);\n            },\n            toggleTooltip: function (show) {\n                this._cellTooltip.toggle(show);\n            },\n            isActive: function () {\n                return this.element[0] === kendo._activeElement();\n            },\n            filter: function (value) {\n                if (!value || value.length < this.options.minLength) {\n                    return;\n                }\n                this._mute = true;\n                this.list.select(-1);\n                this._mute = false;\n                this.formulaSource.filter({\n                    field: this.list.options.dataValueField,\n                    operator: this.options.filterOperator,\n                    value: value\n                });\n            },\n            hide: function () {\n                this.enable(false);\n                this.element.hide();\n                this._cellTooltip.hide();\n            },\n            show: function () {\n                this.enable(true);\n                this.element.show();\n            },\n            row: function () {\n                if (this.activeCell) {\n                    return this.activeCell.row;\n                }\n            },\n            col: function () {\n                if (this.activeCell) {\n                    return this.activeCell.col;\n                }\n            },\n            position: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.show();\n                this.element.css({\n                    'top': rectangle.top + 1 + 'px',\n                    'left': rectangle.left + 1 + 'px'\n                });\n                this._cellTooltip.css({\n                    'top': rectangle.top - this._cellTooltip.height() - 10 + 'px',\n                    'left': rectangle.left\n                });\n            },\n            resize: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.element.css({\n                    width: rectangle.width - 1,\n                    height: rectangle.height - 1\n                });\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var result = this._canInsertRef(isKeyboardAction);\n                var token = result && result.token;\n                var idx;\n                if (token) {\n                    for (idx = 0; idx < this._staticTokens.length; idx++) {\n                        if (isEqualToken(token, this._staticTokens[idx])) {\n                            return null;\n                        }\n                    }\n                }\n                return result;\n            },\n            _canInsertRef: function (isKeyboardAction) {\n                if (this.popup.visible()) {\n                    return null;\n                }\n                var strictMode = isKeyboardAction;\n                var point = this.getPos();\n                var tokens, tok;\n                if (point && this._isFormula()) {\n                    if (point.begin === 0) {\n                        return null;\n                    }\n                    tokens = kendo.spreadsheet.calc.tokenize(this.value(), this.row(), this.col());\n                    for (var i = 0; i < tokens.length; ++i) {\n                        tok = tokens[i];\n                        if (touches(tok, point)) {\n                            return canReplace(tok);\n                        }\n                        if (afterPoint(tok)) {\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                    return canInsertBetween(tok, null);\n                }\n                return null;\n                function afterPoint(tok) {\n                    return tok.begin > point.begin;\n                }\n                function canReplace(tok) {\n                    if (tok) {\n                        if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                            return {\n                                replace: true,\n                                token: tok,\n                                end: tok.end\n                            };\n                        }\n                        if (/^(?:op|punc|startexp)$/.test(tok.type)) {\n                            if (tok.end == point.end) {\n                                return canInsertBetween(tok, tokens[i + 1]);\n                            }\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                }\n                function canInsertBetween(left, right) {\n                    if (left == null) {\n                        return null;\n                    }\n                    if (right == null) {\n                        if (/^(?:op|startexp)$/.test(left.type) || isOpenParen(left.value)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        return null;\n                    }\n                    if (strictMode) {\n                        if (left.type == 'op' && /^(?:punc|op)$/.test(right.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                    } else {\n                        if (left.type == 'startexp') {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:ref|op|punc)$/.test(left.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:punc|op)$/.test(left.type)) {\n                            return /^[,;({]$/.test(left.value) ? {\n                                token: left,\n                                end: point.end\n                            } : null;\n                        }\n                    }\n                    return false;\n                }\n            },\n            refAtPoint: function (ref) {\n                var x = this._canInsertRef();\n                if (x) {\n                    this._replaceAt(x, ref.simplify().toString());\n                }\n            },\n            _replaceAt: function (ctx, newValue) {\n                var value = this.value();\n                var tok = ctx.token;\n                var rest = value.substr(ctx.end);\n                value = value.substr(0, ctx.replace ? tok.begin : ctx.end) + newValue;\n                var point = value.length;\n                value += rest;\n                this._value(value);\n                this.setPos(point);\n                this.scale();\n                this._syntaxHighlight();\n                this._sync();\n            },\n            syncWith: function (formulaInput) {\n                var self = this;\n                var eventName = 'input' + ns;\n                var handler = self._sync.bind(self), iehandler;\n                if (kendo.support.browser.msie) {\n                    eventName = 'keydown' + ns;\n                    iehandler = function () {\n                        setTimeout(handler);\n                    };\n                }\n                self._editorToSync = formulaInput;\n                self.element.off(eventName).on(eventName, iehandler || handler);\n            },\n            scale: function () {\n                var element = this.element;\n                var width, height;\n                if (!this._span) {\n                    this._textContainer();\n                }\n                this._span.html(element.html());\n                width = this._span.width() + this.options.scalePadding;\n                height = this._span.height();\n                if (width > element.width()) {\n                    element.width(width);\n                }\n                if (height > element.height()) {\n                    element.height(height);\n                }\n            },\n            _value: function (value) {\n                this.element.text(value);\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    var txt = this.element[0].innerText;\n                    return txt.replace(/\\n$/, '');\n                }\n                this._value(value);\n                this._syntaxHighlight();\n            },\n            highlightedRefs: function () {\n                return this._highlightedRefs.slice();\n            },\n            _syntaxHighlight: function () {\n                var pos = this.getPos();\n                var value = this.value();\n                var refClasses = kendo.spreadsheet.Pane.classNames.series;\n                var highlightedRefs = [];\n                var refIndex = 0;\n                var parens = [];\n                var tokens = [];\n                var activeToken;\n                if (pos && !pos.collapsed) {\n                    return;\n                }\n                if (!/^=/.test(value)) {\n                    if (this._staticTokens.length || this._highlightedRefs.length) {\n                        this._staticTokens = [];\n                        this._highlightedRefs = [];\n                        this.element.text(value);\n                    }\n                    if (this.popup) {\n                        this.popup.close();\n                    }\n                    return;\n                } else {\n                    tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                    tokens.forEach(function (tok) {\n                        tok.active = false;\n                        tok.cls = ['k-syntax-' + tok.type];\n                        if (tok.type == 'ref') {\n                            tok.colorClass = refClasses[refIndex++ % refClasses.length];\n                            tok.cls.push(tok.colorClass);\n                            highlightedRefs.push(tok);\n                        }\n                        if (pos && tok.type == 'punc') {\n                            if (isOpenParen(tok.value)) {\n                                parens.unshift(tok);\n                            } else if (isCloseParen(tok.value)) {\n                                var open = parens.shift();\n                                if (open) {\n                                    if (isMatchingParen(tok.value, open.value)) {\n                                        if (touches(tok, pos) || touches(open, pos)) {\n                                            tok.cls.push('k-syntax-paren-match');\n                                            open.cls.push('k-syntax-paren-match');\n                                        }\n                                    } else {\n                                        tok.cls.push('k-syntax-error');\n                                        open.cls.push('k-syntax-error');\n                                    }\n                                } else {\n                                    tok.cls.push('k-syntax-error');\n                                }\n                            }\n                        }\n                        if (pos && touches(tok, pos)) {\n                            tok.cls.push('k-syntax-at-point');\n                            tok.active = true;\n                            activeToken = tok;\n                        }\n                        if (tok.type == 'func' && !knownFunction(tok.value) && (!pos || !touches(tok, pos))) {\n                            tok.cls.push('k-syntax-error');\n                        }\n                    });\n                    tokens.reverse().forEach(function (tok) {\n                        var begin = tok.begin, end = tok.end;\n                        var text = kendo.htmlEncode(value.substring(begin, end));\n                        value = value.substr(0, begin) + '<span class=\\'' + tok.cls.join(' ') + '\\'>' + text + '</span>' + value.substr(end);\n                    });\n                    this.element.html(value);\n                }\n                if (pos) {\n                    this.setPos(pos.begin, pos.end);\n                }\n                if (activeToken && /^(?:startexp|op|punc)$/.test(activeToken.type)) {\n                    this._setStaticTokens(tokens);\n                }\n                this._highlightedRefs = highlightedRefs;\n            },\n            _setStaticTokens: function (tokens) {\n                var idx, tok;\n                this._staticTokens = [];\n                for (idx = 0; idx < tokens.length; idx++) {\n                    tok = tokens[idx];\n                    if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                        this._staticTokens.push(tok);\n                    }\n                }\n            },\n            destroy: function () {\n                this._editorToSync = null;\n                this.element.off(ns);\n                clearTimeout(this._focusTimeout);\n                clearTimeout(this._keyDownTimeout);\n                this._cellTooltip = null;\n                this._span = null;\n                this.popup.destroy();\n                this.popup = null;\n                Widget.fn.destroy.call(this);\n            },\n            insertNewline: function () {\n                var val = this.value();\n                var pos = this.getPos();\n                var eof = pos.end == val.length;\n                val = val.substr(0, pos.begin) + (eof ? '\\n\\n' : '\\n' + val.substr(pos.end));\n                this.value(val);\n                this.setPos(pos.begin + 1);\n            }\n        });\n        function isOpenParen(ch) {\n            return ch == '(' || ch == '[' || ch == '{';\n        }\n        function isCloseParen(ch) {\n            return ch == ')' || ch == ']' || ch == '}';\n        }\n        function isMatchingParen(close, open) {\n            return open == '(' ? close == ')' : open == '[' ? close == ']' : open == '{' ? close == '}' : false;\n        }\n        function touches(pos, target) {\n            return pos.begin <= target.begin && pos.end >= target.end;\n        }\n        function knownFunction(name) {\n            return kendo.spreadsheet.calc.runtime.FUNCS[name.toLowerCase()];\n        }\n        function isEqualToken(tok1, tok2) {\n            if (!tok1 || !tok2) {\n                return false;\n            }\n            if (tok1.type == 'ref' && tok2.type == 'ref') {\n                return tok1.ref.eq(tok2.ref);\n            } else {\n                return tok1.value === tok2.value;\n            }\n        }\n        kendo.spreadsheet.FormulaInput = FormulaInput;\n        $.extend(true, FormulaInput, { classNames: classNames });\n    }(kendo, window));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/eventlistener', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var KEY_NAMES = {\n            8: 'backspace',\n            9: 'tab',\n            13: 'enter',\n            27: 'esc',\n            37: 'left',\n            38: 'up',\n            39: 'right',\n            40: 'down',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar',\n            33: 'pageup',\n            34: 'pagedown',\n            46: 'delete',\n            113: ':edit'\n        };\n        var Mac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n        var isAlphaNum = function (keyCode) {\n            if (keyCode > 47 && keyCode < 58 || keyCode > 64 && keyCode < 91 || keyCode > 95 && keyCode < 112 || keyCode > 185 && keyCode < 193 || keyCode > 218 && keyCode < 223) {\n                return true;\n            }\n            return false;\n        };\n        var keyName = function (event) {\n            var keyCode = event.keyCode;\n            var name = KEY_NAMES[keyCode];\n            if (!name && isAlphaNum(keyCode)) {\n                name = ':alphanum';\n            }\n            if (!name && event.key && event.key.length == 1) {\n                name = ':alphanum';\n            }\n            return name;\n        };\n        var EventListener = kendo.Class.extend({\n            init: function (target, observer, handlers) {\n                this._handlers = {};\n                this.target = target;\n                this._observer = observer || window;\n                this.keyDownProxy = this.keyDown.bind(this);\n                this.mouseProxy = this.mouse.bind(this);\n                this.threshold = 5;\n                this._pressLocation = null;\n                target.on('keydown', this.keyDownProxy);\n                target.on('contextmenu mousedown cut copy paste scroll wheel click dblclick focus', this.mouseProxy);\n                $(document.documentElement).on('mousemove mouseup', this.mouseProxy);\n                if (handlers) {\n                    for (var key in handlers) {\n                        this.on(key, handlers[key]);\n                    }\n                }\n            },\n            keyDown: function (e) {\n                this.handleEvent(e, keyName(e.originalEvent));\n            },\n            mouse: function (e) {\n                var rightClick;\n                if (e.which) {\n                    rightClick = e.which == 3;\n                } else if (e.button) {\n                    rightClick = e.button == 2;\n                }\n                var type = e.type;\n                if (type === 'mousedown') {\n                    if (rightClick) {\n                        type = 'rightmousedown';\n                    } else {\n                        this._pressLocation = {\n                            x: e.pageX,\n                            y: e.pageY\n                        };\n                    }\n                }\n                if (type === 'mouseup') {\n                    if (!rightClick) {\n                        this._pressLocation = null;\n                    }\n                }\n                if (type === 'mousemove' && this._pressLocation) {\n                    var dx = this._pressLocation.x - e.pageX;\n                    var dy = this._pressLocation.y - e.pageY;\n                    var distance = Math.sqrt(dx * dx + dy * dy);\n                    if (distance > this.threshold) {\n                        type = 'mousedrag';\n                    }\n                }\n                this.handleEvent(e, type);\n            },\n            handleEvent: function (e, name) {\n                var eventKey = '';\n                e.mod = Mac ? e.metaKey : e.ctrlKey && !e.altKey;\n                if (e.altKey) {\n                    eventKey += 'alt+';\n                }\n                if (e.shiftKey) {\n                    eventKey += 'shift+';\n                }\n                if (e.ctrlKey) {\n                    eventKey += 'ctrl+';\n                }\n                eventKey += name;\n                var catchAllHandler = this._handlers['*+' + name];\n                if (catchAllHandler) {\n                    catchAllHandler.call(this._observer, e, eventKey);\n                }\n                var handler = this._handlers[eventKey];\n                if (handler) {\n                    handler.call(this._observer, e, eventKey);\n                }\n            },\n            on: function (event, callback) {\n                var handlers = this._handlers;\n                if (typeof callback === 'string') {\n                    callback = this._observer[callback];\n                }\n                if (typeof event === 'string') {\n                    event = event.split(',');\n                }\n                event.forEach(function (e) {\n                    handlers[e] = callback;\n                });\n            },\n            destroy: function () {\n                this.target.off('keydown', this.keyDownProxy);\n                this.target.off('keydown', this.mouseProxy);\n                $(document.documentElement).off('mousemove mouseup', this.mouseProxy);\n            }\n        });\n        kendo.spreadsheet.EventListener = EventListener;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/rangelist', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeTreeNode = kendo.Class.extend({\n            init: function Node(level, value, left, right) {\n                this.level = level;\n                this.value = value;\n                this.left = left;\n                this.right = right;\n            }\n        });\n        var NilNode = new function NIL() {\n            this.left = this;\n            this.right = this;\n            this.level = 0;\n        }();\n        function passThrough(value) {\n            return value;\n        }\n        function skew(node) {\n            if (node.left.level === node.level) {\n                var temp = node;\n                node = node.left;\n                temp.left = node.right;\n                node.right = temp;\n            }\n            return node;\n        }\n        function split(node) {\n            if (node.right.right.level === node.level) {\n                var temp = node;\n                node = node.right;\n                temp.right = node.left;\n                node.left = temp;\n                node.level += 1;\n            }\n            return node;\n        }\n        function insert(node, value) {\n            if (node === NilNode) {\n                return new RangeTreeNode(1, value, NilNode, NilNode);\n            } else if (node.value.start - value.start > 0) {\n                node.left = insert(node.left, value);\n            } else {\n                node.right = insert(node.right, value);\n            }\n            return split(skew(node));\n        }\n        function remove(node, value) {\n            if (node === NilNode) {\n                return node;\n            }\n            var diff = node.value.start - value.start;\n            if (diff === 0) {\n                if (node.left !== NilNode && node.right !== NilNode) {\n                    var heir = node.left;\n                    while (heir.right !== NilNode) {\n                        heir = heir.right;\n                    }\n                    node.value = heir.value;\n                    node.left = remove(node.left, node.value);\n                } else if (node.left === NilNode) {\n                    node = node.right;\n                } else {\n                    node = node.left;\n                }\n            } else if (diff > 0) {\n                node.left = remove(node.left, value);\n            } else {\n                node.right = remove(node.right, value);\n            }\n            if (node.left.level < node.level - 1 || node.right.level < node.level - 1) {\n                node.level -= 1;\n                if (node.right.level > node.level) {\n                    node.right.level = node.level;\n                }\n                node = skew(node);\n                node.right = skew(node.right);\n                node.right.right = skew(node.right.right);\n                node = split(node);\n                node.right = split(node.right);\n            }\n            return node;\n        }\n        var Range = kendo.Class.extend({\n            init: function Value(start, end, value) {\n                this.start = start;\n                this.end = end;\n                this.value = value;\n            },\n            intersects: function (range) {\n                return range.start <= this.end && range.end >= this.start;\n            }\n        });\n        var RangeTree = kendo.Class.extend({\n            init: function () {\n                this.root = NilNode;\n            },\n            insert: function (value) {\n                this.root = insert(this.root, value);\n            },\n            remove: function (value) {\n                this.root = remove(this.root, value);\n            },\n            findrange: function (value) {\n                var node = this.root;\n                while (node != NilNode) {\n                    if (value < node.value.start) {\n                        node = node.left;\n                    } else if (value > node.value.end) {\n                        node = node.right;\n                    } else {\n                        return node.value;\n                    }\n                }\n                return null;\n            },\n            values: function () {\n                var result = [];\n                values(this.root, result);\n                return result;\n            },\n            intersecting: function (start, end) {\n                var ranges = [];\n                intersecting(this.root, new Range(start, end), ranges);\n                return ranges;\n            },\n            map: function (callback) {\n                var tree = new RangeTree();\n                map(tree, this.root, callback);\n                return tree;\n            },\n            clone: function () {\n                return this.map(passThrough);\n            },\n            first: function () {\n                var first = this.root;\n                while (first.left != NilNode) {\n                    first = first.left;\n                }\n                return first;\n            },\n            last: function () {\n                var last = this.root;\n                while (last.right != NilNode) {\n                    last = last.right;\n                }\n                return last;\n            }\n        });\n        function values(node, result) {\n            if (node === NilNode) {\n                return;\n            }\n            values(node.left, result);\n            result.push(node.value);\n            values(node.right, result);\n        }\n        function intersecting(node, range, ranges) {\n            if (node === NilNode) {\n                return;\n            }\n            var value = node.value;\n            if (range.start < value.start) {\n                intersecting(node.left, range, ranges);\n            }\n            if (value.intersects(range)) {\n                ranges.push(value);\n            }\n            if (range.end > value.end) {\n                intersecting(node.right, range, ranges);\n            }\n        }\n        function map(tree, root, callback) {\n            if (root === NilNode) {\n                return;\n            }\n            map(tree, root.left, callback);\n            tree.insert(callback(root.value));\n            map(tree, root.right, callback);\n        }\n        var RangeList = kendo.Class.extend({\n            init: function (start, end, value) {\n                if (end === undefined) {\n                    this.tree = start;\n                } else {\n                    this.tree = new RangeTree();\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            values: function () {\n                return this.tree.values();\n            },\n            map: function (callback) {\n                return new RangeList(this.tree.map(callback));\n            },\n            intersecting: function (start, end) {\n                return this.tree.intersecting(start, end);\n            },\n            first: function () {\n                return this.tree.first().value;\n            },\n            last: function () {\n                return this.tree.last().value;\n            },\n            insert: function (start, end, value) {\n                return this.tree.insert(new Range(start, end, value));\n            },\n            value: function (start, end, value) {\n                if (value === undefined) {\n                    if (end === undefined) {\n                        end = start;\n                    }\n                    return this.intersecting(start, end)[0].value;\n                }\n                var ranges = this.tree.intersecting(start - 1, end + 1);\n                if (ranges.length) {\n                    var firstRange = ranges[0], lastRange = ranges[ranges.length - 1];\n                    if (firstRange.end < start) {\n                        if (firstRange.value === value) {\n                            start = firstRange.start;\n                        } else {\n                            ranges.shift();\n                        }\n                    }\n                    if (lastRange.start > end) {\n                        if (lastRange.value === value) {\n                            end = lastRange.end;\n                        } else {\n                            ranges.pop();\n                        }\n                    }\n                    for (var i = 0, length = ranges.length; i < length; i++) {\n                        var range = ranges[i];\n                        var rangeValue = range.value;\n                        var rangeStart = range.start;\n                        var rangeEnd = range.end;\n                        this.tree.remove(range);\n                        if (rangeStart < start) {\n                            if (rangeValue !== value) {\n                                this.insert(rangeStart, start - 1, rangeValue);\n                            } else {\n                                start = rangeStart;\n                            }\n                        }\n                        if (rangeEnd > end) {\n                            if (rangeValue !== value) {\n                                this.insert(end + 1, rangeEnd, rangeValue);\n                            } else {\n                                end = rangeEnd;\n                            }\n                        }\n                    }\n                }\n                this.insert(start, end, value);\n            },\n            expandedValues: function (start, end) {\n                var ranges = this.intersecting(start, end);\n                var result = [];\n                var rangeIndex = 0;\n                for (var i = start; i <= end; i++) {\n                    if (ranges[rangeIndex].end < i) {\n                        rangeIndex++;\n                    }\n                    result.push({\n                        index: i - start,\n                        value: ranges[rangeIndex].value\n                    });\n                }\n                return result;\n            },\n            sortedIndices: function (start, end, valueComparer, indices) {\n                var result = this.expandedValues(start, end);\n                var comparer = function (a, b) {\n                    if (a.value === b.value) {\n                        return a.index - b.index;\n                    }\n                    return valueComparer(a.value, b.value);\n                };\n                if (indices) {\n                    comparer = function (a, b) {\n                        var x = indices[a.index];\n                        var y = indices[b.index];\n                        if (x.value === y.value) {\n                            return valueComparer(a.value, b.value);\n                        }\n                        return a.index - b.index;\n                    };\n                }\n                result.sort(comparer);\n                return result;\n            },\n            sort: function (start, end, indices) {\n                if (this.intersecting(start, end).length === 1) {\n                    return;\n                }\n                var values = this.expandedValues(start, end);\n                for (var i = 0, len = indices.length; i < len; i++) {\n                    this.value(i + start, i + start, values[indices[i].index].value);\n                }\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                var values = this.intersecting(sourceStart, sourceEnd);\n                var start = targetStart;\n                var end;\n                for (var i = 0, len = values.length; i < len; i++) {\n                    var rangeStart = values[i].start;\n                    if (rangeStart < sourceStart) {\n                        rangeStart = sourceStart;\n                    }\n                    var rangeEnd = values[i].end;\n                    if (rangeEnd > sourceEnd) {\n                        rangeEnd = sourceEnd;\n                    }\n                    end = start + (rangeEnd - rangeStart);\n                    this.value(start, end, values[i].value);\n                    start = ++end;\n                }\n            },\n            iterator: function (start, end) {\n                return new Iterator(start, end, this.intersecting(start, end));\n            },\n            getState: function () {\n                return this.tree.clone();\n            },\n            setState: function (state) {\n                this.tree = state;\n            }\n        });\n        var Iterator = kendo.Class.extend({\n            init: function (start, end, ranges) {\n                this.start = start;\n                this.end = end;\n                this.index = 0;\n                this.ranges = ranges;\n            },\n            unique: function () {\n                return this.ranges.map(function (range) {\n                    return range.value;\n                });\n            },\n            at: function (index) {\n                while (this.ranges[this.index].end < index) {\n                    this.index++;\n                }\n                return this.ranges[this.index].value;\n            },\n            forEach: function (callback) {\n                for (var i = this.start; i <= this.end; i++) {\n                    callback(this.at(i), i);\n                }\n                this.index = 0;\n            }\n        });\n        var SparseRangeList = RangeList.extend({\n            init: function (start, end, value) {\n                this.tree = new RangeTree();\n                this.range = new Range(start, end, value);\n            },\n            intersecting: function (start, end) {\n                var ranges = this.tree.intersecting(start, end);\n                var result = [];\n                var range;\n                if (!ranges.length) {\n                    return [this.range];\n                }\n                for (var i = 0, len = ranges.length; i < len; i++) {\n                    range = ranges[i];\n                    if (range.start > start) {\n                        result.push(new Range(start, range.start - 1, this.range.value));\n                    }\n                    result.push(range);\n                    start = range.end + 1;\n                }\n                if (range.end < end) {\n                    result.push(new Range(range.end + 1, end, this.range.value));\n                }\n                return result;\n            },\n            insert: function (start, end, value) {\n                if (value !== this.range.value) {\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            lastRangeStart: function () {\n                var node = this.tree.root;\n                if (node === NilNode) {\n                    return this.range.start;\n                }\n                while (node.right !== NilNode) {\n                    node = node.right;\n                }\n                return node.value.end + 1;\n            }\n        });\n        kendo.spreadsheet.RangeTree = RangeTree;\n        kendo.spreadsheet.RangeList = RangeList;\n        kendo.spreadsheet.SparseRangeList = SparseRangeList;\n        kendo.spreadsheet.ValueRange = Range;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/propertybag', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Property = kendo.Class.extend({\n            init: function (list) {\n                this.list = list;\n            },\n            get: function (index) {\n                return this.parse(this.list.value(index, index));\n            },\n            set: function (start, end, value) {\n                if (value === undefined) {\n                    value = end;\n                    end = start;\n                }\n                this.list.value(start, end, value);\n            },\n            parse: function (value) {\n                return value;\n            },\n            copy: function (start, end, dst) {\n                this.list.copy(start, end, dst);\n            },\n            iterator: function (start, end) {\n                return this.list.iterator(start, end);\n            }\n        });\n        var JsonProperty = Property.extend({\n            set: function (start, end, value) {\n                this.list.value(start, end, JSON.stringify(value));\n            },\n            parse: function (value) {\n                return JSON.parse(value);\n            }\n        });\n        var ValueProperty = Property.extend({\n            init: function (values, formats, validations) {\n                Property.prototype.init.call(this, values);\n                this.validations = validations;\n                this.formats = formats;\n            },\n            set: function (start, end, value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                    this.formats.value(start, end, toExcelFormat(kendo.culture().calendar.patterns.d));\n                }\n                this.list.value(start, end, value);\n            }\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        kendo.spreadsheet.PropertyBag = kendo.Class.extend({\n            specs: [\n                {\n                    property: ValueProperty,\n                    name: 'value',\n                    value: null,\n                    sortable: true,\n                    serializable: true,\n                    depends: 'format'\n                },\n                {\n                    property: Property,\n                    name: 'format',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'formula',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'background',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderBottom',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderRight',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderLeft',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderTop',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'color',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontFamily',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'underline',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontSize',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'italic',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'bold',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'textAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'verticalAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'wrap',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'validation',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'enable',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'link',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'editor',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                }\n            ],\n            init: function (cellCount, defaultValues) {\n                defaultValues = defaultValues || {};\n                this.properties = {};\n                this.lists = {};\n                this.specs.forEach(function (spec) {\n                    var value = defaultValues[spec.name] !== undefined ? defaultValues[spec.name] : spec.value;\n                    this.lists[spec.name] = new kendo.spreadsheet.SparseRangeList(0, cellCount, value);\n                }, this);\n                this.specs.forEach(function (spec) {\n                    this.properties[spec.name] = new spec.property(this.lists[spec.name], this.lists[spec.depends]);\n                }, this);\n            },\n            getState: function () {\n                var state = {};\n                this.specs.forEach(function (spec) {\n                    state[spec.name] = this.lists[spec.name].getState();\n                }, this);\n                return state;\n            },\n            setState: function (state) {\n                this.specs.forEach(function (spec) {\n                    this.lists[spec.name].setState(state[spec.name]);\n                }, this);\n            },\n            get: function (name, index) {\n                if (index === undefined) {\n                    return this.lists[name];\n                }\n                return this.properties[name].get(index);\n            },\n            set: function (name, start, end, value) {\n                this.properties[name].set(start, end, value);\n            },\n            fromJSON: function (index, value) {\n                for (var si = 0; si < this.specs.length; si++) {\n                    var spec = this.specs[si];\n                    if (spec.serializable) {\n                        if (value[spec.name] !== undefined) {\n                            this.set(spec.name, index, index, value[spec.name], false);\n                        }\n                    }\n                }\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                this.specs.forEach(function (spec) {\n                    this.properties[spec.name].copy(sourceStart, sourceEnd, targetStart);\n                }, this);\n            },\n            iterator: function (name, start, end) {\n                return this.properties[name].iterator(start, end);\n            },\n            sortable: function () {\n                return this.specs.filter(function (spec) {\n                    return spec.sortable;\n                }).map(function (spec) {\n                    return this.lists[spec.name];\n                }, this);\n            },\n            iterators: function (start, end) {\n                var specs = this.specs.filter(function (spec) {\n                    return spec.serializable;\n                });\n                return specs.map(function (spec) {\n                    var iterator = this.iterator(spec.name, start, end);\n                    return {\n                        name: spec.name,\n                        value: spec.value,\n                        at: function (index) {\n                            return spec.property.fn.parse(iterator.at(index));\n                        }\n                    };\n                }, this);\n            },\n            forEach: function (start, end, callback) {\n                var iterators = this.iterators(start, end);\n                for (var index = start; index <= end; index++) {\n                    var values = {};\n                    for (var i = 0; i < iterators.length; i++) {\n                        var iterator = iterators[i];\n                        var value = iterator.at(index);\n                        if (value !== iterator.value) {\n                            values[iterator.name] = value;\n                        }\n                    }\n                    callback(values);\n                }\n            },\n            forEachProperty: function (callback) {\n                for (var name in this.properties) {\n                    callback(this.properties[name]);\n                }\n            }\n        });\n        kendo.spreadsheet.ALL_PROPERTIES = $.map(kendo.spreadsheet.PropertyBag.prototype.specs, function (spec) {\n            return spec.name;\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/references', ['kendo.core'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Class = kendo.Class;\n    function columnName(colIndex) {\n        var letter = Math.floor(colIndex / 26) - 1;\n        return (letter >= 0 ? columnName(letter) : '') + String.fromCharCode(65 + colIndex % 26);\n    }\n    function displaySheet(sheet) {\n        if (/^[a-z0-9_]*$/i.test(sheet)) {\n            return sheet;\n        }\n        return '\\'' + sheet.replace(/\\x27/g, '\\\\\\'') + '\\'';\n    }\n    function displayRef(sheet, row, col, rel) {\n        var aa = '';\n        ++row;\n        if (!isFinite(row)) {\n            row = '';\n        } else if (rel != null && !(rel & 2)) {\n            row = '$' + row;\n        }\n        if (!isFinite(col)) {\n            col = '';\n        } else {\n            aa = columnName(col);\n            if (rel != null && !(rel & 1)) {\n                aa = '$' + aa;\n            }\n        }\n        if (sheet) {\n            return displaySheet(sheet) + '!' + aa + row;\n        } else {\n            return aa + row;\n        }\n    }\n    var Ref = Class.extend({\n        type: 'ref',\n        sheet: '',\n        clone: function () {\n            return this;\n        },\n        hasSheet: function () {\n            return this._hasSheet;\n        },\n        simplify: function () {\n            return this;\n        },\n        setSheet: function (sheet, hasSheet) {\n            this.sheet = sheet;\n            if (hasSheet != null) {\n                this._hasSheet = hasSheet;\n            }\n            return this;\n        },\n        absolute: function () {\n            return this;\n        },\n        relative: function () {\n            return this;\n        },\n        adjust: function () {\n            return this;\n        },\n        toString: function () {\n            return this.relative(0, 0, 3, 3).print(0, 0);\n        },\n        forEach: function (callback, obj) {\n            callback.call(obj, this);\n        },\n        map: function (callback, obj) {\n            return callback.call(obj, this);\n        },\n        intersects: function (ref) {\n            return this.intersect(ref) !== NULL;\n        },\n        isCell: function () {\n            return false;\n        },\n        toRow: function () {\n            return this;\n        },\n        toColumn: function () {\n            return this;\n        },\n        first: function () {\n            return this;\n        },\n        lastRange: function () {\n            return this;\n        },\n        size: function () {\n            return 1;\n        },\n        rangeAt: function () {\n            return this;\n        },\n        nextRangeIndex: function () {\n            return 0;\n        },\n        previousRangeIndex: function () {\n            return 0;\n        },\n        eq: function (reference) {\n            var r1 = this;\n            var r2 = reference;\n            if (r1 === NULL || r2 === NULL) {\n                return r1 === r2;\n            }\n            if (r2 instanceof CellRef || r2 instanceof RangeRef && !(r1 instanceof CellRef)) {\n                r1 = reference;\n                r2 = this;\n            }\n            if (r1 instanceof CellRef) {\n                r2 = r2.simplify();\n                return r2 instanceof CellRef && r1.row == r2.row && r1.col == r2.col && r1.sheet == r2.sheet;\n            } else if (r1 instanceof RangeRef) {\n                if (r2 instanceof RangeRef) {\n                    return r2.topLeft.eq(r1.topLeft) && r2.bottomRight.eq(r1.bottomRight);\n                }\n                if (r2 instanceof UnionRef) {\n                    return r2.single() && r1.eq(r2.refs[0]);\n                }\n            } else if (r1 instanceof UnionRef && r2 instanceof UnionRef) {\n                var refs1 = r1.refs;\n                var refs2 = r2.refs;\n                if (refs1.length != refs2.length) {\n                    return false;\n                }\n                for (var i = 0, len = refs1.length; i < len; i++) {\n                    if (!refs1[i].eq(refs2[i])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            return r1 === r2;\n        },\n        concat: function (ref) {\n            return new UnionRef([\n                this,\n                ref\n            ]);\n        },\n        replaceAt: function (index, ref) {\n            return ref;\n        },\n        forEachColumnIndex: function (callback) {\n            this.forEachAxisIndex('col', callback);\n        },\n        forEachRowIndex: function (callback) {\n            this.forEachAxisIndex('row', callback);\n        },\n        forEachAxisIndex: function (axis, callback) {\n            var sorted = [];\n            var method = axis === 'row' ? 'forEachRow' : 'forEachColumn';\n            this[method](function (ref) {\n                var index = ref.first()[axis];\n                if (sorted.indexOf(index) === -1) {\n                    sorted.push(index);\n                }\n            });\n            sorted.sort(function (a, b) {\n                return a > b ? 1 : a < b ? -1 : 0;\n            }).forEach(callback);\n        },\n        valid: function () {\n            return false;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            if (this.sheet && this.sheet.toLowerCase() == oldSheetName.toLowerCase()) {\n                this.sheet = newSheetName;\n                return true;\n            }\n        }\n    });\n    Ref.display = displayRef;\n    var NULL = new (Ref.extend({\n        init: function NullRef() {\n        },\n        print: function () {\n            return '#NULL!';\n        },\n        eq: function (ref) {\n            return ref === this;\n        },\n        forEach: function () {\n        }\n    }))();\n    var NameRef = Ref.extend({\n        ref: 'name',\n        init: function NameRef(name) {\n            this.name = name;\n        },\n        clone: function () {\n            return new NameRef(this.name).setSheet(this.sheet, this.hasSheet());\n        },\n        print: function () {\n            var ret = displaySheet(this.name);\n            if (this.hasSheet()) {\n                ret = displaySheet(this.sheet) + '!' + ret;\n            }\n            return ret;\n        }\n    });\n    var CellRef = Ref.extend({\n        ref: 'cell',\n        init: function CellRef(row, col, rel) {\n            this.row = row;\n            this.col = col;\n            this.rel = rel || 0;\n        },\n        clone: function () {\n            return new CellRef(this.row, this.col, this.rel).setSheet(this.sheet, this.hasSheet());\n        },\n        intersect: function (ref) {\n            if (ref instanceof CellRef) {\n                if (this.eq(ref)) {\n                    return this;\n                } else {\n                    return NULL;\n                }\n            }\n            return ref.intersect(this);\n        },\n        print: function (trow, tcol, mod) {\n            var col = this.col, row = this.row, rel = this.rel, abs;\n            if (trow == null && rel) {\n                var sheet = this.hasSheet() ? displaySheet(this.sheet) + '!' : '';\n                if (isFinite(col)) {\n                    col = rel & 1 ? 'C[' + col + ']' : 'C' + (col + 1);\n                } else {\n                    col = '';\n                }\n                if (isFinite(row)) {\n                    row = rel & 2 ? 'R[' + row + ']' : 'R' + (row + 1);\n                } else {\n                    row = '';\n                }\n                return sheet + row + col;\n            } else {\n                abs = this.absolute(trow, tcol);\n                if (mod) {\n                    row = abs.row % 1048576;\n                    col = abs.col % 16384;\n                    if (row < 0) {\n                        row += 1048576;\n                    }\n                    if (col < 0) {\n                        col += 16384;\n                    }\n                    return displayRef(this._hasSheet && this.sheet, row, col, rel);\n                }\n                return abs.valid() ? displayRef(this._hasSheet && this.sheet, abs.row, abs.col, rel) : '#REF!';\n            }\n        },\n        absolute: function (arow, acol) {\n            var ret = this.clone();\n            if (ret.rel & 3 === 0) {\n                return ret;\n            }\n            if (ret.rel & 1) {\n                ret.col = (ret.col + acol) % 16384;\n            }\n            if (ret.rel & 2) {\n                ret.row = (ret.row + arow) % 1048576;\n            }\n            ret.rel = 0;\n            return ret;\n        },\n        toRangeRef: function () {\n            return new RangeRef(this, this);\n        },\n        relative: function (arow, acol, rel) {\n            if (rel == null) {\n                rel = this.rel;\n            }\n            var row = rel & 2 ? this.row - arow : this.row;\n            var col = rel & 1 ? this.col - acol : this.col;\n            return new CellRef(row, col, rel).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            return 1;\n        },\n        width: function () {\n            return 1;\n        },\n        toString: function () {\n            return displayRef(null, this.row, this.col, 3);\n        },\n        isCell: function () {\n            return true;\n        },\n        leftColumn: function () {\n            return this;\n        },\n        rightColumn: function () {\n            return this;\n        },\n        topRow: function () {\n            return this;\n        },\n        bottomRow: function () {\n            return this;\n        },\n        forEachRow: function (callback) {\n            callback(this.toRangeRef());\n        },\n        forEachColumn: function (callback) {\n            callback(this.toRangeRef());\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var ref = this.absolute(row, col);\n            if (forRow) {\n                if (ref.row >= start) {\n                    if (delta < 0 && ref.row < start - delta) {\n                        return NULL;\n                    }\n                    ref.row += delta;\n                }\n            } else {\n                if (ref.col >= start) {\n                    if (delta < 0 && ref.col < start - delta) {\n                        return NULL;\n                    }\n                    ref.col += delta;\n                }\n            }\n            if (trow != null && tcol != null) {\n                ref = ref.relative(trow, tcol, this.rel);\n            }\n            return ref;\n        },\n        valid: function () {\n            if (this.rel) {\n                throw new Error('valid() called on relative reference');\n            }\n            var col = this.col, row = this.row;\n            return !(isFinite(col) && col < 0 || isFinite(row) && row < 0);\n        }\n    });\n    var RangeRef = Ref.extend({\n        ref: 'range',\n        init: function RangeRef(tl, br) {\n            if (tl._hasSheet && br._hasSheet && tl.sheet.toLowerCase() != br.sheet.toLowerCase()) {\n                this.endSheet = br.sheet;\n            }\n            this.topLeft = new CellRef(tl.row, tl.col, tl.rel);\n            this.bottomRight = new CellRef(br.row, br.col, br.rel);\n            this.normalize();\n        },\n        clone: function () {\n            return new RangeRef(this.topLeft.clone(), this.bottomRight.clone()).setSheet(this.sheet, this.hasSheet());\n        },\n        _containsRange: function (range) {\n            return this._containsCell(range.topLeft) && this._containsCell(range.bottomRight);\n        },\n        _containsCell: function (cell) {\n            return cell.sheet == this.sheet && cell.row >= this.topLeft.row && cell.col >= this.topLeft.col && cell.row <= this.bottomRight.row && cell.col <= this.bottomRight.col;\n        },\n        contains: function (ref) {\n            if (ref instanceof Array) {\n                var that = this;\n                return ref.some(function (_ref) {\n                    return that.contains(_ref);\n                });\n            }\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref);\n            }\n            if (ref instanceof RangeRef) {\n                return this._containsRange(ref);\n            }\n            return false;\n        },\n        _intersectRange: function (ref) {\n            if (this.sheet != ref.sheet) {\n                return NULL;\n            }\n            var a_left = this.topLeft.col;\n            var a_top = this.topLeft.row;\n            var a_right = this.bottomRight.col;\n            var a_bottom = this.bottomRight.row;\n            var b_left = ref.topLeft.col;\n            var b_top = ref.topLeft.row;\n            var b_right = ref.bottomRight.col;\n            var b_bottom = ref.bottomRight.row;\n            if (a_left <= b_right && b_left <= a_right && a_top <= b_bottom && b_top <= a_bottom) {\n                return new RangeRef(new CellRef(Math.max(a_top, b_top), Math.max(a_left, b_left)), new CellRef(Math.min(a_bottom, b_bottom), Math.min(a_right, b_right))).setSheet(this.sheet, this.hasSheet());\n            } else {\n                return NULL;\n            }\n        },\n        intersect: function (ref) {\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref) ? ref : NULL;\n            }\n            if (ref instanceof RangeRef) {\n                return this._intersectRange(ref).simplify();\n            }\n            if (ref instanceof UnionRef) {\n                return ref.intersect(this);\n            }\n            return NULL;\n        },\n        simplify: function () {\n            if (this.isCell()) {\n                return new CellRef(this.topLeft.row, this.topLeft.col, this.topLeft.rel).setSheet(this.sheet, this.hasSheet());\n            }\n            return this;\n        },\n        normalize: function () {\n            var a = this.topLeft, b = this.bottomRight;\n            var r1 = a.row, c1 = a.col, r2 = b.row, c2 = b.col;\n            var rr1 = a.rel & 2, rc1 = a.rel & 1;\n            var rr2 = b.rel & 2, rc2 = b.rel & 1;\n            var tmp, changes = false;\n            if (r1 > r2) {\n                changes = true;\n                tmp = r1;\n                r1 = r2;\n                r2 = tmp;\n                tmp = rr1;\n                rr1 = rr2;\n                rr2 = tmp;\n            }\n            if (c1 > c2) {\n                changes = true;\n                tmp = c1;\n                c1 = c2;\n                c2 = tmp;\n                tmp = rc1;\n                rc1 = rc2;\n                rc2 = tmp;\n            }\n            if (changes) {\n                this.topLeft = new CellRef(r1, c1, rc1 | rr1);\n                this.bottomRight = new CellRef(r2, c2, rc2 | rr2);\n            }\n            return this;\n        },\n        print: function (trow, tcol, mod) {\n            if (mod || this.absolute(trow, tcol).valid()) {\n                var ret = this.topLeft.print(trow, tcol, mod) + ':' + this.bottomRight.print(trow, tcol, mod);\n                if (this.hasSheet()) {\n                    ret = displaySheet(this.sheet) + (this.endSheet ? ':' + displaySheet(this.endSheet) : '') + '!' + ret;\n                }\n                return ret;\n            }\n            return '#REF!';\n        },\n        absolute: function (arow, acol) {\n            return new RangeRef(this.topLeft.absolute(arow, acol), this.bottomRight.absolute(arow, acol)).setSheet(this.sheet, this.hasSheet());\n        },\n        relative: function (arow, acol, relTL, relBR) {\n            if (relBR == null) {\n                relBR = relTL;\n            }\n            return new RangeRef(this.topLeft.relative(arow, acol, relTL), this.bottomRight.relative(arow, acol, relBR)).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.row - this.topLeft.row + 1;\n        },\n        width: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.col - this.topLeft.col + 1;\n        },\n        collapse: function () {\n            return this.topLeft.toRangeRef();\n        },\n        leftColumn: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.bottomRight.row, this.topLeft.col));\n        },\n        rightColumn: function () {\n            return new RangeRef(new CellRef(this.topLeft.row, this.bottomRight.col), this.bottomRight);\n        },\n        topRow: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.topLeft.row, this.bottomRight.col));\n        },\n        bottomRow: function () {\n            return new RangeRef(new CellRef(this.bottomRight.row, this.topLeft.col), this.bottomRight);\n        },\n        toRangeRef: function () {\n            return this;\n        },\n        toRow: function (row) {\n            row += Math.max(0, this.topLeft.row);\n            return new RangeRef(new CellRef(row, this.topLeft.col), new CellRef(row, this.bottomRight.col)).setSheet(this.sheet, this.hasSheet());\n        },\n        toColumn: function (col) {\n            col += Math.max(0, this.topLeft.col);\n            return new RangeRef(new CellRef(this.topLeft.row, col), new CellRef(this.bottomRight.row, col)).setSheet(this.sheet, this.hasSheet());\n        },\n        toCell: function (row, col) {\n            row += Math.max(0, this.topLeft.row);\n            col += Math.max(0, this.topLeft.col);\n            return new CellRef(row, col, 0).setSheet(this.sheet, this.hasSheet());\n        },\n        forEachRow: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startRow; i <= endRow; i++) {\n                callback(new RangeRef(new CellRef(i, startCol), new CellRef(i, endCol)));\n            }\n        },\n        forEachColumn: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startCol; i <= endCol; i++) {\n                callback(new RangeRef(new CellRef(startRow, i), new CellRef(endRow, i)));\n            }\n        },\n        intersecting: function (refs) {\n            return refs.filter(function (ref) {\n                return ref.toRangeRef().intersects(this);\n            }, this);\n        },\n        union: function (refs, callback) {\n            var intersecting = this.intersecting(refs);\n            var topLeftRow = this.topLeft.row;\n            var topLeftCol = this.topLeft.col;\n            var bottomRightRow = this.bottomRight.row;\n            var bottomRightCol = this.bottomRight.col;\n            var modified = false;\n            intersecting.forEach(function (ref) {\n                ref = ref.toRangeRef();\n                if (ref.topLeft.row < topLeftRow) {\n                    modified = true;\n                    topLeftRow = ref.topLeft.row;\n                }\n                if (ref.topLeft.col < topLeftCol) {\n                    modified = true;\n                    topLeftCol = ref.topLeft.col;\n                }\n                if (ref.bottomRight.row > bottomRightRow) {\n                    modified = true;\n                    bottomRightRow = ref.bottomRight.row;\n                }\n                if (ref.bottomRight.col > bottomRightCol) {\n                    modified = true;\n                    bottomRightCol = ref.bottomRight.col;\n                }\n                if (callback) {\n                    callback(ref);\n                }\n            });\n            var result = new RangeRef(new CellRef(topLeftRow, topLeftCol), new CellRef(bottomRightRow, bottomRightCol));\n            if (modified) {\n                return result.union(refs, callback);\n            } else {\n                return result;\n            }\n        },\n        resize: function (options) {\n            var limit = Math.max.bind(Math, 0);\n            function num(value) {\n                return value || 0;\n            }\n            var top = this.topLeft.row + num(options.top);\n            var left = this.topLeft.col + num(options.left);\n            var bottom = this.bottomRight.row + num(options.bottom);\n            var right = this.bottomRight.col + num(options.right);\n            if (left < 0 && right < 0 || top < 0 && bottom < 0) {\n                return NULL;\n            } else if (top <= bottom && left <= right) {\n                return new RangeRef(new CellRef(limit(top), limit(left)), new CellRef(limit(bottom), limit(right)));\n            } else {\n                return NULL;\n            }\n        },\n        move: function (rows, cols) {\n            return new RangeRef(new CellRef(this.topLeft.row + rows, this.topLeft.col + cols), new CellRef(this.bottomRight.row + rows, this.bottomRight.col + cols));\n        },\n        first: function () {\n            return this.topLeft;\n        },\n        isCell: function () {\n            return !this.endSheet && this.topLeft.eq(this.bottomRight);\n        },\n        toString: function () {\n            return this.topLeft + ':' + this.bottomRight;\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var tl = this.topLeft.adjust(row, col, trow, tcol, forRow, start, delta);\n            var tr = this.bottomRight.adjust(row, col, trow, tcol, forRow, start, delta);\n            if (tl === NULL && tr === NULL) {\n                return NULL;\n            }\n            if (tl === NULL) {\n                tl = this.topLeft.absolute(row, col);\n                if (forRow) {\n                    tl.row = start;\n                } else {\n                    tl.col = start;\n                }\n                if (trow != null && tcol != null) {\n                    tl = tl.relative(trow, tcol, this.topLeft.rel);\n                }\n            } else if (tr === NULL) {\n                tr = this.bottomRight.absolute(row, col);\n                if (forRow) {\n                    tr.row = start - 1;\n                } else {\n                    tr.col = start - 1;\n                }\n                if (trow != null && tcol != null) {\n                    tr = tr.relative(trow, tcol, this.bottomRight.rel);\n                }\n            }\n            return new RangeRef(tl, tr).setSheet(this.sheet, this.hasSheet()).simplify();\n        },\n        valid: function () {\n            return this.topLeft.valid() && this.bottomRight.valid();\n        }\n    });\n    var UnionRef = Ref.extend({\n        init: function UnionRef(refs) {\n            this.refs = refs;\n            this.length = refs.length;\n        },\n        clone: function () {\n            return new UnionRef(this.refs.slice());\n        },\n        intersect: function (ref) {\n            var a = [];\n            for (var i = 0; i < this.length; ++i) {\n                var x = ref.intersect(this.refs[i]);\n                if (x !== NULL) {\n                    a.push(x);\n                }\n            }\n            if (a.length > 0) {\n                return new UnionRef(a).simplify();\n            }\n            return NULL;\n        },\n        simplify: function () {\n            var u = new UnionRef(this.refs.reduce(function (a, ref) {\n                ref = ref.simplify();\n                if (ref !== NULL) {\n                    a.push(ref);\n                }\n                return a;\n            }, []));\n            if (u.empty()) {\n                return NULL;\n            }\n            if (u.single()) {\n                return u.refs[0];\n            }\n            return u;\n        },\n        absolute: function (arow, acol) {\n            return new UnionRef(this.refs.map(function (ref) {\n                return ref.absolute(arow, acol);\n            }));\n        },\n        forEach: function (callback, obj) {\n            this.refs.forEach(callback, obj);\n        },\n        toRangeRef: function () {\n            return this.refs[0].toRangeRef();\n        },\n        contains: function (theRef) {\n            return this.refs.some(function (ref) {\n                return ref.contains(theRef);\n            });\n        },\n        map: function (callback, obj) {\n            return new UnionRef(this.refs.map(callback, obj));\n        },\n        first: function () {\n            return this.refs[0].first();\n        },\n        lastRange: function () {\n            return this.refs[this.length - 1];\n        },\n        size: function () {\n            return this.length;\n        },\n        single: function () {\n            return this.length == 1;\n        },\n        empty: function () {\n            return this.length === 0;\n        },\n        isCell: function () {\n            return this.single() && this.refs[0].isCell();\n        },\n        rangeAt: function (index) {\n            return this.refs[index];\n        },\n        nextRangeIndex: function (index) {\n            if (index === this.length - 1) {\n                return 0;\n            } else {\n                return index + 1;\n            }\n        },\n        previousRangeIndex: function (index) {\n            if (index === 0) {\n                return this.length - 1;\n            } else {\n                return index - 1;\n            }\n        },\n        concat: function (ref) {\n            return new UnionRef(this.refs.concat([ref]));\n        },\n        print: function (row, col, mod) {\n            return this.refs.map(function (ref) {\n                return ref.print(row, col, mod);\n            }).join(',');\n        },\n        replaceAt: function (index, ref) {\n            var newRefs = this.refs.slice();\n            newRefs.splice(index, 1, ref);\n            return new UnionRef(newRefs);\n        },\n        leftColumn: function () {\n            return this.map(function (ref) {\n                return ref.leftColumn();\n            });\n        },\n        rightColumn: function () {\n            return this.map(function (ref) {\n                return ref.rightColumn();\n            });\n        },\n        topRow: function () {\n            return this.map(function (ref) {\n                return ref.topRow();\n            });\n        },\n        bottomRow: function () {\n            return this.map(function (ref) {\n                return ref.bottomRow();\n            });\n        },\n        forEachRow: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachRow(callback);\n            });\n        },\n        forEachColumn: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachColumn(callback);\n            });\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            return this.map(function (ref) {\n                return ref.adjust(row, col, trow, tcol, forRow, start, delta);\n            }).simplify();\n        },\n        toString: function () {\n            return this.refs.map(function (ref) {\n                return ref.toString();\n            }).join(', ');\n        },\n        valid: function () {\n            for (var i = this.refs.length; --i >= 0;) {\n                if (this.refs[i].valid()) {\n                    return false;\n                }\n            }\n            return true;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            this.refs.forEach(function (ref) {\n                ref.renameSheet(oldSheetName, newSheetName);\n            });\n        }\n    });\n    spreadsheet.NULLREF = NULL;\n    spreadsheet.SHEETREF = new RangeRef(new CellRef(0, 0), new CellRef(Infinity, Infinity));\n    spreadsheet.FIRSTREF = new CellRef(0, 0);\n    spreadsheet.Ref = Ref;\n    spreadsheet.NameRef = NameRef;\n    spreadsheet.CellRef = CellRef;\n    spreadsheet.RangeRef = RangeRef;\n    spreadsheet.UnionRef = UnionRef;\n    spreadsheet.SHEETREF.print = function () {\n        return '#SHEET';\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofillcalculator', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var AutoFillCalculator = kendo.Class.extend({\n            init: function (grid) {\n                this._grid = grid;\n            },\n            rectIsVertical: function (start, end, x, y) {\n                var startRect = this._grid.rectangle(start.toRangeRef());\n                var endRect = this._grid.rectangle(end.toRangeRef());\n                return Math.abs(endRect[y] - startRect[y]) > Math.abs(startRect[x] - endRect[x]);\n            },\n            autoFillDest: function (selection, cursor) {\n                var topLeft = selection.topLeft;\n                var bottomRight = selection.bottomRight;\n                var quadrant;\n                var lower = cursor.row >= topLeft.row;\n                var further = cursor.col >= topLeft.col;\n                if (lower) {\n                    quadrant = further ? 4 : 3;\n                } else {\n                    quadrant = further ? 2 : 1;\n                }\n                var pivot, opposite, cornerResult, expanding;\n                if (quadrant === 4) {\n                    pivot = topLeft;\n                    opposite = bottomRight;\n                    expanding = cursor.row > opposite.row || cursor.col > opposite.col;\n                    if (expanding) {\n                        cursor = new CellRef(Math.max(cursor.row, opposite.row), Math.max(cursor.col, opposite.col));\n                    }\n                    if (this.rectIsVertical(opposite, cursor, 'right', 'bottom')) {\n                        cornerResult = new CellRef(cursor.row, opposite.col);\n                    } else {\n                        cornerResult = new CellRef(opposite.row, cursor.col);\n                    }\n                } else if (quadrant === 3) {\n                    var bottomLeft = new CellRef(topLeft.col, bottomRight.row);\n                    if (cursor.row > bottomRight.row && this.rectIsVertical(bottomLeft, cursor, 'left', 'bottom')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(cursor.row, bottomRight.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                } else if (quadrant === 2) {\n                    var topRight = new CellRef(topLeft.row, bottomRight.col);\n                    if (cursor.col > bottomRight.col && !this.rectIsVertical(topRight, cursor, 'right', 'top')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(bottomRight.row, cursor.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    }\n                } else {\n                    pivot = bottomRight;\n                    if (this.rectIsVertical(topLeft, cursor, 'left', 'top')) {\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    } else {\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                }\n                return this._grid.normalize(new RangeRef(pivot, cornerResult));\n            }\n        });\n        kendo.spreadsheet.AutoFillCalculator = AutoFillCalculator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/navigator', [\n        'kendo.core',\n        'spreadsheet/autofillcalculator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var EdgeNavigator = kendo.Class.extend({\n            init: function (field, axis, rangeGetter, union) {\n                this.rangeGetter = rangeGetter;\n                this.prevLeft = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.prevVisible(current.topLeft[field]));\n                    return union(range).topLeft[field];\n                };\n                this.nextRight = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.nextVisible(current.bottomRight[field]));\n                    return union(range).bottomRight[field];\n                };\n                this.nextLeft = function (index) {\n                    var range = union(this.range(index));\n                    return axis.nextVisible(range.bottomRight[field]);\n                };\n                this.prevRight = function (index) {\n                    var range = union(this.range(index));\n                    return axis.prevVisible(range.topLeft[field]);\n                };\n            },\n            boundary: function (top, bottom) {\n                this.top = top;\n                this.bottom = bottom;\n            },\n            range: function (index) {\n                return this.rangeGetter(index, this.top, this.bottom);\n            }\n        });\n        var SheetNavigator = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.columns = this._sheet._grid._columns;\n                this.autoFillCalculator = new kendo.spreadsheet.AutoFillCalculator(sheet._grid);\n                this.colEdge = new EdgeNavigator('col', this._sheet._grid._columns, this.columnRange.bind(this), this.union.bind(this));\n                this.rowEdge = new EdgeNavigator('row', this._sheet._grid._rows, this.rowRange.bind(this), this.union.bind(this));\n            },\n            height: function (height) {\n                this._viewPortHeight = height;\n            },\n            union: function (ref) {\n                return this._sheet.unionWithMerged(ref);\n            },\n            columnRange: function (col, topRow, bottomRow) {\n                return this._sheet._ref(topRow, col, bottomRow - topRow, 1);\n            },\n            rowRange: function (row, leftCol, rightCol) {\n                return this._sheet._ref(row, leftCol, 1, rightCol - leftCol);\n            },\n            selectionIncludesMergedCells: function () {\n                return this._sheet.select().contains(this._sheet._mergedCells);\n            },\n            setSelectionValue: function (value) {\n                var selection = this._sheet.selection();\n                setTimeout(function () {\n                    selection.value(value());\n                });\n            },\n            selectAll: function () {\n                this._sheet.select(this._sheet._sheetRef);\n            },\n            select: function (ref, mode, addToExisting) {\n                ref = this.refForMode(ref, mode);\n                if (addToExisting) {\n                    ref = this._sheet.select().concat(ref);\n                }\n                this._sheet.select(ref);\n            },\n            refForMode: function (ref, mode) {\n                var grid = this._sheet._grid;\n                switch (mode) {\n                case 'range':\n                    ref = grid.normalize(ref);\n                    break;\n                case 'row':\n                    ref = grid.rowRef(ref.row);\n                    break;\n                case 'column':\n                    ref = grid.colRef(ref.col);\n                    break;\n                case 'sheet':\n                    ref = this._sheet._sheetRef;\n                    break;\n                }\n                return ref;\n            },\n            startSelection: function (ref, mode, addToExisting, shiftKey) {\n                if (mode == 'autofill') {\n                    this._sheet.startAutoFill();\n                } else if (shiftKey && mode == 'range') {\n                    var range = new RangeRef(this._sheet.activeCell().first(), ref);\n                    this._sheet.select(range, false, false);\n                    this._sheet.startSelection();\n                } else {\n                    this._sheet.startSelection();\n                    this.select(ref, mode, addToExisting);\n                }\n            },\n            completeSelection: function () {\n                this._sheet.completeSelection();\n            },\n            selectForContextMenu: function (ref, mode) {\n                var sheet = this._sheet;\n                if (!sheet.select().contains(this.refForMode(ref, mode))) {\n                    this.select(ref, mode);\n                }\n            },\n            modifySelection: function (action) {\n                var direction = this.determineDirection(action);\n                var sheet = this._sheet;\n                var viewPortHeight = this._viewPortHeight;\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var originalSelection = sheet.currentOriginalSelectionRange();\n                var selection = sheet.select().toRangeRef();\n                var activeCell = sheet.activeCell();\n                var topLeft = originalSelection.topLeft.clone();\n                var bottomRight = originalSelection.bottomRight.clone();\n                var scrollInto;\n                this.colEdge.boundary(selection.topLeft.row, selection.bottomRight.row);\n                this.rowEdge.boundary(selection.topLeft.col, selection.bottomRight.col);\n                switch (direction) {\n                case 'expand-left':\n                    topLeft.col = this.colEdge.prevLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-right':\n                    topLeft.col = this.colEdge.nextLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-right':\n                    bottomRight.col = this.colEdge.nextRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-left':\n                    bottomRight.col = this.colEdge.prevRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-up':\n                    topLeft.row = this.rowEdge.prevLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-down':\n                    topLeft.row = this.rowEdge.nextLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-down':\n                    bottomRight.row = this.rowEdge.nextRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-up':\n                    bottomRight.row = this.rowEdge.prevRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-page-up':\n                    topLeft.row = rows.prevPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'shrink-page-up':\n                    bottomRight.row = rows.prevPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'expand-page-down':\n                    bottomRight.row = rows.nextPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'shrink-page-down':\n                    topLeft.row = rows.nextPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'first-col':\n                    topLeft.col = columns.firstVisible();\n                    bottomRight.col = activeCell.bottomRight.col;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-col':\n                    bottomRight.col = columns.lastVisible();\n                    topLeft.col = activeCell.topLeft.col;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first-row':\n                    topLeft.row = rows.firstVisible();\n                    bottomRight.row = activeCell.bottomRight.row;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-row':\n                    bottomRight.row = rows.lastVisible();\n                    topLeft.row = activeCell.topLeft.row;\n                    scrollInto = bottomRight;\n                    break;\n                case 'last':\n                    bottomRight.row = rows.lastVisible();\n                    bottomRight.col = columns.lastVisible();\n                    topLeft = activeCell.topLeft;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first':\n                    topLeft.row = rows.firstVisible();\n                    topLeft.col = columns.firstVisible();\n                    bottomRight = activeCell.bottomRight;\n                    scrollInto = topLeft;\n                    break;\n                }\n                var newSelection = new RangeRef(topLeft, bottomRight);\n                if (!this.union(newSelection).intersects(activeCell)) {\n                    this.modifySelection(direction.replace('shrink', 'expand'));\n                    return;\n                }\n                if (scrollInto) {\n                    sheet.focus(scrollInto);\n                }\n                this.updateCurrentSelectionRange(newSelection);\n            },\n            moveActiveCell: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var bottomRight = activeCell.bottomRight;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                switch (direction) {\n                case 'left':\n                    column = columns.prevVisible(topLeft.col);\n                    break;\n                case 'up':\n                    row = rows.prevVisible(topLeft.row);\n                    break;\n                case 'right':\n                    column = columns.nextVisible(bottomRight.col);\n                    break;\n                case 'down':\n                    row = rows.nextVisible(bottomRight.row);\n                    break;\n                case 'first-col':\n                    column = columns.firstVisible();\n                    break;\n                case 'last-col':\n                    column = columns.lastVisible();\n                    break;\n                case 'first-row':\n                    row = rows.firstVisible();\n                    break;\n                case 'last-row':\n                    row = rows.lastVisible();\n                    break;\n                case 'last':\n                    row = rows.lastVisible();\n                    column = columns.lastVisible();\n                    break;\n                case 'first':\n                    row = rows.firstVisible();\n                    column = columns.firstVisible();\n                    break;\n                case 'next-page':\n                    row = rows.nextPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                case 'prev-page':\n                    row = rows.prevPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                }\n                sheet.select(new CellRef(row, column));\n            },\n            navigateInSelection: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                var selection = sheet.currentNavigationRange();\n                var selTopLeft = selection.topLeft;\n                var selBottomRight = selection.bottomRight;\n                var done = false;\n                var topLeftCol = topLeft.col;\n                var topLeftRow = topLeft.row;\n                while (!done) {\n                    var current = new CellRef(row, column);\n                    switch (direction) {\n                    case 'next':\n                        if (selBottomRight.eq(current)) {\n                            selection = sheet.nextNavigationRange();\n                            row = selection.topLeft.row;\n                            column = selection.topLeft.col;\n                        } else {\n                            column = columns.nextVisible(topLeftCol, true);\n                            if (column > selBottomRight.col) {\n                                column = selTopLeft.col;\n                                row = rows.nextVisible(row, true);\n                            }\n                        }\n                        break;\n                    case 'previous':\n                        if (selTopLeft.eq(current)) {\n                            selection = sheet.previousNavigationRange();\n                            row = selection.bottomRight.row;\n                            column = selection.bottomRight.col;\n                        } else {\n                            column = columns.prevVisible(topLeftCol, true);\n                            if (column < selTopLeft.col) {\n                                column = selBottomRight.col;\n                                row = rows.prevVisible(row, true);\n                            }\n                        }\n                        break;\n                    case 'lower':\n                        if (selBottomRight.eq(current)) {\n                            selection = sheet.nextNavigationRange();\n                            row = selection.topLeft.row;\n                            column = selection.topLeft.col;\n                        } else {\n                            row = rows.nextVisible(topLeftRow, true);\n                            if (row > selBottomRight.row) {\n                                row = selTopLeft.row;\n                                column = columns.nextVisible(column, true);\n                            }\n                        }\n                        break;\n                    case 'upper':\n                        if (selTopLeft.eq(current)) {\n                            selection = sheet.previousNavigationRange();\n                            row = selection.bottomRight.row;\n                            column = selection.bottomRight.col;\n                        } else {\n                            row = rows.prevVisible(topLeftRow, true);\n                            if (row < selTopLeft.row) {\n                                row = selBottomRight.row;\n                                column = columns.prevVisible(column, true);\n                            }\n                        }\n                        break;\n                    default:\n                        throw new Error('Unknown entry navigation: ' + direction);\n                    }\n                    done = !this.shouldSkip(row, column);\n                    topLeftCol = column;\n                    topLeftRow = row;\n                }\n                if (sheet.singleCellSelection()) {\n                    sheet.select(new CellRef(row, column));\n                } else {\n                    sheet.activeCell(new CellRef(row, column));\n                }\n            },\n            extendSelection: function (ref, mode) {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                if (mode === 'autofill') {\n                    this.resizeAutoFill(ref);\n                    return;\n                }\n                if (mode === 'range') {\n                    ref = grid.normalize(ref);\n                } else if (mode === 'row') {\n                    ref = grid.rowRef(ref.row).bottomRight;\n                } else if (mode === 'column') {\n                    ref = grid.colRef(ref.col).bottomRight;\n                }\n                var activeCell = sheet.originalActiveCell().toRangeRef();\n                this.updateCurrentSelectionRange(new RangeRef(activeCell.topLeft, ref));\n            },\n            shouldSkip: function (row, col) {\n                var ref = new CellRef(row, col);\n                var isMerged = false;\n                this._sheet.forEachMergedCell(function (merged) {\n                    if (merged.intersects(ref) && !merged.collapse().eq(ref)) {\n                        isMerged = true;\n                    }\n                });\n                return isMerged;\n            },\n            resizeAutoFill: function (ref) {\n                var sheet = this._sheet;\n                var selection = sheet.select();\n                var origin = sheet._autoFillOrigin;\n                var dest = this.autoFillCalculator.autoFillDest(selection, ref);\n                var punch = this.punch(selection, dest);\n                var hint, direction, row;\n                if (!punch) {\n                    var preview = sheet.range(dest)._previewFillFrom(sheet.range(origin));\n                    if (preview) {\n                        direction = preview.direction;\n                        var props = preview.props;\n                        if (direction === 0 || direction == 1) {\n                            row = props[props.length - 1];\n                            hint = row[row.length - 1].value;\n                        } else if (direction === 2) {\n                            row = props[0];\n                            hint = row[row.length - 1].value;\n                        } else if (direction === 3) {\n                            row = props[props.length - 1];\n                            hint = row[0].value;\n                        }\n                    }\n                }\n                sheet.updateAutoFill(dest, punch, hint, direction);\n            },\n            determineDirection: function (action) {\n                var selection = this._sheet.currentSelectionRange();\n                var activeCell = this._sheet.activeCell();\n                var leftMode = activeCell.topLeft.col == selection.topLeft.col;\n                var rightMode = activeCell.bottomRight.col == selection.bottomRight.col;\n                var topMode = activeCell.topLeft.row == selection.topLeft.row;\n                var bottomMode = activeCell.bottomRight.row == selection.bottomRight.row;\n                switch (action) {\n                case 'left':\n                    action = rightMode ? 'expand-left' : 'shrink-left';\n                    break;\n                case 'right':\n                    action = leftMode ? 'expand-right' : 'shrink-right';\n                    break;\n                case 'up':\n                    action = bottomMode ? 'expand-up' : 'shrink-up';\n                    break;\n                case 'down':\n                    action = topMode ? 'expand-down' : 'shrink-down';\n                    break;\n                case 'prev-page':\n                    action = bottomMode ? 'expand-page-up' : 'shrink-page-up';\n                    break;\n                case 'next-page':\n                    action = topMode ? 'expand-page-down' : 'shrink-page-down';\n                    break;\n                }\n                return action;\n            },\n            updateCurrentSelectionRange: function (ref) {\n                var sheet = this._sheet;\n                sheet.select(sheet.originalSelect().replaceAt(sheet.selectionRangeIndex(), ref), false);\n            },\n            punch: function (selection, subset) {\n                var punch;\n                if (subset.topLeft.eq(selection.topLeft)) {\n                    if (subset.bottomRight.row < selection.bottomRight.row) {\n                        var bottomRow = this.rowEdge.nextRight(subset.bottomRight.row);\n                        punch = new RangeRef(new CellRef(bottomRow, selection.topLeft.col), selection.bottomRight);\n                    } else if (subset.bottomRight.col < selection.bottomRight.col) {\n                        var bottomCol = this.colEdge.nextRight(subset.bottomRight.col);\n                        punch = new RangeRef(new CellRef(selection.topLeft.row, bottomCol), selection.bottomRight);\n                    }\n                }\n                return punch;\n            }\n        });\n        kendo.spreadsheet.SheetNavigator = SheetNavigator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axismanager', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var AxisManager = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n            },\n            forEachSelectedColumn: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            forEachSelectedRow: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            includesHiddenColumns: function (ref) {\n                return this._sheet._grid._columns.includesHidden(ref.topLeft.col, ref.bottomRight.col);\n            },\n            includesHiddenRows: function (ref) {\n                return this._sheet._grid._rows.includesHidden(ref.topLeft.row, ref.bottomRight.row);\n            },\n            selectionIncludesHiddenColumns: function () {\n                return this.includesHiddenColumns(this._sheet.select());\n            },\n            selectionIncludesHiddenRows: function () {\n                return this.includesHiddenRows(this._sheet.select());\n            },\n            deleteSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.deleteColumn(index - i);\n                });\n            },\n            deleteSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.deleteRow(index - i);\n                });\n            },\n            hideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.hideColumn(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var left = ref.topLeft.col;\n                var right = ref.bottomRight.col;\n                var sel = null;\n                while (true) {\n                    var hasRight = right < sheet._columns._count;\n                    var hasLeft = left >= 0;\n                    if (!hasLeft && !hasRight) {\n                        break;\n                    }\n                    if (hasRight && !sheet.isHiddenColumn(right)) {\n                        sel = right;\n                        break;\n                    }\n                    if (hasLeft && !sheet.isHiddenColumn(left)) {\n                        sel = left;\n                        break;\n                    }\n                    left--;\n                    right++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(0, sel), new kendo.spreadsheet.CellRef(sheet._rows._count - 1, sel));\n                    sheet.range(ref).select();\n                }\n            },\n            hideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.hideRow(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var top = ref.topLeft.row;\n                var bottom = ref.bottomRight.row;\n                var sel = null;\n                while (true) {\n                    var hasBottom = bottom < sheet._rows._count;\n                    var hasTop = top >= 0;\n                    if (!hasTop && !hasBottom) {\n                        break;\n                    }\n                    if (hasBottom && !sheet.isHiddenRow(bottom)) {\n                        sel = bottom;\n                        break;\n                    }\n                    if (hasTop && !sheet.isHiddenRow(top)) {\n                        sel = top;\n                        break;\n                    }\n                    top--;\n                    bottom++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(sel, 0), new kendo.spreadsheet.CellRef(sel, sheet._columns._count - 1));\n                    sheet.range(ref).select();\n                }\n            },\n            unhideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.unhideColumn(index);\n                });\n            },\n            unhideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.unhideRow(index);\n                });\n            },\n            addColumnLeft: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.insertColumn(index - i);\n                });\n            },\n            addColumnRight: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.insertColumn(index + (i + 1));\n                });\n            },\n            preventAddRow: function () {\n                var range = this._sheet.select().toRangeRef();\n                var rowCount = range.height();\n                return this._sheet.preventInsertRow(0, rowCount);\n            },\n            preventAddColumn: function () {\n                return this._sheet.preventInsertColumn();\n            },\n            addRowAbove: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.insertRow(index - i);\n                });\n            },\n            addRowBelow: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.insertRow(index + (i + 1));\n                });\n            }\n        });\n        kendo.spreadsheet.AxisManager = AxisManager;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/clipboard', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Clipboard = kendo.Class.extend({\n            init: function (workbook) {\n                this._content = {};\n                this._externalContent = {};\n                this._internalContent = {};\n                this.workbook = workbook;\n                this.origin = kendo.spreadsheet.NULLREF;\n                this.iframe = document.createElement('iframe');\n                this.iframe.className = 'k-spreadsheet-clipboard-paste';\n                this.menuInvoked = true;\n                this._uid = kendo.guid();\n                document.body.appendChild(this.iframe);\n            },\n            destroy: function () {\n                document.body.removeChild(this.iframe);\n            },\n            canCopy: function () {\n                var status = { canCopy: true };\n                var selection = this.workbook.activeSheet().select();\n                if (selection === kendo.spreadsheet.NULLREF) {\n                    status.canCopy = false;\n                }\n                if (selection instanceof kendo.spreadsheet.UnionRef) {\n                    status.canCopy = false;\n                    status.multiSelection = true;\n                }\n                if (this.menuInvoked) {\n                    status.canCopy = false;\n                    status.menuInvoked = true;\n                }\n                return status;\n            },\n            canPaste: function () {\n                var sheet = this.workbook.activeSheet();\n                var ref = this.pasteRef();\n                var range = sheet.range(ref);\n                var status = {\n                    canPaste: true,\n                    pasteOnMerged: false,\n                    pasteOnDisabled: false\n                };\n                if (!range.enable()) {\n                    status.canPaste = false;\n                    status.pasteOnDisabled = true;\n                }\n                if (!ref.eq(sheet.unionWithMerged(ref))) {\n                    status.canPaste = false;\n                    status.pasteOnMerged = true;\n                }\n                if (this.menuInvoked) {\n                    status.canPaste = false;\n                    status.menuInvoked = true;\n                }\n                if (ref.bottomRight.row >= sheet._rows._count || ref.bottomRight.col >= sheet._columns._count) {\n                    status.canPaste = false;\n                    status.overflow = true;\n                }\n                return status;\n            },\n            intersectsMerged: function () {\n                var sheet = this.workbook.activeSheet();\n                this.parse();\n                this.origin = this._content.origRef;\n                var ref = this.pasteRef();\n                return !ref.eq(sheet.unionWithMerged(ref));\n            },\n            copy: function () {\n                var sheet = this.workbook.activeSheet();\n                this.origin = sheet.select();\n                this._internalContent = sheet.selection().getState();\n                delete this._externalContent.html;\n                delete this._externalContent.plain;\n            },\n            cut: function () {\n                var sheet = this.workbook.activeSheet();\n                this.copy();\n                sheet.range(sheet.select()).clear();\n            },\n            pasteRef: function () {\n                var sheet = this.workbook.activeSheet();\n                var destination = sheet.activeCell().first();\n                var originActiveCell = this.origin.first();\n                var rowDelta = originActiveCell.row - destination.row;\n                var colDelta = originActiveCell.col - destination.col;\n                return this.origin.relative(rowDelta, colDelta, 3);\n            },\n            paste: function () {\n                var sheet = this.workbook.activeSheet();\n                var pasteRef = this.pasteRef();\n                sheet.range(pasteRef).setState(this._content, this);\n                sheet.triggerChange({\n                    recalc: true,\n                    ref: pasteRef\n                });\n            },\n            external: function (data) {\n                if (data && (data.html || data.plain)) {\n                    this._externalContent = data;\n                } else {\n                    return this._externalContent;\n                }\n            },\n            isExternal: function () {\n                return !this._isInternal();\n            },\n            parse: function () {\n                var state = newState();\n                if (this._isInternal()) {\n                    state = this._internalContent;\n                } else {\n                    var data = this._externalContent;\n                    if (data.html) {\n                        var doc = this.iframe.contentWindow.document;\n                        doc.open();\n                        doc.write(data.html);\n                        doc.close();\n                        var table = $(doc).find('table:first');\n                        if (table.length) {\n                            state = parseHTML(table);\n                        } else {\n                            state = parseTSV(data.plain);\n                        }\n                    } else {\n                        state = parseTSV(data.plain);\n                    }\n                    this.origin = state.origRef;\n                }\n                this._content = state;\n            },\n            _isInternal: function () {\n                if (this._externalContent.html === undefined) {\n                    return true;\n                }\n                var internalHTML = $('<div/>').html(this._externalContent.html).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                var internalPlain = $('<div/>').html(this._externalContent.plain).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                return internalHTML || internalPlain;\n            }\n        });\n        kendo.spreadsheet.Clipboard = Clipboard;\n        function newState() {\n            var ref = new CellRef(0, 0, 0);\n            return {\n                ref: ref,\n                mergedCells: [],\n                data: [],\n                foreign: true,\n                origRef: ref.toRangeRef()\n            };\n        }\n        function setStateData(state, row, col, value) {\n            var data = state.data || (state.data = []);\n            if (!data[row]) {\n                data[row] = [];\n            }\n            data[row][col] = value;\n            var br = state.origRef.bottomRight;\n            br.row = Math.max(br.row, row);\n            br.col = Math.max(br.col, col);\n        }\n        function stripStyle(style) {\n            return style.replace(/^-(?:ms|moz|webkit)-/, '');\n        }\n        function borderObject(styles) {\n            var obj = {};\n            [\n                'borderBottom',\n                'borderRight',\n                'borderLeft',\n                'borderTop'\n            ].forEach(function (key) {\n                obj[key] = styles[key + 'Style'] == 'none' ? null : {\n                    size: 1,\n                    color: styles[key + 'Color']\n                };\n            });\n            return obj;\n        }\n        function cellState(element) {\n            var styles = window.getComputedStyle(element[0]);\n            var text = element[0].innerText;\n            var borders = borderObject(styles);\n            var state = {\n                value: text === '' ? null : text,\n                borderBottom: borders.borderBottom,\n                borderRight: borders.borderRight,\n                borderLeft: borders.borderLeft,\n                borderTop: borders.borderTop,\n                fontSize: parseInt(styles['font-size'], 10)\n            };\n            if (styles['background-color'] !== 'rgb(0, 0, 0)' && styles['background-color'] !== 'rgba(0, 0, 0, 0)') {\n                state.background = styles['background-color'];\n            }\n            if (styles.color !== 'rgb(0, 0, 0)' && styles.color !== 'rgba(0, 0, 0, 0)') {\n                state.color = styles.color;\n            }\n            if (styles['text-decoration'] == 'underline') {\n                state.underline = true;\n            }\n            if (styles['font-style'] == 'italic') {\n                state.italic = true;\n            }\n            if (styles['font-weight'] == 'bold') {\n                state.bold = true;\n            }\n            if (stripStyle(styles['text-align']) !== 'right') {\n                state.textAlign = stripStyle(styles['text-align']);\n            }\n            if (styles['vertical-align'] !== 'middle') {\n                state.verticalAlign = styles['vertical-align'];\n            }\n            if (styles['word-wrap'] !== 'normal') {\n                state.wrap = true;\n            }\n            return state;\n        }\n        function parseHTML(table) {\n            var state = newState();\n            table.find('>tr, >tbody>tr').each(function (rowIndex, tr) {\n                $(tr).find('>td, >th').each(function (colIndex, td) {\n                    var rowspan = parseInt($(td).attr('rowspan'), 10) - 1 || 0;\n                    var colspan = parseInt($(td).attr('colspan'), 10) - 1 || 0;\n                    var blankCell = '<td/>';\n                    var ci;\n                    if (rowspan) {\n                        var endRow = rowIndex + rowspan;\n                        for (var ri = rowIndex; ri <= endRow; ri++) {\n                            var row = table.find('tr').eq(ri);\n                            if (ri > rowIndex) {\n                                blankCell = '<td class=\\'rowspan\\'></td>';\n                                if (colIndex === 0) {\n                                    row.find('td').eq(colIndex).after(blankCell);\n                                } else {\n                                    var last = Math.min(row.find('td').length, colIndex);\n                                    row.find('td').eq(last - 1).after(blankCell);\n                                }\n                            }\n                            if (colspan) {\n                                for (ci = colIndex; ci < colspan + colIndex; ci++) {\n                                    blankCell = '<td class=\\'rowspan colspan\\'></td>';\n                                    row.find('td').eq(ci).after(blankCell);\n                                }\n                            }\n                        }\n                    } else {\n                        if (colspan) {\n                            for (ci = colIndex; ci < colspan + colIndex; ci++) {\n                                blankCell = '<td class=\\'colspan\\'></td>';\n                                $(tr).find('td').eq(ci).after(blankCell);\n                            }\n                        }\n                    }\n                });\n            });\n            table.find('>tr, >tbody>tr').each(function (rowIndex, tr) {\n                $(tr).find('>td, >th').each(function (colIndex, td) {\n                    var rowspan = parseInt($(td).attr('rowspan'), 10) - 1 || 0;\n                    var colspan = parseInt($(td).attr('colspan'), 10) - 1 || 0;\n                    setStateData(state, rowIndex, colIndex, cellState($(td)));\n                    if (rowspan || colspan) {\n                        var startCol = String.fromCharCode(65 + colIndex);\n                        var endCol = String.fromCharCode(65 + colIndex + colspan);\n                        var address = startCol + (rowIndex + 1) + ':' + endCol + (rowIndex + 1 + rowspan);\n                        state.mergedCells.push(address);\n                    }\n                });\n            });\n            return state;\n        }\n        function parseTSV(data) {\n            var state = newState();\n            if (data.indexOf('\\t') === -1 && data.indexOf('\\n') == -1) {\n                setStateData(state, 0, 0, { value: data });\n            } else {\n                var rows = data.split('\\n');\n                for (var ri = 0; ri < rows.length; ri++) {\n                    var cols = rows[ri].split('\\t');\n                    for (var ci = 0; ci < cols.length; ci++) {\n                        setStateData(state, ri, ci, { value: cols[ci] });\n                    }\n                }\n            }\n            return state;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/range', [\n        'kendo.core',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var PROPERTIES = [\n            'color',\n            'fontFamily',\n            'underline',\n            'italic',\n            'bold',\n            'textAlign',\n            'verticalAlign',\n            'background',\n            'format',\n            'link',\n            'editor'\n        ];\n        var borders = {\n            borderTop: {\n                complement: 'borderBottom',\n                direction: {\n                    top: -1,\n                    bottom: -1\n                }\n            },\n            borderLeft: {\n                complement: 'borderRight',\n                direction: {\n                    left: -1,\n                    right: -1\n                }\n            },\n            borderRight: {\n                complement: 'borderLeft',\n                direction: {\n                    left: 1,\n                    right: 1\n                }\n            },\n            borderBottom: {\n                complement: 'borderTop',\n                direction: {\n                    top: 1,\n                    bottom: 1\n                }\n            }\n        };\n        var Range = kendo.Class.extend({\n            init: function (ref, sheet) {\n                this._sheet = sheet;\n                this._ref = ref;\n            },\n            clone: function () {\n                return new Range(this._ref.clone(), this._sheet);\n            },\n            skipHiddenCells: function () {\n                var refs = [];\n                var self = this, sheet = self._sheet;\n                var skipHiddenRows = sheet.isHiddenRow.bind(sheet);\n                var skipHiddenCols = sheet.isHiddenColumn.bind(sheet);\n                self._ref.forEach(function add(ref) {\n                    if (ref instanceof UnionRef) {\n                        ref.forEach(add);\n                    } else {\n                        ref = self._normalize(ref.toRangeRef());\n                        var tl = ref.topLeft, br = ref.bottomRight;\n                        var rows = partition(tl.row, br.row, skipHiddenRows);\n                        var cols = partition(tl.col, br.col, skipHiddenCols);\n                        for (var i = 0; i < rows.length; ++i) {\n                            for (var j = 0; j < cols.length; ++j) {\n                                refs.push(new RangeRef(new CellRef(rows[i].begin, cols[j].begin), new CellRef(rows[i].end, cols[j].end)));\n                            }\n                        }\n                    }\n                });\n                return sheet.range(refs.length > 1 ? new UnionRef(refs) : refs[0]);\n            },\n            _normalize: function (ref) {\n                return this._sheet._grid.normalize(ref);\n            },\n            _set: function (name, value, noTrigger) {\n                var self = this;\n                var sheet = self._sheet;\n                self._ref.forEach(function (ref) {\n                    sheet._set(ref.toRangeRef(), name, value);\n                });\n                if (!noTrigger) {\n                    sheet.triggerChange({\n                        recalc: name == 'formula' || name == 'value' || name == 'validation',\n                        value: value,\n                        range: self,\n                        ref: self._ref\n                    });\n                }\n                return self;\n            },\n            _get: function (name) {\n                return this._sheet._get(this._ref.toRangeRef(), name);\n            },\n            _property: function (name, value) {\n                if (value === undefined) {\n                    return this._get(name);\n                } else {\n                    return this._set(name, value);\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this._set('formula', null, true);\n                }\n                return this._property('value', value);\n            },\n            resize: function (direction) {\n                var ref = this._resizedRef(direction);\n                return new Range(ref, this._sheet);\n            },\n            _resizedRef: function (direction) {\n                return this._ref.map(function (ref) {\n                    return ref.toRangeRef().resize(direction);\n                });\n            },\n            _border: function (property, value) {\n                var result;\n                var complement = borders[property].complement;\n                var direction = borders[property].direction;\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    result = this._property(property, value);\n                    if (value !== undefined) {\n                        this._resizedRef(direction).forEach(function (ref) {\n                            if (ref !== kendo.spreadsheet.NULLREF) {\n                                new Range(ref, sheet)._property(complement, null);\n                            }\n                        });\n                    }\n                }.bind(this), {});\n                return result;\n            },\n            _collapsedBorder: function (property) {\n                var result = this._property(property);\n                var complement = borders[property].complement;\n                var direction = borders[property].direction;\n                this._resizedRef(direction).forEach(function (ref) {\n                    if (!result && ref !== kendo.spreadsheet.NULLREF) {\n                        var range = new Range(ref, this._sheet);\n                        result = range._property(complement);\n                    }\n                }.bind(this));\n                return result;\n            },\n            borderTop: function (value) {\n                return this._border('borderTop', value);\n            },\n            borderRight: function (value) {\n                return this._border('borderRight', value);\n            },\n            borderBottom: function (value) {\n                return this._border('borderBottom', value);\n            },\n            borderLeft: function (value) {\n                return this._border('borderLeft', value);\n            },\n            collapsedBorderTop: function () {\n                return this._collapsedBorder('borderTop');\n            },\n            collapsedBorderRight: function () {\n                return this._collapsedBorder('borderRight');\n            },\n            collapsedBorderBottom: function () {\n                return this._collapsedBorder('borderBottom');\n            },\n            collapsedBorderLeft: function () {\n                return this._collapsedBorder('borderLeft');\n            },\n            input: function (value) {\n                var existingFormat = this._get('format'), x;\n                if (value !== undefined) {\n                    var tl = this._ref.toRangeRef().topLeft;\n                    x = kendo.spreadsheet.calc.parse(this._sheet.name(), tl.row, tl.col, value);\n                    this._sheet.batch(function () {\n                        var formula = null;\n                        if (x.type == 'exp') {\n                            formula = kendo.spreadsheet.calc.compile(x);\n                        } else if (existingFormat != '@') {\n                            var existingFormatType = existingFormat && kendo.spreadsheet.formatting.type(x.value, existingFormat);\n                            if (x.type == 'date' && existingFormatType != 'date') {\n                                this.format(x.format || toExcelFormat(kendo.culture().calendar.patterns.d));\n                            } else if (x.type == 'percent' && existingFormatType != 'percent') {\n                                this.format(x.value * 100 == (x.value * 100 | 0) ? '0%' : '0.00%');\n                            } else if (x.format && !existingFormat) {\n                                this.format(x.format);\n                            }\n                        } else if (x.type != 'string') {\n                            x.value = value;\n                        }\n                        this.formula(formula);\n                        if (!formula) {\n                            this.value(x.value);\n                        }\n                    }.bind(this), {\n                        recalc: true,\n                        value: value,\n                        ref: this._ref,\n                        editorChange: this._sheet.isInEditMode()\n                    });\n                    return this;\n                } else {\n                    value = this._get('value');\n                    var formula = this._get('formula');\n                    var type = existingFormat && !formula && kendo.spreadsheet.formatting.type(value, existingFormat);\n                    if (formula) {\n                        value = '=' + formula;\n                    } else\n                        OUT: {\n                            if (existingFormat && type == 'date') {\n                                var t1 = kendo.spreadsheet.formatting.text(value, existingFormat);\n                                x = kendo.spreadsheet.calc.parse(null, null, null, t1);\n                                if (typeof x.value == 'number') {\n                                    var t2 = kendo.spreadsheet.formatting.text(x.value, existingFormat);\n                                    if (t1 == t2) {\n                                        value = t1;\n                                        break OUT;\n                                    }\n                                }\n                            }\n                            if (type === 'date') {\n                                value = kendo.toString(kendo.spreadsheet.numberToDate(value), kendo.culture().calendar.patterns.d);\n                            } else if (type === 'percent') {\n                                value = value * 100 + '%';\n                            } else if (typeof value == 'string' && (/^[=']/.test(value) || /^(?:true|false)$/i.test(value) || looksLikeANumber(value))) {\n                                value = '\\'' + value;\n                            }\n                        }\n                    return value;\n                }\n            },\n            enable: function (value) {\n                if (value === undefined) {\n                    value = true;\n                    this._sheet.forEach(this._ref.toRangeRef(), function (_, __, data) {\n                        if (data.enable === false) {\n                            value = false;\n                        }\n                    });\n                    return value;\n                }\n                return this._property('enable', value);\n            },\n            formula: function (value) {\n                if (value === undefined) {\n                    var f = this._get('formula');\n                    return f ? '' + f : null;\n                }\n                return this._property('formula', value);\n            },\n            validation: function (value) {\n                if (value === undefined) {\n                    var f = this._get('validation');\n                    return f ? f.toJSON() : null;\n                }\n                return this._property('validation', value);\n            },\n            _getValidationState: function () {\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                    for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                        var validation = this._sheet._validation(ri, ci);\n                        if (validation && validation.type === 'reject' && validation.value === false) {\n                            return validation;\n                        }\n                    }\n                }\n                return false;\n            },\n            merge: function () {\n                this._ref = this._sheet._merge(this._ref);\n                return this;\n            },\n            unmerge: function () {\n                var mergedCells = this._sheet._mergedCells;\n                this._ref.forEach(function (ref) {\n                    ref.toRangeRef().intersecting(mergedCells).forEach(function (mergedRef) {\n                        mergedCells.splice(mergedCells.indexOf(mergedRef), 1);\n                    });\n                });\n                this._sheet.triggerChange({});\n                return this;\n            },\n            select: function () {\n                this._sheet.select(this._ref);\n                return this;\n            },\n            values: function (values) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (values !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                if (values === undefined) {\n                    values = new Array(ref.height());\n                    for (var vi = 0; vi < values.length; vi++) {\n                        values[vi] = new Array(ref.width());\n                    }\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            values[ri - topLeftRow][ci - topLeftCol] = this._sheet._value(ri, ci);\n                        }\n                    }\n                    return values;\n                } else {\n                    this._sheet._set(ref, 'formula', null);\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = values[ri - topLeftRow];\n                            if (row) {\n                                var value = row[ci - topLeftCol];\n                                if (value !== undefined) {\n                                    this._sheet._value(ri, ci, value);\n                                }\n                            }\n                        }\n                    }\n                    this._sheet.triggerChange({\n                        recalc: true,\n                        ref: ref\n                    });\n                    return this;\n                }\n            },\n            _properties: function (props) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (props !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                var sheet = this._sheet;\n                if (props === undefined) {\n                    props = new Array(ref.height());\n                    sheet.forEach(ref, function (row, col, data) {\n                        row -= topLeftRow;\n                        col -= topLeftCol;\n                        var line = props[row] || (props[row] = []);\n                        line[col] = data;\n                    });\n                    return props;\n                } else {\n                    var data;\n                    ref = ref.clone();\n                    var setProp = function (propName) {\n                        var propValue = data[propName];\n                        ref.topLeft.row = ref.bottomRight.row = ri;\n                        ref.topLeft.col = ref.bottomRight.col = ci;\n                        if (propName == 'value') {\n                            sheet._set(ref, 'formula', null);\n                        }\n                        sheet._set(ref, propName, propValue);\n                    };\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = props[ri - topLeftRow];\n                            if (row) {\n                                data = row[ci - topLeftCol];\n                                if (data) {\n                                    Object.keys(data).forEach(setProp);\n                                }\n                            }\n                        }\n                    }\n                    sheet.triggerChange({\n                        recalc: true,\n                        ref: this._ref\n                    });\n                    return this;\n                }\n            },\n            clear: function (options) {\n                var clearAll = !options || !Object.keys(options).length;\n                var sheet = this._sheet;\n                var reason = {\n                    recalc: clearAll || options && options.contentsOnly === true,\n                    ref: this._ref\n                };\n                sheet.batch(function () {\n                    if (reason.recalc) {\n                        this.formula(null);\n                    }\n                    if (clearAll) {\n                        this.validation(null);\n                    }\n                    if (clearAll || options && options.formatOnly === true) {\n                        PROPERTIES.forEach(function (x) {\n                            this[x](null);\n                        }.bind(this));\n                        this.unmerge();\n                    }\n                }.bind(this), reason);\n                return this;\n            },\n            clearContent: function () {\n                return this.clear({ contentsOnly: true });\n            },\n            clearFormat: function () {\n                return this.clear({ formatOnly: true });\n            },\n            isSortable: function () {\n                return !this.cantSort();\n            },\n            cantSort: function () {\n                if (this._ref instanceof UnionRef) {\n                    return {\n                        code: 'cantSortMultipleSelection',\n                        message: 'Unsupported for multiple ranges.'\n                    };\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    return {\n                        code: 'cantSortNullRef',\n                        message: 'Unsupported for NULLREF.'\n                    };\n                }\n                var mc = this._sheet._getMergedCells(this._ref.toRangeRef());\n                var primary = mc.primary;\n                var secondary = mc.secondary;\n                var width = null, height = null;\n                var cant = {};\n                try {\n                    this._sheet.forEach(this, function (row, col) {\n                        var id = new CellRef(row, col).print();\n                        var merged = primary[id];\n                        if (merged) {\n                            if (width === null) {\n                                width = merged.width();\n                                height = merged.height();\n                            } else if (!(width == merged.width() && height == merged.height())) {\n                                throw cant;\n                            }\n                        } else if (!secondary[id] && mc.hasMerged) {\n                            throw cant;\n                        }\n                    });\n                } catch (ex) {\n                    if (ex !== cant) {\n                        throw ex;\n                    }\n                    return {\n                        code: 'cantSortMixedCells',\n                        message: 'Unsupported for range containing cells of different shapes.'\n                    };\n                }\n                return false;\n            },\n            sort: function (spec) {\n                var reason = this.cantSort();\n                if (reason) {\n                    throw new Error(reason.message);\n                }\n                if (spec === undefined) {\n                    spec = { column: 0 };\n                }\n                spec = spec instanceof Array ? spec : [spec];\n                this._sheet._sortBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                    if (typeof spec === 'number') {\n                        spec = { column: spec };\n                    }\n                    return {\n                        index: spec.column === undefined ? index : spec.column,\n                        ascending: spec.ascending === undefined ? true : spec.ascending\n                    };\n                }));\n                return this;\n            },\n            isFilterable: function () {\n                return !(this._ref instanceof UnionRef);\n            },\n            filter: function (spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (spec === false) {\n                    this.clearFilters();\n                } else {\n                    spec = spec === true ? [] : spec instanceof Array ? spec : [spec];\n                    this._sheet._filterBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                        return {\n                            index: spec.column === undefined ? index : spec.column,\n                            filter: spec.filter\n                        };\n                    }));\n                }\n                return this;\n            },\n            clearFilter: function (spec) {\n                this._sheet.clearFilter(spec);\n            },\n            clearFilters: function () {\n                var filter = this._sheet.filter();\n                var spec = [];\n                if (filter) {\n                    for (var i = 0; i < filter.columns.length; i++) {\n                        spec.push(i);\n                    }\n                    this._sheet.batch(function () {\n                        this.clearFilter(spec);\n                        this._filter = null;\n                    }, {\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            hasFilter: function () {\n                var filter = this._sheet.filter();\n                return !!filter;\n            },\n            leftColumn: function () {\n                return new Range(this._ref.leftColumn(), this._sheet);\n            },\n            rightColumn: function () {\n                return new Range(this._ref.rightColumn(), this._sheet);\n            },\n            topRow: function () {\n                return new Range(this._ref.topRow(), this._sheet);\n            },\n            bottomRow: function () {\n                return new Range(this._ref.bottomRow(), this._sheet);\n            },\n            column: function (column) {\n                return new Range(this._ref.toColumn(column), this._sheet);\n            },\n            row: function (row) {\n                return new Range(this._ref.toRow(row), this._sheet);\n            },\n            forEachRow: function (callback) {\n                this._ref.forEachRow(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            forEachColumn: function (callback) {\n                this._ref.forEachColumn(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            sheet: function () {\n                return this._sheet;\n            },\n            topLeft: function () {\n                return this._ref.toRangeRef().topLeft;\n            },\n            intersectingMerged: function () {\n                var sheet = this._sheet;\n                var mergedCells = [];\n                sheet._mergedCells.forEach(function (ref) {\n                    if (ref.intersects(this._ref)) {\n                        mergedCells.push(ref.toString());\n                    }\n                }.bind(this));\n                return mergedCells;\n            },\n            getState: function (propertyName) {\n                var topLeft = this._ref.first();\n                var state = {\n                    ref: topLeft,\n                    data: [],\n                    origRef: this._ref\n                };\n                var properties;\n                if (!propertyName) {\n                    properties = kendo.spreadsheet.ALL_PROPERTIES;\n                    state.mergedCells = this.intersectingMerged();\n                } else if (propertyName === 'input') {\n                    properties = [\n                        'value',\n                        'formula'\n                    ];\n                } else if (propertyName === 'border') {\n                    properties = [\n                        'borderLeft',\n                        'borderTop',\n                        'borderRight',\n                        'borderBottom'\n                    ];\n                } else {\n                    properties = [propertyName];\n                }\n                var data = state.data;\n                this.forEachCell(function (row, col, cell) {\n                    var cellState = {};\n                    var dr = row - topLeft.row;\n                    var dc = col - topLeft.col;\n                    if (!data[dr]) {\n                        data[dr] = [];\n                    }\n                    data[dr][dc] = cellState;\n                    properties.forEach(function (property) {\n                        cellState[property] = typeof cell[property] == 'undefined' ? null : cell[property];\n                    });\n                });\n                return state;\n            },\n            setState: function (state, clipboard) {\n                var sheet = this._sheet;\n                var origin = this._ref.first();\n                var rowDelta = state.ref.row - origin.row;\n                var colDelta = state.ref.col - origin.col;\n                sheet.batch(function () {\n                    if (state.mergedCells) {\n                        this.unmerge();\n                    }\n                    var row = origin.row;\n                    state.data.forEach(function (data, dr) {\n                        if (clipboard && !clipboard.isExternal() && sheet.isHiddenRow(state.ref.row + dr)) {\n                            return;\n                        }\n                        var col = origin.col;\n                        data.forEach(function (cellState, dc) {\n                            if (clipboard && !clipboard.isExternal() && sheet.isHiddenColumn(state.ref.col + dc)) {\n                                return;\n                            }\n                            var range = clipboard ? sheet.range(row, col) : sheet.range(origin.row + dr, origin.col + dc);\n                            if (range.enable()) {\n                                for (var property in cellState) {\n                                    if (property != 'value') {\n                                        if (!(clipboard && property == 'enable')) {\n                                            range._set(property, cellState[property]);\n                                        }\n                                    }\n                                }\n                                if (!cellState.formula) {\n                                    if (clipboard && clipboard.isExternal()) {\n                                        try {\n                                            if (cellState.value == null) {\n                                                range._set('value', null);\n                                            } else {\n                                                range.input(cellState.value);\n                                            }\n                                        } catch (ex) {\n                                            range._set('value', cellState.value);\n                                        }\n                                    } else {\n                                        range._set('value', cellState.value);\n                                    }\n                                }\n                            }\n                            col++;\n                        });\n                        row++;\n                    });\n                    if (state.mergedCells) {\n                        state.mergedCells.forEach(function (merged) {\n                            merged = sheet._ref(merged).relative(rowDelta, colDelta, 3);\n                            sheet.range(merged).merge();\n                        }, this);\n                    }\n                }.bind(this), { recalc: true });\n            },\n            _adjustRowHeight: function () {\n                var sheet = this._sheet;\n                var state = this.getState();\n                var mergedCells = [];\n                for (var i = 0; i < state.mergedCells.length; i++) {\n                    mergedCells.push(sheet.range(state.mergedCells[i]));\n                }\n                this.forEachRow(function (row) {\n                    if (row.topLeft().row >= row.sheet()._rows._count) {\n                        return;\n                    }\n                    var maxHeight = row.sheet().rowHeight(row.topLeft().row);\n                    row.forEachCell(function (rowIndex, colIndex, cell) {\n                        var cellRange = sheet.range(rowIndex, colIndex);\n                        var totalWidth = 0;\n                        for (var i = 0; i < mergedCells.length; i++) {\n                            if (cellRange._ref.intersects(mergedCells[i]._ref)) {\n                                totalWidth += cell.width;\n                                break;\n                            }\n                        }\n                        var width = Math.max(sheet.columnWidth(colIndex), totalWidth);\n                        maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, cell.fontSize, cell.wrap));\n                    });\n                    sheet.rowHeight(row.topLeft().row, Math.max(sheet.rowHeight(row.topLeft().row), maxHeight));\n                });\n            },\n            forEachCell: function (callback) {\n                this._ref.forEach(function (ref) {\n                    this._sheet.forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            },\n            hasValue: function () {\n                var yesItHas = {};\n                var defStyle = this._sheet._defaultCellStyle;\n                try {\n                    this.forEachCell(function (row, col, cell) {\n                        for (var key in cell) {\n                            var val = cell[key];\n                            if (val !== undefined && val !== defStyle[key]) {\n                                throw yesItHas;\n                            }\n                        }\n                    });\n                } catch (ex) {\n                    if (ex === yesItHas) {\n                        return true;\n                    } else {\n                        throw ex;\n                    }\n                }\n                return false;\n            },\n            wrap: function (flag) {\n                if (flag === undefined) {\n                    return !!this._property('wrap');\n                }\n                this.forEachRow(function (range) {\n                    var maxHeight = range.sheet().rowHeight(range.topLeft().row);\n                    range.forEachCell(function (row, col, cell) {\n                        var width = this._sheet.columnWidth(col);\n                        if (cell.value !== null && cell.value !== undefined) {\n                            maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, cell.fontSize, true));\n                        }\n                    });\n                    range.sheet().rowHeight(range.topLeft().row, maxHeight);\n                }.bind(this));\n                this._property('wrap', flag);\n                return this;\n            },\n            fontSize: function (size) {\n                if (size === undefined) {\n                    return this._property('fontSize');\n                }\n                this.forEachRow(function (range) {\n                    var maxHeight = range.sheet().rowHeight(range.topLeft().row);\n                    range.forEachCell(function (row, col, cell) {\n                        var width = this._sheet.columnWidth(col);\n                        if (cell.value !== null && cell.value !== undefined) {\n                            maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, size, cell.wrap));\n                        }\n                    });\n                    range.sheet().rowHeight(range.topLeft().row, maxHeight);\n                }.bind(this));\n                this._property('fontSize', size);\n                return this;\n            },\n            draw: function (options, callback) {\n                this._sheet.draw(this, options, callback);\n            }\n        });\n        function partition(begin, end, predicate) {\n            while (begin <= end && predicate(begin)) {\n                begin++;\n            }\n            if (begin > end) {\n                return [];\n            }\n            for (var i = begin + 1; i <= end; ++i) {\n                if (predicate(i)) {\n                    return [{\n                            begin: begin,\n                            end: i - 1\n                        }].concat(partition(i + 1, end, predicate));\n                }\n            }\n            return [{\n                    begin: begin,\n                    end: end\n                }];\n        }\n        $.each(PROPERTIES, function (i, property) {\n            Range.prototype[property] = function (value) {\n                return this._property(property, value);\n            };\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        function looksLikeANumber(str) {\n            return !/^=/.test(str) && /number|percent/.test(kendo.spreadsheet.calc.parse(null, 0, 0, str).type);\n        }\n        var measureBox = $('<div style=\"position: absolute !important; top: -4000px !important; height: auto !important;' + 'padding: 1px !important; margin: 0 !important; border: 1px solid black !important;' + 'line-height: normal !important; visibility: hidden !important;' + 'white-space: pre-wrap; word-break: break-all;\" />')[0];\n        function getTextHeight(text, width, fontSize, wrap) {\n            var styles = {\n                'baselineMarkerSize': 0,\n                'width': wrap === true ? width + 'px' : 'auto',\n                'font-size': (fontSize || 12) + 'px',\n                'word-break': wrap === true ? 'break-all' : 'normal',\n                'white-space': wrap === true ? 'pre-wrap' : 'pre'\n            };\n            return kendo.util.measureText(text, styles, measureBox).height;\n        }\n        kendo.spreadsheet.util = { getTextHeight: getTextHeight };\n        kendo.spreadsheet.Range = Range;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime', ['spreadsheet/references'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var calc = {};\n    var spreadsheet = kendo.spreadsheet;\n    spreadsheet.calc = calc;\n    var exports = calc.runtime = {};\n    var Class = kendo.Class;\n    var Ref = spreadsheet.Ref;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NULL = spreadsheet.NULLREF;\n    function CalcError(code) {\n        if (code instanceof CalcError) {\n            return code;\n        }\n        this.code = code;\n    }\n    CalcError.prototype.toString = function () {\n        return '#' + this.code + (this.code == 'NAME' ? '?' : '!');\n    };\n    var Context = Class.extend({\n        init: function Context(callback, formula, ss, parent) {\n            this.callback = callback;\n            this.formula = formula;\n            this.ss = ss;\n            this.parent = parent;\n        },\n        resolve: function (val) {\n            var self = this;\n            if (val instanceof Ref) {\n                self.resolveCells([val], function () {\n                    self._resolve(val);\n                });\n            } else {\n                self._resolve(val);\n            }\n        },\n        error: function (val) {\n            return new CalcError(val);\n        },\n        _resolve: function (val) {\n            if (val === undefined) {\n                val = null;\n            } else if (Array.isArray(val)) {\n                val = this.asMatrix(val);\n            } else {\n                val = maybeRoundFloatErrors(val);\n            }\n            var f = this.formula;\n            f.value = val;\n            if (this.ss.onFormula(f) && this.callback) {\n                this.callback.call(f, val);\n            }\n        },\n        resolveCells: function (a, f) {\n            var context = this, formulas = [];\n            (function loop(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var x = a[i];\n                    if (x instanceof Ref) {\n                        add(context.getRefCells(x));\n                    }\n                    if (Array.isArray(x)) {\n                        loop(x);\n                    }\n                }\n            }(a));\n            if (!formulas.length) {\n                return f.call(context);\n            }\n            for (var pending = formulas.length, i = 0; i < formulas.length; ++i) {\n                fetch(formulas[i]);\n            }\n            function fetch(formula) {\n                formula.exec(context.ss, function () {\n                    if (!--pending) {\n                        f.call(context);\n                    }\n                }, context);\n            }\n            function add(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var cell = a[i];\n                    if (cell.formula) {\n                        formulas.push(cell.formula);\n                    }\n                }\n                return true;\n            }\n        },\n        cellValues: function (a, f) {\n            var ret = [];\n            for (var i = 0; i < a.length; ++i) {\n                var val = a[i];\n                if (val instanceof Ref) {\n                    val = this.getRefData(val);\n                    ret = ret.concat(val);\n                } else if (Array.isArray(val)) {\n                    ret = ret.concat(this.cellValues(val));\n                } else if (val instanceof Matrix) {\n                    ret = ret.concat(this.cellValues(val.data));\n                } else {\n                    ret.push(val);\n                }\n            }\n            if (f) {\n                return f.apply(this, ret);\n            }\n            return ret;\n        },\n        fetchName: function (ref, callback) {\n            var f = this.formula;\n            var val = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n            if (val instanceof Formula) {\n                val = val.clone(f.sheet, f.row, f.col, true);\n                var ss = new spreadsheet.ValidationFormulaContext(this.ss.workbook);\n                val.exec(ss, callback, this);\n            } else {\n                if (val instanceof Ref) {\n                    val = val.absolute(f.row, f.col);\n                    if (!val.sheet) {\n                        val.sheet = f.sheet;\n                    }\n                }\n                callback(val == null ? new CalcError('NAME') : val);\n            }\n        },\n        force: function (val) {\n            if (val instanceof Ref) {\n                return this.getRefData(val);\n            }\n            return val;\n        },\n        func: function (fname, callback, args) {\n            fname = fname.toLowerCase();\n            var f = FUNCS[fname];\n            if (f) {\n                return f.call(this, callback, args);\n            }\n            callback(new CalcError('NAME'));\n        },\n        bool: function (val) {\n            if (val instanceof Ref) {\n                val = this.getRefData(val);\n            }\n            if (typeof val == 'string') {\n                return val.toLowerCase() == 'true';\n            }\n            if (typeof val == 'number') {\n                return val !== 0;\n            }\n            if (typeof val == 'boolean') {\n                return val;\n            }\n            return val != null;\n        },\n        asMatrix: function (range) {\n            if (range instanceof Matrix) {\n                return range;\n            }\n            var self = this;\n            if (range instanceof RangeRef) {\n                var tl = range.topLeft;\n                var top = tl.row, left = tl.col;\n                var cells = self.getRefCells(range);\n                var m = new Matrix(self);\n                if (isFinite(range.width())) {\n                    m.width = range.width();\n                }\n                if (isFinite(range.height())) {\n                    m.height = range.height();\n                }\n                if (!isFinite(top)) {\n                    top = 0;\n                }\n                if (!isFinite(left)) {\n                    left = 0;\n                }\n                cells.forEach(function (cell) {\n                    m.set(cell.row - top, cell.col - left, cell.value);\n                });\n                return m;\n            }\n            if (Array.isArray(range) && range.length > 0) {\n                var m = new Matrix(self), row = 0;\n                range.forEach(function (line) {\n                    var col = 0;\n                    var h = 1;\n                    line.forEach(function (el) {\n                        var isRange = el instanceof RangeRef;\n                        if (el instanceof Ref && !isRange) {\n                            el = self.getRefData(el);\n                        }\n                        if (isRange || Array.isArray(el)) {\n                            el = self.asMatrix(el);\n                        }\n                        if (el instanceof Matrix) {\n                            el.each(function (el, r, c) {\n                                m.set(row + r, col + c, el);\n                            });\n                            h = Math.max(h, el.height);\n                            col += el.width;\n                        } else {\n                            m.set(row, col++, el);\n                        }\n                    });\n                    row += h;\n                });\n                return m;\n            }\n        },\n        getRefCells: function (refs, hiddenInfo) {\n            var f = this.formula;\n            return this.ss.getRefCells(refs, hiddenInfo, f.sheet, f.row, f.col);\n        },\n        getRefData: function (ref) {\n            var f = this.formula;\n            return this.ss.getData(ref, f.sheet, f.row, f.col);\n        },\n        workbook: function () {\n            return this.ss.workbook;\n        }\n    });\n    var Matrix = Class.extend({\n        init: function Matrix(context) {\n            this.context = context;\n            this.height = 0;\n            this.width = 0;\n            this.data = [];\n        },\n        clone: function () {\n            var m = new Matrix(this.context);\n            m.height = this.height;\n            m.width = this.width;\n            m.data = this.data.map(function (row) {\n                return row.slice();\n            });\n            return m;\n        },\n        get: function (row, col) {\n            var line = this.data[row];\n            var val = line ? line[col] : null;\n            return val instanceof Ref ? this.context.getRefData(val) : val;\n        },\n        set: function (row, col, data) {\n            var line = this.data[row];\n            if (line == null) {\n                line = this.data[row] = [];\n            }\n            line[col] = data;\n            if (row >= this.height) {\n                this.height = row + 1;\n            }\n            if (col >= this.width) {\n                this.width = col + 1;\n            }\n        },\n        each: function (f, includeEmpty) {\n            for (var row = 0; row < this.height; ++row) {\n                for (var col = 0; col < this.width; ++col) {\n                    var val = this.get(row, col);\n                    if (includeEmpty || val != null) {\n                        val = f.call(this.context, val, row, col);\n                        if (val !== undefined) {\n                            return val;\n                        }\n                    }\n                }\n            }\n        },\n        map: function (f, includeEmpty) {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(row, col, f.call(this, el, row, col));\n            }, includeEmpty);\n            return m;\n        },\n        eachRow: function (f) {\n            for (var row = 0; row < this.height; ++row) {\n                var val = f.call(this.context, row);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        eachCol: function (f) {\n            for (var col = 0; col < this.width; ++col) {\n                var val = f.call(this.context, col);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        mapRow: function (f) {\n            var m = new Matrix(this.context);\n            this.eachRow(function (row) {\n                m.set(row, 0, f.call(this.context, row));\n            });\n            return m;\n        },\n        mapCol: function (f) {\n            var m = new Matrix(this.context);\n            this.eachCol(function (col) {\n                m.set(0, col, f.call(this.context, col));\n            });\n            return m;\n        },\n        toString: function () {\n            return JSON.stringify(this.data);\n        },\n        transpose: function () {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(col, row, el);\n            });\n            return m;\n        },\n        unit: function (n) {\n            this.width = this.height = n;\n            var a = this.data = new Array(n);\n            for (var i = n; --i >= 0;) {\n                var row = a[i] = new Array(n);\n                for (var j = n; --j >= 0;) {\n                    row[j] = i == j ? 1 : 0;\n                }\n            }\n            return this;\n        },\n        multiply: function (b) {\n            var a = this, m = new Matrix(a.context);\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < b.width; ++col) {\n                    var s = 0;\n                    for (var i = 0; i < a.width; ++i) {\n                        var va = a.get(row, i);\n                        var vb = b.get(i, col);\n                        if (typeof va != 'number' || typeof vb != 'number') {\n                            throw new CalcError('VALUE');\n                        }\n                        s += va * vb;\n                    }\n                    m.set(row, col, s);\n                }\n            }\n            return m;\n        },\n        adds: function (b, s) {\n            var a = this, m = new Matrix(a.context);\n            var sign = s ? -1 : 1;\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < a.width; ++col) {\n                    var x = a.get(row, col), y = b.get(row, col);\n                    m.set(row, col, x + sign * y);\n                }\n            }\n            return m;\n        },\n        determinant: function () {\n            var a = this.clone().data;\n            var n = a.length;\n            var d = 1, C, L, i, k;\n            for (C = 0; C < n; C++) {\n                for (L = C; L < n && !a[L][C]; L++) {\n                }\n                if (L == n) {\n                    return 0;\n                }\n                if (L != C) {\n                    d = -d;\n                    for (k = C; k < n; k++) {\n                        var t = a[C][k];\n                        a[C][k] = a[L][k];\n                        a[L][k] = t;\n                    }\n                }\n                for (i = C + 1; i < n; i++) {\n                    for (k = C + 1; k < n; k++) {\n                        a[i][k] -= a[C][k] * a[i][C] / a[C][C];\n                    }\n                }\n                d *= a[C][C];\n            }\n            return d;\n        },\n        inverse: function () {\n            var n = this.width;\n            var m = this.augment(new Matrix(this.context).unit(n));\n            var a = m.data;\n            var tmp;\n            for (var k = 0; k < n; ++k) {\n                var imax = argmax(k, n, function (i) {\n                    return a[i][k];\n                });\n                if (!a[imax][k]) {\n                    return null;\n                }\n                if (k != imax) {\n                    tmp = a[k];\n                    a[k] = a[imax];\n                    a[imax] = tmp;\n                }\n                for (var i = k + 1; i < n; ++i) {\n                    for (var j = k + 1; j < 2 * n; ++j) {\n                        a[i][j] -= a[k][j] * a[i][k] / a[k][k];\n                    }\n                    a[i][k] = 0;\n                }\n            }\n            for (var i = 0; i < n; ++i) {\n                for (var f = a[i][i], j = 0; j < 2 * n; ++j) {\n                    a[i][j] /= f;\n                }\n            }\n            for (var k = n; --k >= 0;) {\n                for (var i = k; --i >= 0;) {\n                    if (a[i][k]) {\n                        for (var j = 2 * n; --j >= n;) {\n                            a[i][j] -= a[k][j] * a[i][k];\n                        }\n                    }\n                }\n            }\n            return m.slice(0, n, n, n);\n        },\n        augment: function (m) {\n            var ret = this.clone(), n = ret.width;\n            m.each(function (val, row, col) {\n                ret.set(row, col + n, val);\n            });\n            return ret;\n        },\n        slice: function (row, col, height, width) {\n            var m = new Matrix(this.context);\n            for (var i = 0; i < height; ++i) {\n                for (var j = 0; j < width; ++j) {\n                    m.set(i, j, this.get(row + i, col + j));\n                }\n            }\n            return m;\n        }\n    });\n    function argmax(i, end, f) {\n        var max = f(i), pos = i;\n        while (++i < end) {\n            var v = f(i);\n            if (v > max) {\n                max = v;\n                pos = i;\n            }\n        }\n        return pos;\n    }\n    var Formula = Class.extend({\n        init: function Formula(refs, handler, printer, sheet, row, col) {\n            this.refs = refs;\n            this.handler = handler;\n            this.print = printer;\n            this.absrefs = null;\n            this.sheet = sheet;\n            this.row = row;\n            this.col = col;\n            this.onReady = [];\n            this.pending = false;\n        },\n        clone: function (sheet, row, col, forceRefs) {\n            var lcsheet = sheet.toLowerCase();\n            var refs = this.refs;\n            if (forceRefs || lcsheet != this.sheet.toLowerCase()) {\n                refs = refs.map(function (ref) {\n                    if (!ref.hasSheet() && (!ref.sheet || ref.sheet.toLowerCase() != lcsheet)) {\n                        ref = ref.clone().setSheet(sheet);\n                    }\n                    return ref;\n                });\n            }\n            return new Formula(refs, this.handler, this.print, sheet, row, col);\n        },\n        resolve: function (val) {\n            this.pending = false;\n            this.onReady.forEach(function (callback) {\n                callback(val);\n            });\n        },\n        exec: function (ss, callback, parentContext) {\n            if ('value' in this) {\n                if (callback) {\n                    callback(this.value);\n                }\n            } else {\n                if (callback) {\n                    this.onReady.push(callback);\n                }\n                var ctx = new Context(this.resolve, this, ss, parentContext);\n                var level = 0;\n                while (parentContext) {\n                    if (parentContext.formula === this) {\n                        this.pending = false;\n                        ctx.resolve(new CalcError('CIRCULAR'));\n                        return;\n                    }\n                    parentContext = parentContext.parent;\n                    ++level;\n                }\n                if (this.pending) {\n                    return;\n                }\n                this.pending = true;\n                var next = function () {\n                    if (!this.absrefs) {\n                        this.absrefs = this.refs.map(function (ref) {\n                            return ref.absolute(this.row, this.col);\n                        }, this);\n                    }\n                    this.handler.call(ctx);\n                }.bind(this);\n                if (level < 20) {\n                    next();\n                } else {\n                    setTimeout(next, 0);\n                }\n            }\n        },\n        reset: function () {\n            this.onReady = [];\n            this.pending = false;\n            delete this.value;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            oldSheetName = oldSheetName.toLowerCase();\n            this.absrefs = null;\n            if (this.sheet.toLowerCase() == oldSheetName) {\n                this.sheet = newSheetName;\n            }\n            this.refs.forEach(function (ref) {\n                ref.renameSheet(oldSheetName, newSheetName);\n            });\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            affectedSheet = affectedSheet.toLowerCase();\n            var formulaRow = this.row;\n            var formulaCol = this.col;\n            var formulaSheet = this.sheet.toLowerCase();\n            var formulaMoves = false;\n            if (formulaSheet == affectedSheet) {\n                if (operation == 'row' && formulaRow >= start) {\n                    this.row += delta;\n                    formulaMoves = true;\n                }\n                if (operation == 'col' && formulaCol >= start) {\n                    this.col += delta;\n                    formulaMoves = true;\n                }\n            }\n            var newFormulaRow = this.row;\n            var newFormulaCol = this.col;\n            this.absrefs = null;\n            this.refs = this.refs.map(function (ref) {\n                if (ref === NULL) {\n                    return ref;\n                }\n                if (ref.sheet.toLowerCase() != affectedSheet) {\n                    if (formulaMoves) {\n                        if (operation == 'row' && formulaRow >= start) {\n                            ref = ref.relative(delta, 0);\n                        }\n                        if (operation == 'col' && formulaCol >= start) {\n                            ref = ref.relative(0, delta);\n                        }\n                    }\n                    return ref;\n                }\n                return ref.adjust(formulaRow, formulaCol, newFormulaRow, newFormulaCol, operation == 'row', start, delta);\n            }, this);\n        },\n        toString: function () {\n            return this.print(this.row, this.col);\n        }\n    });\n    var FUNCS = Object.create(null);\n    FUNCS['if'] = function (callback, args) {\n        var self = this;\n        var co = args[0], th = args[1], el = args[2];\n        this.resolveCells([co], function () {\n            var comatrix = self.asMatrix(co);\n            if (comatrix) {\n                th(function (th) {\n                    el(function (el) {\n                        var thmatrix = self.asMatrix(th);\n                        var elmatrix = self.asMatrix(el);\n                        callback(comatrix.map(function (val, row, col) {\n                            if (val instanceof CalcError) {\n                                return val;\n                            } else if (self.bool(val)) {\n                                return thmatrix ? thmatrix.get(row, col) : th;\n                            } else {\n                                return elmatrix ? elmatrix.get(row, col) : el;\n                            }\n                        }));\n                    });\n                });\n            } else {\n                co = this.force(co);\n                if (co instanceof CalcError) {\n                    callback(co);\n                } else if (self.bool(co)) {\n                    th(callback);\n                } else {\n                    el(callback);\n                }\n            }\n        });\n    };\n    FUNCS[''] = function (callback) {\n        callback((1 + Math.sqrt(5)) / 2);\n    };\n    function compileArgumentChecks(functionName, args) {\n        var arrayArgs = 'function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; ';\n        var resolve = 'function resolve(args, callback) { var toResolve = [], i = 0; ';\n        var name, forced, main = '\\'use strict\\'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = \\'VALUE\\'; ', haveForced = false;\n        var canBeArrayArg = false, hasArrayArgs = false;\n        main += args.map(comp).join('');\n        main += 'if (i < args.length) return new CalcError(\\'N/A\\'); ';\n        main += 'return xargs; } ';\n        arrayArgs += 'return { args: xargs, width: width, height: height, arrays: arrays }; } ';\n        var f;\n        if (haveForced) {\n            resolve += 'this.resolveCells(toResolve, callback); } ';\n            f = new Function('CalcError', 'round', main + resolve + arrayArgs + ' return { resolve: resolve, check: check, arrayArgs: arrayArgs };');\n        } else {\n            f = new Function('CalcError', 'round', main + ' return { check: check };');\n        }\n        f = f(CalcError, roundFloatErrors);\n        if (!hasArrayArgs) {\n            delete f.arrayArgs;\n        }\n        return f;\n        function comp(x) {\n            name = x[0];\n            var code = '{ ';\n            if (Array.isArray(name)) {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'while (i < args.length) { ';\n                code += x.map(comp).join('');\n                code += '} ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '+') {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'if (i >= args.length) return new CalcError(\\'N/A\\'); ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'do { ';\n                code += x.slice(1).map(comp).join('');\n                code += '} while (i < args.length); ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '?') {\n                code += 'if (!(' + cond(x[1]) + ')) return new CalcError(err); ';\n            } else {\n                var type = x[1];\n                if (Array.isArray(type) && /^#?collect/.test(type[0])) {\n                    var n = type[2];\n                    force();\n                    code += 'try {' + 'var $' + name + ' = this.cellValues(args.slice(i';\n                    if (n) {\n                        code += ', i + ' + n;\n                    }\n                    code += ')).filter(function($' + name + '){ ';\n                    if (type[0] == 'collect') {\n                        code += 'if ($' + name + ' instanceof CalcError) throw $' + name + '; ';\n                    }\n                    code += 'return ' + cond(type[1]) + '; }, this); ';\n                    if (n) {\n                        code += 'i += ' + n + '; ';\n                    } else {\n                        code += 'i = args.length; ';\n                    }\n                    code += 'xargs.push($' + name + ')' + '} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } ';\n                    resolve += 'toResolve.push(args.slice(i)); ';\n                } else if (type == 'rest') {\n                    code += 'xargs.push(args.slice(i)); i = args.length; ';\n                } else {\n                    if (canBeArrayArg = /^\\*/.test(name)) {\n                        hasArrayArgs = true;\n                        name = name.substr(1);\n                    }\n                    code += 'var $' + name + ' = args[i++]; ';\n                    var allowError = false;\n                    if (/!$/.test(type)) {\n                        type = type.substr(0, type.length - 1);\n                        allowError = true;\n                    } else {\n                        code += 'if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n                    }\n                    code += typeCheck(type, allowError) + 'xargs.push($' + name + '); ';\n                }\n            }\n            code += '} ';\n            return code;\n        }\n        function force() {\n            if (forced) {\n                return '$' + name + '';\n            }\n            haveForced = true;\n            forced = true;\n            resolve += 'toResolve.push(args[i++]); ';\n            return '($' + name + ' = this.force($' + name + '))';\n        }\n        function forceNum(round) {\n            return '(' + (round ? '(typeof ' + force() + ' == \\'number\\' ? ($' + name + ' = round($' + name + '), true) : false) || ' : '(typeof ' + force() + ' == \\'number\\') || ') + '(typeof $' + name + ' == \\'boolean\\') || ' + '(typeof $' + name + ' == \\'string\\' && !/^(?:=|true|false)/i.test($' + name + ') ? (' + 'tmp = kendo.spreadsheet.calc.parse(0, 0, 0, $' + name + '), ' + '/^date|number|percent$/.test(tmp.type) ? ($' + name + ' = +tmp.value, true) : false' + ') : false)' + ')';\n        }\n        function typeCheck(type, allowError) {\n            forced = false;\n            var ret = 'if (!(' + cond(type) + ')) { ';\n            if (forced && !allowError) {\n                ret += ' if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n            }\n            ret += 'return new CalcError(err); } ';\n            if (!forced) {\n                resolve += 'i++; ';\n            }\n            if (canBeArrayArg) {\n                arrayArgs += 'var $' + name + ' = this.asMatrix(args[i]); ' + 'if ($' + name + ') { ' + 'xargs.push($' + name + '); ' + 'width = Math.max(width, $' + name + '.width); ' + 'height = Math.max(height, $' + name + '.height); ' + 'arrays.push(true) } else { ' + 'xargs.push(args[i]); ' + 'arrays.push(false); } i++; ';\n            } else {\n                arrayArgs += 'xargs.push(args[i++]); arrays.push(false); ';\n            }\n            return ret;\n        }\n        function cond(type) {\n            if (Array.isArray(type)) {\n                if (type[0] == 'or') {\n                    return '(' + type.slice(1).map(cond).join(') || (') + ')';\n                }\n                if (type[0] == 'and') {\n                    return '(' + type.slice(1).map(cond).join(') && (') + ')';\n                }\n                if (type[0] == 'values') {\n                    return '(' + type.slice(1).map(function (val) {\n                        return force() + ' === ' + val;\n                    }).join(') || (') + ')';\n                }\n                if (type[0] == 'null') {\n                    return '(' + cond('null') + ' ? (($' + name + ' = ' + type[1] + '), true) : false)';\n                }\n                if (type[0] == 'between' || type[0] == '[between]') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between)') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between]') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '[between)') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == 'assert') {\n                    var err = type[2] || 'N/A';\n                    return '((' + type[1] + ') ? true : (err = ' + JSON.stringify(err) + ', false))';\n                }\n                if (type[0] == 'not') {\n                    return '!(' + cond(type[1]) + ')';\n                }\n                throw new Error('Unknown array type condition: ' + type[0]);\n            }\n            if (type == 'number' || type == 'datetime') {\n                return forceNum(true);\n            }\n            if (type == 'integer' || type == 'date') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0), true))';\n            }\n            if (type == 'divisor') {\n                return '(' + forceNum(true) + ' && ($' + name + ' == 0 ? ((err = \\'DIV/0\\'), false) : true))';\n            }\n            if (type == 'number+') {\n                return '(' + forceNum(true) + ' && ($' + name + ' >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer+') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0) >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'number++') {\n                return '(' + forceNum(true) + ' && ($' + name + ' > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer++') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0) > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'string') {\n                return '((typeof ' + force() + ' == \\'string\\' || typeof $' + name + ' == \\'boolean\\' || typeof $' + name + ' == \\'number\\') ? ($' + name + ' += \\'\\', true) : ($' + name + ' === undefined ? (($' + name + ' = \\'\\'), true) : false))';\n            }\n            if (type == 'boolean') {\n                return '(typeof ' + force() + ' == \\'boolean\\')';\n            }\n            if (type == 'logical') {\n                return '(typeof ' + force() + ' == \\'boolean\\' || (typeof $' + name + ' == \\'number\\' ? ($' + name + ' = !!$' + name + ', true) : false))';\n            }\n            if (type == 'matrix') {\n                force();\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == '#matrix') {\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == 'ref') {\n                return '($' + name + ' instanceof kendo.spreadsheet.Ref)';\n            }\n            if (type == 'area') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef || $' + name + ' instanceof kendo.spreadsheet.RangeRef)';\n            }\n            if (type == 'cell') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef)';\n            }\n            if (type == 'null') {\n                return '(' + force() + ' == null)';\n            }\n            if (type == 'anyvalue') {\n                return '(' + force() + ' != null && i <= args.length)';\n            }\n            if (type == 'forced') {\n                return '(' + force() + ', i <= args.length)';\n            }\n            if (type == 'anything') {\n                return '(i <= args.length)';\n            }\n            if (type == 'blank') {\n                return '(' + force() + ' == null || $' + name + ' === \\'\\')';\n            }\n            throw new Error('Can\\'t check for type: ' + type);\n        }\n    }\n    function roundFloatErrors(num) {\n        var integer = Math.floor(num);\n        var decimal = num - integer;\n        return integer + Math.round(decimal * 1000000000000000) / 1000000000000000;\n    }\n    function maybeRoundFloatErrors(num) {\n        if (typeof num == 'number') {\n            return roundFloatErrors(num);\n        } else {\n            return num;\n        }\n    }\n    function withErrorHandling(obj, f, args) {\n        if (args instanceof CalcError) {\n            return args;\n        }\n        try {\n            return f.apply(obj, args);\n        } catch (ex) {\n            if (ex instanceof CalcError) {\n                return ex;\n            } else {\n                throw ex;\n            }\n        }\n    }\n    function makeSyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        for (var row = 0; row < x.height; ++row) {\n                            for (var col = 0; col < x.width; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        var m = args[i];\n                                        xargs[i] = m.get(row % m.height, col % m.width);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                result.set(row, col, withErrorHandling(this, handler, xargs));\n                            }\n                        }\n                        return callback(result);\n                    }\n                }\n                var xargs = check.call(this, args);\n                callback(withErrorHandling(this, handler, xargs));\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function makeAsyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        var count = x.width * x.height;\n                        var makeCallback = function (row, col) {\n                            return function (value) {\n                                result.set(row, col, value);\n                                --count;\n                                if (count === 0) {\n                                    return callback(result);\n                                }\n                            };\n                        };\n                        for (var row = 0; row < x.height && count > 0; ++row) {\n                            for (var col = 0; col < x.width && count > 0; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        var m = args[i];\n                                        xargs[i] = m.get(row % m.height, col % m.width);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                if (xargs instanceof CalcError) {\n                                    result.set(row, col, xargs);\n                                    --count;\n                                    if (count === 0) {\n                                        return callback(result);\n                                    }\n                                } else {\n                                    xargs.unshift(makeCallback(row, col));\n                                    handler.apply(this, xargs);\n                                }\n                            }\n                        }\n                        return;\n                    }\n                }\n                var x = check.call(this, args);\n                if (x instanceof CalcError) {\n                    callback(x);\n                } else {\n                    x.unshift(callback);\n                    handler.apply(this, x);\n                }\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function defineFunction(name, func) {\n        name = name.toLowerCase();\n        FUNCS[name] = func;\n        return {\n            args: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeSyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            },\n            argsAsync: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeAsyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            }\n        };\n    }\n    function dateToJulianDays(y, m, d) {\n        m++;\n        return (1461 * (y + 4800 + ((m - 14) / 12 | 0)) / 4 | 0) + (367 * (m - 2 - 12 * ((m - 14) / 12 | 0)) / 12 | 0) - (3 * ((y + 4900 + ((m - 14) / 12 | 0)) / 100 | 0) / 4 | 0) + d - 32075;\n    }\n    function julianDaysToDate(jd) {\n        var l, n, j, i, m, d, y;\n        l = jd + 68569;\n        n = 4 * l / 146097 | 0;\n        l = l - ((146097 * n + 3) / 4 | 0);\n        i = 4000 * (l + 1) / 1461001 | 0;\n        l = l - (1461 * i / 4 | 0) + 31;\n        j = 80 * l / 2447 | 0;\n        d = l - (2447 * j / 80 | 0);\n        l = j / 11 | 0;\n        m = j + 2 - 12 * l;\n        y = 100 * (n - 49) + i + l;\n        m--;\n        return {\n            year: y,\n            month: m,\n            date: d,\n            day: (jd + 1) % 7,\n            ord: ORDINAL_ADD_DAYS[isLeapYear(y)][m] + d\n        };\n    }\n    var BASE_DATE = dateToJulianDays(1900, 0, -1);\n    var DAYS_IN_MONTH = [\n        31,\n        28,\n        31,\n        30,\n        31,\n        30,\n        31,\n        31,\n        30,\n        31,\n        30,\n        31\n    ];\n    var ORDINAL_ADD_DAYS = [\n        [\n            0,\n            31,\n            59,\n            90,\n            120,\n            151,\n            181,\n            212,\n            243,\n            273,\n            304,\n            334\n        ],\n        [\n            0,\n            31,\n            60,\n            91,\n            121,\n            152,\n            182,\n            213,\n            244,\n            274,\n            305,\n            335\n        ]\n    ];\n    function isLeapYear(yr) {\n        if (yr % 4) {\n            return 0;\n        }\n        if (yr % 100) {\n            return 1;\n        }\n        if (yr % 400) {\n            return 0;\n        }\n        return 1;\n    }\n    function daysInYear(yr) {\n        return isLeapYear(yr) ? 366 : 365;\n    }\n    function daysInMonth(yr, mo) {\n        return isLeapYear(yr) && mo == 1 ? 29 : DAYS_IN_MONTH[mo];\n    }\n    function unpackDate(serial) {\n        return julianDaysToDate((serial | 0) + BASE_DATE);\n    }\n    function packDate(year, month, date) {\n        return dateToJulianDays(year, month, date) - BASE_DATE;\n    }\n    var MS_IN_MIN = 60 * 1000;\n    var MS_IN_HOUR = 60 * MS_IN_MIN;\n    var MS_IN_DAY = 24 * MS_IN_HOUR;\n    function unpackTime(serial) {\n        var frac = serial - (serial | 0);\n        if (frac < 0) {\n            frac++;\n        }\n        var ms = Math.round(MS_IN_DAY * frac);\n        var hours = Math.floor(ms / MS_IN_HOUR);\n        ms -= hours * MS_IN_HOUR;\n        var minutes = Math.floor(ms / MS_IN_MIN);\n        ms -= minutes * MS_IN_MIN;\n        var seconds = Math.floor(ms / 1000);\n        ms -= seconds * 1000;\n        return {\n            hours: hours,\n            minutes: minutes,\n            seconds: seconds,\n            milliseconds: ms\n        };\n    }\n    function serialToDate(serial) {\n        var d = unpackDate(serial), t = unpackTime(serial);\n        return new Date(d.year, d.month, d.date, t.hours, t.minutes, t.seconds, t.milliseconds);\n    }\n    function packTime(hh, mm, ss, ms) {\n        return (hh + (mm + (ss + ms / 1000) / 60) / 60) / 24;\n    }\n    function dateToSerial(date) {\n        var time = packTime(date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds());\n        date = packDate(date.getFullYear(), date.getMonth(), date.getDate());\n        if (date < 0) {\n            return date - 1 + time;\n        } else {\n            return date + time;\n        }\n    }\n    function parseDate(str) {\n        return kendo.parseDate(str) || kendo.parseDate(str, [\n            'MMMM dd yyyy',\n            'MMMM dd yy',\n            'MMM dd yyyy',\n            'MMM dd yy',\n            'dd MMMM yyyy',\n            'dd MMMM yy',\n            'dd MMM yyyy',\n            'dd MMM yy',\n            'MMMM dd, yyyy',\n            'MMMM dd, yy',\n            'MMM dd, yyyy',\n            'MMM dd, yy',\n            'MMMM dd',\n            'MMM dd',\n            'MMMM yyyy',\n            'MMM yyyy',\n            'dd MMMM',\n            'dd MMM'\n        ]);\n    }\n    exports.CalcError = CalcError;\n    exports.Formula = Formula;\n    exports.Matrix = Matrix;\n    exports.packDate = packDate;\n    exports.unpackDate = unpackDate;\n    exports.packTime = packTime;\n    exports.unpackTime = unpackTime;\n    exports.serialToDate = serialToDate;\n    exports.dateToSerial = dateToSerial;\n    exports.daysInMonth = daysInMonth;\n    exports.isLeapYear = isLeapYear;\n    exports.daysInYear = daysInYear;\n    exports.parseDate = parseDate;\n    spreadsheet.dateToNumber = dateToSerial;\n    spreadsheet.numberToDate = serialToDate;\n    spreadsheet.defineFunction = defineFunction;\n    spreadsheet.CalcError = CalcError;\n    exports.defineFunction = defineFunction;\n    exports.defineAlias = function (alias, name) {\n        var orig = FUNCS[name];\n        if (!orig) {\n            throw new Error('Function ' + name + ' is not yet defined');\n        }\n        if (!orig.kendoSpreadsheetAliases) {\n            orig.kendoSpreadsheetAliases = [name];\n        }\n        orig.kendoSpreadsheetAliases.push(alias);\n        FUNCS[alias] = orig;\n    };\n    exports.FUNCS = FUNCS;\n    var NUMBER_OR_ZERO = [\n        'or',\n        'number',\n        [\n            'null',\n            0\n        ]\n    ];\n    var ARGS_NUMERIC = [\n        [\n            '*a',\n            NUMBER_OR_ZERO\n        ],\n        [\n            '*b',\n            NUMBER_OR_ZERO\n        ]\n    ];\n    var ARGS_ANYVALUE = [\n        [\n            '*a',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ];\n    defineFunction('binary+', function (a, b) {\n        return a + b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary-', function (a, b) {\n        return a - b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary*', function (a, b) {\n        return a * b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary/', function (a, b) {\n        return a / b;\n    }).args([\n        [\n            '*a',\n            NUMBER_OR_ZERO\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('binary^', function (a, b) {\n        return Math.pow(a, b);\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary&', function (a, b) {\n        if (a == null) {\n            a = '';\n        }\n        if (b == null) {\n            b = '';\n        }\n        return '' + a + b;\n    }).args([\n        [\n            '*a',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('binary=', function (a, b) {\n        return a === b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<>', function (a, b) {\n        return a !== b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<', binaryCompare(function (a, b) {\n        return a < b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary<=', binaryCompare(function (a, b) {\n        return a <= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>', binaryCompare(function (a, b) {\n        return a > b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>=', binaryCompare(function (a, b) {\n        return a >= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('unary+', function (a) {\n        return a;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('unary-', function (a) {\n        return -a;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('unary%', function (a) {\n        return a / 100;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('binary:', function (a, b) {\n        return new RangeRef(a, b).setSheet(a.sheet || this.formula.sheet, a.hasSheet());\n    }).args([\n        [\n            'a',\n            'cell'\n        ],\n        [\n            'b',\n            'cell'\n        ]\n    ]);\n    defineFunction('binary,', function (a, b) {\n        return new UnionRef([\n            a,\n            b\n        ]);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('binary ', function (a, b) {\n        return a.intersect(b);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('not', function (a) {\n        return !this.bool(a);\n    }).args([[\n            '*a',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]]);\n    defineFunction('isblank', function (val) {\n        if (val instanceof CellRef) {\n            val = this.getRefData(val);\n            return val == null;\n        }\n        return false;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    defineFunction('iserror', function (val) {\n        return val instanceof CalcError;\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('iserr', function (val) {\n        return val instanceof CalcError && val.code != 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isna', function (val) {\n        return val instanceof CalcError && val.code == 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('islogical', function (val) {\n        return typeof val == 'boolean';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnontext', function (val) {\n        return typeof val != 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('istext', function (val) {\n        return typeof val == 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnumber', function (val) {\n        return typeof val == 'number';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isref', function (val) {\n        return val instanceof CellRef || val instanceof RangeRef;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    FUNCS[',getname'] = function (callback, args) {\n        this.fetchName(args[0], callback);\n    };\n    function binaryCompare(func) {\n        return function (left, right) {\n            if (typeof left == 'string' && typeof right != 'string') {\n                right = right == null ? '' : right + '';\n            }\n            if (typeof left != 'string' && typeof right == 'string') {\n                left = left == null ? '' : left + '';\n            }\n            if (typeof left == 'number' && right == null) {\n                right = 0;\n            }\n            if (typeof right == 'number' && left == null) {\n                left = 0;\n            }\n            if (typeof left == 'string' && typeof right == 'string') {\n                left = left.toLowerCase();\n                right = right.toLowerCase();\n            }\n            if (typeof right == typeof left) {\n                return func(left, right);\n            } else {\n                return new CalcError('VALUE');\n            }\n        };\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/validation', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    var $ = kendo.jQuery;\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var exports = {};\n    spreadsheet.validation = exports;\n    var calc = spreadsheet.calc;\n    var Class = kendo.Class;\n    var TRANSPOSE_FORMAT = '_matrix({0})';\n    var DATE_FORMAT = 'DATEVALUE(\"{0}\")';\n    calc.runtime.defineFunction('_matrix', function (m) {\n        if (typeof m == 'string') {\n            m = this.asMatrix([m.split(/\\s*,\\s*/)]);\n        }\n        return m;\n    }).args([[\n            'm',\n            [\n                'or',\n                'matrix',\n                'string'\n            ]\n        ]]);\n    function compileValidation(sheet, row, col, validation) {\n        var validationHandler;\n        var comparer;\n        var parsedFromDate;\n        var parsedToDate;\n        if (typeof validation === 'string') {\n            validation = JSON.parse(validation);\n        }\n        if (validation.from) {\n            if (validation.dataType === 'list' && !validation.fromIsListValue) {\n                validation.from = kendo.format(TRANSPOSE_FORMAT, validation.from);\n                validation.fromIsListValue = true;\n            }\n            if (validation.dataType === 'date') {\n                parsedFromDate = calc.runtime.parseDate(validation.from);\n                if (parsedFromDate) {\n                    validation.from = kendo.format(DATE_FORMAT, validation.from);\n                    validation.fromIsDateValue = true;\n                }\n            }\n            validation.from = calc.compile(calc.parseFormula(sheet, row, col, validation.from));\n        }\n        if (validation.to) {\n            if (validation.dataType === 'date') {\n                parsedToDate = calc.runtime.parseDate(validation.to);\n                if (parsedToDate) {\n                    validation.to = kendo.format(DATE_FORMAT, validation.to);\n                    validation.toIsDateValue = true;\n                }\n            }\n            validation.to = calc.compile(calc.parseFormula(sheet, row, col, validation.to));\n        }\n        if (validation.dataType == 'custom') {\n            comparer = exports.validationComparers.custom;\n        } else if (validation.dataType == 'list') {\n            comparer = exports.validationComparers.list;\n        } else {\n            comparer = exports.validationComparers[validation.comparerType];\n        }\n        if (!comparer) {\n            throw kendo.format('\\'{0}\\' comparer is not implemented.', validation.comparerType);\n        }\n        validationHandler = function (valueToCompare) {\n            var toValue = this.to && this.to_value ? this.to_value : undefined;\n            if (valueToCompare === null || valueToCompare === '') {\n                if (this.allowNulls) {\n                    this.value = true;\n                } else {\n                    this.value = false;\n                }\n            } else if (this.dataType == 'custom') {\n                this.value = comparer(valueToCompare, this.from_value, toValue);\n            } else if (this.dataType == 'list') {\n                var data = this._getListData();\n                this.value = comparer(valueToCompare, data, toValue);\n            } else {\n                this.value = comparer(valueToCompare, this.from_value, toValue);\n            }\n            return this.value;\n        };\n        return new kendo.spreadsheet.validation.Validation($.extend(validation, {\n            handler: validationHandler,\n            sheet: sheet,\n            row: row,\n            col: col\n        }));\n    }\n    var Validation = Class.extend({\n        init: function Validation(options) {\n            this.handler = options.handler;\n            this.from = options.from;\n            this.to = options.to;\n            this.dataType = options.dataType;\n            this.comparerType = options.comparerType;\n            this.type = options.type ? options.type : 'warning';\n            this.allowNulls = options.allowNulls ? true : false;\n            this.fromIsDateValue = options.fromIsDateValue ? true : false;\n            this.toIsDateValue = options.toIsDateValue ? true : false;\n            this.showButton = options.showButton;\n            this.fromIsListValue = options.fromIsListValue ? true : false;\n            this.sheet = options.sheet;\n            this.row = options.row;\n            this.col = options.col;\n            if (options.tooltipMessageTemplate) {\n                this.tooltipMessageTemplate = options.tooltipMessageTemplate;\n            }\n            if (options.tooltipTitleTemplate) {\n                this.tooltipTitleTemplate = options.tooltipTitleTemplate;\n            }\n            if (options.messageTemplate) {\n                this.messageTemplate = options.messageTemplate;\n            }\n            if (options.titleTemplate) {\n                this.titleTemplate = options.titleTemplate;\n            }\n        },\n        _formatMessages: function (format) {\n            var from = this.from ? this.from_value : '';\n            var to = this.to ? this.to_value : '';\n            var fromFormula = this.from ? this.from.toString() : '';\n            var toFormula = this.to ? this.to.toString() : '';\n            var dataType = this.dataType;\n            var type = this.type;\n            var comparerType = this.comparerType;\n            return kendo.format(format, from, to, fromFormula, toFormula, dataType, type, comparerType);\n        },\n        _setMessages: function () {\n            this.title = '';\n            this.message = '';\n            if (this.tooltipTitleTemplate) {\n                this.tooltipTitle = this._formatMessages(this.tooltipTitleTemplate);\n            }\n            if (this.tooltipMessageTemplate) {\n                this.tooltipMessage = this._formatMessages(this.tooltipMessageTemplate);\n            }\n            if (this.titleTemplate) {\n                this.title = this._formatMessages(this.titleTemplate);\n            }\n            if (this.messageTemplate) {\n                this.message = this._formatMessages(this.messageTemplate);\n            }\n        },\n        _getListData: function () {\n            if (!this.from_value || !this.from_value.data) {\n                return [];\n            }\n            var cube = this.from_value.data;\n            var i;\n            var y;\n            var data = [];\n            for (i = 0; i < cube.length; i++) {\n                var array = cube[i];\n                if (array) {\n                    for (y = 0; y < array.length; y++) {\n                        data.push(array[y]);\n                    }\n                }\n            }\n            return data;\n        },\n        clone: function (sheet, row, col) {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.clone(sheet, row, col);\n            }\n            if (options.to) {\n                options.to = options.to.clone(sheet, row, col);\n            }\n            return new Validation($.extend(options, { handler: this.handler }, {\n                sheet: sheet,\n                row: row,\n                col: col\n            }));\n        },\n        exec: function (ss, compareValue, compareFormat, callback) {\n            var self = this;\n            function getValue(val) {\n                if (val instanceof kendo.spreadsheet.Ref) {\n                    val = ss.getData(val);\n                    if (Array.isArray(val)) {\n                        val = val[0];\n                    }\n                }\n                return val;\n            }\n            var calculateFromCallBack = function (val) {\n                self.from_value = getValue(val);\n                self.value = self.handler.call(self, compareValue, compareFormat);\n                self._setMessages();\n                if (callback) {\n                    callback(self.value);\n                }\n            };\n            if (self.to) {\n                self.to.exec(ss, function (val) {\n                    self.to_value = getValue(val);\n                    self.from.exec(ss, calculateFromCallBack);\n                });\n            } else {\n                self.from.exec(ss, calculateFromCallBack);\n            }\n        },\n        reset: function () {\n            if (this.from) {\n                this.from.reset();\n            }\n            if (this.to) {\n                this.to.reset();\n            }\n            delete this.value;\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            if (this.from) {\n                this.from.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.to) {\n                this.to.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.sheet.toLowerCase() == affectedSheet.toLowerCase()) {\n                var formulaRow = this.row;\n                var formulaCol = this.col;\n                switch (operation) {\n                case 'row':\n                    if (formulaRow >= start) {\n                        this.row += delta;\n                    }\n                    break;\n                case 'col':\n                    if (formulaCol >= start) {\n                        this.col += delta;\n                    }\n                    break;\n                }\n            }\n        },\n        toJSON: function () {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.toString();\n                if (options.dataType === 'list') {\n                    options.from = options.from.replace(/^_matrix\\((.*)\\)$/i, '$1');\n                    delete options.fromIsListValue;\n                }\n                if (options.dataType === 'date') {\n                    if (this.fromIsDateValue) {\n                        options.from = options.from.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                        delete options.fromIsDateValue;\n                    }\n                }\n            }\n            if (options.to) {\n                options.to = options.to.toString();\n                if (options.dataType === 'date') {\n                    if (this.toIsDateValue) {\n                        options.to = options.to.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                        delete options.toIsDateValue;\n                    }\n                }\n            }\n            return options;\n        },\n        _getOptions: function () {\n            return {\n                from: this.from,\n                to: this.to,\n                dataType: this.dataType,\n                type: this.type,\n                comparerType: this.comparerType,\n                row: this.row,\n                col: this.col,\n                sheet: this.sheet,\n                allowNulls: this.allowNulls,\n                fromIsListValue: this.fromIsListValue,\n                fromIsDateValue: this.fromIsDateValue,\n                toIsDateValue: this.toIsDateValue,\n                tooltipMessageTemplate: this.tooltipMessageTemplate,\n                tooltipTitleTemplate: this.tooltipTitleTemplate,\n                messageTemplate: this.messageTemplate,\n                titleTemplate: this.titleTemplate,\n                showButton: this.showButton\n            };\n        }\n    });\n    exports.compile = compileValidation;\n    exports.validationComparers = {\n        greaterThan: function (valueToCompare, from) {\n            return valueToCompare > from;\n        },\n        lessThan: function (valueToCompare, from) {\n            return valueToCompare < from;\n        },\n        between: function (valueToCompare, from, to) {\n            return valueToCompare >= from && valueToCompare <= to;\n        },\n        equalTo: function (valueToCompare, from) {\n            return valueToCompare == from;\n        },\n        notEqualTo: function (valueToCompare, from) {\n            return valueToCompare != from;\n        },\n        greaterThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare >= from;\n        },\n        lessThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare <= from;\n        },\n        notBetween: function (valueToCompare, from, to) {\n            return valueToCompare < from || valueToCompare > to;\n        },\n        custom: function (valueToCompare, from) {\n            return from;\n        },\n        list: function (valueToCompare, data) {\n            return data.indexOf(valueToCompare) > -1;\n        }\n    };\n    exports.Validation = Validation;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheet', [\n        'kendo.core',\n        'kendo.color',\n        'spreadsheet/runtime',\n        'spreadsheet/validation',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Range = kendo.spreadsheet.Range;\n        var Selection = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.selection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalSelection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this._activeCell = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalActiveCell = kendo.spreadsheet.FIRSTREF;\n            },\n            currentSelectionRange: function () {\n                return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentOriginalNavigationRange: function () {\n                return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentNavigationRange: function () {\n                if (this.singleCellSelection()) {\n                    return this._sheet._sheetRef;\n                } else {\n                    return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n                }\n            },\n            nextNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            previousNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            activeCell: function (ref) {\n                if (ref) {\n                    this.originalActiveCell = ref.first();\n                    this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n                    this._sheet.focus(ref);\n                    this._sheet.triggerChange({\n                        activeCell: true,\n                        selection: true\n                    });\n                }\n                return this._activeCell;\n            },\n            select: function (ref, expanded, changeActiveCell) {\n                if (ref) {\n                    if (ref.eq(this.originalSelection)) {\n                        return;\n                    }\n                    this._sheet.triggerSelect(new Range(ref, this._sheet));\n                    this.originalSelection = ref;\n                    this.selection = expanded;\n                    if (changeActiveCell !== false) {\n                        if (ref.isCell()) {\n                            this.activeCell(ref);\n                        } else {\n                            this.activeCell(this.selection.lastRange().first());\n                        }\n                        this.selectionRangeIndex = this.selection.size() - 1;\n                    } else {\n                        this._sheet.triggerChange({ selection: true });\n                    }\n                }\n                return this.selection;\n            },\n            singleCellSelection: function () {\n                return this._activeCell.eq(this.selection);\n            }\n        });\n        var Sheet = kendo.Observable.extend({\n            init: function () {\n                kendo.Observable.prototype.init.call(this);\n                this._reinit.apply(this, arguments);\n            },\n            events: [\n                'commandRequest',\n                'afterInsertRow',\n                'afterDeleteRow',\n                'insertRow',\n                'insertColumn',\n                'deleteRow',\n                'deleteColumn',\n                'hideRow',\n                'hideColumn',\n                'unhideRow',\n                'unhideColumn',\n                'select'\n            ],\n            _reinit: function (rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth, defaultCellStyle) {\n                var cellCount = rowCount * columnCount - 1;\n                defaultCellStyle = defaultCellStyle || {};\n                this._defaultCellStyle = {\n                    background: defaultCellStyle.background,\n                    color: defaultCellStyle.color,\n                    fontFamily: defaultCellStyle.fontFamily,\n                    fontSize: defaultCellStyle.fontSize,\n                    italic: defaultCellStyle.italic,\n                    bold: defaultCellStyle.bold,\n                    underline: defaultCellStyle.underline,\n                    wrap: defaultCellStyle.wrap\n                };\n                this._rows = new kendo.spreadsheet.Axis(rowCount, rowHeight);\n                this._columns = new kendo.spreadsheet.Axis(columnCount, columnWidth);\n                this._mergedCells = [];\n                this._frozenRows = 0;\n                this._frozenColumns = 0;\n                this._suspendChanges = false;\n                this._filter = null;\n                this._showGridLines = true;\n                this._gridLinesColor = null;\n                this._grid = new kendo.spreadsheet.Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n                this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n                this._properties = new kendo.spreadsheet.PropertyBag(cellCount, this._defaultCellStyle);\n                this._sorter = new kendo.spreadsheet.Sorter(this._grid, this._properties.sortable());\n                this._viewSelection = new Selection(this);\n                this._editSelection = new Selection(this);\n                this._formulaSelections = [];\n            },\n            _selectionState: function () {\n                return this._inEdit ? this._editSelection : this._viewSelection;\n            },\n            navigator: function () {\n                if (!this._navigator) {\n                    this._navigator = new kendo.spreadsheet.SheetNavigator(this);\n                }\n                return this._navigator;\n            },\n            axisManager: function () {\n                if (!this._axisManager) {\n                    this._axisManager = new kendo.spreadsheet.AxisManager(this);\n                }\n                return this._axisManager;\n            },\n            _name: function (value) {\n                if (!value) {\n                    return this._sheetName;\n                }\n                this._sheetName = value;\n                return this;\n            },\n            name: function () {\n                return this._name();\n            },\n            _property: function (accessor, value, reason) {\n                if (value === undefined) {\n                    return accessor();\n                } else {\n                    accessor(value);\n                    return this.triggerChange(reason);\n                }\n            },\n            _field: function (name, value, reason) {\n                if (value === undefined) {\n                    return this[name];\n                } else {\n                    this[name] = value;\n                    return this.triggerChange(reason);\n                }\n            },\n            suspendChanges: function (value) {\n                if (value === undefined) {\n                    return this._suspendChanges;\n                }\n                this._suspendChanges = value;\n                return this;\n            },\n            triggerChange: function (reason) {\n                if (!this._suspendChanges) {\n                    this.trigger('change', reason);\n                }\n                return this;\n            },\n            triggerSelect: function (range) {\n                this.trigger('select', { range: range });\n            },\n            setDataSource: function (dataSource, columns) {\n                if (this.dataSourceBinder) {\n                    this.dataSourceBinder.destroy();\n                }\n                this.dataSourceBinder = new kendo.spreadsheet.SheetDataSourceBinder({\n                    dataSource: dataSource,\n                    sheet: this,\n                    columns: columns\n                });\n                this.dataSource = this.dataSourceBinder.dataSource;\n            },\n            hideColumn: function (columnIndex) {\n                if (this.trigger('hideColumn', { index: columnIndex })) {\n                    return;\n                }\n                return this._property(this._columns.hide.bind(this._columns), columnIndex, { layout: true });\n            },\n            unhideColumn: function (columnIndex) {\n                if (this.trigger('unhideColumn', { index: columnIndex })) {\n                    return;\n                }\n                return this._property(this._columns.unhide.bind(this._columns), columnIndex, { layout: true });\n            },\n            isHiddenColumn: function (columnIndex) {\n                return this._grid._columns.hidden(columnIndex);\n            },\n            _copyRange: function (sourceRangeRef, targetRef) {\n                var grid = this._grid;\n                var rowCount = grid.rowCount;\n                var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n                var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n                var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n                var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n                var targetIndex = targetRef.col * rowCount + targetRef.row;\n                this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n            },\n            _adjustReferences: function (operation, start, delta, mergedCells) {\n                this._mergedCells = mergedCells.reduce(function (a, ref) {\n                    ref = ref.adjust(null, null, null, null, operation == 'row', start, delta);\n                    if (ref instanceof RangeRef) {\n                        a.push(ref);\n                    }\n                    return a;\n                }, []);\n                if (this._workbook) {\n                    var affectedSheet = this._name();\n                    this._workbook._sheets.forEach(function (sheet) {\n                        sheet._forFormulas(function (formula) {\n                            formula.adjust(affectedSheet, operation, start, delta);\n                        });\n                        sheet._forValidations(function (validation) {\n                            validation.adjust(affectedSheet, operation, start, delta);\n                        });\n                    });\n                    this._workbook.adjustNames(affectedSheet, operation == 'row', start, delta);\n                }\n                var selection = this.select();\n                selection = selection.adjust(null, null, null, null, operation == 'row', start, delta);\n                if (selection !== kendo.spreadsheet.NULLREF) {\n                    this.select(selection);\n                }\n                var axis = operation == 'col' ? this._columns : this._rows;\n                axis.adjust(start, delta);\n            },\n            _forFormulas: function (callback) {\n                var props = this._properties;\n                var formulas = props.get('formula').values();\n                var n = formulas.length;\n                formulas.forEach(function (f, i) {\n                    callback.call(this, f.value, i, n);\n                }, this);\n            },\n            _forValidations: function (callback) {\n                var props = this._properties;\n                props.get('validation').values().forEach(function (v) {\n                    callback.call(this, v.value);\n                }, this);\n            },\n            preventInsertRow: function (rowIndex, count) {\n                if (this.selectedHeaders().allRows) {\n                    return {\n                        reason: 'error',\n                        type: 'insertRowWhenColumnIsSelected'\n                    };\n                }\n                count = count || 1;\n                var grid = this._grid;\n                var range = this.range(grid.rowCount - count, 0, count, grid.columnCount);\n                if (range.hasValue()) {\n                    return {\n                        reason: 'error',\n                        type: 'shiftingNonblankCells'\n                    };\n                }\n                return false;\n            },\n            preventInsertColumn: function () {\n                if (this.selectedHeaders().allCols) {\n                    return {\n                        reason: 'error',\n                        type: 'insertColumnWhenRowIsSelected'\n                    };\n                }\n                return false;\n            },\n            insertRow: function (rowIndex) {\n                var result = this.preventInsertRow(rowIndex);\n                if (result) {\n                    throw new Error('Shifting nonblank cells off the worksheet is not supported!');\n                }\n                if (this.trigger('insertRow', { index: rowIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var rowCount = grid.rowCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col), new CellRef(rowCount - 2, bottomRight.col));\n                        this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n                        new Range(ref, this).clear();\n                    }\n                    this._adjustReferences('row', rowIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n                this.trigger('afterInsertRow', { index: rowIndex });\n                return this;\n            },\n            isEnabledRow: function (rowIndex) {\n                var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n                return new Range(ref, this).enable();\n            },\n            deleteRow: function (rowIndex) {\n                if (!this.isEnabledRow(rowIndex)) {\n                    return this;\n                }\n                if (this.trigger('deleteRow', { index: rowIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        new Range(ref, this).clear();\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row + 1, topLeft.col), new CellRef(Infinity, bottomRight.col));\n                        this._copyRange(nextRef, topLeft);\n                        var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n                        new Range(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n                    }\n                    this._adjustReferences('row', rowIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n                this.trigger('afterDeleteRow', { index: rowIndex });\n                return this;\n            },\n            insertColumn: function (columnIndex) {\n                if (this.trigger('insertColumn', { index: columnIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnCount; ci >= columnIndex; ci--) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear();\n                        if (ci == columnIndex) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col - 1), new CellRef(bottomRight.row, bottomRight.col - 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n                return this;\n            },\n            isEnabledColumn: function (columnIndex) {\n                var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n                return new Range(ref, this).enable();\n            },\n            deleteColumn: function (columnIndex) {\n                if (!this.isEnabledColumn(columnIndex)) {\n                    return this;\n                }\n                if (this.trigger('deleteColumn', { index: columnIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnIndex; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear();\n                        if (ci == columnCount - 1) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col + 1), new CellRef(bottomRight.row, bottomRight.col + 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n                return this;\n            },\n            hideRow: function (rowIndex) {\n                if (this.trigger('hideRow', { index: rowIndex })) {\n                    return;\n                }\n                return this._property(this._rows.hide.bind(this._rows), rowIndex, { layout: true });\n            },\n            unhideRow: function (rowIndex) {\n                if (this.trigger('unhideRow', { index: rowIndex })) {\n                    return;\n                }\n                return this._property(this._rows.unhide.bind(this._rows), rowIndex, { layout: true });\n            },\n            isHiddenRow: function (rowIndex) {\n                return this._grid._rows.hidden(rowIndex);\n            },\n            columnWidth: function (columnIndex, width) {\n                return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, { layout: true });\n            },\n            rowHeight: function (rowIndex, height) {\n                return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, { layout: true });\n            },\n            frozenRows: function (value) {\n                return this._field('_frozenRows', value, { layout: true });\n            },\n            frozenColumns: function (value) {\n                return this._field('_frozenColumns', value, { layout: true });\n            },\n            showGridLines: function (value) {\n                return this._field('_showGridLines', value, { layout: true });\n            },\n            gridLinesColor: function (value) {\n                return this._field('_gridLinesColor', value, { layout: true });\n            },\n            _ref: function (row, column, numRows, numColumns) {\n                var ref = null;\n                if (row instanceof kendo.spreadsheet.Ref) {\n                    return row;\n                }\n                if (row instanceof kendo.spreadsheet.Range) {\n                    return row._ref.toRangeRef();\n                }\n                if (typeof row === 'string') {\n                    ref = kendo.spreadsheet.calc.parseReference(row);\n                } else {\n                    if (!numRows) {\n                        numRows = 1;\n                    }\n                    if (!numColumns) {\n                        numColumns = 1;\n                    }\n                    ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n                }\n                return ref;\n            },\n            range: function (row, column, numRows, numColumns) {\n                return new Range(this._ref(row, column, numRows, numColumns), this);\n            },\n            _getMergedCells: function (range) {\n                var grid = this._grid;\n                var primary = {};\n                var secondary = {};\n                var hasMerged = false;\n                this.forEachMergedCell(range, function (ref) {\n                    var topLeft = ref.topLeft;\n                    grid.forEach(ref, function (cellRef) {\n                        if (topLeft.eq(cellRef)) {\n                            primary[cellRef.print()] = ref;\n                            hasMerged = true;\n                        } else if (range.contains(cellRef)) {\n                            secondary[cellRef.print()] = topLeft;\n                            hasMerged = true;\n                        }\n                    });\n                });\n                return {\n                    primary: primary,\n                    secondary: secondary,\n                    hasMerged: hasMerged\n                };\n            },\n            forEachMergedCell: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                this._mergedCells.forEach(function (merged) {\n                    if (selectAll || merged.intersects(ref)) {\n                        callback(merged);\n                    }\n                });\n            },\n            forEachFilterHeader: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                if (this._filter) {\n                    var refs = [];\n                    this._filter.ref.forEachColumn(function (columnRef) {\n                        if (selectAll || columnRef.intersects(ref)) {\n                            refs.push(columnRef.topLeft);\n                        }\n                    });\n                    this._mergedCells.forEach(function (merged) {\n                        refs = refs.map(function (ref) {\n                            if (merged.intersects(ref)) {\n                                return merged;\n                            }\n                            return ref;\n                        });\n                    });\n                    refs.reduce(function unique(result, element) {\n                        if (result.indexOf(element) < 0) {\n                            result.push(element);\n                        }\n                        return result;\n                    }, []).forEach(callback);\n                }\n            },\n            forEach: function (ref, callback) {\n                if (!(ref instanceof RangeRef)) {\n                    ref = this._ref(ref);\n                }\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                function doIt(value) {\n                    callback(ri++, ci, value);\n                }\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var ri = topLeft.row;\n                    var startCellIndex = this._grid.index(ri, ci);\n                    var endCellIndex = this._grid.index(bottomRight.row, ci);\n                    this._properties.forEach(startCellIndex, endCellIndex, doIt);\n                }\n            },\n            startResizing: function (initialPosition) {\n                this._initialPosition = initialPosition;\n                this._resizeInProgress = true;\n            },\n            startAutoFill: function () {\n                this._autoFillInProgress = true;\n                var selection = this.select();\n                this._autoFillOrigin = selection;\n                this._autoFillDest = selection;\n                this.triggerChange({ selection: true });\n            },\n            updateAutoFill: function (dest, punch, hint, direction) {\n                this._autoFillDest = dest;\n                this._autoFillPunch = punch;\n                this._autoFillHint = hint;\n                this._autoFillDirection = direction;\n                this.triggerChange({ selection: true });\n            },\n            autoFillRef: function () {\n                return this._autoFillDest;\n            },\n            autoFillPunch: function () {\n                return this._autoFillPunch;\n            },\n            autoFillInProgress: function () {\n                return this._autoFillInProgress;\n            },\n            resizingInProgress: function () {\n                return this._resizeInProgress;\n            },\n            completeResizing: function () {\n                if (this._resizeInProgress) {\n                    this._resizeInProgress = false;\n                    var hintPosition = this.resizeHintPosition();\n                    if (this._initialPosition && hintPosition) {\n                        var handlePosition = this.resizeHandlePosition();\n                        if (handlePosition.col !== -Infinity) {\n                            this.trigger('commandRequest', {\n                                command: 'ColumnWidthCommand',\n                                options: {\n                                    target: handlePosition.col,\n                                    value: this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x)\n                                }\n                            });\n                        } else {\n                            this.trigger('commandRequest', {\n                                command: 'RowHeightCommand',\n                                options: {\n                                    target: handlePosition.row,\n                                    value: this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y)\n                                }\n                            });\n                        }\n                    } else {\n                        this.trigger('change', { resize: true });\n                    }\n                }\n            },\n            resizeHandlePosition: function () {\n                return this._resizeHandlePosition;\n            },\n            resizeHintPosition: function (location) {\n                if (location !== undefined) {\n                    this._resizeHintPosition = location;\n                    this.trigger('change', { resize: true });\n                }\n                return this._resizeHintPosition;\n            },\n            removeResizeHandle: function () {\n                if (this._resizeHandlePosition) {\n                    this._resizeHintPosition = undefined;\n                    this._resizeHandlePosition = undefined;\n                    this._initialPosition = undefined;\n                    this.trigger('change', { resize: true });\n                }\n            },\n            positionResizeHandle: function (ref) {\n                this._resizeHandlePosition = ref;\n                this.trigger('change', { resize: true });\n            },\n            startSelection: function () {\n                this._selectionInProgress = true;\n            },\n            completeSelection: function () {\n                if (this._selectionInProgress) {\n                    this._selectionInProgress = false;\n                    this._resizeHintPosition = undefined;\n                    this.trigger('change', { selection: true });\n                }\n                if (this._autoFillInProgress) {\n                    this._autoFillInProgress = false;\n                    var dest = this._autoFillDest;\n                    var origin = this._autoFillOrigin;\n                    if (this._autoFillPunch) {\n                        this.trigger('commandRequest', {\n                            command: 'ClearContentCommand',\n                            options: { operatingRange: this.range(this._autoFillPunch) }\n                        });\n                    } else {\n                        if (!dest.eq(origin)) {\n                            this.trigger('commandRequest', {\n                                command: 'AutoFillCommand',\n                                options: {\n                                    operatingRange: this.range(dest),\n                                    origin: this.range(origin)\n                                }\n                            });\n                        } else {\n                            this.triggerChange({ selection: true });\n                        }\n                    }\n                    this._autoFillDest = null;\n                    this._autoFillPunch = null;\n                    this._autoFillOrigin = null;\n                    this.select(dest);\n                }\n            },\n            selectionInProgress: function () {\n                return this._selectionInProgress;\n            },\n            select: function (ref, changeActiveCell) {\n                var selectionState = this._selectionState();\n                var expandedRef;\n                if (ref) {\n                    ref = this._ref(ref);\n                    ref = this._grid.normalize(ref);\n                    expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n                }\n                return selectionState.select(ref, expandedRef, changeActiveCell);\n            },\n            originalSelect: function () {\n                return this._selectionState().originalSelection;\n            },\n            currentSelectionRange: function () {\n                return this._selectionState().currentSelectionRange();\n            },\n            currentOriginalSelectionRange: function () {\n                return this._selectionState().currentOriginalNavigationRange();\n            },\n            currentNavigationRange: function () {\n                return this._selectionState().currentNavigationRange();\n            },\n            nextNavigationRange: function () {\n                return this._selectionState().nextNavigationRange();\n            },\n            previousNavigationRange: function () {\n                return this._selectionState().previousNavigationRange();\n            },\n            selectionRangeIndex: function () {\n                return this._selectionState().selectionRangeIndex;\n            },\n            activeCell: function (ref) {\n                return this._selectionState().activeCell(ref);\n            },\n            originalActiveCell: function () {\n                return this._selectionState().originalActiveCell;\n            },\n            singleCellSelection: function () {\n                return this._selectionState().singleCellSelection();\n            },\n            unionWithMerged: function (ref) {\n                var mergedCells = this._mergedCells;\n                return ref.map(function (ref) {\n                    return ref.toRangeRef().union(mergedCells);\n                });\n            },\n            trim: function (ref) {\n                var trims = [];\n                var grid = this._grid;\n                this._properties.forEachProperty(function (property) {\n                    trims.push(grid.trim(ref, property.list));\n                });\n                return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n            },\n            focus: function (ref) {\n                if (ref) {\n                    this._focus = ref.toRangeRef();\n                } else {\n                    var focus = this._focus;\n                    this._focus = null;\n                    return focus;\n                }\n            },\n            activeCellSelection: function () {\n                return new Range(this._grid.normalize(this.activeCell()), this);\n            },\n            selection: function () {\n                return new Range(this._grid.normalize(this._selectionState().selection), this);\n            },\n            selectedHeaders: function () {\n                var selection = this.select();\n                var rows = {};\n                var cols = {};\n                var allCols = false;\n                var allRows = false;\n                var maxRow = this._grid.rowCount - 1;\n                var maxCol = this._grid.columnCount - 1;\n                selection.forEach(function (ref) {\n                    var i;\n                    var rowState = 'partial';\n                    var colState = 'partial';\n                    ref = ref.toRangeRef();\n                    var bottomRight = ref.bottomRight;\n                    var topLeft = ref.topLeft;\n                    var rowSelection = topLeft.col <= 0 && bottomRight.col >= maxCol;\n                    var colSelection = topLeft.row <= 0 && bottomRight.row >= maxRow;\n                    if (colSelection) {\n                        allRows = true;\n                        colState = 'full';\n                    }\n                    if (rowSelection) {\n                        allCols = true;\n                        rowState = 'full';\n                    }\n                    if (!colSelection) {\n                        for (i = topLeft.row; i <= bottomRight.row; i++) {\n                            if (rows[i] !== 'full') {\n                                rows[i] = rowState;\n                            }\n                        }\n                    }\n                    if (!rowSelection) {\n                        for (i = topLeft.col; i <= bottomRight.col; i++) {\n                            if (cols[i] !== 'full') {\n                                cols[i] = colState;\n                            }\n                        }\n                    }\n                });\n                return {\n                    rows: rows,\n                    cols: cols,\n                    allRows: allRows,\n                    allCols: allCols,\n                    all: allRows && allCols\n                };\n            },\n            isInEditMode: function (isInEdit) {\n                if (isInEdit === undefined) {\n                    return this._inEdit;\n                }\n                this._inEdit = isInEdit;\n                if (isInEdit) {\n                    this._editSelection.selection = this._viewSelection.selection.clone();\n                    this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n                    this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n                    this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n                }\n            },\n            _setFormulaSelections: function (selection) {\n                this._formulaSelections = (selection || []).slice();\n                this.triggerChange({ selection: true });\n            },\n            _viewActiveCell: function () {\n                return this._viewSelection._activeCell.toRangeRef();\n            },\n            toJSON: function () {\n                var positions = {};\n                var rows = this._rows.toJSON('height', positions);\n                var columns = this._columns.toJSON('width', {});\n                var viewSelection = this._viewSelection;\n                var hyperlinks = [];\n                var defaultCellStyle = this._defaultCellStyle || {};\n                function clearDefaultStyle(cell) {\n                    Object.keys(defaultCellStyle).forEach(function (key) {\n                        if (cell[key] === defaultCellStyle[key]) {\n                            delete cell[key];\n                        }\n                    });\n                }\n                this.forEach(kendo.spreadsheet.SHEETREF, function (row, col, cell) {\n                    clearDefaultStyle(cell);\n                    if (Object.keys(cell).length === 0) {\n                        return;\n                    }\n                    if (cell.link) {\n                        hyperlinks.push({\n                            ref: kendo.spreadsheet.Ref.display(null, row, col),\n                            target: cell.link\n                        });\n                    }\n                    var position = positions[row];\n                    if (position === undefined) {\n                        position = rows.length;\n                        rows.push({ index: row });\n                        positions[row] = position;\n                    }\n                    row = rows[position];\n                    cell.index = col;\n                    if (row.cells === undefined) {\n                        row.cells = [];\n                    }\n                    if (cell.formula) {\n                        cell.formula = cell.formula.toString();\n                    }\n                    if (cell.validation) {\n                        cell.validation = cell.validation.toJSON();\n                    }\n                    if (cell.color) {\n                        cell.color = kendo.parseColor(cell.color).toCss();\n                    }\n                    if (cell.background) {\n                        cell.background = kendo.parseColor(cell.background).toCss();\n                    }\n                    if (cell.borderTop && cell.borderTop.color) {\n                        cell.borderTop.color = kendo.parseColor(cell.borderTop.color).toCss();\n                    }\n                    if (cell.borderBottom && cell.borderBottom.color) {\n                        cell.borderBottom.color = kendo.parseColor(cell.borderBottom.color).toCss();\n                    }\n                    if (cell.borderRight && cell.borderRight.color) {\n                        cell.borderRight.color = kendo.parseColor(cell.borderRight.color).toCss();\n                    }\n                    if (cell.borderLeft && cell.borderLeft.color) {\n                        cell.borderLeft.color = kendo.parseColor(cell.borderLeft.color).toCss();\n                    }\n                    row.cells.push(cell);\n                });\n                var json = {\n                    name: this._name(),\n                    rows: rows,\n                    columns: columns,\n                    selection: viewSelection.selection.toString(),\n                    activeCell: viewSelection.activeCell().toString(),\n                    frozenRows: this.frozenRows(),\n                    frozenColumns: this.frozenColumns(),\n                    showGridLines: this.showGridLines(),\n                    gridLinesColor: this.gridLinesColor(),\n                    mergedCells: this._mergedCells.map(function (ref) {\n                        return ref.toString();\n                    }),\n                    hyperlinks: hyperlinks,\n                    defaultCellStyle: defaultCellStyle\n                };\n                if (this._sort) {\n                    json.sort = {\n                        ref: this._sort.ref.toString(),\n                        columns: this._sort.columns.map(function (column) {\n                            return {\n                                index: column.index,\n                                ascending: column.ascending\n                            };\n                        })\n                    };\n                }\n                if (this._filter) {\n                    json.filter = {\n                        ref: this._filter.ref.toString(),\n                        columns: this._filter.columns.map(function (column) {\n                            var filter = column.filter.toJSON();\n                            filter.index = column.index;\n                            return filter;\n                        })\n                    };\n                }\n                return json;\n            },\n            fromJSON: function (json) {\n                this.batch(function () {\n                    if (json.name !== undefined) {\n                        this._name(json.name);\n                    }\n                    if (json.frozenColumns !== undefined) {\n                        this.frozenColumns(json.frozenColumns);\n                    }\n                    if (json.frozenRows !== undefined) {\n                        this.frozenRows(json.frozenRows);\n                    }\n                    if (json.columns !== undefined) {\n                        this._columns.fromJSON('width', json.columns);\n                    }\n                    if (json.rows !== undefined) {\n                        this._rows.fromJSON('height', json.rows);\n                        for (var ri = 0; ri < json.rows.length; ri++) {\n                            var row = json.rows[ri];\n                            var rowIndex = row.index;\n                            if (rowIndex === undefined) {\n                                rowIndex = ri;\n                            }\n                            if (row.cells) {\n                                for (var ci = 0; ci < row.cells.length; ci++) {\n                                    var cell = row.cells[ci];\n                                    var columnIndex = cell.index;\n                                    if (columnIndex === undefined) {\n                                        columnIndex = ci;\n                                    }\n                                    if (cell.formula) {\n                                        cell.formula = this._compileFormula(rowIndex, columnIndex, cell.formula);\n                                    }\n                                    if (cell.validation) {\n                                        cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                                    }\n                                    this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                                }\n                            }\n                        }\n                    }\n                    if (json.selection) {\n                        this._viewSelection.selection = this._viewSelection.originalSelection = this._ref(json.selection);\n                    }\n                    if (json.activeCell) {\n                        var activeCellRef = this._ref(json.activeCell);\n                        this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                        this._viewSelection.originalActiveCell = activeCellRef;\n                    }\n                    if (json.mergedCells) {\n                        json.mergedCells.forEach(function (ref) {\n                            this.range(ref).merge();\n                        }, this);\n                    }\n                    if (json.sort) {\n                        this._sort = {\n                            ref: this._ref(json.sort.ref),\n                            columns: json.sort.columns.slice(0)\n                        };\n                    }\n                    if (json.filter) {\n                        var ref = json.filter.ref;\n                        var columns = json.filter.columns === undefined ? [] : json.filter.columns;\n                        if (!ref) {\n                            kendo.logToConsole('Dropping filter for sheet \\'' + json.name + '\\' due to missing ref');\n                        } else {\n                            this._filter = {\n                                ref: this._ref(ref),\n                                columns: columns.map(function (column) {\n                                    return {\n                                        index: column.index,\n                                        filter: kendo.spreadsheet.Filter.create(column)\n                                    };\n                                })\n                            };\n                            this._refreshFilter();\n                        }\n                    }\n                    if (json.showGridLines !== undefined) {\n                        this._showGridLines = json.showGridLines;\n                    }\n                    this._gridLinesColor = json.gridLinesColor;\n                });\n                this._rows._refresh();\n                this._columns._refresh();\n            },\n            formula: function (ref) {\n                return this._properties.get('formula', this._grid.cellRefIndex(ref));\n            },\n            validation: function (ref) {\n                return this._properties.get('validation', this._grid.cellRefIndex(ref));\n            },\n            resetFormulas: function () {\n                this._forFormulas(function (formula) {\n                    formula.reset();\n                });\n            },\n            resetValidations: function () {\n                this._forValidations(function (validation) {\n                    validation.reset();\n                });\n            },\n            recalc: function (context, callback) {\n                var formulas = this._properties.get('formula').values();\n                var count = formulas.length, pending = 0, i = 0;\n                if (!count && callback) {\n                    return callback();\n                }\n                function next() {\n                    pending--;\n                    if (i == count && !pending) {\n                        callback();\n                    }\n                }\n                while (i < count) {\n                    pending++;\n                    formulas[i++].value.exec(context, callback ? next : null);\n                }\n            },\n            revalidate: function (context) {\n                var self = this;\n                this._forValidations(function (validation) {\n                    var cellRef = new CellRef(validation.row, validation.col);\n                    var ref = new RangeRef(cellRef, cellRef);\n                    validation.exec(context, self._get(ref, 'value'), self._get(ref, 'format'));\n                });\n            },\n            _value: function (row, col, value) {\n                var index = this._grid.index(row, col);\n                if (value !== undefined) {\n                    this._properties.set('value', index, index, value);\n                } else {\n                    return this._properties.get('value', index);\n                }\n            },\n            _validation: function (row, col) {\n                var index = this._grid.index(row, col);\n                return this._properties.get('validation', index);\n            },\n            _compileValidation: function (row, col, validation) {\n                if (validation instanceof kendo.spreadsheet.validation.Validation) {\n                    return validation.clone(this._name(), row, col);\n                }\n                if (validation.from != null) {\n                    validation.from = (validation.from + '').replace(/^=/, '');\n                }\n                if (validation.to != null) {\n                    validation.to = (validation.to + '').replace(/^=/, '');\n                }\n                return kendo.spreadsheet.validation.compile(this._name(), row, col, validation);\n            },\n            _compileFormula: function (row, col, f) {\n                f = f.replace(/^=/, '');\n                f = kendo.spreadsheet.calc.parseFormula(this._name(), row, col, f);\n                return kendo.spreadsheet.calc.compile(f);\n            },\n            _copyValuesInRange: function (topLeft, bottomRight, value, property) {\n                var ci, start, end;\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    start = this._grid.index(topLeft.row, ci);\n                    end = this._grid.index(bottomRight.row, ci);\n                    for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                        value = value.clone(this._name(), row, ci);\n                        this._properties.set(property, index, index, value);\n                    }\n                }\n                return value;\n            },\n            _set: function (ref, name, value) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                var ci, start, end;\n                if (value && name == 'formula') {\n                    if (typeof value == 'string') {\n                        value = this._compileFormula(topLeft.row, topLeft.col, value);\n                    }\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'formula');\n                } else if (value && name == 'validation') {\n                    value = this._compileValidation(topLeft.row, topLeft.col, value);\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'validation');\n                } else {\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        start = this._grid.index(topLeft.row, ci);\n                        end = this._grid.index(bottomRight.row, ci);\n                        this._properties.set(name, start, end, value);\n                        if (name == 'formula') {\n                            this._properties.set('value', start, end, null);\n                        }\n                    }\n                }\n            },\n            _get: function (ref, name) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var index = this._grid.index(topLeft.row, topLeft.col);\n                return this._properties.get(name, index);\n            },\n            batch: function (callback, reason) {\n                var suspended = this.suspendChanges();\n                this.suspendChanges(true);\n                callback.call(this);\n                return this.suspendChanges(suspended).triggerChange(reason || { recalc: true });\n            },\n            _sortBy: function (ref, columns) {\n                var indices = null;\n                columns.forEach(function (column) {\n                    indices = this._sorter.sortBy(ref, column.index, this._properties.get('value'), column.ascending, indices);\n                }, this);\n                this._sort = {\n                    ref: ref,\n                    columns: columns\n                };\n                this._refreshFilter();\n                this.triggerChange({ recalc: true });\n            },\n            _refreshFilter: function () {\n                if (this._filter) {\n                    this._filterBy(this._filter.ref, this._filter.columns);\n                }\n            },\n            _filterBy: function (ref, columns) {\n                this.batch(function () {\n                    for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                        if (this._rows.hidden(ri)) {\n                            this._rows.unhide(ri);\n                        }\n                    }\n                    columns.forEach(function (column) {\n                        var columnRef = ref.resize({ top: 1 }).toColumn(column.index);\n                        var cells = [];\n                        if (columnRef === kendo.spreadsheet.NULLREF) {\n                            return;\n                        }\n                        this.forEach(columnRef, function (row, col, cell) {\n                            cell.row = row;\n                            cells.push(cell);\n                        });\n                        column.filter.prepare(cells);\n                        for (var ci = 0; ci < cells.length; ci++) {\n                            var cell = cells[ci];\n                            var value = column.filter.value(cell);\n                            if (column.filter.matches(value) === false) {\n                                this.hideRow(cell.row);\n                            }\n                        }\n                    }, this);\n                    this._filter = {\n                        ref: ref,\n                        columns: columns\n                    };\n                }, {\n                    layout: true,\n                    filter: true\n                });\n            },\n            filterColumn: function (ref) {\n                var filterRef = this.filter().ref;\n                return ref.toRangeRef().topLeft.col - filterRef.topLeft.col;\n            },\n            filter: function () {\n                return this._filter;\n            },\n            clearFilter: function (spec) {\n                this._clearFilter(spec instanceof Array ? spec : [spec]);\n            },\n            _clearFilter: function (indices) {\n                if (this._filter) {\n                    this.batch(function () {\n                        this._filter.columns = this._filter.columns.filter(function (column) {\n                            return indices.indexOf(column.index) < 0;\n                        });\n                        this._refreshFilter();\n                    }, {\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            getAxisState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState()\n                };\n            },\n            setAxisState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this.triggerChange({ layout: true });\n            },\n            getState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState(),\n                    mergedCells: this._mergedCells.map(function (cell) {\n                        return cell.clone();\n                    }),\n                    properties: this._properties.getState()\n                };\n            },\n            setState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this._mergedCells = state.mergedCells;\n                this._properties.setState(state.properties);\n                this.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            _merge: function (ref) {\n                var mergedCells = this._mergedCells;\n                var sheet = this;\n                var mergedRef;\n                this.batch(function () {\n                    mergedRef = ref.map(function (ref) {\n                        if (ref instanceof kendo.spreadsheet.CellRef) {\n                            return ref;\n                        }\n                        var currentRef = ref.toRangeRef().union(mergedCells, function (ref) {\n                            mergedCells.splice(mergedCells.indexOf(ref), 1);\n                        });\n                        var range = new Range(currentRef, sheet);\n                        var formula = range._get('formula');\n                        var value = range.value();\n                        var format = range.format();\n                        var background = range.background();\n                        range.value(null);\n                        range.format(null);\n                        range.background(null);\n                        var topLeft = new Range(currentRef.collapse(), sheet);\n                        if (formula) {\n                            topLeft._set('formula', formula);\n                        } else {\n                            topLeft.value(value);\n                        }\n                        topLeft.format(format);\n                        topLeft.background(background);\n                        mergedCells.push(currentRef);\n                        return currentRef;\n                    });\n                    var viewSelection = sheet._viewSelection;\n                    viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n                    viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n                }, {\n                    activeCell: true,\n                    selection: true\n                });\n                return mergedRef;\n            }\n        });\n        kendo.spreadsheet.Sheet = Sheet;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetsbar', [\n        'kendo.core',\n        'kendo.sortable'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var outerWidth = kendo._outerWidth;\n        var DOT = '.';\n        var EMPTYCHAR = ' ';\n        var sheetsBarClassNames = {\n            sheetsBarWrapper: 'k-widget k-header',\n            sheetsBarSheetsWrapper: 'k-tabstrip k-floatwrap k-tabstrip-bottom',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            sheetsBarAdd: 'k-spreadsheet-sheets-bar-add',\n            sheetsBarRemove: 'k-spreadsheet-sheets-remove',\n            sheetsBarItems: 'k-spreadsheet-sheets-items',\n            sheetsBarEditor: 'k-spreadsheet-sheets-editor',\n            sheetsBarScrollable: 'k-tabstrip-scrollable',\n            sheetsBarNext: 'k-tabstrip-next',\n            sheetsBarPrev: 'k-tabstrip-prev',\n            sheetsBarKItem: 'k-item k-state-default',\n            sheetsBarKActive: 'k-state-active k-state-tab-on-top',\n            sheetsBarKTextbox: 'k-textbox',\n            sheetsBarKLink: 'k-link',\n            sheetsBarKIcon: 'k-icon',\n            sheetsBarKFontIcon: 'k-icon',\n            sheetsBarKButton: 'k-button k-button-icon',\n            sheetsBarKButtonBare: 'k-button-bare',\n            sheetsBarKArrowW: 'k-i-arrow-60-left',\n            sheetsBarKArrowE: 'k-i-arrow-60-right',\n            sheetsBarKReset: 'k-reset k-tabstrip-items',\n            sheetsBarKIconX: 'k-i-close',\n            sheetsBarKSprite: 'k-sprite',\n            sheetsBarKIconPlus: 'k-i-plus',\n            sheetsBarHintWrapper: 'k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint',\n            sheetsBarKResetItems: 'k-reset k-tabstrip-items'\n        };\n        var SheetsBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                var classNames = SheetsBar.classNames;\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(classNames.sheetsBarWrapper);\n                this._openDialog = options.openDialog;\n                this._tree = new kendo.dom.Tree(element[0]);\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper([])\n                ]);\n                this._toggleScrollEvents(true);\n                this._createSortable();\n                this._sortable.bind('start', this._onSheetReorderStart.bind(this));\n                this._sortable.bind('end', this._onSheetReorderEnd.bind(this));\n                element.on('click', DOT + classNames.sheetsBarRemove, this._onSheetRemove.bind(this));\n                element.on('click', 'li', this._onSheetSelect.bind(this));\n                element.on('dblclick', 'li' + DOT + classNames.sheetsBarActive, this._createEditor.bind(this));\n                element.on('click', DOT + classNames.sheetsBarAdd, this._onAddSelect.bind(this));\n            },\n            options: {\n                name: 'SheetsBar',\n                scrollable: { distance: 200 }\n            },\n            events: [\n                'select',\n                'reorder',\n                'rename'\n            ],\n            _createEditor: function () {\n                if (this._editor) {\n                    return;\n                }\n                this._renderSheets(this._sheets, this._selectedIndex, true);\n                this._editor = this.element.find(kendo.format('input{0}{1}', DOT, SheetsBar.classNames.sheetsBarEditor)).focus().on('keydown', this._onEditorKeydown.bind(this)).on('blur', this._onEditorBlur.bind(this));\n            },\n            _destroyEditor: function (canceled) {\n                var newSheetName = canceled ? null : this._editor.val();\n                this._editor.off();\n                this._editor = null;\n                this._renderSheets(this._sheets, this._selectedIndex, false);\n                this._onSheetRename(newSheetName);\n            },\n            renderSheets: function (sheets, selectedIndex) {\n                if (!sheets || selectedIndex < 0) {\n                    return;\n                }\n                this._renderSheets(sheets, selectedIndex, false);\n            },\n            _renderSheets: function (sheets, selectedIndex, isInEditMode) {\n                var that = this;\n                var wrapperOffsetWidth;\n                var sheetsGroupScrollWidth;\n                var classNames = SheetsBar.classNames;\n                that._isRtl = kendo.support.isRtl(that.element);\n                that._sheets = sheets;\n                that._selectedIndex = selectedIndex;\n                that._renderHtml(isInEditMode, true);\n                if (!that._scrollableAllowed()) {\n                    return;\n                }\n                var sheetsWrapper = that._sheetsWrapper();\n                var scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                var scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                var gapWidth = 2;\n                var addButton = that.element.find(DOT + classNames.sheetsBarAdd);\n                var addButtonWidth = outerWidth(addButton) + addButton.position().left + gapWidth;\n                var scrollPrevButtonWidth = outerWidth(scrollPrevButton) + gapWidth;\n                var sheetsGroup = that._sheetsGroup();\n                scrollPrevButton.css({ left: addButtonWidth });\n                sheetsWrapper.addClass(classNames.sheetsBarScrollable + EMPTYCHAR + classNames.sheetsBarSheetsWrapper);\n                sheetsGroup.css({ marginLeft: addButtonWidth });\n                wrapperOffsetWidth = sheetsWrapper[0].offsetWidth;\n                sheetsGroupScrollWidth = sheetsGroup[0].scrollWidth;\n                if (sheetsGroupScrollWidth + addButtonWidth > wrapperOffsetWidth) {\n                    var scrollNextButtonRight = Math.ceil(kendo.parseFloat(scrollNextButton.css('right')));\n                    if (!that._scrollableModeActive) {\n                        that._nowScrollingSheets = false;\n                        that._scrollableModeActive = true;\n                    }\n                    sheetsGroup.css({\n                        marginLeft: scrollPrevButtonWidth + addButtonWidth,\n                        marginRight: outerWidth(scrollNextButton) + scrollNextButtonRight + gapWidth\n                    });\n                } else {\n                    if (that._scrollableModeActive && sheetsGroupScrollWidth <= wrapperOffsetWidth) {\n                        that._scrollableModeActive = false;\n                        sheetsGroup.css({\n                            marginLeft: addButtonWidth,\n                            marginRight: ''\n                        });\n                    } else {\n                        sheetsGroup.css({ marginLeft: addButtonWidth });\n                    }\n                }\n                that._toggleScrollButtons();\n            },\n            _toggleScrollButtons: function (toggle) {\n                var that = this;\n                var ul = that._sheetsGroup();\n                var wrapper = that._sheetsWrapper();\n                var scrollLeft = ul.scrollLeft();\n                var prev = wrapper.find(DOT + SheetsBar.classNames.sheetsBarPrev);\n                var next = wrapper.find(DOT + SheetsBar.classNames.sheetsBarNext);\n                if (toggle === false) {\n                    prev.toggle(false);\n                    next.toggle(false);\n                } else {\n                    prev.toggle(that._isRtl ? scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1 : scrollLeft !== 0);\n                    next.toggle(that._isRtl ? scrollLeft !== 0 : scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1);\n                }\n            },\n            _toggleScrollEvents: function (toggle) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n                var options = that.options;\n                var scrollPrevButton;\n                var scrollNextButton;\n                var sheetsWrapper = that._sheetsWrapper();\n                scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                if (toggle) {\n                    scrollPrevButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? 1 : -1));\n                    });\n                    scrollNextButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? -1 : 1));\n                    });\n                    scrollPrevButton.add(scrollNextButton).on('mouseup', function () {\n                        that._nowScrollingSheets = false;\n                    });\n                } else {\n                    scrollPrevButton.off();\n                    scrollNextButton.off();\n                }\n            },\n            _renderHtml: function (isInEditMode, renderScrollButtons) {\n                var idx;\n                var sheetElements = [];\n                var dom = kendo.dom;\n                var element = dom.element;\n                var sheets = this._sheets;\n                var selectedIndex = this._selectedIndex;\n                var classNames = SheetsBar.classNames;\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var sheet = sheets[idx];\n                    var isSelectedSheet = idx === selectedIndex;\n                    var attr = { className: classNames.sheetsBarKItem + EMPTYCHAR };\n                    var elementContent = [];\n                    if (isSelectedSheet) {\n                        attr.className += classNames.sheetsBarKActive + EMPTYCHAR + classNames.sheetsBarActive;\n                    } else {\n                        attr.className += classNames.sheetsBarInactive;\n                    }\n                    if (isSelectedSheet && isInEditMode) {\n                        elementContent.push(element('input', {\n                            type: 'text',\n                            value: sheet.name(),\n                            className: classNames.sheetsBarKTextbox + EMPTYCHAR + classNames.sheetsBarEditor,\n                            maxlength: 50\n                        }, []));\n                    } else {\n                        elementContent.push(element('span', {\n                            className: classNames.sheetsBarKLink,\n                            title: sheet.name()\n                        }, [dom.text(sheet.name())]));\n                        if (sheets.length > 1) {\n                            var deleteIcon = element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconX }, []);\n                            elementContent.push(element('span', { className: classNames.sheetsBarKLink + EMPTYCHAR + classNames.sheetsBarRemove }, [deleteIcon]));\n                        }\n                    }\n                    sheetElements.push(element('li', attr, elementContent));\n                }\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper(sheetElements, renderScrollButtons)\n                ]);\n            },\n            _createSheetsWrapper: function (sheetElements, renderScrollButtons) {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                var childrenElements = [element('ul', { className: classNames.sheetsBarKReset }, sheetElements)];\n                renderScrollButtons = true;\n                if (renderScrollButtons) {\n                    var baseButtonClass = classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonBare + EMPTYCHAR;\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarPrev }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowW }, [])]));\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarNext }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowE }, [])]));\n                }\n                return element('div', { className: classNames.sheetsBarItems }, childrenElements);\n            },\n            _createSortable: function () {\n                var classNames = SheetsBar.classNames;\n                this._sortable = new kendo.ui.Sortable(this.element, {\n                    filter: kendo.format('ul li.{0},ul li.{1}', classNames.sheetsBarActive, classNames.sheetsBarInactive),\n                    container: DOT + classNames.sheetsBarItems,\n                    axis: 'x',\n                    animation: false,\n                    ignore: 'input',\n                    end: function () {\n                        if (this.draggable.hint) {\n                            this.draggable.hint.remove();\n                        }\n                    },\n                    hint: function (element) {\n                        var hint = $(element).clone();\n                        return hint.wrap('<div class=\\'' + classNames.sheetsBarHintWrapper + '\\'><ul class=\\'' + classNames.sheetsBarKResetItems + '\\'></ul></div>').closest('div');\n                    }\n                });\n            },\n            _onEditorKeydown: function (e) {\n                if (this._editor) {\n                    if (e.which === 13) {\n                        this._destroyEditor();\n                    }\n                    if (e.which === 27) {\n                        this._destroyEditor(true);\n                    }\n                }\n            },\n            _onEditorBlur: function () {\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n            },\n            _onSheetReorderEnd: function (e) {\n                e.preventDefault();\n                this.trigger('reorder', {\n                    oldIndex: e.oldIndex,\n                    newIndex: e.newIndex\n                });\n            },\n            _onSheetReorderStart: function (e) {\n                if (this._editor) {\n                    e.preventDefault();\n                }\n            },\n            _onSheetRemove: function (e) {\n                var removedSheetName = $(e.target).closest('li').text();\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n                var closeCallback = function (e) {\n                    var dlg = e.sender;\n                    if (dlg.isConfirmed()) {\n                        this.trigger('remove', {\n                            name: removedSheetName,\n                            confirmation: true\n                        });\n                    }\n                }.bind(this);\n                this._openDialog('confirmation', { close: closeCallback });\n            },\n            _onSheetSelect: function (e) {\n                var selectedSheetText = $(e.target).text();\n                if ($(e.target).is(DOT + SheetsBar.classNames.sheetsBarEditor) || !selectedSheetText) {\n                    e.preventDefault();\n                    return;\n                }\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n                this._scrollSheetsToItem($(e.target).closest('li'));\n                this.trigger('select', {\n                    name: selectedSheetText,\n                    isAddButton: false\n                });\n            },\n            _onSheetRename: function (newSheetName) {\n                if (this._sheets[this._selectedIndex].name() === newSheetName || newSheetName === null) {\n                    return;\n                }\n                this.trigger('rename', {\n                    name: newSheetName,\n                    sheetIndex: this._selectedIndex\n                });\n            },\n            _onAddSelect: function () {\n                this.trigger('select', { isAddButton: true });\n            },\n            _addButton: function () {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                return element('a', { className: classNames.sheetsBarAdd + EMPTYCHAR + classNames.sheetsBarKButton }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconPlus }, [])]);\n            },\n            destroy: function () {\n                this._sortable.destroy();\n            },\n            _scrollableAllowed: function () {\n                var options = this.options;\n                return options.scrollable && !isNaN(options.scrollable.distance);\n            },\n            _scrollSheetsToItem: function (item) {\n                var that = this;\n                if (!that._scrollableModeActive) {\n                    return;\n                }\n                var sheetsGroup = that._sheetsGroup();\n                var currentScrollOffset = sheetsGroup.scrollLeft();\n                var itemWidth = outerWidth(item);\n                var itemOffset = that._isRtl ? item.position().left : item.position().left - sheetsGroup.children().first().position().left;\n                var sheetsGroupWidth = sheetsGroup[0].offsetWidth;\n                var sheetsGroupPadding = Math.ceil(parseFloat(sheetsGroup.css('padding-left')));\n                var itemPosition;\n                if (that._isRtl) {\n                    if (itemOffset < 0) {\n                        itemPosition = currentScrollOffset + itemOffset - (sheetsGroupWidth - currentScrollOffset) - sheetsGroupPadding;\n                    } else if (itemOffset + itemWidth > sheetsGroupWidth) {\n                        itemPosition = currentScrollOffset + itemOffset - itemWidth + sheetsGroupPadding * 2;\n                    }\n                } else {\n                    if (currentScrollOffset + sheetsGroupWidth < itemOffset + itemWidth) {\n                        itemPosition = itemOffset + itemWidth - sheetsGroupWidth + sheetsGroupPadding * 2;\n                    } else if (currentScrollOffset > itemOffset) {\n                        itemPosition = itemOffset - sheetsGroupPadding;\n                    }\n                }\n                sheetsGroup.finish().animate({ 'scrollLeft': itemPosition }, 'fast', 'linear', function () {\n                    that._toggleScrollButtons();\n                });\n            },\n            _sheetsGroup: function () {\n                return this._sheetsWrapper().children('ul');\n            },\n            _sheetsWrapper: function () {\n                return this.element.find(DOT + SheetsBar.classNames.sheetsBarItems);\n            },\n            _scrollSheetsByDelta: function (delta) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var scrLeft = sheetsGroup.scrollLeft();\n                sheetsGroup.finish().animate({ 'scrollLeft': scrLeft + delta }, 'fast', 'linear', function () {\n                    if (that._nowScrollingSheets) {\n                        that._scrollSheetsByDelta(delta);\n                    } else {\n                        that._toggleScrollButtons();\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.SheetsBar = SheetsBar;\n        $.extend(true, SheetsBar, { classNames: sheetsBarClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/calc', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var Ref = spreadsheet.Ref;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var NameRef = spreadsheet.NameRef;\n    var exports = spreadsheet.calc;\n    var runtime = exports.runtime;\n    var OPERATORS = Object.create(null);\n    var ParseError = kendo.Class.extend({\n        init: function ParseError(message, pos) {\n            this.message = message;\n            this.pos = pos;\n        },\n        toString: function () {\n            return this.message;\n        }\n    });\n    (function (ops) {\n        ops.forEach(function (cls, i) {\n            cls.forEach(function (op) {\n                OPERATORS[op] = ops.length - i;\n            });\n        });\n    }([\n        [':'],\n        [' '],\n        [','],\n        ['%'],\n        ['^'],\n        [\n            '*',\n            '/'\n        ],\n        [\n            '+',\n            '-'\n        ],\n        ['&'],\n        [\n            '=',\n            '<',\n            '>',\n            '<=',\n            '>=',\n            '<>'\n        ]\n    ]));\n    var TRUE = {\n        type: 'bool',\n        value: true\n    };\n    var FALSE = {\n        type: 'bool',\n        value: false\n    };\n    function getcol(str) {\n        str = str.toUpperCase();\n        for (var col = 0, i = 0; i < str.length; ++i) {\n            col = col * 26 + str.charCodeAt(i) - 64;\n        }\n        return col - 1;\n    }\n    function getrow(str) {\n        return parseInt(str, 10) - 1;\n    }\n    function parseReference(name, noThrow) {\n        if (name.toLowerCase() == '#sheet') {\n            return spreadsheet.SHEETREF;\n        }\n        OUT: {\n            var m;\n            if (m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name)) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row < 1048576 && col < 16384) {\n                    return new CellRef(getrow(m[4]), getcol(m[2]));\n                }\n                break OUT;\n            }\n            var stream = TokenStream(name, {});\n            var a = [];\n            while (true) {\n                var ref = stream.next();\n                if (ref instanceof CellRef) {\n                    ref.rel = 0;\n                } else if (ref instanceof RangeRef) {\n                    ref.topLeft.rel = 0;\n                    ref.bottomRight.rel = 0;\n                } else {\n                    break OUT;\n                }\n                a.push(ref);\n                if (stream.eof()) {\n                    break;\n                }\n                if (!stream.is('op', ',')) {\n                    break OUT;\n                }\n                stream.next();\n            }\n            return a.length == 1 ? a[0] : new spreadsheet.UnionRef(a);\n        }\n        if (!noThrow) {\n            throw new Error('Cannot parse reference: ' + name);\n        }\n    }\n    function parseFormula(sheet, row, col, input) {\n        var refs = [];\n        input = TokenStream(input, {\n            row: row,\n            col: col\n        });\n        var is = input.is;\n        return {\n            type: 'exp',\n            ast: parseExpression(true),\n            refs: refs,\n            sheet: sheet,\n            row: row,\n            col: col\n        };\n        function addReference(ref) {\n            ref.index = refs.length;\n            refs.push(ref);\n            return ref;\n        }\n        function skip(type, value, allowEOF) {\n            if (is(type, value)) {\n                return input.next();\n            } else {\n                var tok = input.peek();\n                if (tok) {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB but found ' + tok.type + ' \\xAB' + tok.value + '\\xBB');\n                } else if (!allowEOF) {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB');\n                }\n            }\n        }\n        function parseExpression(commas) {\n            return maybeBinary(maybeIntersect(parseAtom(commas)), 0, commas);\n        }\n        function parseSymbol(tok) {\n            if (tok.upper == 'TRUE' || tok.upper == 'FALSE') {\n                return tok.upper == 'TRUE' ? TRUE : FALSE;\n            }\n            return addReference(new NameRef(tok.value));\n        }\n        function parseFuncall() {\n            var fname = input.next();\n            fname = fname.value;\n            skip('punc', '(');\n            var args = [];\n            while (1) {\n                if (is('punc', ')')) {\n                    break;\n                }\n                if (is('op', ',')) {\n                    args.push({ type: 'null' });\n                    input.next();\n                    continue;\n                }\n                args.push(parseExpression(false));\n                if (input.eof() || is('punc', ')')) {\n                    break;\n                }\n                skip('op', ',');\n            }\n            skip('punc', ')', true);\n            return {\n                type: 'func',\n                func: fname,\n                args: args\n            };\n        }\n        function fixReference(ref) {\n            if (!ref.hasSheet()) {\n                ref.setSheet(sheet);\n            }\n            return addReference(ref);\n        }\n        function parseAtom(commas) {\n            var exp;\n            if (is('ref')) {\n                exp = fixReference(input.next());\n            } else if (is('func')) {\n                exp = parseFuncall();\n            } else if (is('punc', '(')) {\n                input.next();\n                exp = parseExpression(true);\n                skip('punc', ')', true);\n            } else if (is('punc', '{')) {\n                input.next();\n                exp = parseArray();\n                skip('punc', '}', true);\n            } else if (is('num') || is('str') || is('error')) {\n                exp = input.next();\n            } else if (is('sym')) {\n                exp = parseSymbol(input.next());\n            } else if (is('op', '+') || is('op', '-')) {\n                exp = {\n                    type: 'prefix',\n                    op: input.next().value,\n                    exp: parseAtom(commas)\n                };\n            } else if (!input.peek()) {\n                input.croak('Incomplete expression');\n            } else if (is('punc', '[')) {\n                input.croak('External reference not supported');\n            } else {\n                input.croak('Parse error');\n            }\n            return maybePercent(exp);\n        }\n        function parseArray() {\n            var row = [], value = [row], first = true;\n            while (!input.eof() && !is('punc', '}')) {\n                if (first) {\n                    first = false;\n                } else if (is('punc', ';')) {\n                    value.push(row = []);\n                    input.next();\n                } else {\n                    skip('op', ',');\n                }\n                row.push(parseExpression(false));\n            }\n            return {\n                type: 'matrix',\n                value: value\n            };\n        }\n        function maybeIntersect(exp) {\n            if (is('punc', '(') || is('ref') || is('num') || is('func')) {\n                return {\n                    type: 'binary',\n                    op: ' ',\n                    left: exp,\n                    right: parseExpression(false)\n                };\n            } else {\n                return exp;\n            }\n        }\n        function maybePercent(exp) {\n            if (is('op', '%')) {\n                input.next();\n                return maybePercent({\n                    type: 'postfix',\n                    op: '%',\n                    exp: exp\n                });\n            } else {\n                return exp;\n            }\n        }\n        function maybeBinary(left, my_prec, commas) {\n            var tok = is('op');\n            if (tok && (commas || tok.value != ',')) {\n                var his_prec = OPERATORS[tok.value];\n                if (his_prec > my_prec) {\n                    input.next();\n                    var right = maybeBinary(parseAtom(commas), his_prec, commas);\n                    return maybeBinary({\n                        type: 'binary',\n                        op: tok.value,\n                        left: left,\n                        right: right\n                    }, my_prec, commas);\n                }\n            }\n            return left;\n        }\n    }\n    function parseNameDefinition(name, def) {\n        var nameRef = parseFormula(null, 0, 0, name);\n        if (!(nameRef.ast instanceof NameRef)) {\n            throw new ParseError('Invalid name: ' + name);\n        }\n        nameRef = nameRef.ast;\n        if (!(def instanceof Ref)) {\n            var defAST = parseFormula(nameRef.sheet, 0, 0, def);\n            if (defAST.ast instanceof Ref) {\n                def = defAST.ast;\n            } else if (/^(?:str|num|bool|error)$/.test(defAST.ast.type)) {\n                def = defAST.ast.value;\n            } else {\n                def = makeFormula(defAST);\n            }\n        }\n        return {\n            name: nameRef,\n            value: def\n        };\n    }\n    function makePrinter(exp) {\n        return makeClosure('function(row, col, mod){return(' + print(exp.ast, exp, 0) + ')}');\n        function print(node, parent, prec) {\n            switch (node.type) {\n            case 'num':\n            case 'bool':\n                return JSON.stringify(node.value);\n            case 'error':\n                return JSON.stringify('#' + node.value);\n            case 'str':\n                return JSON.stringify(JSON.stringify(node.value));\n            case 'ref':\n                return 'this.refs[' + node.index + '].print(row, col, mod)';\n            case 'prefix':\n                return withParens(function () {\n                    return JSON.stringify(node.op) + ' + ' + print(node.exp, node, OPERATORS[node.op]);\n                });\n            case 'postfix':\n                return withParens(function () {\n                    return print(node.exp, node, OPERATORS[node.op]) + ' + ' + JSON.stringify(node.op);\n                });\n            case 'binary':\n                return withParens(function () {\n                    var left = parenthesize(print(node.left, node, OPERATORS[node.op]), node.left instanceof NameRef && node.op == ':');\n                    var right = parenthesize(print(node.right, node, OPERATORS[node.op]), node.right instanceof NameRef && node.op == ':');\n                    return left + ' + ' + JSON.stringify(node.op) + ' + ' + right;\n                });\n            case 'func':\n                return JSON.stringify(node.func + '(') + ' + ' + (node.args.length > 0 ? node.args.map(function (arg) {\n                    return print(arg, node, 0);\n                }).join(' + \\', \\' + ') : '\\'\\'') + ' + \\')\\'';\n            case 'matrix':\n                return '\\'{ \\' + ' + node.value.map(function (el) {\n                    return el.map(function (el) {\n                        return print(el, node, 0);\n                    }).join(' + \\', \\' + ');\n                }).join(' + \\'; \\' + ') + '+ \\' }\\'';\n            case 'null':\n                return '\\'\\'';\n            }\n            throw new Error('Cannot make printer for node ' + node.type);\n            function withParens(f) {\n                var op = node.op;\n                var needParens = OPERATORS[op] < prec || !prec && op == ',' || parent.type == 'prefix' && prec == OPERATORS[op] && parent.op == '-' || parent.type == 'binary' && prec == OPERATORS[op] && node === parent.right;\n                return parenthesize(f(), needParens);\n            }\n        }\n        function parenthesize(code, cond) {\n            return cond ? '\\'(\\' + ' + code + ' + \\')\\'' : code;\n        }\n    }\n    function toCPS(ast, k) {\n        var GENSYM = 0;\n        return cps(ast, k);\n        function cps(node, k) {\n            switch (node.type) {\n            case 'ref':\n                return cpsRef(node, k);\n            case 'num':\n            case 'str':\n            case 'null':\n            case 'error':\n            case 'bool':\n                return cpsAtom(node, k);\n            case 'prefix':\n            case 'postfix':\n                return cpsUnary(node, k);\n            case 'binary':\n                return cpsBinary(node, k);\n            case 'func':\n                return cpsFunc(node, k);\n            case 'lambda':\n                return cpsLambda(node, k);\n            case 'matrix':\n                return cpsMatrix(node.value, k, true);\n            }\n            throw new Error('Cannot CPS ' + node.type);\n        }\n        function cpsRef(node, k) {\n            return node.ref == 'name' ? cpsNameRef(node, k) : cpsAtom(node, k);\n        }\n        function cpsAtom(node, k) {\n            return k(node);\n        }\n        function cpsNameRef(node, k) {\n            return {\n                type: 'func',\n                func: ',getname',\n                args: [\n                    makeContinuation(k),\n                    node\n                ]\n            };\n        }\n        function cpsUnary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'unary' + node.op,\n                args: [node.exp]\n            }, k);\n        }\n        function cpsBinary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'binary' + node.op,\n                args: [\n                    node.left,\n                    node.right\n                ]\n            }, k);\n        }\n        function cpsIf(co, th, el, k) {\n            return cps(co, function (co) {\n                var rest = makeContinuation(k);\n                var thenK = gensym('T');\n                var elseK = gensym('E');\n                return {\n                    type: 'func',\n                    func: 'if',\n                    args: [\n                        rest,\n                        co,\n                        {\n                            type: 'lambda',\n                            vars: [thenK],\n                            body: cps(th || TRUE, function (th) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: thenK\n                                    },\n                                    args: [th]\n                                };\n                            })\n                        },\n                        {\n                            type: 'lambda',\n                            vars: [elseK],\n                            body: cps(el || FALSE, function (el) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: elseK\n                                    },\n                                    args: [el]\n                                };\n                            })\n                        }\n                    ]\n                };\n            });\n        }\n        function cpsAnd(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(TRUE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    {\n                        type: 'func',\n                        func: 'AND',\n                        args: args.slice(1)\n                    },\n                    FALSE\n                ]\n            }, k);\n        }\n        function cpsOr(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(FALSE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    TRUE,\n                    {\n                        type: 'func',\n                        func: 'OR',\n                        args: args.slice(1)\n                    }\n                ]\n            }, k);\n        }\n        function cpsFunc(node, k) {\n            switch (node.func.toLowerCase()) {\n            case 'if':\n                return cpsIf(node.args[0], node.args[1], node.args[2], k);\n            case 'and':\n                return cpsAnd(node.args, k);\n            case 'or':\n                return cpsOr(node.args, k);\n            case 'true':\n                return k(TRUE);\n            case 'false':\n                return k(FALSE);\n            }\n            return function loop(args, i) {\n                if (i == node.args.length) {\n                    return {\n                        type: 'func',\n                        func: node.func,\n                        args: args\n                    };\n                } else {\n                    return cps(node.args[i], function (value) {\n                        return loop(args.concat([value]), i + 1);\n                    });\n                }\n            }([makeContinuation(k)], 0);\n        }\n        function cpsLambda(node, k) {\n            var cont = gensym('K');\n            var body = cps(node.body, function (body) {\n                return {\n                    type: 'call',\n                    func: {\n                        type: 'var',\n                        value: cont\n                    },\n                    args: [body]\n                };\n            });\n            return k({\n                type: 'lambda',\n                vars: [cont].concat(node.vars),\n                body: body\n            });\n        }\n        function cpsMatrix(elements, k, isMatrix) {\n            var a = [];\n            return function loop(i) {\n                if (i == elements.length) {\n                    return k({\n                        type: 'matrix',\n                        value: a\n                    });\n                } else {\n                    return (isMatrix ? cpsMatrix : cps)(elements[i], function (val) {\n                        a[i] = val;\n                        return loop(i + 1);\n                    });\n                }\n            }(0);\n        }\n        function makeContinuation(k) {\n            var cont = gensym('R');\n            return {\n                type: 'lambda',\n                vars: [cont],\n                body: k({\n                    type: 'var',\n                    name: cont\n                })\n            };\n        }\n        function gensym(name) {\n            if (!name) {\n                name = '';\n            }\n            name = '_' + name;\n            return name + ++GENSYM;\n        }\n    }\n    var makeClosure = function (cache) {\n        return function (code) {\n            var f = cache[code];\n            if (!f) {\n                f = cache[code] = new Function('\\'use strict\\';return(' + code + ')')();\n            }\n            return f;\n        };\n    }(Object.create(null));\n    var FORMULA_CACHE = Object.create(null);\n    function makeFormula(exp) {\n        var printer = makePrinter(exp);\n        var hash = printer.call(exp);\n        var formula = FORMULA_CACHE[hash];\n        if (formula) {\n            return formula.clone(exp.sheet, exp.row, exp.col);\n        }\n        var code = js(toCPS(exp.ast, function (ret) {\n            return {\n                type: 'return',\n                value: ret\n            };\n        }));\n        code = [\n            'function(){',\n            'var context = this, refs = context.formula.absrefs',\n            code,\n            '}'\n        ].join(';\\n');\n        formula = new runtime.Formula(exp.refs, makeClosure(code), printer, exp.sheet, exp.row, exp.col);\n        FORMULA_CACHE[hash] = formula;\n        return formula;\n        function js(node) {\n            var type = node.type;\n            if (type == 'num') {\n                return node.value + '';\n            } else if (type == 'str') {\n                return JSON.stringify(node.value);\n            } else if (type == 'error') {\n                return 'context.error(' + JSON.stringify(node.value) + ')';\n            } else if (type == 'return') {\n                return 'context.resolve(' + js(node.value) + ')';\n            } else if (type == 'func') {\n                return 'context.func(' + JSON.stringify(node.func) + ', ' + js(node.args[0]) + ', ' + jsArray(node.args.slice(1)) + ')';\n            } else if (type == 'call') {\n                return js(node.func) + '(' + node.args.map(js).join(', ') + ')';\n            } else if (type == 'ref') {\n                return 'refs[' + node.index + ']';\n            } else if (type == 'bool') {\n                return '' + node.value;\n            } else if (type == 'if') {\n                return '(context.bool(' + js(node.co) + ') ? ' + js(node.th) + ' : ' + js(node.el) + ')';\n            } else if (type == 'lambda') {\n                return '(function(' + node.vars.join(', ') + '){ return(' + js(node.body) + ') })';\n            } else if (type == 'var') {\n                return node.name;\n            } else if (type == 'matrix') {\n                return jsArray(node.value);\n            } else if (type == 'null') {\n                return 'null';\n            } else {\n                throw new Error('Cannot compile expression ' + type);\n            }\n        }\n        function jsArray(a) {\n            return '[ ' + a.map(js).join(', ') + ' ]';\n        }\n    }\n    function identity(x) {\n        return x;\n    }\n    function TokenStream(input, options) {\n        input = RawTokenStream(InputStream(input), options);\n        var ahead = input.ahead;\n        var skip = input.skip;\n        var token = null;\n        var fixCell = options.row != null && options.col != null ? function (cell) {\n            if (cell.rel & 1) {\n                cell.col -= options.col;\n            }\n            if (cell.rel & 2) {\n                cell.row -= options.row;\n            }\n            return cell;\n        } : identity;\n        var addPos = options.forEditor ? function (thing, startToken, endToken) {\n            thing.begin = startToken.begin;\n            thing.end = endToken.end;\n            return thing;\n        } : identity;\n        return {\n            peek: peek,\n            next: next,\n            croak: input.croak,\n            eof: input.eof,\n            is: is\n        };\n        function is(type, value) {\n            var tok = peek();\n            return tok != null && (type == null || tok.type === type) && (value == null || tok.value === value) ? tok : null;\n        }\n        function peek() {\n            if (token == null) {\n                token = readNext();\n            }\n            return token;\n        }\n        function next() {\n            if (token != null) {\n                var tmp = token;\n                token = null;\n                return tmp;\n            }\n            return readNext();\n        }\n        function readNext() {\n            var ret;\n            var t = input.peek();\n            if (t) {\n                if (t.type == 'sym' || t.type == 'rc' || t.type == 'num') {\n                    ret = ahead(8, refRange3D) || ahead(6, refCell3D) || ahead(6, refSheetRange) || ahead(4, refSheetCell) || ahead(4, refRange) || ahead(2, refCell) || ahead(2, funcall);\n                }\n                if (!ret) {\n                    ret = input.next();\n                }\n            }\n            return ret;\n        }\n        function toCell(tok, isFirst) {\n            if (tok.type == 'rc') {\n                if (tok.rel && !options.forEditor && (options.row == null || options.col == null)) {\n                    input.croak('Cannot read relative cell in RC notation');\n                }\n                return new CellRef(tok.row, tok.col, tok.rel);\n            }\n            if (tok.type == 'num') {\n                if (tok.value <= 1048577) {\n                    return fixCell(new CellRef(getrow(tok.value), isFirst ? -Infinity : +Infinity, 2));\n                } else {\n                    return null;\n                }\n            }\n            var name = tok.value;\n            var m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name);\n            if (m) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row <= 1048576 && col <= 16383) {\n                    return fixCell(new CellRef(getrow(m[4]), getcol(m[2]), (m[1] ? 0 : 1) | (m[3] ? 0 : 2)));\n                } else {\n                    return null;\n                }\n            }\n            var abs = name.charAt(0) == '$';\n            if (abs) {\n                name = name.substr(1);\n            }\n            if (/^\\d+$/.test(name)) {\n                var row = getrow(name);\n                if (row <= 1048576) {\n                    return fixCell(new CellRef(getrow(name), isFirst ? -Infinity : +Infinity, abs ? 0 : 2));\n                }\n            } else {\n                var col = getcol(name);\n                if (col <= 16383) {\n                    return fixCell(new CellRef(isFirst ? -Infinity : +Infinity, getcol(name), abs ? 0 : 1));\n                }\n            }\n        }\n        function refRange3D(a, b, c, d, e, f, g, h) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && f.type == 'op' && f.value == ':' && (g.type == 'sym' || g.type == 'rc' || g.type == 'num' && g.value == g.value | 0) && g.type == e.type && !(h.type == 'punc' && h.value == '(' && !g.space)) {\n                var tl = toCell(e, true), br = toCell(g, false);\n                if (tl && br) {\n                    skip(7);\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, g);\n                }\n            }\n        }\n        function refCell3D(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(e);\n                if (tl) {\n                    skip(5);\n                    var br = tl.clone();\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetRange(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && d.type == 'op' && d.value == ':' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(c, true), br = toCell(e, false);\n                if (tl && br) {\n                    skip(5);\n                    return addPos(new RangeRef(tl, br).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetCell(a, b, c, d) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                skip(3);\n                var x = toCell(c);\n                if (!x || !isFinite(x.row)) {\n                    x = new NameRef(c.value);\n                }\n                return addPos(x.setSheet(a.value, true), a, c);\n            }\n        }\n        function refRange(a, b, c, d) {\n            if ((a.type == 'sym' || a.type == 'rc' || a.type == 'num' && a.value == a.value | 0) && (b.type == 'op' && b.value == ':') && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                var tl = toCell(a, true), br = toCell(c, false);\n                if (tl && br) {\n                    skip(3);\n                    return addPos(new RangeRef(tl, br), a, c);\n                }\n            }\n        }\n        function refCell(a, b) {\n            if ((a.type == 'sym' || a.type == 'rc') && !(b.type == 'punc' && b.value == '(' && !a.space)) {\n                var x = toCell(a);\n                if (x && isFinite(x.row) && isFinite(x.col)) {\n                    skip(1);\n                    return addPos(x, a, a);\n                }\n            }\n        }\n        function funcall(a, b) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '(' && !a.space) {\n                a.type = 'func';\n                skip(1);\n                return a;\n            }\n        }\n    }\n    function isWhitespace(ch) {\n        return ' \\t\\n\\xA0\\u200B'.indexOf(ch) >= 0;\n    }\n    function RawTokenStream(input, options) {\n        var tokens = [], index = 0;\n        var readWhile = input.readWhile;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: input.croak,\n            ahead: ahead,\n            skip: skip\n        };\n        function isDigit(ch) {\n            return /[0-9]/i.test(ch);\n        }\n        function isIdStart(ch) {\n            return /[a-z$_]/i.test(ch) || util.isUnicodeLetter(ch);\n        }\n        function isId(ch) {\n            return isIdStart(ch) || isDigit(ch) || ch == '.';\n        }\n        function isOpChar(ch) {\n            return ch in OPERATORS;\n        }\n        function isPunc(ch) {\n            return '!;(){}[]'.indexOf(ch) >= 0;\n        }\n        function readNumber() {\n            var has_dot = false;\n            var number = readWhile(function (ch) {\n                if (ch == '.') {\n                    if (has_dot) {\n                        return false;\n                    }\n                    has_dot = true;\n                    return true;\n                }\n                return isDigit(ch);\n            });\n            return {\n                type: 'num',\n                value: parseFloat(number)\n            };\n        }\n        function symbol(id, quote) {\n            return {\n                type: 'sym',\n                value: id,\n                upper: id.toUpperCase(),\n                space: isWhitespace(input.peek()),\n                quote: quote\n            };\n        }\n        function getRC(a, b, c) {\n            if (!a && !b && !c) {\n                return null;\n            }\n            if (!a && !c || a && c) {\n                var num = b ? parseInt(b, 10) : 0;\n                return a ? num : num - 1;\n            }\n        }\n        function readSymbol() {\n            var m = input.lookingAt(/^R(\\[)?(-?[0-9]+)?(\\])?C(\\[)?(-?[0-9]+)?(\\])?/i);\n            if (m) {\n                var row = getRC(m[1], m[2], m[3]);\n                var col = getRC(m[4], m[5], m[6]);\n                if (row != null && col != null) {\n                    input.skip(m);\n                    return {\n                        type: 'rc',\n                        row: row,\n                        col: col,\n                        rel: (m[4] || !(m[4] || m[5] || m[6]) ? 1 : 0) | (m[1] || !(m[1] || m[2] || m[3]) ? 2 : 0)\n                    };\n                }\n            }\n            return symbol(readWhile(isId));\n        }\n        function readString() {\n            input.next();\n            return {\n                type: 'str',\n                value: input.readEscaped('\"')\n            };\n        }\n        function readSheetName() {\n            input.next();\n            return symbol(input.readEscaped('\\''), true);\n        }\n        function readOperator() {\n            return {\n                type: 'op',\n                value: readWhile(function (ch, op) {\n                    return op + ch in OPERATORS;\n                })\n            };\n        }\n        function readPunc() {\n            return {\n                type: 'punc',\n                value: input.next()\n            };\n        }\n        function readNext() {\n            if (input.eof()) {\n                return null;\n            }\n            var ch = input.peek(), m;\n            if (ch == '\"') {\n                return readString();\n            }\n            if (ch == '\\'') {\n                return readSheetName();\n            }\n            if (isDigit(ch) || ch == '.') {\n                return readNumber();\n            }\n            if (isIdStart(ch)) {\n                return readSymbol();\n            }\n            if (isOpChar(ch)) {\n                return readOperator();\n            }\n            if (isPunc(ch)) {\n                return readPunc();\n            }\n            if (m = input.lookingAt(/^#([a-z\\/]+)[?!]?/i)) {\n                input.skip(m);\n                return {\n                    type: 'error',\n                    value: m[1]\n                };\n            }\n            if (!options.forEditor) {\n                input.croak('Can\\'t handle character: ' + ch);\n            }\n            return {\n                type: 'error',\n                value: input.next()\n            };\n        }\n        function peek() {\n            while (tokens.length <= index) {\n                readWhile(isWhitespace);\n                var begin = input.pos();\n                var tok = readNext();\n                if (options.forEditor && tok) {\n                    tok.begin = begin;\n                    tok.end = input.pos();\n                }\n                tokens.push(tok);\n            }\n            return tokens[index];\n        }\n        function next() {\n            var tok = peek();\n            if (tok) {\n                index++;\n            }\n            return tok;\n        }\n        function ahead(n, f) {\n            var pos = index, a = [];\n            while (n-- > 0) {\n                a.push(next() || EOF);\n            }\n            index = pos;\n            return f.apply(a, a);\n        }\n        function skip(n) {\n            index += n;\n        }\n        function eof() {\n            return peek() == null;\n        }\n    }\n    var EOF = { type: 'eof' };\n    function InputStream(input) {\n        var pos = 0, line = 1, col = 0;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: croak,\n            readWhile: readWhile,\n            readEscaped: readEscaped,\n            lookingAt: lookingAt,\n            skip: skip,\n            forward: forward,\n            pos: location\n        };\n        function location() {\n            return pos;\n        }\n        function next() {\n            var ch = input.charAt(pos++);\n            if (ch == '\\n') {\n                line++;\n                col = 0;\n            } else {\n                col++;\n            }\n            return ch;\n        }\n        function peek() {\n            return input.charAt(pos);\n        }\n        function eof() {\n            return peek() === '';\n        }\n        function croak(msg) {\n            throw new ParseError(msg + ' (input: ' + input + ')', pos);\n        }\n        function skip(ch) {\n            if (typeof ch == 'string') {\n                if (input.substr(pos, ch.length) != ch) {\n                    croak('Expected ' + ch);\n                }\n                forward(ch.length);\n            } else if (ch instanceof RegExp) {\n                var m = ch.exec(input.substr(pos));\n                if (m) {\n                    forward(m[0].length);\n                    return m;\n                }\n            } else {\n                forward(ch[0].length);\n            }\n        }\n        function forward(n) {\n            while (n-- > 0) {\n                next();\n            }\n        }\n        function readEscaped(end) {\n            var escaped = false, str = '';\n            while (!eof()) {\n                var ch = next();\n                if (escaped) {\n                    str += ch;\n                    escaped = false;\n                } else if (ch == '\\\\') {\n                    escaped = true;\n                } else if (ch == end) {\n                    break;\n                } else {\n                    str += ch;\n                }\n            }\n            return str;\n        }\n        function readWhile(predicate) {\n            var str = '';\n            while (!eof() && predicate(peek(), str)) {\n                str += next();\n            }\n            return str;\n        }\n        function lookingAt(rx) {\n            return rx.exec(input.substr(pos));\n        }\n    }\n    var FORMAT_PARSERS = [];\n    var registerFormatParser = exports.registerFormatParser = function (p) {\n        FORMAT_PARSERS.push(p);\n    };\n    exports.parse = function (sheet, row, col, input) {\n        if (input instanceof Date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(input)\n            };\n        }\n        if (typeof input == 'number') {\n            return {\n                type: 'number',\n                value: input\n            };\n        }\n        if (typeof input == 'boolean') {\n            return {\n                type: 'boolean',\n                value: input\n            };\n        }\n        input += '';\n        if (/^'/.test(input)) {\n            return {\n                type: 'string',\n                value: input.substr(1)\n            };\n        }\n        if (/^[0-9.]+%$/.test(input)) {\n            var str = input.substr(0, input.length - 1);\n            var num = parseFloat(str);\n            if (!isNaN(num) && num == str) {\n                return {\n                    type: 'percent',\n                    value: num / 100\n                };\n            }\n        }\n        if (/^=/.test(input)) {\n            input = input.substr(1);\n            if (/\\S/.test(input)) {\n                return parseFormula(sheet, row, col, input);\n            } else {\n                return {\n                    type: 'string',\n                    value: '=' + input\n                };\n            }\n        }\n        for (var i = 0; i < FORMAT_PARSERS.length; ++i) {\n            var result = FORMAT_PARSERS[i](input);\n            if (result) {\n                return result;\n            }\n        }\n        if (input.toLowerCase() == 'true') {\n            return {\n                type: 'boolean',\n                value: true\n            };\n        }\n        if (input.toLowerCase() == 'false') {\n            return {\n                type: 'boolean',\n                value: false\n            };\n        }\n        var date = runtime.parseDate(input);\n        if (date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(date)\n            };\n        }\n        var num = parseFloat(input);\n        if (!isNaN(num) && input.length > 0 && num == input) {\n            return {\n                type: 'number',\n                value: num\n            };\n        }\n        return {\n            type: 'string',\n            value: input\n        };\n    };\n    function tokenize(input, row, col) {\n        var tokens = [];\n        input = TokenStream(input, {\n            forEditor: true,\n            row: row,\n            col: col\n        });\n        while (!input.eof()) {\n            tokens.push(next());\n        }\n        var tok = tokens[0];\n        if (tok.type == 'op' && tok.value == '=') {\n            tok.type = 'startexp';\n        }\n        return tokens;\n        function next() {\n            var tok = input.next();\n            if (tok.type == 'sym') {\n                if (tok.upper == 'TRUE') {\n                    tok.type = 'bool';\n                    tok.value = true;\n                } else if (tok.upper == 'FALSE') {\n                    tok.type = 'bool';\n                    tok.value = false;\n                }\n            } else if (tok.type == 'ref') {\n                tok = {\n                    type: 'ref',\n                    ref: row != null && col != null ? tok.absolute(row, col) : tok,\n                    begin: tok.begin,\n                    end: tok.end\n                };\n            }\n            return tok;\n        }\n    }\n    function parseSqref(input, row, col) {\n        row = row || 0;\n        col = col || 0;\n        input = TokenStream(input, {\n            row: row,\n            col: col\n        });\n        var refs = [];\n        while (!input.eof()) {\n            var ref = input.next();\n            if (ref.type != 'ref') {\n                throw new ParseError('Expecting a reference but got: ' + JSON.stringify(ref));\n            }\n            refs.push(ref.absolute(row, col));\n        }\n        return refs;\n    }\n    exports.parseNameDefinition = parseNameDefinition;\n    exports.parseFormula = parseFormula;\n    exports.parseReference = parseReference;\n    exports.compile = makeFormula;\n    exports.parseSqref = parseSqref;\n    exports.InputStream = InputStream;\n    exports.ParseError = ParseError;\n    exports.tokenize = tokenize;\n    registerFormatParser(function (input) {\n        var m;\n        if (m = /^(\\d+):(\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            return {\n                type: 'date',\n                format: 'hh:mm',\n                value: runtime.packTime(hh, mm, 0, 0)\n            };\n        }\n        if (m = /^(\\d+):(\\d+)(\\.\\d+)$/.exec(input)) {\n            var mm = parseInt(m[1], 10);\n            var ss = parseInt(m[2], 10);\n            var ms = parseFloat(m[3]) * 1000;\n            return {\n                type: 'date',\n                format: 'mm:ss.00',\n                value: runtime.packTime(0, mm, ss, ms)\n            };\n        }\n        if (m = /^(\\d+):(\\d+):(\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            return {\n                type: 'date',\n                format: 'hh:mm:ss',\n                value: runtime.packTime(hh, mm, ss, 0)\n            };\n        }\n        if (m = /^(\\d+):(\\d+):(\\d+)(\\.\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            var ms = parseFloat(m[4]) * 1000;\n            return {\n                type: 'date',\n                format: 'hh:mm:ss.00',\n                value: runtime.packTime(hh, mm, ss, ms)\n            };\n        }\n    });\n    registerFormatParser(function (input) {\n        var m, n;\n        var culture = kendo.culture();\n        var comma = culture.numberFormat[','];\n        var dot = culture.numberFormat['.'];\n        var currency = culture.numberFormat.currency.symbol;\n        var rxnum = getNumberRegexp(comma, dot);\n        var rxcur = new RegExp('^\\\\s*\\\\' + currency + '\\\\s*');\n        var sign = 1;\n        var format = '';\n        var suffix = '';\n        var has_currency = false;\n        input = InputStream(input.replace(/^\\s+|\\s+$/g, ''));\n        if (input.skip(/^-\\s*/)) {\n            sign = -1;\n        }\n        if (m = input.skip(rxcur)) {\n            has_currency = true;\n            format += '\"' + m[0] + '\"';\n        }\n        if (input.skip(/^-\\s*/)) {\n            if (sign < 0) {\n                return null;\n            }\n            sign = -1;\n        }\n        if (!(n = input.skip(rxnum))) {\n            return null;\n        }\n        format += '#';\n        if (m = input.skip(rxcur)) {\n            if (has_currency) {\n                return null;\n            }\n            has_currency = true;\n            suffix = '\"' + m[0] + '\"';\n        }\n        if (!input.eof()) {\n            return null;\n        }\n        if (n[2] || has_currency) {\n            format += ',#';\n        }\n        if (n[3]) {\n            format += '.' + repeat('0', n[3].length - 1);\n        }\n        var value = n[0].replace(new RegExp('\\\\' + comma, 'g'), '').replace(new RegExp('\\\\' + dot, 'g'), '.');\n        format += suffix;\n        if (has_currency) {\n            format += ';-' + format;\n        }\n        return {\n            type: 'number',\n            format: format,\n            value: sign * parseFloat(value)\n        };\n    });\n    var NUMBER_FORMAT_RX = {};\n    function getNumberRegexp(comma, dot) {\n        var id = comma + dot;\n        var rx = NUMBER_FORMAT_RX[id];\n        if (!rx) {\n            rx = '^(\\\\d+(COM\\\\d{3})*(DOT\\\\d+)?)';\n            rx = rx.replace(/DOT/g, '\\\\' + dot).replace(/COM/g, '\\\\' + comma);\n            rx = new RegExp(rx);\n            NUMBER_FORMAT_RX[id] = rx;\n        }\n        return rx;\n    }\n    function repeat(str, len) {\n        var out = '';\n        while (len-- > 0) {\n            out += str;\n        }\n        return out;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/excel-reader', [\n        'kendo.core',\n        'kendo.color',\n        'util/parse-xml',\n        'spreadsheet/calc'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var $ = kendo.jQuery;\n    var parseXML = kendo.util.parseXML;\n    var parseReference = kendo.spreadsheet.calc.parseReference;\n    var MAP_EXCEL_OPERATOR = {\n        greaterThanOrEqual: 'greaterThanOrEqualTo',\n        lessThanOrEqual: 'lessThanOrEqualTo'\n    };\n    var ERROR_LOG = null;\n    function readExcel(file, workbook, deferred) {\n        var reader = new FileReader();\n        reader.onload = function (e) {\n            var zip = new JSZip(e.target.result);\n            readWorkbook(zip, workbook, deferred);\n        };\n        reader.readAsArrayBuffer(file);\n    }\n    var SEL_CELL = [\n        'sheetData',\n        'row',\n        'c'\n    ];\n    var SEL_COL = [\n        'cols',\n        'col'\n    ];\n    var SEL_DEFINED_NAME = [\n        'definedNames',\n        'definedName'\n    ];\n    var SEL_FORMULA = [\n        'sheetData',\n        'row',\n        'c',\n        'f'\n    ];\n    var SEL_MERGE = [\n        'mergeCells',\n        'mergeCell'\n    ];\n    var SEL_PANE = [\n        'sheetViews',\n        'sheetView',\n        'pane'\n    ];\n    var SEL_ROW = [\n        'sheetData',\n        'row'\n    ];\n    var SEL_SELECTION = [\n        'sheetViews',\n        'sheetView',\n        'selection'\n    ];\n    var SEL_SHEET = [\n        'sheets',\n        'sheet'\n    ];\n    var SEL_STRING = [\n        'sheetData',\n        'row',\n        'c',\n        'is'\n    ];\n    var SEL_TEXT = ['t'];\n    var SEL_SHARED_STRING = ['si'];\n    var SEL_VALUE = [\n        'sheetData',\n        'row',\n        'c',\n        'v'\n    ];\n    var SEL_VIEW = [\n        'bookViews',\n        'workbookView'\n    ];\n    var SEL_SHEET_VIEW = [\n        'sheetViews',\n        'sheetView'\n    ];\n    var SEL_HYPERLINK = [\n        'hyperlinks',\n        'hyperlink'\n    ];\n    var SEL_VALIDATION = [\n        'dataValidations',\n        'dataValidation'\n    ];\n    var SEL_VALIDATION_FORMULA1 = [\n        'dataValidations',\n        'dataValidation',\n        'formula1'\n    ];\n    var SEL_VALIDATION_FORMULA2 = [\n        'dataValidations',\n        'dataValidation',\n        'formula2'\n    ];\n    function xl(file) {\n        if (!/^\\//.test(file)) {\n            file = 'xl/' + file;\n        } else {\n            file = file.substr(1);\n        }\n        return file;\n    }\n    function readWorkbook(zip, workbook, progress) {\n        ERROR_LOG = workbook.excelImportErrors = [];\n        var strings = readStrings(zip);\n        var relationships = readRelationships(zip, '_rels/workbook.xml');\n        var theme = readTheme(zip, relationships.byType.theme[0]);\n        var styles = readStyles(zip, theme);\n        var items = [];\n        var activeSheet = 0;\n        parse(zip, 'xl/workbook.xml', {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_SHEET)) {\n                    var relId = attrs['r:id'];\n                    var file = relationships.byId[relId];\n                    var name = attrs.name;\n                    var dim = sheetDimensions(zip, file);\n                    items.push({\n                        workbook: workbook,\n                        zip: zip,\n                        strings: strings,\n                        styles: styles,\n                        file: file,\n                        options: {\n                            name: name,\n                            rows: Math.max(workbook.options.rows || 0, dim.rows),\n                            columns: Math.max(workbook.options.columns || 0, dim.cols),\n                            columnWidth: dim.columnWidth,\n                            rowHeight: dim.rowHeight\n                        }\n                    });\n                } else if (this.is(SEL_VIEW)) {\n                    if (attrs.activeTab) {\n                        activeSheet = integer(attrs.activeTab);\n                    }\n                }\n            },\n            text: function (text) {\n                var attrs = this.is(SEL_DEFINED_NAME);\n                if (attrs && !(bool(attrs['function']) || bool(attrs.vbProcedure))) {\n                    var localSheetId = attrs.localSheetId;\n                    var sheet = null;\n                    if (localSheetId != null) {\n                        sheet = items[localSheetId].options.name;\n                    }\n                    var name = attrs.name;\n                    if (sheet) {\n                        name = '\\'' + sheet.replace(/\\'/g, '\\\\\\'') + '\\'!' + name;\n                    }\n                    withErrorLog(sheet, null, function () {\n                        workbook.defineName(name, text, bool(attrs.hidden));\n                    }, 'reading user-defined name: ' + name);\n                }\n            }\n        });\n        var loading = new $.Deferred();\n        loading.progress(function (args) {\n            if (progress) {\n                progress.notify(args);\n            }\n        }).then(function () {\n            var sheets = workbook.sheets();\n            recalcSheets(sheets);\n            workbook.activeSheet(sheets[activeSheet]);\n            if (progress) {\n                progress.resolve();\n            }\n        });\n        loadSheets(items, workbook, loading);\n    }\n    function loadSheets(items, workbook, progress) {\n        var ready = new $.Deferred().resolve();\n        for (var i = 0; i < items.length; i++) {\n            (function (entry, i) {\n                ready = ready.then(function () {\n                    var sheet = workbook.insertSheet(entry.options);\n                    sheet.suspendChanges(true);\n                    var promise = queueSheet(sheet, entry);\n                    var args = {\n                        sheet: sheet,\n                        progress: i / (items.length - 1)\n                    };\n                    promise.then(function () {\n                        progress.notify(args);\n                    });\n                    return promise;\n                });\n            }(items[i], i));\n        }\n        ready.then(function () {\n            progress.resolve();\n        });\n    }\n    function queueSheet(sheet, ctx) {\n        var deferred = new $.Deferred();\n        setTimeout(function () {\n            readSheet(ctx.zip, ctx.file, sheet, ctx.strings, ctx.styles);\n            deferred.resolve();\n        }, 0);\n        return deferred;\n    }\n    function recalcSheets(sheets) {\n        for (var i = 0; i < sheets.length; i++) {\n            sheets[i].suspendChanges(false).triggerChange({ recalc: true });\n        }\n    }\n    function sheetDimensions(zip, file) {\n        var dim = {\n            rows: 0,\n            cols: 0\n        };\n        parse(zip, xl(file), {\n            enter: function (tag, attrs) {\n                if (tag == 'dimension') {\n                    var ref = parseReference(attrs.ref);\n                    if (ref.bottomRight) {\n                        dim.cols = ref.bottomRight.col + 1;\n                        dim.rows = ref.bottomRight.row + 1;\n                    }\n                } else if (tag === 'sheetFormatPr') {\n                    if (attrs.defaultColWidth) {\n                        dim.columnWidth = toColWidth(parseFloat(attrs.defaultColWidth));\n                    }\n                    if (attrs.defaultRowHeight) {\n                        dim.rowHeight = toRowHeight(parseFloat(attrs.defaultRowHeight));\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    this.exit();\n                }\n            }\n        });\n        return dim;\n    }\n    function toColWidth(size) {\n        var maximumDigitWidth = 7;\n        var fraction = (256 * size + Math.floor(128 / maximumDigitWidth)) / 256;\n        return Math.floor(fraction) * maximumDigitWidth;\n    }\n    function toRowHeight(pts) {\n        return pts * 1.5625;\n    }\n    function readSheet(zip, file, sheet, strings, styles) {\n        var ref, type, value, formula, formulaRange;\n        var nCols = sheet._columns._count;\n        var prevCellRef = null;\n        var relsFile = file.replace(/worksheets\\//, 'worksheets/_rels/');\n        var relationships = readRelationships(zip, relsFile);\n        var formula1, formula2;\n        var filterRef;\n        var filterColumn;\n        var customFilterLogic;\n        var customFilterCriteria;\n        var valueFilterBlanks;\n        var valueFilterValues;\n        var filters = [];\n        ERROR_LOG = sheet._workbook.excelImportErrors;\n        parse(zip, xl(file), {\n            enter: function (tag, attrs) {\n                var tmp;\n                if (this.is(SEL_CELL)) {\n                    value = null;\n                    formula = null;\n                    formulaRange = null;\n                    ref = attrs.r;\n                    if (ref == null) {\n                        ref = parseReference(prevCellRef);\n                        ref.col++;\n                        ref = ref.toString();\n                    }\n                    prevCellRef = ref;\n                    type = attrs.t;\n                    var styleIndex = attrs.s;\n                    if (styleIndex != null) {\n                        applyStyle(sheet, ref, styles, styleIndex);\n                    }\n                } else if (this.is(SEL_MERGE)) {\n                    sheet.range(attrs.ref).merge();\n                } else if (this.is(SEL_COL)) {\n                    var start = integer(attrs.min) - 1;\n                    var stop = Math.min(nCols, integer(attrs.max)) - 1;\n                    var width;\n                    if (attrs.width) {\n                        width = toColWidth(parseFloat(attrs.width));\n                        if (width !== 0) {\n                            sheet._columns.values.value(start, stop, width);\n                        }\n                    }\n                    if (attrs.hidden === '1' || width === 0) {\n                        for (var ci = start; ci <= stop; ci++) {\n                            sheet.hideColumn(ci);\n                        }\n                    }\n                    if (attrs.style != null) {\n                        applyStyle(sheet, new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(-Infinity, start), new kendo.spreadsheet.CellRef(+Infinity, stop)), styles, attrs.style);\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    var row = integer(attrs.r) - 1;\n                    var height;\n                    if (attrs.ht) {\n                        height = toRowHeight(parseFloat(attrs.ht));\n                        if (height !== 0) {\n                            sheet._rows.values.value(row, row, height);\n                        }\n                    }\n                    if (attrs.hidden === '1' || height === 0) {\n                        sheet.hideRow(row);\n                    }\n                } else if (this.is(SEL_SELECTION)) {\n                    if (attrs.activeCell) {\n                        var acRef = parseReference(attrs.activeCell);\n                        sheet.select(acRef, true);\n                    }\n                } else if (this.is(SEL_PANE)) {\n                    if (attrs.state == 'frozen') {\n                        if (attrs.xSplit) {\n                            sheet.frozenColumns(integer(attrs.xSplit));\n                        }\n                        if (attrs.ySplit) {\n                            sheet.frozenRows(integer(attrs.ySplit));\n                        }\n                    }\n                } else if (this.is(SEL_SHEET_VIEW)) {\n                    sheet.showGridLines(bool(attrs.showGridLines, true));\n                } else if (this.is(SEL_HYPERLINK)) {\n                    var relId = attrs['r:id'];\n                    var target = relationships.byId[relId];\n                    if (target) {\n                        sheet.range(attrs.ref).link(target);\n                    }\n                } else if (this.is(['autoFilter'])) {\n                    filterRef = attrs.ref;\n                } else if (filterRef) {\n                    if (this.is(['filterColumn'])) {\n                        filterColumn = parseInt(attrs.colId, 10);\n                    } else if (this.is(['customFilters'])) {\n                        customFilterLogic = bool(attrs.and) ? 'and' : 'or';\n                        customFilterCriteria = [];\n                    } else if (this.is(['customFilter'])) {\n                        tmp = getCustomFilter(attrs.operator, attrs.val);\n                        if (tmp) {\n                            customFilterCriteria.push({\n                                operator: tmp.operator,\n                                value: tmp.value\n                            });\n                        }\n                    } else if (this.is(['dynamicFilter'])) {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.DynamicFilter({ type: dynamicFilterType(attrs.type) })\n                        });\n                    } else if (this.is(['top10'])) {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.TopFilter({\n                                value: getFilterVal(attrs.val),\n                                type: function (percent, top) {\n                                    return percent && top ? 'topPercent' : top ? 'topNumber' : percent ? 'bottomPercent' : 'bottomNumber';\n                                }(bool(attrs.percent), bool(attrs.top))\n                            })\n                        });\n                    } else if (this.is(['filters'])) {\n                        valueFilterBlanks = bool(attrs.blank);\n                        valueFilterValues = [];\n                    } else if (this.is(['filter'])) {\n                        valueFilterValues.push(getFilterVal(attrs.val));\n                    }\n                }\n            },\n            leave: function (tag, attrs) {\n                if (this.is(SEL_CELL)) {\n                    if (formula != null) {\n                        var failed = withErrorLog(sheet, formulaRange || ref, function () {\n                            sheet.range(formulaRange || ref).formula(formula);\n                        }, 'parsing formula');\n                        if (failed) {\n                            sheet.range(formulaRange || ref).value(formula).background('#ffaaaa');\n                        }\n                    } else if (value != null) {\n                        var range = sheet.range(ref);\n                        if (!range._get('formula')) {\n                            if (!type || type == 'n') {\n                                value = parseFloat(value);\n                            } else if (type == 's') {\n                                value = strings[integer(value)];\n                            } else if (type == 'b') {\n                                value = value === '1';\n                            } else if (type == 'd') {\n                                value = kendo.parseDate(value);\n                            }\n                            if (value != null) {\n                                range.value(value);\n                            }\n                        }\n                    }\n                } else if (this.is(SEL_VALIDATION)) {\n                    (function () {\n                        var refs = kendo.spreadsheet.calc.parseSqref(attrs.sqref);\n                        var type = attrs.type.toLowerCase();\n                        var operator = attrs.operator;\n                        if (/^(?:whole|decimal)$/.test(type)) {\n                            type = 'number';\n                        } else if (type == 'list') {\n                            operator = 'list';\n                        }\n                        if (!operator && /^(?:number|date)$/.test(type)) {\n                            operator = 'between';\n                        }\n                        refs.forEach(function (ref) {\n                            withErrorLog(sheet, ref, function () {\n                                sheet.range(ref).validation({\n                                    type: bool(attrs.showErrorMessage, true) ? 'reject' : 'warning',\n                                    from: formula1,\n                                    to: formula2,\n                                    dataType: type,\n                                    comparerType: MAP_EXCEL_OPERATOR[operator] || operator,\n                                    allowNulls: bool(attrs.allowBlank),\n                                    showButton: bool(attrs.showDropDown) || type == 'date' || type == 'list',\n                                    messageTemplate: attrs.error,\n                                    titleTemplate: attrs.errorTitle\n                                });\n                            }, 'parsing validation');\n                        });\n                    }());\n                } else if (tag == 'cols') {\n                    sheet._columns._refresh();\n                } else if (tag == 'sheetData') {\n                    sheet._rows._refresh();\n                } else if (tag == 'autoFilter') {\n                    sheet.range(filterRef).filter(filters);\n                    filterRef = null;\n                } else if (filterRef) {\n                    if (tag == 'customFilters') {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.CustomFilter({\n                                logic: customFilterLogic,\n                                criteria: customFilterCriteria\n                            })\n                        });\n                    } else if (tag == 'filters') {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.ValueFilter({\n                                values: valueFilterValues,\n                                blanks: valueFilterBlanks\n                            })\n                        });\n                    }\n                }\n            },\n            text: function (text) {\n                var attrs;\n                if (this.is(SEL_VALUE) || this.is(SEL_STRING)) {\n                    value = text;\n                } else if (attrs = this.is(SEL_FORMULA)) {\n                    formula = text;\n                    if (attrs.t == 'shared') {\n                        formulaRange = attrs.ref;\n                    }\n                } else if (this.is(SEL_VALIDATION_FORMULA1)) {\n                    formula1 = text;\n                } else if (this.is(SEL_VALIDATION_FORMULA2)) {\n                    formula2 = text;\n                }\n            }\n        });\n    }\n    function getCustomFilter(op, value) {\n        var ourOp = {\n            equal: 'eq',\n            notEqual: 'ne',\n            greaterThan: 'gt',\n            greaterThanOrEqual: 'gte',\n            lessThan: 'lt',\n            lessThanOrEqual: 'lte'\n        }[op];\n        value = getFilterVal(value);\n        if (ourOp && typeof value == 'number') {\n            return {\n                operator: ourOp,\n                value: value\n            };\n        }\n        if ((op == 'notEqual' || !op) && typeof value == 'string') {\n            return {\n                operator: op ? 'doesnotmatch' : 'matches',\n                value: value\n            };\n        }\n    }\n    function dynamicFilterType(type) {\n        return {\n            Q1: 'quarter1',\n            Q2: 'quarter2',\n            Q3: 'quarter3',\n            Q4: 'quarter4',\n            M1: 'january',\n            M2: 'february',\n            M3: 'march',\n            M4: 'april',\n            M5: 'may',\n            M6: 'june',\n            M7: 'july',\n            M8: 'august',\n            M9: 'september',\n            M10: 'october',\n            M11: 'november',\n            M12: 'december'\n        }[type.toUpperCase()] || type;\n    }\n    function getFilterVal(val) {\n        var tmp = parseFloat(val);\n        if (!isNaN(tmp) && tmp == val) {\n            return tmp;\n        }\n        return val;\n    }\n    function withErrorLog(sheet, ref, func, context) {\n        try {\n            func();\n            return false;\n        } catch (ex) {\n            var err = {\n                context: context,\n                error: String(ex)\n            };\n            if (sheet) {\n                err.sheet = sheet.name();\n            }\n            if (ref) {\n                err.location = String(ref);\n            }\n            ERROR_LOG.push(err);\n            return true;\n        }\n    }\n    var BORDER_WIDTHS = {\n        'none': 0,\n        'thin': 1,\n        'medium': 2,\n        'dashed': 1,\n        'dotted': 1,\n        'thick': 3,\n        'double': 3,\n        'hair': 1,\n        'mediumDashed': 2,\n        'dashDot': 1,\n        'mediumDashDot': 2,\n        'dashDotDot': 1,\n        'mediumDashDotDot': 2,\n        'slantDashDot': 1\n    };\n    var DEFAULT_FORMATS = {\n        0: 'General',\n        1: '0',\n        2: '0.00',\n        3: '#,##0',\n        4: '#,##0.00',\n        9: '0%',\n        10: '0.00%',\n        11: '0.00E+00',\n        12: '# ?/?',\n        13: '# ??/??',\n        14: 'mm-dd-yy',\n        15: 'd-mmm-yy',\n        16: 'd-mmm',\n        17: 'mmm-yy',\n        18: 'h:mm AM/PM',\n        19: 'h:mm:ss AM/PM',\n        20: 'h:mm',\n        21: 'h:mm:ss',\n        22: 'm/d/yy h:mm',\n        37: '#,##0 ;(#,##0)',\n        38: '#,##0 ;[Red](#,##0)',\n        39: '#,##0.00;(#,##0.00)',\n        40: '#,##0.00;[Red](#,##0.00)',\n        45: 'mm:ss',\n        46: '[h]:mm:ss',\n        47: 'mmss.0',\n        48: '##0.0E+0',\n        49: '@'\n    };\n    function applyStyle(sheet, ref, styles, styleIndex) {\n        var range = sheet.range(ref);\n        var xf = styles.inlineStyles[styleIndex], base, value;\n        if (xf.xfId) {\n            base = styles.namedStyles[xf.xfId];\n        }\n        if (shouldSet('applyBorder', 'borderId')) {\n            setBorder(styles.borders[value]);\n        }\n        if (shouldSet('applyFont', 'fontId')) {\n            setFont(styles.fonts[value]);\n        }\n        if (shouldSet('applyAlignment', 'textAlign')) {\n            range.textAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'verticalAlign')) {\n            range.verticalAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'wrapText')) {\n            range._property('wrap', value);\n        }\n        if (shouldSet('applyFill', 'fillId')) {\n            setFill(styles.fills[value]);\n        }\n        if (shouldSet('applyNumberFormat', 'numFmtId')) {\n            setFormat(styles.numFmts[value] || DEFAULT_FORMATS[value]);\n        }\n        function setFormat(f) {\n            var format = typeof f == 'string' ? f : f.formatCode;\n            if (format != null && !/^general$/i.test(format)) {\n                format = format.replace(/^\\[\\$-[0-9]+\\]/, '');\n                range.format(format);\n            }\n        }\n        function setFill(f) {\n            if (f.type == 'solid') {\n                range.background(f.color);\n            }\n        }\n        function setFont(f) {\n            range.fontFamily(f.name);\n            range._property('fontSize', f.size);\n            if (f.bold) {\n                range.bold(true);\n            }\n            if (f.italic) {\n                range.italic(true);\n            }\n        }\n        function setBorder(b) {\n            function set(side, prop) {\n                var border = b[side];\n                if (!border) {\n                    return;\n                }\n                var width = BORDER_WIDTHS[border.style];\n                if (width === 0) {\n                    return;\n                }\n                var color = border.color;\n                if (color == null) {\n                    color = '#000';\n                }\n                range._property(prop, {\n                    size: width,\n                    color: color\n                });\n            }\n            set('left', 'borderLeft');\n            set('top', 'borderTop');\n            set('right', 'borderRight');\n            set('bottom', 'borderBottom');\n        }\n        function shouldSet(applyName, propName) {\n            var t = xf[applyName];\n            if (t != null && !t) {\n                return false;\n            }\n            value = xf[propName];\n            if (base && value == null) {\n                t = base[applyName];\n                if (t != null && !t) {\n                    return false;\n                }\n                value = base[propName];\n            }\n            return value != null;\n        }\n    }\n    function parse(zip, file, callbacks) {\n        var part = zip.files[file];\n        if (part) {\n            parseXML(part.asUint8Array(), callbacks);\n        }\n    }\n    function readStrings(zip) {\n        var strings = [];\n        var current = null;\n        parse(zip, 'xl/sharedStrings.xml', {\n            leave: function () {\n                if (this.is(SEL_SHARED_STRING)) {\n                    strings.push(current);\n                    current = null;\n                }\n            },\n            text: function (text) {\n                if (this.is(SEL_TEXT)) {\n                    if (current == null) {\n                        current = '';\n                    }\n                    current += text;\n                }\n            }\n        });\n        return strings;\n    }\n    function readRelationships(zip, file) {\n        var map = {\n            byId: {},\n            byType: { theme: [] }\n        };\n        parse(zip, xl(file) + '.rels', {\n            enter: function (tag, attrs) {\n                if (tag == 'Relationship') {\n                    map.byId[attrs.Id] = attrs.Target;\n                    var type = attrs.Type.match(/\\w+$/)[0];\n                    var entries = map.byType[type] || [];\n                    entries.push(attrs.Target);\n                    map.byType[type] = entries;\n                }\n            }\n        });\n        return map;\n    }\n    var SEL_BORDER = [\n        'borders',\n        'border'\n    ];\n    var SEL_FILL = [\n        'fills',\n        'fill'\n    ];\n    var SEL_FONT = [\n        'fonts',\n        'font'\n    ];\n    var SEL_INLINE_STYLE = [\n        'cellXfs',\n        'xf'\n    ];\n    var SEL_NAMED_STYLE = [\n        'cellStyleXfs',\n        'xf'\n    ];\n    var SEL_NUM_FMT = [\n        'numFmts',\n        'numFmt'\n    ];\n    var INDEXED_COLORS = [\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008000'),\n        toCSSColor('FF000080'),\n        toCSSColor('FF808000'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF008080'),\n        toCSSColor('FFC0C0C0'),\n        toCSSColor('FF808080'),\n        toCSSColor('FF9999FF'),\n        toCSSColor('FF993366'),\n        toCSSColor('FFFFFFCC'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FF660066'),\n        toCSSColor('FFFF8080'),\n        toCSSColor('FF0066CC'),\n        toCSSColor('FFCCCCFF'),\n        toCSSColor('FF000080'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008080'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FF00CCFF'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FFCCFFCC'),\n        toCSSColor('FFFFFF99'),\n        toCSSColor('FF99CCFF'),\n        toCSSColor('FFFF99CC'),\n        toCSSColor('FFCC99FF'),\n        toCSSColor('FFFFCC99'),\n        toCSSColor('FF3366FF'),\n        toCSSColor('FF33CCCC'),\n        toCSSColor('FF99CC00'),\n        toCSSColor('FFFFCC00'),\n        toCSSColor('FFFF9900'),\n        toCSSColor('FFFF6600'),\n        toCSSColor('FF666699'),\n        toCSSColor('FF969696'),\n        toCSSColor('FF003366'),\n        toCSSColor('FF339966'),\n        toCSSColor('FF003300'),\n        toCSSColor('FF333300'),\n        toCSSColor('FF993300'),\n        toCSSColor('FF993366'),\n        toCSSColor('FF333399'),\n        toCSSColor('FF333333'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF')\n    ];\n    function readStyles(zip, theme) {\n        var styles = {\n            fonts: [],\n            numFmts: {},\n            fills: [],\n            borders: [],\n            namedStyles: [],\n            inlineStyles: []\n        };\n        var font = null;\n        var fill = null;\n        var border = null;\n        var xf = null;\n        parse(zip, 'xl/styles.xml', {\n            enter: function (tag, attrs, closed) {\n                if (this.is(SEL_NUM_FMT)) {\n                    styles.numFmts[attrs.numFmtId] = attrs;\n                } else if (this.is(SEL_FONT)) {\n                    styles.fonts.push(font = {});\n                } else if (font) {\n                    if (tag == 'sz') {\n                        font.size = parseFloat(attrs.val);\n                    } else if (tag == 'name') {\n                        font.name = attrs.val;\n                    } else if (tag == 'b') {\n                        font.bold = bool(attrs.val, true);\n                    } else if (tag == 'i') {\n                        font.italic = bool(attrs.val, true);\n                    }\n                } else if (this.is(SEL_FILL)) {\n                    styles.fills.push(fill = {});\n                } else if (fill) {\n                    if (tag == 'patternFill') {\n                        fill.type = attrs.patternType;\n                    } else if (tag == 'fgColor' && fill.type === 'solid') {\n                        fill.color = getColor(attrs);\n                    } else if (tag == 'bgColor' && fill.type !== 'solid') {\n                        fill.color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_BORDER)) {\n                    styles.borders.push(border = {});\n                } else if (border) {\n                    if (/^(?:left|top|right|bottom)$/.test(tag) && attrs.style) {\n                        border[tag] = { style: attrs.style };\n                    }\n                    if (tag == 'color') {\n                        var side = this.stack[this.stack.length - 2].$tag;\n                        border[side].color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_NAMED_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.namedStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (this.is(SEL_INLINE_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.inlineStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (xf) {\n                    if (tag == 'alignment') {\n                        if (/^(?:left|center|right|justify)$/.test(attrs.horizontal)) {\n                            xf.textAlign = attrs.horizontal;\n                        }\n                        if (/^(?:top|center|bottom)$/.test(attrs.vertical)) {\n                            xf.verticalAlign = attrs.vertical;\n                        }\n                        if (attrs.wrapText != null) {\n                            xf.wrapText = bool(attrs.wrapText);\n                        }\n                    }\n                }\n            },\n            leave: function (tag) {\n                if (this.is(SEL_FONT)) {\n                    font = null;\n                } else if (this.is(SEL_FILL)) {\n                    fill = null;\n                } else if (this.is(SEL_BORDER)) {\n                    border = null;\n                } else if (tag == 'xf') {\n                    xf = null;\n                }\n            }\n        });\n        function getXf(attrs) {\n            var xf = {\n                borderId: integer(attrs.borderId),\n                fillId: integer(attrs.fillId),\n                fontId: integer(attrs.fontId),\n                numFmtId: integer(attrs.numFmtId),\n                pivotButton: bool(attrs.pivotButton),\n                quotePrefix: bool(attrs.quotePrefix),\n                xfId: integer(attrs.xfId)\n            };\n            addBool('applyAlignment');\n            addBool('applyBorder');\n            addBool('applyFill');\n            addBool('applyFont');\n            addBool('applyNumberFormat');\n            addBool('applyProtection');\n            function addBool(name) {\n                if (attrs[name] != null) {\n                    xf[name] = bool(attrs[name]);\n                }\n            }\n            return xf;\n        }\n        function getColor(attrs) {\n            if (attrs.rgb) {\n                return toCSSColor(attrs.rgb);\n            } else if (attrs.indexed) {\n                return INDEXED_COLORS[integer(attrs.indexed)];\n            } else if (attrs.theme) {\n                var themeColor = theme.colorScheme[integer(attrs.theme)];\n                if (!themeColor) {\n                    return INDEXED_COLORS[0];\n                }\n                var color = kendo.parseColor(themeColor);\n                if (attrs.tint) {\n                    color = color.toHSL();\n                    var tint = parseFloat(attrs.tint);\n                    if (tint < 0) {\n                        color.l = color.l * (1 + tint);\n                    } else {\n                        color.l = color.l * (1 - tint) + (100 - 100 * (1 - tint));\n                    }\n                }\n                return color.toCssRgba();\n            }\n        }\n        return styles;\n    }\n    var SEL_SCHEME_RGBCLR = [\n        'a:clrScheme',\n        '*',\n        'a:srgbClr'\n    ];\n    var SEL_SCHEME_SYSCLR = [\n        'a:clrScheme',\n        '*',\n        'a:sysClr'\n    ];\n    function readTheme(zip, rel) {\n        var scheme = [];\n        var theme = { colorScheme: scheme };\n        var file = xl(rel);\n        if (zip.files[file]) {\n            parse(zip, file, {\n                enter: function (tag, attrs) {\n                    if (this.is(SEL_SCHEME_SYSCLR)) {\n                        scheme.push(toCSSColor(attrs.val == 'window' ? 'FFFFFFFF' : 'FF000000'));\n                    } else if (this.is(SEL_SCHEME_RGBCLR)) {\n                        scheme.push(toCSSColor('FF' + attrs.val));\n                    }\n                }\n            });\n            if (scheme.length > 3) {\n                swap(scheme, 0, 1);\n                swap(scheme, 2, 3);\n            }\n        }\n        function swap(arr, a, b) {\n            var tmp = arr[a];\n            arr[a] = arr[b];\n            arr[b] = tmp;\n        }\n        return theme;\n    }\n    function integer(val) {\n        return val == null ? null : parseInt(val, 10);\n    }\n    function bool(val, def) {\n        if (val == null) {\n            return def;\n        }\n        return val == 'true' || val === true || val == 1;\n    }\n    function toCSSColor(rgb) {\n        var m = /^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(rgb);\n        return 'rgba(' + parseInt(m[2], 16) + ', ' + parseInt(m[3], 16) + ', ' + parseInt(m[4], 16) + ', ' + parseInt(m[1], 16) / 255 + ')';\n    }\n    kendo.spreadsheet.readExcel = readExcel;\n    kendo.spreadsheet._readSheet = readSheet;\n    kendo.spreadsheet._readStrings = readStrings;\n    kendo.spreadsheet._readStyles = readStyles;\n    kendo.spreadsheet._readTheme = readTheme;\n    kendo.spreadsheet._readWorkbook = readWorkbook;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/workbook', [\n        'kendo.core',\n        'spreadsheet/runtime',\n        'spreadsheet/references',\n        'spreadsheet/excel-reader'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Formula = kendo.spreadsheet.calc.runtime.Formula;\n        var Ref = kendo.spreadsheet.Ref;\n        var CalcError = kendo.spreadsheet.CalcError;\n        var Workbook = kendo.Observable.extend({\n            init: function (options, view) {\n                kendo.Observable.fn.init.call(this);\n                this.options = options;\n                this._view = view;\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n                this._sheet = this.insertSheet({\n                    rows: this.options.rows,\n                    columns: this.options.columns,\n                    rowHeight: this.options.rowHeight,\n                    columnWidth: this.options.columnWidth,\n                    headerHeight: this.options.headerHeight,\n                    headerWidth: this.options.headerWidth,\n                    dataSource: this.options.dataSource\n                });\n                this.undoRedoStack = new kendo.util.UndoRedoStack();\n                this.undoRedoStack.bind([\n                    'undo',\n                    'redo'\n                ], this._onUndoRedo.bind(this));\n                this._context = new kendo.spreadsheet.FormulaContext(this);\n                this._validationContext = new kendo.spreadsheet.ValidationFormulaContext(this);\n                this._names = Object.create(null);\n                this.fromJSON(this.options);\n            },\n            clipboard: function () {\n                if (!this._clipboard) {\n                    this._clipboard = new kendo.spreadsheet.Clipboard(this);\n                }\n                return this._clipboard;\n            },\n            destroy: function () {\n                this.unbind();\n                if (this._clipboard) {\n                    this._clipboard.destroy();\n                }\n            },\n            events: [\n                'cut',\n                'copy',\n                'paste',\n                'change',\n                'excelImport',\n                'excelExport',\n                'insertSheet',\n                'removeSheet',\n                'selectSheet',\n                'renameSheet',\n                'insertRow',\n                'insertColumn',\n                'deleteRow',\n                'deleteColumn',\n                'hideRow',\n                'hideColumn',\n                'unhideRow',\n                'unhideColumn',\n                'select',\n                'changeFormat'\n            ],\n            _sheetChange: function (e) {\n                this.trigger('change', e);\n            },\n            _sheetInsertRow: function (e) {\n                if (this.trigger('insertRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetInsertColumn: function (e) {\n                if (this.trigger('insertColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetDeleteRow: function (e) {\n                if (this.trigger('deleteRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetDeleteColumn: function (e) {\n                if (this.trigger('deleteColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetHideRow: function (e) {\n                if (this.trigger('hideRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetHideColumn: function (e) {\n                if (this.trigger('hideColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetUnhideRow: function (e) {\n                if (this.trigger('unhideRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetUnhideColumn: function (e) {\n                if (this.trigger('unhideColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetSelect: function (e) {\n                this.trigger('select', e);\n            },\n            _sheetCommandRequest: function (e) {\n                this.trigger('commandRequest', e);\n            },\n            _inputForRef: function (ref) {\n                return new kendo.spreadsheet.Range(ref, this._sheet).input();\n            },\n            _onUndoRedo: function (e) {\n                e.command.range().select();\n            },\n            execute: function (options) {\n                var commandOptions = $.extend({ workbook: this }, options.options);\n                var command = new kendo.spreadsheet[options.command](commandOptions);\n                var sheet = this.activeSheet();\n                if (commandOptions.origin) {\n                    command.origin(commandOptions.origin);\n                }\n                if (commandOptions.operatingRange) {\n                    command.range(commandOptions.operatingRange);\n                } else if (commandOptions.editActiveCell) {\n                    command.range(sheet.activeCellSelection());\n                } else {\n                    command.range(sheet.selection());\n                }\n                var result = command.exec();\n                if (!result || result.reason !== 'error') {\n                    if (command.cannotUndo) {\n                        this.undoRedoStack.clear();\n                    } else {\n                        this.undoRedoStack.push(command);\n                    }\n                }\n                return result;\n            },\n            resetFormulas: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetFormulas();\n                });\n            },\n            resetValidations: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetValidations();\n                });\n            },\n            refresh: function (reason) {\n                if (reason.recalc) {\n                    this.resetFormulas();\n                    this.resetValidations();\n                    this._sheet.recalc(this._context);\n                    this._sheet.revalidate(this._validationContext);\n                }\n            },\n            activeSheet: function (sheet) {\n                if (sheet === undefined) {\n                    return this._sheet;\n                }\n                if (!this.sheetByName(sheet.name())) {\n                    return;\n                }\n                this._sheet = sheet;\n                sheet.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            moveSheetToIndex: function (sheet, toIndex) {\n                var fromIndex = this.sheetIndex(sheet);\n                var sheets = this._sheets;\n                if (fromIndex === -1) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheets.splice(toIndex, 0, sheets.splice(fromIndex, 1)[0]);\n                this.trigger('change', { sheetSelection: true });\n            },\n            insertSheet: function (options) {\n                options = options || {};\n                var that = this;\n                var insertIndex = typeof options.index === 'number' ? options.index : that._sheets.length;\n                var sheetName;\n                var sheets = that._sheets;\n                var getUniqueSheetName = function (sheetNameSuffix) {\n                    sheetNameSuffix = sheetNameSuffix ? sheetNameSuffix : 1;\n                    var name = 'Sheet' + sheetNameSuffix;\n                    if (!that.sheetByName(name)) {\n                        return name;\n                    }\n                    return getUniqueSheetName(sheetNameSuffix + 1);\n                };\n                if (options.name && that.sheetByName(options.name)) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheetName = options.name || getUniqueSheetName();\n                var sheet = new kendo.spreadsheet.Sheet(options.rows || this.options.rows, options.columns || this.options.columns, options.rowHeight || this.options.rowHeight, options.columnWidth || this.options.columnWidth, options.headerHeight || this.options.headerHeight, options.headerWidth || this.options.headerWidth, options.defaultCellStyle || this.options.defaultCellStyle);\n                sheet._workbook = this;\n                sheet._name(sheetName);\n                this._bindSheetEvents(sheet);\n                sheets.splice(insertIndex, 0, sheet);\n                if (options.data) {\n                    sheet.fromJSON(options.data);\n                }\n                if (options.dataSource) {\n                    sheet.setDataSource(options.dataSource);\n                }\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            _bindSheetEvents: function (sheet) {\n                sheet.bind('change', this._sheetChange.bind(this));\n                sheet.bind('insertRow', this._sheetInsertRow.bind(this));\n                sheet.bind('insertColumn', this._sheetInsertColumn.bind(this));\n                sheet.bind('deleteRow', this._sheetDeleteRow.bind(this));\n                sheet.bind('deleteColumn', this._sheetDeleteColumn.bind(this));\n                sheet.bind('hideRow', this._sheetHideRow.bind(this));\n                sheet.bind('hideColumn', this._sheetHideColumn.bind(this));\n                sheet.bind('unhideRow', this._sheetUnhideRow.bind(this));\n                sheet.bind('unhideColumn', this._sheetUnhideColumn.bind(this));\n                sheet.bind('select', this._sheetSelect.bind(this));\n                sheet.bind('commandRequest', this._sheetCommandRequest.bind(this));\n            },\n            sheets: function () {\n                return this._sheets.slice();\n            },\n            sheetByName: function (sheetName) {\n                return this._sheets[this.sheetIndex(sheetName)];\n            },\n            sheetByIndex: function (index) {\n                return this._sheets[index];\n            },\n            sheetIndex: function (sheet) {\n                var sheets = this._sheets;\n                var sheetName = (typeof sheet == 'string' ? sheet : sheet.name()).toLowerCase();\n                var idx = this._sheetsSearchCache[sheetName];\n                if (idx >= 0) {\n                    return idx;\n                }\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var name = sheets[idx].name().toLowerCase();\n                    this._sheetsSearchCache[name] = idx;\n                    if (name === sheetName) {\n                        return idx;\n                    }\n                }\n                return -1;\n            },\n            renameSheet: function (sheet, newSheetName) {\n                var oldSheetName = sheet.name().toLowerCase();\n                if (!newSheetName || oldSheetName === newSheetName.toLowerCase() || this.sheetByName(newSheetName)) {\n                    return;\n                }\n                sheet = this.sheetByName(oldSheetName);\n                if (!sheet) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                if (this.trigger('renameSheet', {\n                        sheet: sheet,\n                        newSheetName: newSheetName\n                    })) {\n                    return;\n                }\n                this._sheets.forEach(function (sheet) {\n                    sheet._forFormulas(function (formula) {\n                        formula.renameSheet(oldSheetName, newSheetName);\n                    });\n                });\n                this.forEachName(function (def, name) {\n                    if (def.nameref.renameSheet(oldSheetName, newSheetName)) {\n                        this.undefineName(name);\n                        def.name = def.nameref.print();\n                        this.nameDefinition(def.name, def);\n                    }\n                    if (def.value instanceof Ref || def.value instanceof Formula) {\n                        def.value.renameSheet(oldSheetName, newSheetName);\n                    }\n                }.bind(this));\n                sheet._name(newSheetName);\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            removeSheet: function (sheet) {\n                var that = this;\n                var sheets = that._sheets;\n                var name = sheet.name();\n                var index = that.sheetIndex(sheet);\n                if (sheets.length === 1) {\n                    return;\n                }\n                if (this.trigger('removeSheet', { sheet: sheet })) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                if (index > -1) {\n                    sheet.unbind();\n                    sheets.splice(index, 1);\n                    if (that.activeSheet().name() === name) {\n                        var newSheet = sheets[index === sheets.length ? index - 1 : index];\n                        that.activeSheet(newSheet);\n                    } else {\n                        this.trigger('change', {\n                            recalc: true,\n                            sheetSelection: true\n                        });\n                    }\n                }\n            },\n            _clearSheets: function () {\n                for (var i = 0; i < this._sheets.length; i++) {\n                    this._sheets[i].unbind();\n                }\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n                this._names = {};\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._clearSheets();\n                    for (var idx = 0; idx < json.sheets.length; idx++) {\n                        var data = json.sheets[idx];\n                        var args = sheetParamsFromJSON(data, this.options);\n                        var sheet = this.insertSheet({\n                            rows: args.rowCount,\n                            columns: args.columnCount,\n                            rowHeight: args.rowHeight,\n                            columnWidth: args.columnWidth,\n                            headerHeight: args.headerHeight,\n                            headerWidth: args.headerWidth,\n                            data: data\n                        });\n                        if (data.dataSource) {\n                            sheet.setDataSource(data.dataSource);\n                        }\n                    }\n                }\n                if (json.activeSheet) {\n                    this.activeSheet(this.sheetByName(json.activeSheet));\n                } else {\n                    this.activeSheet(this._sheets[0]);\n                }\n                if (json.names) {\n                    json.names.forEach(function (def) {\n                        this.defineName(def.name, def.value, def.hidden);\n                    }, this);\n                }\n            },\n            toJSON: function () {\n                this.resetFormulas();\n                this.resetValidations();\n                var names = Object.keys(this._names).map(function (name) {\n                    var def = this._names[name];\n                    var val = def.value;\n                    if (val instanceof Ref || val instanceof Formula) {\n                        val = val.print(0, 0, true);\n                    } else if (val instanceof CalcError) {\n                        val = val + '';\n                    } else {\n                        val = JSON.stringify(val);\n                    }\n                    return {\n                        value: val,\n                        hidden: def.hidden,\n                        name: def.name,\n                        sheet: def.nameref.sheet,\n                        localName: def.nameref.name\n                    };\n                }, this);\n                return {\n                    activeSheet: this.activeSheet().name(),\n                    sheets: this._sheets.map(function (sheet) {\n                        sheet.recalc(this._context);\n                        sheet.revalidate(this._validationContext);\n                        return sheet.toJSON();\n                    }, this),\n                    names: names,\n                    columnWidth: this.options.columnWidth,\n                    rowHeight: this.options.rowHeight\n                };\n            },\n            fromFile: function (file) {\n                var deferred = new $.Deferred();\n                var promise = deferred.promise();\n                var args = {\n                    file: file,\n                    promise: promise\n                };\n                if (file && !this.trigger('excelImport', args)) {\n                    this._clearSheets();\n                    kendo.spreadsheet.readExcel(file, this, deferred);\n                } else {\n                    deferred.reject();\n                }\n                return promise;\n            },\n            saveAsExcel: function (options) {\n                options = $.extend({}, this.options.excel, options);\n                var data = this.toJSON();\n                if (!this.trigger('excelExport', { workbook: data })) {\n                    var workbook = new kendo.ooxml.Workbook(data);\n                    kendo.saveAs({\n                        dataURI: workbook.toDataURL(),\n                        fileName: data.fileName || options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy\n                    });\n                }\n            },\n            draw: function (options, callback) {\n                if (typeof options == 'function' && !callback) {\n                    callback = options;\n                    options = {};\n                }\n                var parts = [], sheets = this._sheets;\n                (function loop(i) {\n                    if (i < sheets.length) {\n                        sheets[i].draw(kendo.spreadsheet.SHEETREF, options, function (group) {\n                            parts.push(group);\n                            loop(i + 1);\n                        });\n                    } else {\n                        var group = parts[0];\n                        for (i = 1; i < parts.length; ++i) {\n                            group.children = group.children.concat(parts[i].children);\n                        }\n                        callback(group);\n                    }\n                }(0));\n            },\n            nameForRef: function (ref, sheet) {\n                if (sheet === undefined) {\n                    sheet = ref.sheet;\n                }\n                sheet = sheet.toLowerCase();\n                var str = ref + '';\n                for (var name in this._names) {\n                    var def = this._names[name];\n                    var val = def.value;\n                    if (val instanceof Ref) {\n                        if (!val.sheet || val.sheet && sheet == val.sheet.toLowerCase()) {\n                            if (val + '' == str) {\n                                return def;\n                            }\n                        }\n                    }\n                }\n                return { name: str };\n            },\n            defineName: function (name, value, hidden) {\n                var x = kendo.spreadsheet.calc.parseNameDefinition(name, value);\n                name = x.name.print();\n                this._names[name.toLowerCase()] = {\n                    value: x.value,\n                    hidden: hidden,\n                    name: name,\n                    nameref: x.name\n                };\n            },\n            undefineName: function (name) {\n                delete this._names[name.toLowerCase()];\n            },\n            nameValue: function (name) {\n                name = name.toLowerCase();\n                if (name in this._names) {\n                    return this._names[name].value;\n                }\n                return null;\n            },\n            nameDefinition: function (name, def) {\n                name = name.toLowerCase();\n                if (arguments.length > 1) {\n                    if (def === undefined) {\n                        delete this._names[name];\n                    } else {\n                        this._names[name] = def;\n                    }\n                }\n                return this._names[name];\n            },\n            forEachName: function (func) {\n                Object.keys(this._names).forEach(function (name) {\n                    func(this._names[name], name);\n                }, this);\n            },\n            adjustNames: function (affectedSheet, forRow, start, delta) {\n                affectedSheet = affectedSheet.toLowerCase();\n                Object.keys(this._names).forEach(function (name) {\n                    var def = this._names[name];\n                    var x = def.value;\n                    if (x instanceof Ref && x.sheet.toLowerCase() == affectedSheet) {\n                        def.value = x.adjust(null, null, null, null, forRow, start, delta);\n                    } else if (x instanceof Formula) {\n                        x.adjust(affectedSheet, forRow ? 'row' : 'col', start, delta);\n                    }\n                }, this);\n            },\n            options: {}\n        });\n        function sheetParamsFromJSON(data, options) {\n            function or(a, b, c) {\n                return a !== undefined ? a : b !== undefined ? b : c;\n            }\n            var rowCount = or(data.rowCount, options.rows, 200), columnCount = or(data.columnCount, options.columns, 50), rowHeight = or(data.rowHeight, options.rowHeight, 20), columnWidth = or(data.columnWidth, options.columnWidth, 64), headerHeight = or(data.headerHeight, options.headerHeight, 20), headerWidth = or(data.headerWidth, options.headerWidth, 32);\n            if (data.rows !== undefined) {\n                for (var i = 0; i < data.rows.length; ++i) {\n                    var row = data.rows[i];\n                    var ri = or(row.index, i);\n                    if (ri >= rowCount) {\n                        rowCount = ri + 1;\n                    }\n                    if (row.cells) {\n                        for (var j = 0; j < row.cells.length; ++j) {\n                            var cell = row.cells[j];\n                            var ci = or(cell.index, j);\n                            if (ci >= columnCount) {\n                                columnCount = ci + 1;\n                            }\n                        }\n                    }\n                }\n            }\n            return {\n                rowCount: rowCount,\n                columnCount: columnCount,\n                rowHeight: rowHeight,\n                columnWidth: columnWidth,\n                headerHeight: headerHeight,\n                headerWidth: headerWidth\n            };\n        }\n        kendo.spreadsheet.Workbook = Workbook;\n        if (kendo.PDFMixin) {\n            kendo.PDFMixin.extend(Workbook.prototype);\n            Workbook.prototype.saveAsPDF = function (options) {\n                var progress = new $.Deferred();\n                var promise = progress.promise();\n                var args = { promise: promise };\n                if (this.trigger('pdfExport', args)) {\n                    return;\n                }\n                this._drawPDF(options, progress).then(function (root) {\n                    return kendo.drawing.exportPDF(root);\n                }).done(function (dataURI) {\n                    kendo.saveAs({\n                        dataURI: dataURI,\n                        fileName: options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy,\n                        proxyTarget: options.proxyTarget\n                    });\n                    progress.resolve();\n                }).fail(function (err) {\n                    progress.reject(err);\n                });\n                return promise;\n            };\n            Workbook.prototype._drawPDF = function (options) {\n                var result = new $.Deferred();\n                var callback = function (group) {\n                    result.resolve(group);\n                };\n                switch (options.area) {\n                case 'workbook':\n                    options.workbook.draw(options, callback);\n                    break;\n                case 'sheet':\n                    options.workbook.activeSheet().draw(options, callback);\n                    break;\n                case 'selection':\n                    options.workbook.activeSheet().selection().draw(options, callback);\n                    break;\n                }\n                return result.promise();\n            };\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulacontext', ['kendo.core'], f);\n}(function () {\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NameRef = spreadsheet.NameRef;\n    var Ref = spreadsheet.Ref;\n    var FormulaContext = kendo.Class.extend({\n        init: function (workbook) {\n            this.workbook = workbook;\n        },\n        getRefCells: function (ref, hiddenInfo, fsheet, frow, fcol) {\n            var sheet, formula, value, i;\n            if (ref instanceof CellRef) {\n                sheet = this.workbook.sheetByName(ref.sheet);\n                if (!sheet || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                formula = sheet.formula(ref);\n                value = sheet.range(ref.row, ref.col).value();\n                if (formula != null || value != null) {\n                    return [{\n                            formula: formula,\n                            value: value,\n                            row: ref.row,\n                            col: ref.col,\n                            sheet: ref.sheet,\n                            hidden: hiddenInfo ? sheet.columnWidth(ref.col) === 0 || sheet.rowHeight(ref.row) === 0 : false\n                        }];\n                } else {\n                    return [];\n                }\n            }\n            if (ref instanceof RangeRef) {\n                i = this.workbook.sheetIndex(ref.sheet);\n                var states = [], n = i;\n                if (ref.endSheet) {\n                    n = this.workbook.sheetIndex(ref.endSheet);\n                    if (i > n) {\n                        var tmp = i;\n                        i = n;\n                        n = tmp;\n                    }\n                }\n                if (i < 0 || n < 0 || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                while (i <= n) {\n                    sheet = this.workbook.sheetByIndex(i++);\n                    var tl = sheet._grid.normalize(ref.topLeft);\n                    var br = sheet._grid.normalize(ref.bottomRight);\n                    var startCellIndex = sheet._grid.cellRefIndex(tl);\n                    var endCellIndex = sheet._grid.cellRefIndex(br);\n                    var values = sheet._properties.iterator('value', startCellIndex, endCellIndex);\n                    for (var col = tl.col; col <= br.col; ++col) {\n                        for (var row = tl.row; row <= br.row; ++row) {\n                            var index = sheet._grid.index(row, col);\n                            formula = sheet._properties.get('formula', index);\n                            value = values.at(index);\n                            if (formula != null || value != null) {\n                                states.push({\n                                    formula: formula,\n                                    value: value,\n                                    row: row,\n                                    col: col,\n                                    sheet: sheet.name(),\n                                    hidden: hiddenInfo ? sheet.columnWidth(col) === 0 || sheet.rowHeight(row) === 0 : false\n                                });\n                            }\n                        }\n                    }\n                }\n                return states;\n            }\n            if (ref instanceof UnionRef) {\n                var a = [];\n                for (i = 0; i < ref.refs.length; ++i) {\n                    a = a.concat(this.getRefCells(ref.refs[i], hiddenInfo, fsheet, frow, fcol));\n                }\n                return a;\n            }\n            if (ref instanceof NameRef) {\n                var val = this.nameValue(ref, fsheet, frow, fcol);\n                if (val instanceof Ref) {\n                    return this.getRefCells(val, hiddenInfo, fsheet, frow, fcol);\n                }\n                return [{ value: val == null ? new kendo.spreadsheet.calc.runtime.CalcError('NAME') : val }];\n            }\n            return [];\n        },\n        nameValue: function (ref, fsheet, frow, fcol) {\n            var val;\n            if (ref.hasSheet()) {\n                val = this.workbook.nameValue(ref.print());\n            } else {\n                ref = ref.clone().setSheet(fsheet, true);\n                val = this.workbook.nameValue(ref.print());\n                if (val == null) {\n                    val = this.workbook.nameValue(ref.name);\n                }\n            }\n            if (val instanceof Ref) {\n                val = val.absolute(frow, fcol);\n            }\n            return val;\n        },\n        getData: function (ref, fsheet, frow, fcol) {\n            var single = ref instanceof CellRef;\n            if (ref instanceof NameRef) {\n                single = this.workbook.nameValue(ref.name) instanceof CellRef;\n            }\n            var data = this.getRefCells(ref, false, fsheet, frow, fcol).map(function (cell) {\n                var val = cell.value;\n                if (val instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                    val = val.value;\n                }\n                return val;\n            });\n            return single ? data[0] : data;\n        },\n        onFormula: function (f) {\n            var sheet = this.workbook.sheetByName(f.sheet);\n            var row = f.row, col = f.col, value = f.value;\n            var currentFormula = sheet.formula({\n                row: row,\n                col: col\n            });\n            if (currentFormula !== f) {\n                return false;\n            }\n            if (value instanceof Ref) {\n                value = this.getData(value, f.sheet, row, col);\n                if (Array.isArray(value)) {\n                    value = value[0];\n                }\n                if (value === undefined) {\n                    value = null;\n                }\n            }\n            if (value instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                value.each(function (value, r, c) {\n                    sheet._value(row + r, col + c, value);\n                });\n            } else {\n                sheet._value(row, col, value);\n            }\n            clearTimeout(sheet._formulaContextRefresh);\n            sheet._formulaContextRefresh = setTimeout(function () {\n                sheet.batch(function () {\n                }, { layout: true });\n            }, 50);\n            return true;\n        }\n    });\n    var ValidationFormulaContext = FormulaContext.extend({\n        onFormula: function () {\n            return true;\n        }\n    });\n    spreadsheet.FormulaContext = FormulaContext;\n    spreadsheet.ValidationFormulaContext = ValidationFormulaContext;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/controller', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        'use strict';\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var alphaNumRegExp = /:alphanum$/;\n        var ACTIONS = {\n            'up': 'up',\n            'down': 'down',\n            'left': 'left',\n            'right': 'right',\n            'home': 'first-col',\n            'ctrl+left': 'first-col',\n            'end': 'last-col',\n            'ctrl+right': 'last-col',\n            'ctrl+up': 'first-row',\n            'ctrl+down': 'last-row',\n            'ctrl+home': 'first',\n            'ctrl+end': 'last',\n            'pageup': 'prev-page',\n            'pagedown': 'next-page'\n        };\n        var ENTRY_ACTIONS = {\n            'tab': 'next',\n            'shift+tab': 'previous',\n            'enter': 'lower',\n            'shift+enter': 'upper',\n            'delete': 'clearContents',\n            'backspace': 'clearContents',\n            'shift+:alphanum': 'edit',\n            ':alphanum': 'edit',\n            'ctrl+:alphanum': 'ctrl',\n            'alt+ctrl+:alphanum': 'edit',\n            ':edit': 'edit'\n        };\n        var CONTAINER_EVENTS = {\n            'wheel': 'onWheel',\n            '*+mousedown': 'onMouseDown',\n            'contextmenu': 'onContextMenu',\n            '*+mousedrag': 'onMouseDrag',\n            '*+mouseup': 'onMouseUp',\n            '*+dblclick': 'onDblClick',\n            'mousemove': 'onMouseMove'\n        };\n        var CLIPBOARD_EVENTS = {\n            '*+pageup': 'onPageUp',\n            '*+pagedown': 'onPageDown',\n            'mouseup': 'onMouseUp',\n            '*+cut': 'onCut',\n            '*+paste': 'onPaste',\n            '*+copy': 'onCopy'\n        };\n        var EDITOR_EVENTS = {\n            'esc': 'onEditorEsc',\n            'enter': 'onEditorBlur',\n            'alt+enter': 'insertNewline',\n            'shift+enter': 'onEditorBlur',\n            'tab': 'onEditorBlur',\n            'shift+tab': 'onEditorBlur'\n        };\n        var FORMULABAR_EVENTS = $.extend({ focus: 'onEditorBarFocus' }, EDITOR_EVENTS);\n        var FORMULAINPUT_EVENTS = $.extend({ focus: 'onEditorCellFocus' }, EDITOR_EVENTS);\n        var SELECTION_MODES = {\n            cell: 'range',\n            rowheader: 'row',\n            columnheader: 'column',\n            topcorner: 'sheet',\n            autofill: 'autofill'\n        };\n        function toActionSelector(selectors) {\n            return selectors.map(function (action) {\n                return '[data-action=\"' + action + '\"]';\n            }).join(',');\n        }\n        var COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector([\n            'cut',\n            'copy',\n            'paste',\n            'insert-left',\n            'insert-right',\n            'insert-above',\n            'insert-below'\n        ]);\n        var UNHIDE_ACTION_SELECTORS = toActionSelector([\n            'unhide-row',\n            'unhide-column'\n        ]);\n        var ACTION_KEYS = [];\n        var SHIFT_ACTION_KEYS = [];\n        var ENTRY_ACTION_KEYS = [];\n        for (var key in ACTIONS) {\n            ACTION_KEYS.push(key);\n            SHIFT_ACTION_KEYS.push('shift+' + key);\n        }\n        for (key in ENTRY_ACTIONS) {\n            ENTRY_ACTION_KEYS.push(key);\n        }\n        CLIPBOARD_EVENTS[ACTION_KEYS] = 'onAction';\n        CLIPBOARD_EVENTS[SHIFT_ACTION_KEYS] = 'onShiftAction';\n        CLIPBOARD_EVENTS[ENTRY_ACTION_KEYS] = 'onEntryAction';\n        FORMULAINPUT_EVENTS[ACTION_KEYS] = 'onEditorAction';\n        FORMULAINPUT_EVENTS[SHIFT_ACTION_KEYS] = 'onEditorShiftAction';\n        var Controller = kendo.Class.extend({\n            init: function (view, workbook) {\n                this.view = view;\n                this.workbook(workbook);\n                this.container = $(view.container);\n                this.clipboardElement = $(view.clipboard);\n                this.cellContextMenu = view.cellContextMenu;\n                this.rowHeaderContextMenu = view.rowHeaderContextMenu;\n                this.colHeaderContextMenu = view.colHeaderContextMenu;\n                this.scroller = view.scroller;\n                this.tabstrip = view.tabstrip;\n                this.sheetsbar = view.sheetsbar;\n                view.nameEditor.bind('enter', this.onNameEditorEnter.bind(this));\n                view.nameEditor.bind('cancel', this.onNameEditorCancel.bind(this));\n                view.nameEditor.bind('select', this.onNameEditorSelect.bind(this));\n                view.nameEditor.bind('delete', this.onNameEditorDelete.bind(this));\n                this.editor = view.editor;\n                this.editor.bind('change', this.onEditorChange.bind(this));\n                this.editor.bind('activate', this.onEditorActivate.bind(this));\n                this.editor.bind('deactivate', this.onEditorDeactivate.bind(this));\n                this.editor.bind('update', this.onEditorUpdate.bind(this));\n                $(view.scroller).on('scroll', this.onScroll.bind(this));\n                this.listener = new kendo.spreadsheet.EventListener(this.container, this, CONTAINER_EVENTS);\n                this._enableEditorEvents();\n                if (this.sheetsbar) {\n                    this.sheetsbar.bind('select', this.onSheetBarSelect.bind(this));\n                    this.sheetsbar.bind('reorder', this.onSheetBarReorder.bind(this));\n                    this.sheetsbar.bind('rename', this.onSheetBarRename.bind(this));\n                    this.sheetsbar.bind('remove', this.onSheetBarRemove.bind(this));\n                }\n                this.cellContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.rowHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.colHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.cellContextMenu.element.add(this.rowHeaderContextMenu.element).add(this.colHeaderContextMenu.element).on('contextmenu', false);\n                if (this.tabstrip) {\n                    this.tabstrip.bind('action', this.onCommandRequest.bind(this));\n                    this.tabstrip.bind('dialog', this.onDialogRequest.bind(this));\n                }\n            },\n            _enableEditorEvents: function (enable) {\n                if (enable === undefined || enable) {\n                    this.keyListener = new kendo.spreadsheet.EventListener(this.clipboardElement, this, CLIPBOARD_EVENTS);\n                    this.barKeyListener = new kendo.spreadsheet.EventListener(this.editor.barElement(), this, FORMULABAR_EVENTS);\n                    this.inputKeyListener = new kendo.spreadsheet.EventListener(this.editor.cellElement(), this, FORMULAINPUT_EVENTS);\n                } else {\n                    this.keyListener.destroy();\n                    this.barKeyListener.destroy();\n                    this.inputKeyListener.destroy();\n                }\n            },\n            _execute: function (options) {\n                var result = this._workbook.execute(options);\n                if (options.command === 'EditCommand' && !result) {\n                    this._workbook.trigger('change', { editorClose: true });\n                }\n                if (result) {\n                    this._preventNavigation = true;\n                    if (result.reason === 'error') {\n                        this.view.showError(result, function () {\n                            this.activateEditor();\n                            this.editor.value(this._lastEditorValue);\n                            this.editor._value = this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell());\n                            this.editor.select();\n                        }.bind(this));\n                    } else {\n                        this.view.openDialog(result.reason);\n                    }\n                }\n                return result;\n            },\n            _activeTooltip: function () {\n                return this._workbook.activeSheet().activeCell().simplify().toString();\n            },\n            onContextMenuSelect: function (e) {\n                var action = $(e.item).data('action');\n                var command;\n                switch (action) {\n                case 'cut':\n                    command = {\n                        command: 'ToolbarCutCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'copy':\n                    command = {\n                        command: 'ToolbarCopyCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'paste':\n                    command = {\n                        command: 'ToolbarPasteCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'unmerge':\n                    command = {\n                        command: 'MergeCellCommand',\n                        options: { value: 'unmerge' }\n                    };\n                    break;\n                case 'merge':\n                    this.view.openDialog('merge');\n                    break;\n                case 'hide-row':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'hide-column':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'unhide-row':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'unhide-column':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'delete-row':\n                    command = { command: 'DeleteRowCommand' };\n                    break;\n                case 'delete-column':\n                    command = { command: 'DeleteColumnCommand' };\n                    break;\n                }\n                if (command) {\n                    this._execute(command);\n                }\n            },\n            onSheetBarRemove: function (e) {\n                var sheet = this._workbook.sheetByName(e.name);\n                if (!sheet) {\n                    return;\n                }\n                this._workbook.removeSheet(sheet);\n            },\n            destroy: function () {\n                this.listener.destroy();\n                this._enableEditorEvents(false);\n                this.keyListener.destroy();\n                this.inputKeyListener.destroy();\n            },\n            onSheetBarSelect: function (e) {\n                var sheet;\n                var workbook = this._workbook;\n                if (e.isAddButton) {\n                    if (this._workbook.trigger('insertSheet')) {\n                        return;\n                    }\n                    sheet = workbook.insertSheet();\n                } else {\n                    sheet = workbook.sheetByName(e.name);\n                }\n                if (workbook.activeSheet().name() !== sheet.name()) {\n                    if (this._workbook.trigger('selectSheet', { sheet: sheet })) {\n                        return;\n                    }\n                    workbook.activeSheet(sheet);\n                }\n            },\n            onSheetBarReorder: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.oldIndex);\n                this._workbook.moveSheetToIndex(sheet, e.newIndex);\n                this._workbook.activeSheet(sheet);\n            },\n            onSheetBarRename: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.sheetIndex);\n                if (this._workbook.sheetByName(e.name)) {\n                    this.view.showError({\n                        reason: 'error',\n                        type: 'duplicateSheetName'\n                    });\n                    return;\n                }\n                this._workbook.renameSheet(sheet, e.name);\n                this.clipboardElement.focus();\n            },\n            sheet: function (sheet) {\n                this.navigator = sheet.navigator();\n                this.axisManager = sheet.axisManager();\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n                this.clipboard = workbook.clipboard();\n                workbook.bind('commandRequest', this.onCommandRequest.bind(this));\n            },\n            refresh: function () {\n                var editor = this.editor;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                this._viewPortHeight = this.view.scroller.clientHeight;\n                this.navigator.height(this._viewPortHeight);\n                if (!editor.isActive() && !this.isEditorDisabled) {\n                    editor.enable(sheet.selection().enable() !== false);\n                    editor.value(workbook._inputForRef(sheet.activeCell()));\n                }\n                var ref = sheet.selection()._ref.simplify();\n                var def = this._workbook.nameForRef(ref, sheet.name());\n                this.view.nameEditor.value(def.name);\n            },\n            onScroll: function () {\n                this.view.render();\n            },\n            onWheel: function (event) {\n                var deltaX = event.originalEvent.deltaX;\n                var deltaY = event.originalEvent.deltaY;\n                if (event.originalEvent.deltaMode === 1) {\n                    deltaX *= 10;\n                    deltaY *= 10;\n                }\n                this.scrollWith(deltaX, deltaY);\n                event.preventDefault();\n            },\n            onAction: function (event, action) {\n                this.navigator.moveActiveCell(ACTIONS[action]);\n                event.preventDefault();\n            },\n            onPageUp: function () {\n                this.scrollDown(-this._viewPortHeight);\n            },\n            onPageDown: function () {\n                this.scrollDown(this._viewPortHeight);\n            },\n            onEntryAction: function (event, action) {\n                if (event.mod) {\n                    var shouldPrevent = true;\n                    var key = String.fromCharCode(event.keyCode);\n                    switch (key) {\n                    case 'A':\n                        this.navigator.selectAll();\n                        break;\n                    case 'Y':\n                        this._workbook.undoRedoStack.redo();\n                        break;\n                    case 'Z':\n                        this._workbook.undoRedoStack.undo();\n                        break;\n                    default:\n                        shouldPrevent = false;\n                        break;\n                    }\n                    if (shouldPrevent) {\n                        event.preventDefault();\n                    }\n                } else {\n                    var disabled = this._workbook.activeSheet().selection().enable() === false;\n                    if (action == 'delete' || action == 'backspace') {\n                        if (!disabled) {\n                            this._execute({ command: 'ClearContentCommand' });\n                        }\n                        event.preventDefault();\n                    } else if (alphaNumRegExp.test(action) || action === ':edit') {\n                        if (disabled) {\n                            event.preventDefault();\n                            return;\n                        }\n                        if (action !== ':edit') {\n                            this.editor.value('');\n                        }\n                        this.activateEditor();\n                    } else {\n                        this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                        event.preventDefault();\n                    }\n                }\n            },\n            onShiftAction: function (event, action) {\n                this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                event.preventDefault();\n            },\n            onMouseMove: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress() || sheet.selectionInProgress()) {\n                    return;\n                }\n                var object = this.objectAt(event);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.positionResizeHandle(object.ref);\n                } else {\n                    sheet.removeResizeHandle();\n                }\n            },\n            onMouseDown: function (event) {\n                var object = this.objectAt(event);\n                if (object.pane) {\n                    this.originFrame = object.pane;\n                }\n                if (object.type === 'editor') {\n                    this.onEditorEsc();\n                    this.openCustomEditor();\n                    event.preventDefault();\n                    return;\n                }\n                if (this.editor.canInsertRef(false) && object.ref) {\n                    this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n                    this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey);\n                    event.preventDefault();\n                    return;\n                } else {\n                    this._preventNavigation = false;\n                    this.editor.deactivate();\n                    if (this._preventNavigation) {\n                        return;\n                    }\n                }\n                var sheet = this._workbook.activeSheet();\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.startResizing({\n                        x: object.x,\n                        y: object.y\n                    });\n                    event.preventDefault();\n                    return;\n                }\n                if (object.type === 'filtericon') {\n                    this.openFilterMenu(event);\n                    event.preventDefault();\n                    return;\n                }\n                this._selectionMode = SELECTION_MODES[object.type];\n                this.appendSelection = event.mod;\n                this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey);\n            },\n            onContextMenu: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress()) {\n                    return;\n                }\n                event.preventDefault();\n                this.cellContextMenu.close();\n                this.colHeaderContextMenu.close();\n                this.rowHeaderContextMenu.close();\n                var menu;\n                var object = this.objectAt(event);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    return;\n                }\n                this.navigator.selectForContextMenu(object.ref, SELECTION_MODES[object.type]);\n                var isComposite = this.navigator._sheet.select() instanceof kendo.spreadsheet.UnionRef;\n                var showUnhide = false;\n                var showUnmerge = false;\n                if (object.type == 'columnheader') {\n                    menu = this.colHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenColumns();\n                } else if (object.type == 'rowheader') {\n                    menu = this.rowHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenRows();\n                } else {\n                    menu = this.cellContextMenu;\n                    showUnmerge = this.navigator.selectionIncludesMergedCells();\n                }\n                menu.element.find(COMPOSITE_UNAVAILABLE_ACTION_SELECTORS).toggle(!isComposite);\n                menu.element.find(UNHIDE_ACTION_SELECTORS).toggle(showUnhide);\n                menu.element.find('[data-action=unmerge]').toggle(showUnmerge);\n                setTimeout(function () {\n                    menu.open(event.pageX, event.pageY);\n                });\n            },\n            prevent: function (event) {\n                event.preventDefault();\n            },\n            constrainResize: function (type, ref) {\n                var sheet = this._workbook.activeSheet();\n                var resizeHandle = sheet.resizeHandlePosition();\n                return !resizeHandle || type === 'outside' || type === 'topcorner' || ref.col < resizeHandle.col || ref.row < resizeHandle.row;\n            },\n            onMouseDrag: function (event) {\n                if (this._selectionMode === 'sheet') {\n                    return;\n                }\n                var location = {\n                    clientX: event.clientX,\n                    clientY: event.clientY\n                };\n                var object = this.objectAt(location);\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress()) {\n                    if (!this.constrainResize(object.type, object.ref)) {\n                        sheet.resizeHintPosition({\n                            x: object.x,\n                            y: object.y\n                        });\n                    }\n                    return;\n                }\n                if (object.type === 'outside') {\n                    this.startAutoScroll(object);\n                    return;\n                }\n                if (this.originFrame === object.pane) {\n                    this.selectToLocation(location);\n                } else {\n                    var frame = this.originFrame._grid;\n                    if (object.x > frame.right) {\n                        this.scrollLeft();\n                    }\n                    if (object.y > frame.bottom) {\n                        this.scrollTop();\n                    }\n                    if (object.y < frame.top || object.x < frame.left) {\n                        this.startAutoScroll(object, location);\n                    } else {\n                        this.selectToLocation(location);\n                    }\n                }\n                event.preventDefault();\n            },\n            onMouseUp: function (event) {\n                var sheet = this._workbook.activeSheet();\n                sheet.completeResizing();\n                this.navigator.completeSelection();\n                this.stopAutoScroll();\n                var editor = this.editor.activeEditor();\n                if (!editor) {\n                    return;\n                }\n                var el = event.target;\n                while (el) {\n                    if (el === editor.element[0]) {\n                        return;\n                    }\n                    el = el.parentNode;\n                }\n                var object = this.objectAt(event);\n                if (object && object.ref && editor.canInsertRef(false)) {\n                    editor.refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                }\n            },\n            onDblClick: function (event) {\n                var object = this.objectAt(event);\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (object.type !== 'cell' || disabled) {\n                    return;\n                }\n                this.editor.activate({\n                    range: this._workbook.activeSheet()._viewActiveCell(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                }).focus();\n                this.onEditorUpdate();\n            },\n            onCut: function (e) {\n                if (e) {\n                    var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                    this.clipboardElement.append(table.clone(false));\n                    setTimeout(function () {\n                        this.clipboardElement.empty().append(table);\n                    }.bind(this));\n                }\n                this._execute({\n                    command: 'CutCommand',\n                    options: {\n                        workbook: this.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            clipBoardValue: function () {\n                return this.clipboardElement.html();\n            },\n            onPaste: function (e) {\n                var html = '';\n                var plain = '';\n                this.clipboard.menuInvoked = e === undefined;\n                if (e) {\n                    if (e.originalEvent.clipboardData && e.originalEvent.clipboardData.getData) {\n                        e.preventDefault();\n                        var hasHTML = false;\n                        var hasPlainText = false;\n                        if (window.DOMStringList && e.originalEvent.clipboardData.types instanceof window.DOMStringList) {\n                            hasHTML = e.originalEvent.clipboardData.types.contains('text/html');\n                            hasPlainText = e.originalEvent.clipboardData.types.contains('text/plain');\n                        } else {\n                            hasHTML = /text\\/html/.test(e.originalEvent.clipboardData.types);\n                            hasPlainText = /text\\/plain/.test(e.originalEvent.clipboardData.types);\n                        }\n                        if (hasHTML) {\n                            html = e.originalEvent.clipboardData.getData('text/html');\n                        }\n                        if (hasPlainText) {\n                            plain = e.originalEvent.clipboardData.getData('text/plain').trim();\n                        }\n                    } else {\n                        var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                        this.clipboardElement.empty();\n                        setTimeout(function () {\n                            var html = this.clipboardElement.html();\n                            var plain = window.clipboardData.getData('Text').trim();\n                            if (!html && !plain) {\n                                return;\n                            }\n                            this.clipboard.external({\n                                html: html,\n                                plain: plain\n                            });\n                            this.clipboardElement.empty().append(table);\n                            this._execute({\n                                command: 'PasteCommand',\n                                options: {\n                                    workbook: this.view._workbook,\n                                    event: e.originalEvent || e\n                                }\n                            });\n                            this.clipboard.menuInvoked = true;\n                        }.bind(this));\n                        return;\n                    }\n                } else {\n                    if (kendo.support.browser.msie) {\n                        this.clipboardElement.focus().select();\n                        document.execCommand('paste');\n                        return;\n                    } else {\n                        this.clipboard.menuInvoked = true;\n                    }\n                }\n                if (!html && !plain) {\n                    return;\n                }\n                this.clipboard.external({\n                    html: html,\n                    plain: plain\n                });\n                this._execute({\n                    command: 'PasteCommand',\n                    options: {\n                        workbook: this.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            onCopy: function (e) {\n                this.clipboard.menuInvoked = e === undefined;\n                this._execute({\n                    command: 'CopyCommand',\n                    options: {\n                        workbook: this.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            scrollTop: function () {\n                this.scroller.scrollTop = 0;\n            },\n            scrollLeft: function () {\n                this.scroller.scrollLeft = 0;\n            },\n            scrollDown: function (value) {\n                this.scroller.scrollTop += value;\n            },\n            scrollRight: function (value) {\n                this.scroller.scrollLeft += value;\n            },\n            scrollWith: function (right, down) {\n                this.scroller.scrollTop += down;\n                this.scroller.scrollLeft += right;\n            },\n            objectAt: function (location) {\n                var box = this.container[0].getBoundingClientRect();\n                return this.view.objectAt(location.clientX - box.left, location.clientY - box.top);\n            },\n            selectToLocation: function (cellLocation) {\n                var object = this.objectAt(cellLocation);\n                if (object.pane) {\n                    this.extendSelection(object);\n                    this.lastKnownCellLocation = cellLocation;\n                    this.originFrame = object.pane;\n                }\n                this.stopAutoScroll();\n            },\n            extendSelection: function (object) {\n                this.navigator.extendSelection(object.ref, this._selectionMode, this.appendSelection);\n            },\n            autoScroll: function () {\n                var x = this._autoScrollTarget.x;\n                var y = this._autoScrollTarget.y;\n                var boundaries = this.originFrame._grid;\n                var scroller = this.view.scroller;\n                var scrollStep = 8;\n                var scrollLeft = scroller.scrollLeft;\n                var scrollTop = scroller.scrollTop;\n                if (x < boundaries.left) {\n                    this.scrollRight(-scrollStep);\n                }\n                if (x > boundaries.right) {\n                    this.scrollRight(scrollStep);\n                }\n                if (y < boundaries.top) {\n                    this.scrollDown(-scrollStep);\n                }\n                if (y > boundaries.bottom) {\n                    this.scrollDown(scrollStep);\n                }\n                if (scrollTop === scroller.scrollTop && scrollLeft === scroller.scrollLeft) {\n                    this.selectToLocation(this.finalLocation);\n                } else {\n                    this.extendSelection(this.objectAt(this.lastKnownCellLocation));\n                }\n            },\n            startAutoScroll: function (viewObject, location) {\n                if (!this._scrollInterval) {\n                    this._scrollInterval = setInterval(this.autoScroll.bind(this), 50);\n                }\n                this.finalLocation = location || this.lastKnownCellLocation;\n                this._autoScrollTarget = viewObject;\n            },\n            stopAutoScroll: function () {\n                clearInterval(this._scrollInterval);\n                this._scrollInterval = null;\n            },\n            openCustomEditor: function () {\n                this.view.openCustomEditor();\n            },\n            openFilterMenu: function (event) {\n                var object = this.objectAt(event);\n                var sheet = this._workbook.activeSheet();\n                var column = sheet.filterColumn(object.ref);\n                var filterMenu = this.view.createFilterMenu(column);\n                filterMenu.bind('action', this.onCommandRequest.bind(this));\n                filterMenu.bind('action', filterMenu.close.bind(filterMenu));\n                filterMenu.openFor(event.target);\n            },\n            onEditorChange: function (e) {\n                this._workbook.activeSheet().isInEditMode(false);\n                this._lastEditorValue = e.value;\n                this._execute({\n                    command: 'EditCommand',\n                    options: {\n                        editActiveCell: true,\n                        value: e.value\n                    }\n                });\n            },\n            onEditorActivate: function () {\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                sheet._setFormulaSelections(this.editor.highlightedRefs());\n                sheet.isInEditMode(true);\n            },\n            onEditorDeactivate: function () {\n                var sheet = this._workbook.activeSheet();\n                sheet.isInEditMode(false);\n                sheet._setFormulaSelections([]);\n            },\n            onEditorUpdate: function () {\n                this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n            },\n            onEditorBarFocus: function () {\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (disabled) {\n                    return;\n                }\n                this.editor.activate({\n                    range: this._workbook.activeSheet()._viewActiveCell(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                });\n            },\n            onEditorCellFocus: function () {\n                this.editor.scale();\n            },\n            onEditorEsc: function () {\n                this.resetEditorValue();\n                this.editor.deactivate();\n                this.clipboardElement.focus();\n            },\n            insertNewline: function (e) {\n                e.preventDefault();\n                this.editor.insertNewline();\n            },\n            onEditorBlur: function (_, action) {\n                if (this.editor.isFiltered()) {\n                    return;\n                }\n                this._preventNavigation = false;\n                this.editor.deactivate();\n                if (!this._preventNavigation) {\n                    this.clipboardElement.focus();\n                    this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                }\n            },\n            onEditorAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    editor.activeEditor().refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            onEditorShiftAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                    editor.activeEditor().refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            resetEditorValue: function () {\n                this.editor.value(this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell()));\n            },\n            activateEditor: function () {\n                this.editor.activate({\n                    range: this._workbook.activeSheet()._viewActiveCell(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                }).focus();\n            },\n            deactivateEditor: function () {\n                this.view.editor.deactivate();\n            },\n            onCommandRequest: function (e) {\n                if (e.command) {\n                    this._execute(e);\n                } else {\n                    this._workbook.undoRedoStack[e.action]();\n                }\n            },\n            onDialogRequest: function (e) {\n                var additionalOptions = {\n                    pdfExport: this._workbook.options.pdf,\n                    excelExport: this._workbook.options.excel\n                };\n                if (e.options) {\n                    $.extend(true, e.options, additionalOptions);\n                } else {\n                    e.options = additionalOptions;\n                }\n                this.view.openDialog(e.name, e.options);\n            },\n            onNameEditorEnter: function () {\n                var ref;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                var name = this.view.nameEditor.value();\n                ref = kendo.spreadsheet.calc.parseReference(name, true) || workbook.nameValue(name);\n                if (ref instanceof kendo.spreadsheet.Ref) {\n                    if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                        var tmp = workbook.sheetByName(ref.sheet);\n                        if (tmp) {\n                            workbook.activeSheet(tmp);\n                            sheet = tmp;\n                        }\n                    }\n                    sheet.range(ref).select();\n                    return;\n                }\n                ref = sheet.selection()._ref.clone().simplify().setSheet(sheet.name(), true);\n                this._execute({\n                    command: 'DefineNameCommand',\n                    options: {\n                        name: name,\n                        value: ref\n                    }\n                });\n                this.clipboardElement.focus();\n            },\n            onNameEditorCancel: function () {\n                this.clipboardElement.focus();\n            },\n            onNameEditorSelect: function (ev) {\n                var name = ev.name;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                var ref = workbook.nameValue(name);\n                if (ref instanceof kendo.spreadsheet.Ref) {\n                    if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                        var tmp = workbook.sheetByName(ref.sheet);\n                        if (tmp) {\n                            workbook.activeSheet(tmp);\n                            sheet = tmp;\n                        }\n                    }\n                    sheet.range(ref).select();\n                    return;\n                }\n                this.clipboardElement.focus();\n            },\n            onNameEditorDelete: function (ev) {\n                this._execute({\n                    command: 'DeleteNameCommand',\n                    options: { name: ev.name }\n                });\n                this.clipboardElement.focus();\n            }\n        });\n        kendo.spreadsheet.Controller = Controller;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/view', [\n        'kendo.core',\n        'kendo.menu',\n        'spreadsheet/sheetsbar'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var DOT = '.';\n        var RESIZE_HANDLE_WIDTH = 7;\n        var viewClassNames = {\n            view: 'k-spreadsheet-view',\n            fixedContainer: 'k-spreadsheet-fixed-container',\n            editContainer: 'k-spreadsheet-edit-container',\n            scroller: 'k-spreadsheet-scroller',\n            viewSize: 'k-spreadsheet-view-size',\n            clipboard: 'k-spreadsheet-clipboard',\n            cellEditor: 'k-spreadsheet-cell-editor',\n            barEditor: 'k-spreadsheet-editor',\n            topCorner: 'k-spreadsheet-top-corner',\n            filterHeadersWrapper: 'k-filter-wrapper',\n            filterRange: 'k-filter-range',\n            filterButton: 'k-spreadsheet-filter',\n            filterButtonActive: 'k-state-active',\n            horizontalResize: 'k-horizontal-resize',\n            verticalResize: 'k-vertical-resize',\n            icon: 'k-icon',\n            iconFilterDefault: 'k-i-arrow-60-down',\n            sheetsBar: 'k-spreadsheet-sheets-bar',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            cellContextMenu: 'k-spreadsheet-cell-context-menu',\n            rowHeaderContextMenu: 'k-spreadsheet-row-header-context-menu',\n            colHeaderContextMenu: 'k-spreadsheet-col-header-context-menu'\n        };\n        kendo.spreadsheet.messages.view = {\n            errors: {\n                openUnsupported: 'Unsupported format. Please select an .xlsx file.',\n                shiftingNonblankCells: 'Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.',\n                insertColumnWhenRowIsSelected: 'Cannot insert column when all columns are selected.',\n                insertRowWhenColumnIsSelected: 'Cannot insert row when all rows are selected.',\n                filterRangeContainingMerges: 'Cannot create a filter within a range containing merges',\n                sortRangeContainingMerges: 'Cannot sort a range containing merges',\n                cantSortMultipleSelection: 'Cannot sort multiple selection',\n                cantSortNullRef: 'Cannot sort empty selection',\n                cantSortMixedCells: 'Cannot sort range containing cells of mixed shapes',\n                validationError: 'The value that you entered violates the validation rules set on the cell.',\n                cannotModifyDisabled: 'Cannot modify disabled cells.'\n            },\n            tabs: {\n                home: 'Home',\n                insert: 'Insert',\n                data: 'Data'\n            }\n        };\n        function selectElementContents(el) {\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            var range = document.createRange();\n            range.selectNodeContents(el);\n            sel.addRange(range);\n        }\n        function cellBefore(table, row) {\n            var cells = table.trs[row].children;\n            return cells[cells.length - 2];\n        }\n        function cellAbove(table, row) {\n            var prevRow = table.trs[row - 1];\n            var index = table.trs[row].children.length - 1;\n            if (prevRow && index >= 0) {\n                return prevRow.children[index];\n            }\n        }\n        function cellBorder(value) {\n            return [\n                'solid',\n                (value.size || 1) + 'px',\n                value.color || '#000'\n            ].join(' ');\n        }\n        function asURL(link) {\n            if (!/:\\/\\//.test(link)) {\n                link = 'http://' + link;\n            }\n            return link;\n        }\n        function drawCell(collection, cell, cls, hBorders, vBorders, showGrid) {\n            function maybeLink(el) {\n                var link = cell.link;\n                if (!link) {\n                    if (typeof cell.value == 'object') {\n                        link = cell.value.link;\n                    }\n                }\n                if (link) {\n                    var style = { textDecoration: 'none' };\n                    if (cell.color) {\n                        style.color = cell.color;\n                    }\n                    if (cell.underline) {\n                        style.textDecoration = 'underline';\n                    }\n                    return kendo.dom.element('a', {\n                        href: asURL(link),\n                        style: style,\n                        target: '_blank'\n                    }, el ? [el] : []);\n                }\n                return el;\n            }\n            if (!cls && !kendo.spreadsheet.draw.shouldDrawCell(cell)) {\n                return;\n            }\n            var left = cell.left;\n            var top = cell.top;\n            var width = cell.width + 1;\n            var height = cell.height + 1;\n            var style = {};\n            var background = cell.background;\n            var defaultBorder = null;\n            if (background) {\n                defaultBorder = background;\n                if (showGrid) {\n                    defaultBorder = kendo.parseColor(defaultBorder).toHSV();\n                    defaultBorder.v *= 0.9;\n                    defaultBorder = defaultBorder.toCssRgba();\n                }\n                defaultBorder = cellBorder({ color: defaultBorder });\n            }\n            if (background) {\n                style.backgroundColor = background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.overflowWrap = 'break-word';\n                style.wordWrap = 'break-word';\n            }\n            if (cell.borderLeft) {\n                style.borderLeft = cellBorder(cell.borderLeft);\n                if (vBorders) {\n                    vBorders[cell.left] = true;\n                }\n            } else if (defaultBorder && vBorders && !vBorders[cell.left]) {\n                style.borderLeft = defaultBorder;\n            } else {\n                left++;\n                width--;\n            }\n            if (cell.borderTop) {\n                style.borderTop = cellBorder(cell.borderTop);\n                if (hBorders) {\n                    hBorders[cell.top] = true;\n                }\n            } else if (defaultBorder && hBorders && !hBorders[cell.top]) {\n                style.borderTop = defaultBorder;\n            } else {\n                top++;\n                height--;\n            }\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n                if (vBorders) {\n                    vBorders[cell.right] = true;\n                }\n            } else if (defaultBorder && vBorders && !vBorders[cell.right]) {\n                style.borderRight = defaultBorder;\n            } else {\n                width--;\n            }\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n                if (hBorders) {\n                    hBorders[cell.bottom] = true;\n                }\n            } else if (defaultBorder && hBorders && !hBorders[cell.bottom]) {\n                style.borderBottom = defaultBorder;\n            } else {\n                height--;\n            }\n            style.left = left + 'px';\n            style.top = top + 'px';\n            style.width = width + 'px';\n            style.height = height + 'px';\n            var data = cell.value, type = typeof data;\n            if (cell.format && data != null) {\n                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            } else if (data !== null && data !== undefined) {\n                data = kendo.dom.text(data);\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var classNames = [paneClassNames.cell];\n            if (cls) {\n                classNames.push(cls);\n            }\n            if (cell.enable === false) {\n                classNames.push('k-state-disabled');\n            }\n            if (cell.merged) {\n                classNames.push('k-spreadsheet-merged-cell');\n            }\n            var verticalAlign = cell.verticalAlign || 'bottom';\n            if (verticalAlign && data) {\n                data = kendo.dom.element('div', { className: 'k-vertical-align-' + verticalAlign }, [maybeLink(data)]);\n            } else {\n                data = maybeLink(data);\n            }\n            var children = data ? [data] : [];\n            var properties = { style: style };\n            var validation = cell.validation;\n            if (validation && !validation.value) {\n                children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                classNames.push('k-dirty-cell');\n                properties.title = validation.message;\n            }\n            properties.className = classNames.join(' ');\n            var div = kendo.dom.element('div', properties, children);\n            collection.push(div);\n            return div;\n        }\n        function addCell(table, row, cell) {\n            var style = {};\n            if (cell.background) {\n                style.backgroundColor = cell.background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.verticalAlign) {\n                style.verticalAlign = cell.verticalAlign === 'center' ? 'middle' : cell.verticalAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.wordBreak = 'break-all';\n            }\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n            } else if (cell.background) {\n                style.borderRightColor = cell.background;\n            }\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n            } else if (cell.background) {\n                style.borderBottomColor = cell.background;\n            }\n            var data = cell.value, type = typeof data;\n            if (cell.format && data != null) {\n                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var className = null;\n            if (cell.enable === false) {\n                className = 'k-state-disabled';\n            }\n            var td = table.addCell(row, data, style, className, cell.validation);\n            var border, sibling;\n            if (cell.borderLeft) {\n                sibling = cellBefore(table, row);\n                border = cellBorder(cell.borderLeft);\n                if (sibling && border) {\n                    sibling.attr.style.borderRight = border;\n                }\n            } else if (cell.background) {\n                style.borderLeftColor = cell.background;\n            }\n            if (cell.borderTop) {\n                sibling = cellAbove(table, row);\n                border = cellBorder(cell.borderTop);\n                if (sibling && border) {\n                    sibling.attr.style.borderBottom = border;\n                }\n            } else if (cell.background) {\n                style.borderTopColor = cell.background;\n            }\n            return td;\n        }\n        var HtmlTable = kendo.Class.extend({\n            init: function () {\n                this.cols = [];\n                this.trs = [];\n                this._height = 0;\n                this._width = 0;\n            },\n            addColumn: function (width) {\n                this._width += width;\n                var col = kendo.dom.element('col', { style: { width: width + 'px' } });\n                col.visible = width > 0;\n                this.cols.push(col);\n            },\n            addRow: function (height) {\n                var attr = null;\n                attr = { style: { height: height + 'px' } };\n                this._height += height;\n                var tr = kendo.dom.element('tr', attr);\n                tr.visible = height > 0;\n                this.trs.push(tr);\n            },\n            addCell: function (rowIndex, text, style, className, validation) {\n                if (text === null || text === undefined) {\n                    text = '';\n                }\n                if (!(text instanceof kendo.dom.Node)) {\n                    text = kendo.dom.text(text);\n                }\n                var children = [text];\n                var properties = { style: style };\n                if (validation && !validation.value) {\n                    children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                    className = (className || '') + (className ? ' ' : '') + 'k-dirty-cell';\n                    properties.title = validation.message;\n                }\n                if (className) {\n                    properties.className = className;\n                }\n                var td = kendo.dom.element('td', properties, children);\n                this.trs[rowIndex].children.push(td);\n                return td;\n            },\n            toDomTree: function (x, y, className) {\n                this.trs = this.trs.filter(function (tr) {\n                    return tr.visible;\n                });\n                var offset = 0;\n                this.cols = this.cols.filter(function (col, ci) {\n                    if (!col.visible) {\n                        this.trs.forEach(function (tr) {\n                            tr.children.splice(ci - offset, 1);\n                        });\n                        offset++;\n                    }\n                    return col.visible;\n                }, this);\n                return kendo.dom.element('table', {\n                    style: {\n                        left: x + 'px',\n                        top: y + 'px',\n                        height: this._height + 'px',\n                        width: this._width + 'px'\n                    },\n                    className: className\n                }, [\n                    kendo.dom.element('colgroup', null, this.cols),\n                    kendo.dom.element('tbody', null, this.trs)\n                ]);\n            }\n        });\n        var CELL_CONTEXT_MENU = '<ul class=\"#=classNames.cellContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=merge>Merge</li>' + '<li data-action=unmerge>Unmerge</li>' + '</ul>';\n        var ROW_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.rowHeaderContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-row\">Delete</li>' + '<li data-action=\"hide-row\">Hide</li>' + '<li data-action=\"unhide-row\">Unhide</li>' + '</ul>';\n        var COL_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.colHeaderContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-column\">Delete</li>' + '<li data-action=\"hide-column\">Hide</li>' + '<li data-action=\"unhide-column\">Unhide</li>' + '</ul>';\n        kendo.spreadsheet.ContextMenu = kendo.ui.ContextMenu;\n        var VIEW_CONTENTS = kendo.template('<div class=\"#=classNames.view#\"><div class=\"#=classNames.fixedContainer#\"></div><div class=\"#=classNames.scroller#\"><div class=\"#=classNames.viewSize#\"></div></div>' + '<div tabindex=\"0\" class=\"#=classNames.clipboard#\" contenteditable=true></div><div class=\"#=classNames.cellEditor#\"></div></div><div class=\"#=classNames.sheetsBar#\"></div>' + CELL_CONTEXT_MENU + ROW_HEADER_CONTEXT_MENU + COL_HEADER_CONTEXT_MENU);\n        function within(value, min, max) {\n            return value >= min && value <= max;\n        }\n        var View = kendo.Class.extend({\n            init: function (element, options) {\n                var classNames = View.classNames;\n                this.element = element;\n                this.options = $.extend(true, { messages: kendo.spreadsheet.messages.view }, this.options, options);\n                this._chrome();\n                this._dialogs = [];\n                element.append(VIEW_CONTENTS({ classNames: classNames }));\n                this._formulaInput();\n                this.wrapper = element.find(DOT + classNames.view);\n                this.container = element.find(DOT + classNames.fixedContainer)[0];\n                this.scroller = element.find(DOT + classNames.scroller)[0];\n                this.clipboard = element.find(DOT + classNames.clipboard);\n                this.viewSize = $(this.scroller.firstChild);\n                this.tree = new kendo.dom.Tree(this.container);\n                this.clipboardContents = new kendo.dom.Tree(this.clipboard[0]);\n                this.editor = new kendo.spreadsheet.SheetEditor(this);\n                this._sheetsbar();\n                var contextMenuConfig = {\n                    target: element,\n                    animation: false,\n                    showOn: 'never'\n                };\n                this.cellContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.cellContextMenu), contextMenuConfig);\n                this.colHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.colHeaderContextMenu), contextMenuConfig);\n                this.rowHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.rowHeaderContextMenu), contextMenuConfig);\n                var scrollbar = kendo.support.scrollbar();\n                $(this.container).css({\n                    width: this.wrapper[0].clientWidth - scrollbar,\n                    height: this.wrapper[0].clientHeight - scrollbar\n                });\n            },\n            enableClipboard: function (enable) {\n                this.isClipboardDeactivated = !enable;\n                if (enable) {\n                    this.clipboard.attr('contenteditable', enable);\n                } else {\n                    this.clipboard.removeAttr('contenteditable');\n                }\n            },\n            _resize: function () {\n                var outerHeight = kendo._outerHeight;\n                var tabstripHeight = this.tabstrip ? outerHeight(this.tabstrip.element) : 0;\n                var formulaBarHeight = this.formulaBar ? outerHeight(this.formulaBar.element) : 0;\n                var sheetsBarHeight = this.sheetsbar ? outerHeight(this.sheetsbar.element) : 0;\n                this.wrapper.height(this.element.height() - (tabstripHeight + formulaBarHeight + sheetsBarHeight));\n                if (this.tabstrip) {\n                    this.tabstrip.quickAccessAdjust();\n                }\n            },\n            _chrome: function () {\n                var wrapper = $('<div class=\\'k-spreadsheet-action-bar\\' />').prependTo(this.element);\n                var nameEditor = $('<div class=\\'k-spreadsheet-name-editor\\' />').appendTo(wrapper);\n                this.nameEditor = new kendo.spreadsheet.NameEditor(nameEditor);\n                var formulaBar = $('<div />').appendTo(wrapper);\n                this.formulaBar = new kendo.spreadsheet.FormulaBar(formulaBar);\n                if (this.options.toolbar) {\n                    this._tabstrip();\n                }\n            },\n            _formulaInput: function () {\n                var editor = this.element.find(DOT + View.classNames.cellEditor);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput(editor, { autoScale: true });\n            },\n            _sheetsbar: function () {\n                if (this.options.sheetsbar) {\n                    var options = $.extend(true, { openDialog: this.openDialog.bind(this) }, this.options.sheetsbar);\n                    this.sheetsbar = new kendo.spreadsheet.SheetsBar(this.element.find(DOT + View.classNames.sheetsBar), options);\n                }\n            },\n            _tabstrip: function () {\n                var messages = this.options.messages.tabs;\n                var options = $.extend(true, {\n                    home: true,\n                    insert: true,\n                    data: true\n                }, this.options.toolbar);\n                var tabs = [];\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                    this.element.children('.k-tabstrip').remove();\n                }\n                for (var name in options) {\n                    if (options[name] === true || options[name] instanceof Array) {\n                        tabs.push({\n                            id: name,\n                            text: messages[name],\n                            content: ''\n                        });\n                    }\n                }\n                this.tabstrip = new kendo.spreadsheet.TabStrip($('<div />').prependTo(this.element), {\n                    animation: false,\n                    dataTextField: 'text',\n                    dataContentField: 'content',\n                    dataSource: tabs,\n                    toolbarOptions: options,\n                    view: this\n                });\n                this.tabstrip.select(0);\n            },\n            _executeCommand: function (e) {\n                this._sheet.trigger('commandRequest', e);\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n                this.nameEditor._workbook = workbook;\n            },\n            sheet: function (sheet) {\n                this._sheet = sheet;\n            },\n            activeCellRectangle: function () {\n                return this.cellRectangle(this._sheet._viewActiveCell());\n            },\n            _rectangle: function (pane, ref) {\n                return pane._grid.boundingRectangle(ref.toRangeRef());\n            },\n            isColumnResizer: function (x, pane, ref) {\n                var rectangle = this._rectangle(pane, ref);\n                x -= this._sheet._grid._headerWidth;\n                var handleWidth = RESIZE_HANDLE_WIDTH / 2;\n                var right = rectangle.right - this.scroller.scrollLeft;\n                return right - handleWidth <= x && x <= right + handleWidth;\n            },\n            isRowResizer: function (y, pane, ref) {\n                var rectangle = this._rectangle(pane, ref);\n                y -= this._sheet._grid._headerHeight;\n                var handleWidth = RESIZE_HANDLE_WIDTH / 2;\n                var bottom = rectangle.bottom - this.scroller.scrollTop;\n                return bottom - handleWidth <= y && y <= bottom + handleWidth;\n            },\n            isFilterIcon: function (x, y, pane, ref) {\n                var theGrid = pane._grid;\n                var scrollTop = theGrid.rows.frozen ? 0 : this.scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : this.scroller.scrollLeft;\n                x -= this._sheet._grid._headerWidth - scrollLeft;\n                y -= this._sheet._grid._headerHeight - scrollTop;\n                var result = false;\n                this._sheet.forEachFilterHeader(ref, function (ref) {\n                    if (!result) {\n                        var rect = this._rectangle(pane, ref);\n                        result = pane.filterIconRect(rect).intersects(x, y);\n                    }\n                }.bind(this));\n                return result;\n            },\n            isAutoFill: function (x, y, pane) {\n                var selection = this._sheet.select();\n                if (selection.size > 1) {\n                    return false;\n                }\n                x -= this._sheet._grid._headerWidth;\n                y -= this._sheet._grid._headerHeight;\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n                var rectangle = this._rectangle(pane, selection);\n                return Math.abs(rectangle.right - x) < 8 && Math.abs(rectangle.bottom - y) < 8;\n            },\n            isEditButton: function (x, y) {\n                var ed = this._sheet.activeCellCustomEditor();\n                if (ed) {\n                    var r = this.activeCellRectangle();\n                    if (x > r.right && x <= r.right + 20 && y >= r.top && y <= r.bottom) {\n                        return true;\n                    }\n                }\n            },\n            objectAt: function (x, y) {\n                var grid = this._sheet._grid;\n                var object, pane;\n                if (x < 0 || y < 0 || x > this.scroller.clientWidth || y > this.scroller.clientHeight) {\n                    object = { type: 'outside' };\n                } else if (x < grid._headerWidth && y < grid._headerHeight) {\n                    object = { type: 'topcorner' };\n                } else {\n                    pane = this.paneAt(x, y);\n                    if (!pane) {\n                        object = { type: 'outside' };\n                    } else {\n                        var row = pane._grid.rows.index(y, this.scroller.scrollTop);\n                        var column = pane._grid.columns.index(x, this.scroller.scrollLeft);\n                        var type = 'cell';\n                        var ref = new CellRef(row, column);\n                        var selecting = this._sheet.selectionInProgress();\n                        if (this.isAutoFill(x, y, pane)) {\n                            type = 'autofill';\n                        } else if (this.isFilterIcon(x, y, pane, ref)) {\n                            type = 'filtericon';\n                        } else if (!selecting && x < grid._headerWidth) {\n                            ref = new CellRef(row, -Infinity);\n                            type = this.isRowResizer(y, pane, ref) ? 'rowresizehandle' : 'rowheader';\n                        } else if (!selecting && y < grid._headerHeight) {\n                            ref = new CellRef(-Infinity, column);\n                            type = this.isColumnResizer(x, pane, ref) ? 'columnresizehandle' : 'columnheader';\n                        } else if (this.isEditButton(x, y)) {\n                            type = 'editor';\n                        }\n                        object = {\n                            type: type,\n                            ref: ref\n                        };\n                    }\n                }\n                object.pane = pane;\n                object.x = x;\n                object.y = y;\n                return object;\n            },\n            paneAt: function (x, y) {\n                return this.panes.filter(function paneLocationWithin(pane) {\n                    var grid = pane._grid;\n                    return within(y, grid.top, grid.bottom) && within(x, grid.left, grid.right);\n                })[0];\n            },\n            containingPane: function (cell) {\n                return this.panes.filter(function (pane) {\n                    if (pane._grid.contains(cell)) {\n                        return true;\n                    }\n                    return false;\n                })[0];\n            },\n            cellRectangle: function (cell) {\n                var theGrid = this.containingPane(cell)._grid;\n                var rectangle = this._sheet._grid.rectangle(cell);\n                return rectangle.offset(theGrid.headerWidth - (theGrid.columns.frozen ? 0 : this.scroller.scrollLeft), theGrid.headerHeight - (theGrid.rows.frozen ? 0 : this.scroller.scrollTop));\n            },\n            refresh: function (reason) {\n                var sheet = this._sheet;\n                if (this.tabstrip) {\n                    this.tabstrip.refreshTools(sheet.range(sheet.activeCell()));\n                }\n                if (reason.sheetSelection && this.sheetsbar) {\n                    this.sheetsbar.renderSheets(this._workbook.sheets(), this._workbook.sheetIndex(this._sheet));\n                }\n                this._resize();\n                this.viewSize[0].style.height = sheet._grid.totalHeight() + 'px';\n                this.viewSize[0].style.width = sheet._grid.totalWidth() + 'px';\n                if (reason.layout) {\n                    var frozenColumns = sheet.frozenColumns();\n                    var frozenRows = sheet.frozenRows();\n                    this.panes = [this._pane(frozenRows, frozenColumns)];\n                    if (frozenColumns > 0) {\n                        this.panes.push(this._pane(frozenRows, 0, null, frozenColumns));\n                    }\n                    if (frozenRows > 0) {\n                        this.panes.push(this._pane(0, frozenColumns, frozenRows, null));\n                    }\n                    if (frozenRows > 0 && frozenColumns > 0) {\n                        this.panes.push(this._pane(0, 0, frozenRows, frozenColumns));\n                    }\n                }\n                if (reason.filter) {\n                    this._destroyFilterMenu();\n                }\n                if (reason.activeCell) {\n                    this._focus = sheet.activeCell().toRangeRef();\n                }\n            },\n            createFilterMenu: function (column) {\n                if (this._filterMenu && this._filterMenu.options.column == column) {\n                    return this._filterMenu;\n                }\n                this._destroyFilterMenu();\n                var sheet = this._sheet;\n                var ref = sheet.filter().ref;\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var element = $('<div />').appendTo(this.element);\n                var options = {\n                    column: column,\n                    range: range\n                };\n                var filterMenu = new kendo.spreadsheet.FilterMenu(element, options);\n                this._filterMenu = filterMenu;\n                return filterMenu;\n            },\n            selectClipBoardContents: function () {\n                if (!this.isClipboardDeactivated) {\n                    this.clipboard.focus();\n                    selectElementContents(this.clipboard[0]);\n                }\n            },\n            scrollIntoView: function (cell) {\n                var willScroll = false;\n                var theGrid = this.containingPane(cell)._grid;\n                var boundaries = theGrid.scrollBoundaries(cell);\n                var scroller = this.scroller;\n                var scrollTop = theGrid.rows.frozen ? 0 : scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n                if (boundaries.top < scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollTop;\n                }\n                if (boundaries.bottom > scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollBottom;\n                }\n                if (boundaries.left < scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollLeft;\n                }\n                if (boundaries.right > scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollRight;\n                }\n                return willScroll;\n            },\n            _destroyDialog: function () {\n                this._dialogs.pop();\n            },\n            openCustomEditor: function () {\n                var self = this;\n                var cell = self._sheet.activeCell().first();\n                var editor = self._sheet.activeCellCustomEditor();\n                var range = self._sheet.range(cell);\n                editor.edit({\n                    range: range,\n                    rect: self.activeCellRectangle(),\n                    view: this,\n                    validation: this._sheet.validation(cell),\n                    callback: function (value, parse) {\n                        self._executeCommand({\n                            command: 'EditCommand',\n                            options: {\n                                operatingRange: range,\n                                property: parse ? 'input' : 'value',\n                                value: value\n                            }\n                        });\n                    }\n                });\n            },\n            openDialog: function (name, options) {\n                var dialog = kendo.spreadsheet.dialogs.create(name, options);\n                if (dialog) {\n                    dialog.bind('action', this._executeCommand.bind(this));\n                    dialog.bind('deactivate', this._destroyDialog.bind(this));\n                    this._dialogs.push(dialog);\n                    var sheet = this._sheet;\n                    var ref = sheet.activeCell();\n                    var range = new kendo.spreadsheet.Range(ref, sheet);\n                    dialog.open(range);\n                    return dialog;\n                }\n            },\n            showError: function (options, reopenEditor) {\n                var errorMessages = this.options.messages.errors;\n                var focusButton = function (e) {\n                    var cont = e.sender.dialog().element;\n                    cont.find('.k-button:first').focus();\n                    cont.find('.k-button, input').on('keydown', function (ev) {\n                        if (ev.keyCode == kendo.keys.ESC) {\n                            e.sender.close();\n                        }\n                    });\n                };\n                var onClose = function (e) {\n                    var dlg = e.sender;\n                    this.selectClipBoardContents();\n                    if (dlg._retry && reopenEditor) {\n                        reopenEditor();\n                    }\n                }.bind(this);\n                if (kendo.spreadsheet.dialogs.registered(options.type)) {\n                    var dialogOptions = { close: onClose };\n                    if (options.type === 'validationError') {\n                        dialogOptions = $.extend(dialogOptions, {\n                            title: options.title || 'Error',\n                            text: options.body ? options.body : errorMessages[options.type],\n                            activate: focusButton\n                        });\n                    }\n                    this.openDialog(options.type, dialogOptions);\n                } else {\n                    this.openDialog('message', {\n                        title: options.title || 'Error',\n                        text: options.body ? options.body : errorMessages[options.type],\n                        activate: focusButton,\n                        close: onClose\n                    });\n                }\n            },\n            destroy: function () {\n                this._dialogs.forEach(function (dialog) {\n                    dialog.destroy();\n                });\n                this.cellContextMenu.destroy();\n                this.rowHeaderContextMenu.destroy();\n                this.colHeaderContextMenu.destroy();\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                }\n                this._destroyFilterMenu();\n            },\n            _destroyFilterMenu: function () {\n                if (this._filterMenu) {\n                    this._filterMenu.destroy();\n                    this._filterMenu = undefined;\n                    this._filterMenuColumn = undefined;\n                }\n            },\n            render: function () {\n                if (!this.element.is(':visible')) {\n                    return;\n                }\n                var sheet = this._sheet;\n                var focus = sheet.focus();\n                if (focus && this.scrollIntoView(focus)) {\n                    return;\n                }\n                var resizeDirection = !sheet.resizingInProgress() ? 'none' : sheet.resizeHandlePosition().col === -Infinity ? 'column' : 'row';\n                this.wrapper.toggleClass(viewClassNames.editContainer, this.editor.isActive()).toggleClass(viewClassNames.horizontalResize, resizeDirection == 'row').toggleClass(viewClassNames.verticalResize, resizeDirection == 'column');\n                var grid = sheet._grid;\n                var scrollTop = this.scroller.scrollTop;\n                var scrollLeft = this.scroller.scrollLeft;\n                if (scrollTop < 0) {\n                    scrollTop = 0;\n                }\n                if (scrollLeft < 0) {\n                    scrollLeft = 0;\n                }\n                var result = this.panes.map(function (pane) {\n                    return pane.render(scrollLeft, scrollTop);\n                }, this);\n                var merged = [];\n                merged = Array.prototype.concat.apply(merged, result);\n                var topCorner = kendo.dom.element('div', {\n                    style: {\n                        width: grid._headerWidth + 'px',\n                        height: grid._headerHeight + 'px'\n                    },\n                    className: View.classNames.topCorner\n                });\n                merged.push(topCorner);\n                if (sheet.resizeHandlePosition() && sheet.resizeHintPosition()) {\n                    merged.push(this.renderResizeHint());\n                }\n                this.tree.render(merged);\n                if (this.editor.isActive()) {\n                    this.editor.toggleTooltip(this.activeCellRectangle());\n                } else if (!sheet.selectionInProgress() && !sheet.resizingInProgress() && !sheet.isInEditMode()) {\n                    this.renderClipboardContents();\n                }\n            },\n            renderResizeHint: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var horizontal = ref.col !== -Infinity;\n                var style;\n                if (horizontal) {\n                    style = {\n                        height: this.scroller.clientHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: sheet.resizeHintPosition().x + 'px',\n                        top: '0px'\n                    };\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this.scroller.clientWidth + 'px',\n                        top: sheet.resizeHintPosition().y + 'px',\n                        left: '0px'\n                    };\n                }\n                var classNames = Pane.classNames;\n                return kendo.dom.element('div', {\n                    className: classNames.resizeHint + (!horizontal ? ' ' + classNames.resizeHintVertical : ''),\n                    style: style\n                }, [\n                    kendo.dom.element('div', { className: classNames.resizeHintHandle }),\n                    kendo.dom.element('div', { className: classNames.resizeHintMarker })\n                ]);\n            },\n            renderClipboardContents: function () {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                var selection = sheet.select().toRangeRef();\n                var status = this._workbook.clipboard().canCopy();\n                if (status.canCopy === false && status.multiSelection) {\n                    this.clipboardContents.render([]);\n                    this.selectClipBoardContents();\n                    return;\n                }\n                selection = sheet.trim(selection);\n                var table = new HtmlTable();\n                var selectionView = grid.rangeDimensions(selection);\n                selectionView.rows.forEach(function (height) {\n                    table.addRow(height);\n                });\n                selectionView.columns.forEach(function (width) {\n                    table.addColumn(width);\n                });\n                var tmp = sheet._getMergedCells(selection);\n                var primaryMergedCells = tmp.primary;\n                var secondaryMergedCells = tmp.secondary;\n                sheet.forEach(selection, function (row, col, cell) {\n                    var location = new CellRef(row, col).print();\n                    if (!secondaryMergedCells[location]) {\n                        var td = addCell(table, row - selection.topLeft.row, cell);\n                        var mergedCell = primaryMergedCells[location];\n                        if (mergedCell) {\n                            td.attr.colspan = mergedCell.width();\n                            td.attr.rowspan = mergedCell.height();\n                        }\n                    }\n                });\n                this.clipboardContents.render([table.toDomTree(0, 0, 'kendo-clipboard-' + this._workbook.clipboard()._uid)]);\n                this.selectClipBoardContents();\n            },\n            _pane: function (row, column, rowCount, columnCount) {\n                var pane = new Pane(this._sheet, this._sheet._grid.pane({\n                    row: row,\n                    column: column,\n                    rowCount: rowCount,\n                    columnCount: columnCount\n                }));\n                pane.refresh(this.scroller.clientWidth, this.scroller.clientHeight);\n                return pane;\n            }\n        });\n        var paneClassNames = {\n            cell: 'k-spreadsheet-cell',\n            vaxis: 'k-spreadsheet-vaxis',\n            haxis: 'k-spreadsheet-haxis',\n            rowHeader: 'k-spreadsheet-row-header',\n            columnHeader: 'k-spreadsheet-column-header',\n            pane: 'k-spreadsheet-pane',\n            data: 'k-spreadsheet-data',\n            mergedCell: 'k-spreadsheet-merged-cell',\n            mergedCellsWrapper: 'k-merged-cells-wrapper',\n            activeCell: 'k-spreadsheet-active-cell',\n            selection: 'k-spreadsheet-selection',\n            selectionWrapper: 'k-selection-wrapper',\n            autoFillWrapper: 'k-auto-fill-wrapper',\n            single: 'k-single',\n            top: 'k-top',\n            right: 'k-right',\n            bottom: 'k-bottom',\n            left: 'k-left',\n            resizeHandle: 'k-resize-handle',\n            columnResizeHandle: 'k-column-resize-handle',\n            rowResizeHandle: 'k-row-resize-handle',\n            resizeHint: 'k-resize-hint',\n            resizeHintHandle: 'k-resize-hint-handle',\n            resizeHintMarker: 'k-resize-hint-marker',\n            resizeHintVertical: 'k-resize-hint-vertical',\n            selectionHighlight: 'k-spreadsheet-selection-highlight',\n            series: [\n                'k-series-a',\n                'k-series-b',\n                'k-series-c',\n                'k-series-d',\n                'k-series-e',\n                'k-series-f'\n            ]\n        };\n        var Pane = kendo.Class.extend({\n            init: function (sheet, grid) {\n                this._sheet = sheet;\n                this._grid = grid;\n            },\n            refresh: function (width, height) {\n                this._grid.refresh(width, height);\n            },\n            isVisible: function (scrollLeft, scrollTop, ref) {\n                return this._grid.view(scrollLeft, scrollTop).ref.intersects(ref);\n            },\n            render: function (scrollLeft, scrollTop) {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var grid = this._grid;\n                var view = grid.view(scrollLeft, scrollTop);\n                this._currentView = view;\n                this._currentRect = this._rectangle(view.ref);\n                this._selectedHeaders = sheet.selectedHeaders();\n                var children = [];\n                children.push(this.renderData());\n                children.push(this.renderSelection());\n                children.push(this.renderAutoFill());\n                children.push(this.renderEditorSelection());\n                children.push(this.renderFilterHeaders());\n                if (grid.hasRowHeader) {\n                    var rowHeader = kendo.dom.element('div', {\n                        className: classNames.rowHeader,\n                        style: {\n                            width: grid.headerWidth + 'px',\n                            top: view.rowOffset + 'px'\n                        }\n                    });\n                    children.push(rowHeader);\n                    sheet.forEach(view.ref.leftColumn(), function (row) {\n                        if (!sheet.isHiddenRow(row)) {\n                            var text = row + 1, height = sheet.rowHeight(row);\n                            rowHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(row, 'row'),\n                                style: {\n                                    width: grid.headerWidth + 'px',\n                                    height: height + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                        }\n                    }.bind(this));\n                }\n                if (grid.hasColumnHeader) {\n                    var columnHeader = kendo.dom.element('div', {\n                        className: classNames.columnHeader,\n                        style: {\n                            top: '0px',\n                            left: view.columnOffset + 'px',\n                            width: this._currentRect.width + 'px',\n                            height: grid.headerHeight + 'px'\n                        }\n                    });\n                    children.push(columnHeader);\n                    var left = 0;\n                    sheet.forEach(view.ref.topRow(), function (row, col) {\n                        if (!sheet.isHiddenColumn(col)) {\n                            var text = kendo.spreadsheet.Ref.display(null, Infinity, col), width = sheet.columnWidth(col);\n                            columnHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(col, 'col'),\n                                style: {\n                                    position: 'absolute',\n                                    left: left + 'px',\n                                    width: width + 'px',\n                                    height: grid.headerHeight + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                            left += width;\n                        }\n                    }.bind(this));\n                }\n                if (sheet.resizeHandlePosition() && (grid.hasColumnHeader || grid.hasRowHeader)) {\n                    var ref = sheet._grid.normalize(sheet.resizeHandlePosition());\n                    if (view.ref.intersects(ref)) {\n                        if (!sheet.resizeHintPosition()) {\n                            children.push(this.renderResizeHandle());\n                        }\n                    }\n                }\n                var paneClasses = [classNames.pane];\n                if (grid.hasColumnHeader) {\n                    paneClasses.push(classNames.top);\n                }\n                if (grid.hasRowHeader) {\n                    paneClasses.push(classNames.left);\n                }\n                return kendo.dom.element('div', {\n                    style: grid.style,\n                    className: paneClasses.join(' ')\n                }, children);\n            },\n            headerClassName: function (index, type) {\n                var selectedHeaders = this._selectedHeaders;\n                var itemSelection;\n                var allHeaders;\n                if (type === 'row') {\n                    itemSelection = selectedHeaders.rows[index];\n                    allHeaders = selectedHeaders.allRows;\n                } else {\n                    itemSelection = selectedHeaders.cols[index];\n                    allHeaders = selectedHeaders.allCols;\n                }\n                var className = itemSelection || (selectedHeaders.all ? 'full' : allHeaders ? 'partial' : 'none');\n                if (className) {\n                    className = 'k-selection-' + className;\n                }\n                return className;\n            },\n            renderData: function () {\n                var sheet = this._sheet;\n                var view = this._currentView;\n                var cont = kendo.dom.element('div', {\n                    className: Pane.classNames.data,\n                    style: {\n                        position: 'relative',\n                        left: view.columnOffset + 'px',\n                        top: view.rowOffset + 'px'\n                    }\n                });\n                var rect = this._currentRect;\n                var layout = kendo.spreadsheet.draw.doLayout(sheet, view.ref, { forScreen: true }), prev;\n                var showGridLines = sheet._showGridLines;\n                if (showGridLines) {\n                    prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        if (x !== prev) {\n                            prev = x;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.vaxis,\n                                style: {\n                                    left: x + 'px',\n                                    height: rect.height + 'px',\n                                    borderColor: sheet.gridLinesColor()\n                                }\n                            }));\n                        }\n                    });\n                    prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        if (y !== prev) {\n                            prev = y;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.haxis,\n                                style: {\n                                    top: y + 'px',\n                                    width: rect.width + 'px',\n                                    borderColor: sheet.gridLinesColor()\n                                }\n                            }));\n                        }\n                    });\n                }\n                var vBorders = {}, hBorders = {};\n                layout.cells.forEach(function (cell) {\n                    var hb = hBorders[cell.col] || (hBorders[cell.col] = {});\n                    var vb = vBorders[cell.row] || (vBorders[cell.row] = {});\n                    drawCell(cont.children, cell, null, hb, vb, showGridLines);\n                });\n                return cont;\n            },\n            renderResizeHandle: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var rectangle = this._rectangle(ref);\n                var classNames = [Pane.classNames.resizeHandle];\n                var style;\n                if (ref.col !== -Infinity) {\n                    style = {\n                        height: this._grid.headerHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: rectangle.right - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        top: '0px'\n                    };\n                    classNames.push(viewClassNames.horizontalResize);\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this._grid.headerWidth + 'px',\n                        top: rectangle.bottom - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        left: '0px'\n                    };\n                    classNames.push(viewClassNames.verticalResize);\n                }\n                return kendo.dom.element('div', {\n                    className: classNames.join(' '),\n                    style: style\n                });\n            },\n            filterIconRect: function (rect) {\n                var BUTTON_SIZE = 16;\n                var BUTTON_OFFSET = 3;\n                return new kendo.spreadsheet.Rectangle(rect.right - BUTTON_SIZE - BUTTON_OFFSET, rect.top + BUTTON_OFFSET, BUTTON_SIZE, BUTTON_SIZE);\n            },\n            renderFilterHeaders: function () {\n                var sheet = this._sheet;\n                var children = [];\n                var classNames = View.classNames;\n                var filter = sheet.filter();\n                function icon(className) {\n                    return kendo.dom.element('span', { className: classNames.icon + ' ' + className });\n                }\n                function filterButton(classNames, position, index) {\n                    var style = {\n                        left: position.left + 'px',\n                        top: position.top + 'px'\n                    };\n                    var filtered = filter && filter.columns.some(function (c) {\n                        return c.index === index;\n                    });\n                    var classes = classNames.filterButton;\n                    if (filtered) {\n                        classes += ' ' + classNames.filterButtonActive;\n                    }\n                    var button = kendo.dom.element('span', {\n                        className: classes,\n                        style: style\n                    }, [icon(classNames.iconFilterDefault)]);\n                    return button;\n                }\n                if (filter) {\n                    this._addDiv(children, filter.ref, classNames.filterRange);\n                }\n                sheet.forEachFilterHeader(this._currentView.ref, function (ref) {\n                    var rect = this._rectangle(ref);\n                    var position = this.filterIconRect(rect);\n                    var column = this._sheet.filterColumn(ref);\n                    var button = filterButton(classNames, position, column);\n                    children.push(button);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.filterHeadersWrapper }, children);\n            },\n            renderEditorSelection: function () {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var selections = [];\n                sheet._formulaSelections.forEach(function (range) {\n                    var ref = range.ref;\n                    if (ref === kendo.spreadsheet.NULLREF) {\n                        return;\n                    }\n                    this._addDiv(selections, ref, classNames.selectionHighlight + ' ' + range.colorClass);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderSelection: function () {\n                var classNames = Pane.classNames;\n                var selections = [];\n                var activeCellClasses = [classNames.activeCell];\n                var selectionClasses = [classNames.selection];\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell().toRangeRef();\n                var activeFormulaColor = this._activeFormulaColor();\n                var selection = sheet.select();\n                activeCellClasses = activeCellClasses.concat(activeFormulaColor, this._directionClasses(activeCell));\n                selectionClasses = selectionClasses.concat(activeFormulaColor);\n                if (sheet.singleCellSelection()) {\n                    activeCellClasses.push(classNames.single);\n                }\n                if (selection.size() === 1) {\n                    selectionClasses.push('k-single-selection');\n                }\n                if (this._sheet.autoFillPunch()) {\n                    selectionClasses.push('k-dim-auto-fill-handle');\n                }\n                selection.forEach(function (ref) {\n                    if (ref !== kendo.spreadsheet.NULLREF) {\n                        this._addDiv(selections, ref, selectionClasses.join(' '));\n                    }\n                }.bind(this));\n                this._addTable(selections, activeCell, activeCellClasses.join(' '));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderAutoFill: function () {\n                var autoFillRectangle = [];\n                if (this._sheet.autoFillInProgress()) {\n                    var autoFillRef = this._sheet.autoFillRef();\n                    var punch = this._sheet.autoFillPunch();\n                    var direction = this._sheet._autoFillDirection;\n                    this._addDiv(autoFillRectangle, autoFillRef, 'k-auto-fill');\n                    if (punch) {\n                        this._addDiv(autoFillRectangle, punch, 'k-auto-fill-punch');\n                    } else if (direction !== undefined) {\n                        var ref, cssClass;\n                        switch (direction) {\n                        case 0:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 1:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 2:\n                            ref = new CellRef(autoFillRef.topLeft.row, autoFillRef.bottomRight.col);\n                            cssClass = 'k-auto-fill-tr-hint';\n                            break;\n                        case 3:\n                            ref = new CellRef(autoFillRef.bottomRight.row, autoFillRef.topLeft.col);\n                            cssClass = 'k-auto-fill-bl-hint';\n                            break;\n                        }\n                        var hint = kendo.dom.element('span', { className: 'k-tooltip' }, [kendo.dom.text(this._sheet._autoFillHint)]);\n                        var rectangle = this._addDiv(autoFillRectangle, ref, cssClass);\n                        if (rectangle) {\n                            rectangle.children.push(hint);\n                        }\n                    }\n                }\n                return kendo.dom.element('div', { className: Pane.classNames.autoFillWrapper }, autoFillRectangle);\n            },\n            _addDiv: function (collection, ref, className) {\n                var view = this._currentView, div;\n                if (view.ref.intersects(ref)) {\n                    div = this._rectangle(ref).resize(1, 1).toDiv(className);\n                    collection.push(div);\n                }\n                return div;\n            },\n            _addTable: function (collection, ref, className) {\n                var self = this;\n                var sheet = self._sheet;\n                var view = self._currentView;\n                if (view.ref.intersects(ref)) {\n                    var rectangle = self._rectangle(ref);\n                    var ed = self._sheet.activeCellCustomEditor();\n                    sheet.forEach(ref.collapse(), function (row, col, cell) {\n                        cell.left = rectangle.left;\n                        cell.top = rectangle.top;\n                        cell.width = rectangle.width;\n                        cell.height = rectangle.height;\n                        drawCell(collection, cell, className, null, null, true);\n                        if (ed) {\n                            var btn = kendo.dom.element('div', {\n                                className: 'k-button k-spreadsheet-editor-button',\n                                style: {\n                                    left: cell.left + cell.width + 'px',\n                                    top: cell.top + 'px',\n                                    height: cell.height + 'px'\n                                }\n                            });\n                            if (ed.icon) {\n                                btn.children.push(kendo.dom.element('span', { className: 'k-icon ' + ed.icon }));\n                            }\n                            collection.push(btn);\n                        }\n                    });\n                }\n            },\n            _activeFormulaColor: function () {\n                var activeFormulaSelection;\n                var colorClasses = [];\n                if (this._sheet.isInEditMode()) {\n                    activeFormulaSelection = this._sheet._formulaSelections.filter(function (sel) {\n                        return sel.active && sel.type == 'ref';\n                    })[0];\n                    if (activeFormulaSelection) {\n                        colorClasses.push(activeFormulaSelection.colorClass);\n                    }\n                }\n                return colorClasses;\n            },\n            _directionClasses: function (cell) {\n                var cellClasses = [];\n                var classNames = Pane.classNames;\n                var view = this._currentView.ref;\n                if (!cell.move(0, -1).intersects(view)) {\n                    cellClasses.push(classNames.left);\n                }\n                if (!cell.move(-1, 0).intersects(view)) {\n                    cellClasses.push(classNames.top);\n                }\n                if (!cell.move(0, 1).intersects(view)) {\n                    cellClasses.push(classNames.right);\n                }\n                if (!cell.move(1, 0).intersects(view)) {\n                    cellClasses.push(classNames.bottom);\n                }\n                return cellClasses;\n            },\n            _rectangle: function (ref) {\n                return this._grid.boundingRectangle(ref.toRangeRef()).offset(-this._currentView.mergedCellLeft, -this._currentView.mergedCellTop);\n            }\n        });\n        kendo.spreadsheet.View = View;\n        kendo.spreadsheet.Pane = Pane;\n        kendo.spreadsheet.drawCell = drawCell;\n        $.extend(true, View, { classNames: viewClassNames });\n        $.extend(true, Pane, { classNames: paneClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/customeditors', [\n        'kendo.core',\n        'kendo.popup',\n        'kendo.calendar',\n        'kendo.listview',\n        'spreadsheet/sheet'\n    ], f);\n}(function () {\n    (function (kendo) {\n        'use strict';\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var EDITORS = {};\n        var registerEditor = kendo.spreadsheet.registerEditor = function (name, editor) {\n            EDITORS[name] = editor;\n        };\n        kendo.spreadsheet.Sheet.prototype.activeCellCustomEditor = function () {\n            var cell = this.activeCell().first();\n            if (this.range(cell).enable()) {\n                var val = this.validation(cell);\n                var key = this._properties.get('editor', this._grid.cellRefIndex(cell));\n                var editor;\n                if (key != null) {\n                    editor = EDITORS[key];\n                } else if (val && val.showButton) {\n                    key = '_validation_' + val.dataType;\n                    editor = EDITORS[key];\n                }\n                if (typeof editor == 'function') {\n                    editor = EDITORS[key] = editor();\n                }\n                return editor;\n            }\n        };\n        registerEditor('_validation_date', function () {\n            var context, calendar, popup;\n            function create() {\n                if (!calendar) {\n                    calendar = $('<div>').kendoCalendar();\n                    popup = $('<div>').kendoPopup();\n                    calendar.appendTo(popup);\n                    calendar = calendar.getKendoCalendar();\n                    popup = popup.getKendoPopup();\n                    calendar.bind('change', function () {\n                        popup.close();\n                        var date = calendar.value();\n                        if (!context.range.format()) {\n                            context.range.format('yyyy-mm-dd');\n                        }\n                        context.callback(kendo.spreadsheet.dateToNumber(date));\n                    });\n                }\n                popup.setOptions({ anchor: context.view.element.find('.k-spreadsheet-editor-button') });\n            }\n            function open() {\n                create();\n                var date = context.range.value();\n                if (date != null) {\n                    calendar.value(kendo.spreadsheet.numberToDate(date));\n                } else {\n                    calendar.value(null);\n                }\n                var val = context.validation;\n                if (val) {\n                    var min = kendo.ui.Calendar.fn.options.min;\n                    var max = kendo.ui.Calendar.fn.options.max;\n                    if (/^(?:greaterThan|between)/.test(val.comparerType)) {\n                        min = kendo.spreadsheet.numberToDate(val.from.value);\n                    }\n                    if (val.comparerType == 'between') {\n                        max = kendo.spreadsheet.numberToDate(val.to.value);\n                    }\n                    if (val.comparerType == 'lessThan') {\n                        max = kendo.spreadsheet.numberToDate(val.from.value);\n                    }\n                    calendar.setOptions({\n                        disableDates: function (date) {\n                            var from = val.from ? val.from.value | 0 : 0;\n                            var to = val.to ? val.to.value | 0 : 0;\n                            date = kendo.spreadsheet.dateToNumber(date) | 0;\n                            return !kendo.spreadsheet.validation.validationComparers[val.comparerType](date, from, to);\n                        },\n                        min: min,\n                        max: max\n                    });\n                } else {\n                    calendar.setOptions({\n                        disableDates: null,\n                        min: null,\n                        max: null\n                    });\n                }\n                popup.open();\n            }\n            return {\n                edit: function (options) {\n                    context = options;\n                    open();\n                },\n                icon: 'k-i-calendar'\n            };\n        });\n        registerEditor('_validation_list', function () {\n            var context, list, popup;\n            function create() {\n                if (!list) {\n                    list = $('<ul class=\\'k-list k-reset\\'/>').kendoStaticList({\n                        template: '#:value#',\n                        selectable: true,\n                        autoBind: false\n                    });\n                    popup = $('<div>').kendoPopup();\n                    list.appendTo(popup);\n                    popup = popup.getKendoPopup();\n                    list = list.getKendoStaticList();\n                    list.bind('change', function () {\n                        popup.close();\n                        var item = list.value()[0];\n                        if (item) {\n                            context.callback(item.value);\n                        }\n                    });\n                }\n                popup.setOptions({ anchor: context.view.element.find('.k-spreadsheet-editor-button') });\n            }\n            function open() {\n                create();\n                var matrix = context.validation.from.value;\n                var data = [];\n                if (matrix) {\n                    matrix.each(function (el) {\n                        data.push({ value: el });\n                    });\n                }\n                var dataSource = new kendo.data.DataSource({ data: data });\n                list.setDataSource(dataSource);\n                dataSource.read();\n                popup.open();\n            }\n            return {\n                edit: function (options) {\n                    context = options;\n                    open();\n                },\n                icon: 'k-i-arrow-60-down'\n            };\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/grid', [\n        'kendo.core',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var Rectangle = kendo.Class.extend({\n            init: function (left, top, width, height) {\n                this.left = left;\n                this.width = width;\n                this.right = left + width;\n                this.top = top;\n                this.height = height;\n                this.bottom = top + height;\n            },\n            offset: function (left, top) {\n                return new Rectangle(this.left + left, this.top + top, this.width, this.height);\n            },\n            resize: function (width, height) {\n                return new Rectangle(this.left, this.top, this.width + width, this.height + height);\n            },\n            intersects: function (x, y) {\n                return this.left < x && x < this.left + this.width && this.top < y && y < this.top + this.height;\n            },\n            toDiv: function (className) {\n                return kendo.dom.element('div', {\n                    className: className,\n                    style: {\n                        width: this.width + 'px',\n                        height: this.height + 'px',\n                        top: this.top + 'px',\n                        left: this.left + 'px'\n                    }\n                });\n            }\n        });\n        var Grid = kendo.Class.extend({\n            init: function (rows, columns, rowCount, columnCount, headerHeight, headerWidth) {\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this._columns = columns;\n                this._rows = rows;\n                this._headerHeight = headerHeight;\n                this._headerWidth = headerWidth;\n            },\n            isAxis: function (ref) {\n                ref = ref.toRangeRef();\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                return topLeft.row === 0 && bottomRight.row === this.rowCount - 1 || topLeft.col === 0 && bottomRight.col === this.columnCount - 1;\n            },\n            width: function (start, end) {\n                return this._columns.sum(start, end);\n            },\n            height: function (start, end) {\n                return this._rows.sum(start, end);\n            },\n            totalHeight: function () {\n                return this._rows.total + this._headerHeight;\n            },\n            totalWidth: function () {\n                return this._columns.total + this._headerWidth;\n            },\n            index: function (row, column) {\n                return column * this.rowCount + row;\n            },\n            cellRef: function (index) {\n                return new CellRef(index % this.rowCount, index / this.rowCount >> 0);\n            },\n            rowRef: function (row) {\n                return new RangeRef(new CellRef(row, 0), new CellRef(row, this.columnCount - 1));\n            },\n            colRef: function (col) {\n                return new RangeRef(new CellRef(0, col), new CellRef(this.rowCount - 1, col));\n            },\n            cellRefIndex: function (ref) {\n                return this.index(ref.row, ref.col);\n            },\n            normalize: function (ref) {\n                if (ref instanceof RangeRef) {\n                    return new RangeRef(this.normalize(ref.topLeft), this.normalize(ref.bottomRight)).setSheet(ref.sheet, ref.hasSheet());\n                }\n                if (ref instanceof UnionRef) {\n                    return ref.map(function (ref) {\n                        return this.normalize(ref);\n                    }, this);\n                }\n                if (ref instanceof CellRef) {\n                    ref = ref.clone();\n                    ref.col = Math.max(0, Math.min(this.columnCount - 1, ref.col));\n                    ref.row = Math.max(0, Math.min(this.rowCount - 1, ref.row));\n                }\n                return ref;\n            },\n            rectangle: function (ref) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                return new Rectangle(this.width(0, topLeft.col - 1), this.height(0, topLeft.row - 1), this.width(topLeft.col, bottomRight.col), this.height(topLeft.row, bottomRight.row));\n            },\n            pane: function (options) {\n                return new PaneGrid(new kendo.spreadsheet.PaneAxis(this._rows, options.row, options.rowCount, this._headerHeight), new kendo.spreadsheet.PaneAxis(this._columns, options.column, options.columnCount, this._headerWidth), this);\n            },\n            rangeDimensions: function (rangeRef) {\n                return {\n                    rows: this._rows.values.iterator(rangeRef.topLeft.row, rangeRef.bottomRight.row),\n                    columns: this._columns.values.iterator(rangeRef.topLeft.col, rangeRef.bottomRight.col)\n                };\n            },\n            forEach: function (ref, callback) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    for (var ri = topLeft.row; ri <= bottomRight.row; ri++) {\n                        callback(new CellRef(ri, ci));\n                    }\n                }\n            },\n            trim: function (ref, property) {\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                var bottomRightRow = topLeft.row;\n                var bottomRightCol = topLeft.col;\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var start = this.index(topLeft.row, ci);\n                    var end = this.index(bottomRight.row, ci);\n                    var values = property.tree.intersecting(start, end);\n                    if (values.length) {\n                        var cell = this.cellRef(values[values.length - 1].end);\n                        bottomRightRow = Math.max(bottomRightRow, cell.row);\n                        bottomRightCol = ci;\n                    }\n                }\n                return new RangeRef(ref.topLeft, new CellRef(Math.min(bottomRightRow, ref.bottomRight.row), bottomRightCol));\n            }\n        });\n        var PaneGrid = kendo.Class.extend({\n            init: function (rows, columns, grid) {\n                this.rows = rows;\n                this.columns = columns;\n                this._grid = grid;\n                this.headerHeight = rows.headerSize;\n                this.headerWidth = columns.headerSize;\n                this.hasRowHeader = columns.hasHeader;\n                this.hasColumnHeader = rows.hasHeader;\n            },\n            refresh: function (width, height) {\n                this.columns.viewSize(width);\n                this.rows.viewSize(height);\n                var x = this.columns.paneSegment();\n                var y = this.rows.paneSegment();\n                this.left = x.offset;\n                this.top = y.offset;\n                this.right = x.offset + x.length;\n                this.bottom = y.offset + y.length;\n                this.style = {\n                    top: y.offset + 'px',\n                    left: x.offset + 'px',\n                    height: y.length + 'px',\n                    width: x.length + 'px'\n                };\n            },\n            view: function (left, top) {\n                var rows = this.rows.visible(top);\n                var columns = this.columns.visible(left);\n                return {\n                    rows: rows,\n                    columns: columns,\n                    rowOffset: rows.offset,\n                    columnOffset: columns.offset,\n                    mergedCellLeft: columns.start,\n                    mergedCellTop: rows.start,\n                    ref: new RangeRef(new CellRef(rows.values.start, columns.values.start), new CellRef(rows.values.end, columns.values.end))\n                };\n            },\n            contains: function (ref) {\n                return this.rows.contains(ref.topLeft.row, ref.bottomRight.row) && this.columns.contains(ref.topLeft.col, ref.bottomRight.col);\n            },\n            index: function (row, column) {\n                return this._grid.index(row, column);\n            },\n            boundingRectangle: function (ref) {\n                return this._grid.rectangle(ref);\n            },\n            cellRefIndex: function (ref) {\n                return this._grid.cellRefIndex(ref);\n            },\n            scrollBoundaries: function (cell) {\n                var position = this.boundingRectangle(cell);\n                var boundaries = {\n                    top: Math.max(0, position.top - this.top + (this.hasColumnHeader ? 0 : this.headerHeight)),\n                    left: Math.max(0, position.left - this.left + (this.hasRowHeader ? 0 : this.headerWidth)),\n                    right: position.right - this.columns._viewSize + this.headerWidth,\n                    bottom: position.bottom - this.rows._viewSize + this.headerHeight\n                };\n                var widthCompensation = this.columns.defaultValue / 2;\n                var heightCompensation = this.rows.defaultValue / 2;\n                boundaries.scrollTop = boundaries.top - heightCompensation;\n                boundaries.scrollBottom = boundaries.bottom + heightCompensation;\n                boundaries.scrollLeft = boundaries.left - widthCompensation;\n                boundaries.scrollRight = boundaries.right + widthCompensation;\n                return boundaries;\n            }\n        });\n        kendo.spreadsheet.Grid = Grid;\n        kendo.spreadsheet.PaneGrid = PaneGrid;\n        kendo.spreadsheet.Rectangle = Rectangle;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axis', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Axis = kendo.Class.extend({\n            init: function (count, value) {\n                this._value = value;\n                this._count = count;\n                this.values = new kendo.spreadsheet.RangeList(0, count - 1, value);\n                this._hidden = new kendo.spreadsheet.RangeList(0, count - 1, 0);\n                this.scrollBarSize = kendo.support.scrollbar();\n                this._refresh();\n            },\n            adjust: function (start, delta) {\n                if (delta < 0) {\n                    this.values.copy(start - delta, this._count - 1, start);\n                    this._hidden.copy(start - delta, this._count - 1, start);\n                } else {\n                    this.values.copy(start, this._count, start + delta);\n                    this._hidden.copy(start, this._count, start + delta);\n                    this.values.value(start, start + delta - 1, this._value);\n                    this._hidden.value(start, start + delta - 1, 0);\n                }\n                this._refresh();\n            },\n            toJSON: function (field, positions) {\n                var values = [];\n                var iterator = this.values.iterator(0, this._count - 1);\n                for (var idx = 0; idx < this._count; idx++) {\n                    var value = iterator.at(idx);\n                    if (value === this._value) {\n                        continue;\n                    }\n                    var position = positions[idx];\n                    if (position === undefined) {\n                        position = values.length;\n                        var item = { index: idx };\n                        item[field] = value;\n                        values.push(item);\n                        positions[idx] = position;\n                    }\n                }\n                return values;\n            },\n            fromJSON: function (field, values) {\n                for (var idx = 0; idx < values.length; idx++) {\n                    var value = values[idx][field];\n                    var index = values[idx].index;\n                    if (index === undefined) {\n                        index = idx;\n                    }\n                    this.value(index, index, value);\n                }\n            },\n            hide: function (index) {\n                if (!this.hidden(index)) {\n                    var value = this.value(index, index);\n                    this._hidden.value(index, index, value);\n                    this.value(index, index, 0);\n                }\n            },\n            hidden: function (index) {\n                return this._hidden.value(index, index) !== 0;\n            },\n            includesHidden: function (start, end) {\n                return this._hidden.intersecting(start, end).length > 1;\n            },\n            nextVisible: function (index, overflow) {\n                var end = this._count - 1;\n                if (index === end) {\n                    return overflow ? index + 1 : index;\n                }\n                index += 1;\n                var range = this._hidden.intersecting(index, index)[0];\n                if (range.value !== 0) {\n                    if (range.end === end) {\n                        return index - 1;\n                    } else {\n                        return range.end + 1;\n                    }\n                } else {\n                    return index;\n                }\n            },\n            nextPage: function (index, pageSize) {\n                return this.index(this.sum(0, index - 1) + pageSize);\n            },\n            prevPage: function (index, pageSize) {\n                return this.index(this.sum(0, index) - pageSize);\n            },\n            firstVisible: function () {\n                var firstHidden = this._hidden.first();\n                if (firstHidden.value === 0) {\n                    return 0;\n                } else {\n                    return firstHidden.end + 1;\n                }\n            },\n            lastVisible: function () {\n                var lastHidden = this._hidden.last();\n                if (lastHidden.value === 0) {\n                    return this._count - 1;\n                } else {\n                    return lastHidden.start - 1;\n                }\n            },\n            prevVisible: function (index, overflow) {\n                if (index === 0) {\n                    return overflow ? -1 : 0;\n                }\n                index -= 1;\n                var range = this._hidden.intersecting(index, index)[0];\n                if (range.value !== 0) {\n                    if (range.start === 0) {\n                        return index + 1;\n                    } else {\n                        return range.start - 1;\n                    }\n                } else {\n                    return index;\n                }\n            },\n            unhide: function (index) {\n                if (this.hidden(index)) {\n                    var value = this._hidden.value(index, index);\n                    this._hidden.value(index, index, 0);\n                    this.value(index, index, value);\n                }\n            },\n            value: function (start, end, value) {\n                if (value !== undefined) {\n                    this.values.value(start, end, value);\n                    this._refresh();\n                } else {\n                    return this.values.iterator(start, end).at(0);\n                }\n            },\n            sum: function (start, end) {\n                var values = this.values.iterator(start, end);\n                var sum = 0;\n                for (var idx = start; idx <= end; idx++) {\n                    sum += values.at(idx);\n                }\n                return sum;\n            },\n            visible: function (start, end) {\n                var startSegment = null;\n                var endSegment = null;\n                var lastPage = false;\n                if (end >= this.total + this.scrollBarSize) {\n                    lastPage = true;\n                }\n                var ranges = this._pixelValues.intersecting(start, end);\n                startSegment = ranges[0];\n                endSegment = ranges[ranges.length - 1];\n                if (!startSegment) {\n                    return {\n                        values: this.values.iterator(0, 0),\n                        offset: 0\n                    };\n                }\n                var startOffset = start - startSegment.start;\n                var startIndex = (startOffset / startSegment.value.value >> 0) + startSegment.value.start;\n                var offset = startOffset - (startIndex - startSegment.value.start) * startSegment.value.value;\n                var endOffset = end - endSegment.start;\n                var endIndex = (endOffset / endSegment.value.value >> 0) + endSegment.value.start;\n                if (endIndex > endSegment.value.end) {\n                    endIndex = endSegment.value.end;\n                }\n                if (lastPage) {\n                    offset += endSegment.value.value - (endOffset - (endIndex - endSegment.value.start) * endSegment.value.value);\n                }\n                offset = Math.min(-offset, 0);\n                return {\n                    values: this.values.iterator(startIndex, endIndex),\n                    offset: offset\n                };\n            },\n            index: function (value) {\n                var index = 0;\n                var iterator = this.values.iterator(0, this._count - 1);\n                var current = iterator.at(0);\n                while (current < value && index < this._count - 1) {\n                    current += iterator.at(++index);\n                }\n                return index;\n            },\n            _refresh: function () {\n                var current = 0;\n                this._pixelValues = this.values.map(function (range) {\n                    var start = current;\n                    current += (range.end - range.start + 1) * range.value;\n                    var end = current - 1;\n                    return new kendo.spreadsheet.ValueRange(start, end, range);\n                });\n                this.total = current;\n            },\n            getState: function () {\n                return {\n                    values: this.values.getState(),\n                    hidden: this._hidden.getState()\n                };\n            },\n            setState: function (state) {\n                this.values.setState(state.values);\n                this._hidden.setState(state.hidden);\n                this._refresh();\n            }\n        });\n        var PaneAxis = kendo.Class.extend({\n            init: function (axis, start, count, headerSize) {\n                this._axis = axis;\n                this._start = start;\n                this._count = count;\n                this.hasHeader = start === 0;\n                this.headerSize = headerSize;\n                this.defaultValue = axis._value;\n                this.frozen = count > 0;\n            },\n            viewSize: function (viewSize) {\n                this._viewSize = viewSize;\n            },\n            sum: function (start, end) {\n                return this._axis.sum(start, end - 1);\n            },\n            start: function () {\n                return this.sum(0, this._start);\n            },\n            size: function () {\n                return this.sum(this._start, this._start + this._count);\n            },\n            index: function (value, offset) {\n                return this._axis.index(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n            paneSegment: function () {\n                var offset = this.start();\n                var length;\n                if (!this.hasHeader) {\n                    offset += this.headerSize;\n                }\n                if (this.frozen) {\n                    length = this.size();\n                    if (this.hasHeader) {\n                        length += this.headerSize;\n                    } else {\n                        length -= this.headerSize;\n                    }\n                } else {\n                    length = this._viewSize - offset;\n                }\n                return {\n                    offset: offset,\n                    length: length\n                };\n            },\n            visible: function (offset) {\n                var start = this.start();\n                var size;\n                if (this.frozen) {\n                    size = this.size();\n                    if (!this.hasHeader) {\n                        size -= this.headerSize;\n                    }\n                } else {\n                    size = this._viewSize - start - this.headerSize;\n                    start += offset;\n                }\n                var result = this._axis.visible(start, start + size - 1);\n                if (this.frozen) {\n                    result.offset = 0;\n                }\n                result.start = start;\n                if (this.hasHeader) {\n                    result.offset += this.headerSize;\n                    result.start -= this.headerSize;\n                }\n                return result;\n            },\n            contains: function (start, end) {\n                if (this.frozen) {\n                    if (start > this._start + this._count) {\n                        return false;\n                    }\n                    if (end < this._start) {\n                        return false;\n                    }\n                    return true;\n                } else {\n                    return end >= this._start;\n                }\n            }\n        });\n        kendo.spreadsheet.Axis = Axis;\n        kendo.spreadsheet.PaneAxis = PaneAxis;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filter', [\n        'kendo.core',\n        'kendo.data'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Filter = kendo.spreadsheet.Filter = kendo.Class.extend({\n            prepare: function () {\n            },\n            value: function (cell) {\n                return cell.value;\n            },\n            matches: function () {\n                throw new Error('The \\'matches\\' method is not implemented.');\n            },\n            toJSON: function () {\n                throw new Error('The \\'toJSON\\' method is not implemented.');\n            }\n        });\n        Filter.create = function (options) {\n            var filter = options.filter;\n            if (!filter) {\n                throw new Error('Filter type not specified.');\n            }\n            var constructor = kendo.spreadsheet[filter.charAt(0).toUpperCase() + filter.substring(1) + 'Filter'];\n            if (!constructor) {\n                throw new Error('Filter type not recognized.');\n            }\n            return new constructor(options);\n        };\n        kendo.spreadsheet.ValueFilter = Filter.extend({\n            _values: [],\n            _dates: [],\n            _blanks: false,\n            init: function ValueFilter(options) {\n                if (options.values !== undefined) {\n                    this._values = options.values;\n                }\n                if (options.blanks !== undefined) {\n                    this._blanks = options.blanks;\n                }\n                if (options.dates !== undefined) {\n                    this._dates = options.dates;\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (this._dates.length > 0 && cell.format && typeof value === 'number') {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            matches: function (value) {\n                if (value === null || value === undefined) {\n                    return this._blanks;\n                }\n                if (value instanceof Date) {\n                    return this._dates.some(function (date) {\n                        return date.year === value.getFullYear() && (date.month === undefined || date.month === value.getMonth()) && (date.day === undefined || date.day === value.getDate()) && (date.hours === undefined || date.hours === value.getHours()) && (date.minutes === undefined || date.minutes === value.getMinutes()) && (date.seconds === undefined || date.seconds === value.getSeconds());\n                    });\n                }\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'value',\n                    blanks: this._blanks,\n                    values: this._values.slice(0)\n                };\n            }\n        });\n        kendo.spreadsheet.CustomFilter = Filter.extend({\n            _logic: 'and',\n            init: function CustomFilter(options) {\n                if (options.logic !== undefined) {\n                    this._logic = options.logic;\n                }\n                if (options.criteria === undefined) {\n                    throw new Error('Must specify criteria.');\n                }\n                this._criteria = options.criteria;\n                var expression = kendo.data.Query.filterExpr({\n                    logic: this._logic,\n                    filters: this._criteria\n                }).expression;\n                this._matches = new Function('d', 'return ' + expression);\n            },\n            matches: function (value) {\n                if (value === null) {\n                    return false;\n                }\n                return this._matches(value);\n            },\n            value: function (cell) {\n                var value = cell.value;\n                var criterionValue = this._criteria[0].value;\n                var criterionType = criterionValue instanceof Date ? 'date' : typeof criterionValue;\n                var valueType = typeof value;\n                if (cell.format) {\n                    valueType = kendo.spreadsheet.formatting.type(value, cell.format);\n                }\n                if (valueType != criterionType) {\n                    if (criterionType == 'string') {\n                        if (cell.format) {\n                            value = kendo.spreadsheet.formatting.text(value, cell.format);\n                        }\n                        value = value + '';\n                    }\n                } else if (valueType == 'date') {\n                    value = kendo.spreadsheet.numberToDate(value);\n                }\n                return value;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'custom',\n                    logic: this._logic,\n                    criteria: this._criteria\n                };\n            }\n        });\n        kendo.spreadsheet.TopFilter = Filter.extend({\n            init: function TopFilter(options) {\n                this._type = options.type;\n                this._value = options.value;\n                this._values = [];\n            },\n            prepare: function (cells) {\n                var values = cells.map(this.value).sort().filter(function (value, index, array) {\n                    return index === 0 || value !== array[index - 1];\n                });\n                if (this._type === 'topNumber' || this._type == 'topPercent') {\n                    values.sort(function (x, y) {\n                        return y - x;\n                    });\n                } else {\n                    values.sort(function (x, y) {\n                        return x - y;\n                    });\n                }\n                var count = this._value;\n                if (this._type === 'topPercent' || this._type === 'bottomPercent') {\n                    count = values.length * count / 100 >> 0;\n                }\n                this._values = values.slice(0, count);\n            },\n            matches: function (value) {\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'top',\n                    type: this._type,\n                    value: this._value\n                };\n            }\n        });\n        kendo.spreadsheet.DynamicFilter = Filter.extend({\n            init: function DynamicFilter(options) {\n                this._type = options.type;\n                this._predicate = this[options.type];\n                if (typeof this._predicate !== 'function') {\n                    throw new Error('DynamicFilter type \\'' + options.type + '\\' not recognized.');\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (cell.format) {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            prepare: function (cells) {\n                var sum = 0;\n                var count = 0;\n                for (var ci = 0; ci < cells.length; ci++) {\n                    var value = this.value(cells[ci]);\n                    if (typeof value === 'number') {\n                        sum += value;\n                        count++;\n                    }\n                }\n                if (count > 0) {\n                    this._average = sum / count;\n                } else {\n                    this._average = 0;\n                }\n            },\n            matches: function (value) {\n                return this._predicate(value);\n            },\n            aboveAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value > this._average;\n            },\n            belowAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value < this._average;\n            },\n            tomorrow: function (value) {\n                if (value instanceof Date) {\n                    var tomorrow = kendo.date.addDays(kendo.date.today(), 1);\n                    return kendo.date.getDate(value).getTime() === tomorrow.getTime();\n                }\n                return false;\n            },\n            today: function (value) {\n                if (value instanceof Date) {\n                    return kendo.date.isToday(value);\n                }\n                return false;\n            },\n            yesterday: function (value) {\n                if (value instanceof Date) {\n                    var yesterday = kendo.date.addDays(kendo.date.today(), -1);\n                    return kendo.date.getDate(value).getTime() === yesterday.getTime();\n                }\n                return false;\n            },\n            nextWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), 7), value);\n            },\n            thisWeek: function (value) {\n                return sameWeek(kendo.date.today(), value);\n            },\n            lastWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), -7), value);\n            },\n            nextMonth: function (value) {\n                return sameMonth(value, 1);\n            },\n            thisMonth: function (value) {\n                return sameMonth(value, 0);\n            },\n            lastMonth: function (value) {\n                return sameMonth(value, -1);\n            },\n            nextQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() + 1 === value.getFullYear();\n                }\n                return false;\n            },\n            thisQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 0 && today.getFullYear() === value.getFullYear();\n                }\n                return false;\n            },\n            lastQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(today) - quarter(value);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() - 1 === value.getFullYear();\n                }\n                return false;\n            },\n            nextYear: function (value) {\n                return sameYear(value, 1);\n            },\n            thisYear: function (value) {\n                return sameYear(value, 0);\n            },\n            lastYear: function (value) {\n                return sameYear(value, -1);\n            },\n            yearToDate: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    return value.getFullYear() === today.getFullYear() && value <= today;\n                }\n                return false;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'dynamic',\n                    type: this._type\n                };\n            }\n        });\n        [\n            1,\n            2,\n            3,\n            4\n        ].forEach(function (target) {\n            kendo.spreadsheet.DynamicFilter.prototype['quarter' + target] = function (value) {\n                if (value instanceof Date) {\n                    return quarter(value) === target;\n                }\n                return false;\n            };\n        });\n        kendo.cultures['en-US'].calendar.months.names.forEach(function (month, index) {\n            kendo.spreadsheet.DynamicFilter.prototype[month.toLowerCase()] = function (value) {\n                if (value instanceof Date) {\n                    return value.getMonth() === index;\n                }\n                return false;\n            };\n        });\n        function quarter(value) {\n            var month = value.getMonth() + 1;\n            if (month >= 1 && month <= 3) {\n                return 1;\n            } else if (month >= 4 && month <= 6) {\n                return 2;\n            } else if (month >= 7 && month <= 9) {\n                return 3;\n            } else {\n                return 4;\n            }\n        }\n        function sameYear(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.today();\n                today.setFullYear(today.getFullYear() + offset);\n                return today.getFullYear() === value.getFullYear();\n            }\n            return false;\n        }\n        function sameMonth(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.firstDayOfMonth(kendo.date.today());\n                today.setMonth(today.getMonth() + offset, 1);\n                return today.getTime() === kendo.date.firstDayOfMonth(value).getTime();\n            }\n            return false;\n        }\n        function sameWeek(a, b) {\n            if (b instanceof Date) {\n                var firstWeek = kendo.date.dayOfWeek(kendo.date.getDate(a), 1);\n                var secondWeek = kendo.date.dayOfWeek(kendo.date.getDate(b), 1);\n                return firstWeek.getTime() === secondWeek.getTime();\n            }\n            return false;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sorter', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Sorter = kendo.Class.extend({\n            init: function (grid, lists) {\n                this._grid = grid;\n                this._lists = lists;\n            },\n            indices: function (rangeRef, list, ascending, indices) {\n                var comparer = Sorter.ascendingComparer;\n                if (ascending === false) {\n                    comparer = Sorter.descendingComparer;\n                }\n                return list.sortedIndices(this._grid.cellRefIndex(rangeRef.topLeft), this._grid.cellRefIndex(rangeRef.bottomRight), comparer, indices);\n            },\n            sortBy: function (ref, column, list, ascending, indices) {\n                var sortedIndices = this.indices(ref.toColumn(column), list, ascending, indices);\n                for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col; ci++) {\n                    var start = this._grid.index(ref.topLeft.row, ci);\n                    var end = this._grid.index(ref.bottomRight.row, ci);\n                    for (var li = 0; li < this._lists.length; li++) {\n                        if (start < this._lists[li].lastRangeStart()) {\n                            this._lists[li].sort(start, end, sortedIndices);\n                        }\n                    }\n                }\n                return sortedIndices;\n            }\n        });\n        Sorter.ascendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            var typeA = typeof a;\n            var typeB = typeof b;\n            if (typeA === 'number') {\n                if (typeB === 'number') {\n                    return a - b;\n                } else {\n                    return -1;\n                }\n            }\n            if (typeA === 'string') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return a.localeCompare(b);\n                default:\n                    return -1;\n                }\n            }\n            if (typeA === 'boolean') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return 1;\n                case 'boolean':\n                    return a - b;\n                default:\n                    return -1;\n                }\n            }\n            if (a instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                if (b instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                    return 0;\n                } else {\n                    return 1;\n                }\n            }\n            throw new Error('Cannot compare ' + a + ' and ' + b);\n        };\n        Sorter.descendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            return Sorter.ascendingComparer(b, a);\n        };\n        kendo.spreadsheet.Sorter = Sorter;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/numformat', [\n        'spreadsheet/calc',\n        'kendo.dom'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var calc = kendo.spreadsheet.calc;\n    var dom = kendo.dom;\n    var RX_COLORS = /^\\[(black|green|white|blue|magenta|yellow|cyan|red)\\]/i;\n    var RX_CONDITION = /^\\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\\]/;\n    function parse(input) {\n        input = calc.InputStream(input);\n        var sections = [], haveConditional = false, decimalPart;\n        while (!input.eof()) {\n            var sec = readSection();\n            sections.push(sec);\n            if (sec.cond) {\n                haveConditional = true;\n            }\n        }\n        if (!haveConditional) {\n            if (sections.length == 1) {\n                sections[0].cond = 'num';\n            } else if (sections.length == 2) {\n                sections[0].cond = {\n                    op: '>=',\n                    value: 0\n                };\n                sections[1].cond = {\n                    op: '<',\n                    value: 0\n                };\n            } else if (sections.length >= 3) {\n                sections[0].cond = {\n                    op: '>',\n                    value: 0\n                };\n                sections[1].cond = {\n                    op: '<',\n                    value: 0\n                };\n                sections[2].cond = {\n                    op: '=',\n                    value: 0\n                };\n                if (sections.length > 3) {\n                    sections[3].cond = 'text';\n                    sections = sections.slice(0, 4);\n                }\n            }\n        }\n        return sections;\n        function maybeColor() {\n            var m = input.skip(RX_COLORS);\n            if (m) {\n                return m[1].toLowerCase();\n            }\n        }\n        function maybeCondition() {\n            var m = input.skip(RX_CONDITION);\n            if (m) {\n                var val = parseFloat(m[2]);\n                if (!isNaN(val)) {\n                    return {\n                        op: m[1],\n                        value: val\n                    };\n                }\n            }\n        }\n        function readFormat() {\n            var format = [], tok, prev = null;\n            while (!input.eof() && (tok = readNext())) {\n                if (tok.type == 'date') {\n                    if (prev && /^(el)?time$/.test(prev.type) && prev.part == 'h' && tok.part == 'm' && tok.format < 3) {\n                        tok.type = 'time';\n                    }\n                } else if (/^(el)?time$/.test(tok.type) && tok.part == 's') {\n                    if (prev && prev.type == 'date' && prev.part == 'm' && prev.format < 3) {\n                        prev.type = 'time';\n                    }\n                }\n                if (!/^(?:str|space|fill)$/.test(tok.type)) {\n                    prev = tok;\n                }\n                format.push(tok);\n            }\n            return format;\n        }\n        function maybeFraction(tok) {\n            if (tok.type != 'date' || tok.part == 'm' && tok.format < 3) {\n                var m = input.skip(/^\\.(0+)/);\n                if (m) {\n                    tok.fraction = m[1].length;\n                    if (tok.type == 'date') {\n                        tok.type = 'time';\n                    }\n                }\n            }\n            return tok;\n        }\n        function readNext() {\n            var ch, m;\n            if (m = input.skip(/^([#0?]+)(?:,([#0?]+))+/)) {\n                return {\n                    type: 'digit',\n                    sep: true,\n                    format: m[1] + m[2],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^[#0?]+/)) {\n                return {\n                    type: 'digit',\n                    sep: false,\n                    format: m[0],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^(e)([+-])/i)) {\n                return {\n                    type: 'exp',\n                    ch: m[1],\n                    sign: m[2]\n                };\n            }\n            if (m = input.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'date',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^(hh?|ss?)/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'time',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^\\[(hh?|mm?|ss?)\\]/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'eltime',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^(am\\/pm|a\\/p)/i)) {\n                m = m[1].split('/');\n                return {\n                    type: 'ampm',\n                    am: m[0],\n                    pm: m[1]\n                };\n            }\n            switch (ch = input.next()) {\n            case ';':\n                return null;\n            case '\\\\':\n                return {\n                    type: 'str',\n                    value: input.next()\n                };\n            case '\"':\n                return {\n                    type: 'str',\n                    value: input.readEscaped(ch)\n                };\n            case '@':\n                return { type: 'text' };\n            case '_':\n                return {\n                    type: 'space',\n                    value: input.next()\n                };\n            case '*':\n                return {\n                    type: 'fill',\n                    value: input.next()\n                };\n            case '.':\n                if (input.lookingAt(/^\\s*[#0?]/)) {\n                    decimalPart = true;\n                    return { type: 'dec' };\n                }\n                return {\n                    type: 'str',\n                    value: '.'\n                };\n            case '%':\n                return { type: 'percent' };\n            case ',':\n                return { type: 'comma' };\n            }\n            return {\n                type: 'str',\n                value: ch\n            };\n        }\n        function readSection() {\n            decimalPart = false;\n            var color = maybeColor(), cond = maybeCondition();\n            if (!color && cond) {\n                color = maybeColor();\n            }\n            return {\n                color: color,\n                cond: cond,\n                body: readFormat()\n            };\n        }\n    }\n    function print(sections) {\n        return sections.map(printSection).join(';');\n        function printSection(sec) {\n            var out = '';\n            if (sec.color) {\n                out += '[' + sec.color + ']';\n            }\n            if (sec.cond) {\n                if (!(sec.cond == 'text' || sec.cond == 'num')) {\n                    out += '[' + sec.cond.op + sec.cond.value + ']';\n                }\n            }\n            out += sec.body.map(printToken).join('');\n            return out;\n        }\n        function maybeFraction(fmt, tok) {\n            if (tok.fraction) {\n                fmt += '.' + padLeft('', tok.fraction, '0');\n            }\n            return fmt;\n        }\n        function printToken(tok) {\n            if (tok.type == 'digit') {\n                if (tok.sep) {\n                    return tok.format.charAt(0) + ',' + tok.format.substr(1);\n                } else {\n                    return tok.format;\n                }\n            } else if (tok.type == 'exp') {\n                return tok.ch + tok.sign;\n            } else if (tok.type == 'date' || tok.type == 'time') {\n                return maybeFraction(padLeft('', tok.format, tok.part), tok);\n            } else if (tok.type == 'eltime') {\n                return maybeFraction('[' + padLeft('', tok.format, tok.part) + ']', tok);\n            } else if (tok.type == 'ampm') {\n                return tok.am + '/' + tok.pm;\n            } else if (tok.type == 'str') {\n                return JSON.stringify(tok.value);\n            } else if (tok.type == 'text') {\n                return '@';\n            } else if (tok.type == 'space') {\n                return '_' + tok.value;\n            } else if (tok.type == 'fill') {\n                return '*' + tok.value;\n            } else if (tok.type == 'dec') {\n                return '.';\n            } else if (tok.type == 'percent') {\n                return '%';\n            } else if (tok.type == 'comma') {\n                return ',';\n            }\n        }\n    }\n    function adjustDecimals(sections, x) {\n        sections.forEach(function (sec) {\n            var diff = x;\n            if (sec.cond == 'text') {\n                return;\n            }\n            var body = sec.body, adjusted = false, i = body.length;\n            while (diff !== 0 && --i >= 0) {\n                var tok = body[i];\n                if (tok.type == 'digit') {\n                    if (tok.decimal) {\n                        adjusted = true;\n                        if (diff > 0) {\n                            tok.format += padLeft('', diff, '0');\n                        } else if (diff < 0) {\n                            var tmp = tok.format.length;\n                            tok.format = tok.format.substr(0, tmp + diff);\n                            diff += tmp - tok.format.length;\n                        }\n                        if (tok.format.length === 0) {\n                            body.splice(i, 1);\n                            while (--i >= 0) {\n                                tok = body[i];\n                                if (tok.type == 'digit' && tok.decimal) {\n                                    ++i;\n                                    break;\n                                }\n                                if (tok.type == 'dec') {\n                                    body.splice(i, 1);\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    if (diff > 0) {\n                        break;\n                    }\n                }\n            }\n            if (!adjusted && diff > 0) {\n                body.splice(i + 1, 0, { type: 'dec' }, {\n                    type: 'digit',\n                    sep: false,\n                    decimal: true,\n                    format: padLeft('', diff, '0')\n                });\n            }\n        });\n    }\n    function TokenStream(parts) {\n        var index = 0;\n        return {\n            next: function () {\n                return parts[index++];\n            },\n            eof: function () {\n                return index >= parts.length;\n            },\n            ahead: function (n, f) {\n                if (index + n <= parts.length) {\n                    var val = f.apply(null, parts.slice(index, index + n));\n                    if (val) {\n                        index += n;\n                    }\n                    return val;\n                }\n            },\n            restart: function () {\n                index = 0;\n            }\n        };\n    }\n    function compileFormatPart(format) {\n        var input = TokenStream(format.body);\n        var hasDate = false;\n        var hasTime = false;\n        var hasAmpm = false;\n        var percentCount = 0;\n        var scaleCount = 0;\n        var code = '';\n        var separeThousands = false;\n        var declen = 0;\n        var intFormat = [], decFormat = [];\n        var condition = format.cond;\n        var preamble = '';\n        if (condition == 'text') {\n            preamble = 'if (typeof value == \\'string\\' || value instanceof kendo.spreadsheet.CalcError) { ';\n        } else if (condition == 'num') {\n            preamble = 'if (typeof value == \\'number\\') { ';\n        } else if (condition) {\n            var op = condition.op == '=' ? '==' : condition.op;\n            preamble = 'if (typeof value == \\'number\\' && value ' + op + ' ' + condition.value + ') { ';\n            code += 'value = Math.abs(value); ';\n        }\n        if (format.color) {\n            code += 'result.color = ' + JSON.stringify(format.color) + '; ';\n        }\n        function checkComma(a, b) {\n            if (a.type == 'digit' && b.type == 'comma' || a.type == 'comma' && a.hidden && b.type == 'comma') {\n                b.hidden = true;\n                scaleCount++;\n            }\n        }\n        while (!input.eof()) {\n            input.ahead(2, checkComma);\n            var tok = input.next();\n            if (tok.type == 'percent') {\n                percentCount++;\n            } else if (tok.type == 'digit') {\n                if (tok.decimal) {\n                    declen += tok.format.length;\n                    decFormat.push(tok.format);\n                } else {\n                    intFormat.push(tok.format);\n                    if (tok.sep) {\n                        separeThousands = true;\n                    }\n                }\n            } else if (tok.type == 'time') {\n                hasTime = true;\n            } else if (tok.type == 'date') {\n                hasDate = true;\n            } else if (tok.type == 'ampm') {\n                hasAmpm = hasTime = true;\n            }\n        }\n        if (percentCount > 0) {\n            code += 'value *= ' + Math.pow(100, percentCount) + '; ';\n        }\n        if (scaleCount > 0) {\n            code += 'value /= ' + Math.pow(1000, scaleCount) + '; ';\n        }\n        if (intFormat.length) {\n            code += 'var intPart = runtime.formatInt(culture, value, ' + JSON.stringify(intFormat) + ', ' + declen + ', ' + separeThousands + '); ';\n        }\n        if (decFormat.length) {\n            code += 'var decPart = runtime.formatDec(value, ' + JSON.stringify(decFormat) + ', ' + declen + '); ';\n        }\n        if (intFormat.length || decFormat.length) {\n            code += 'type = \\'number\\'; ';\n        }\n        if (hasDate) {\n            code += 'var date = runtime.unpackDate(value); ';\n        }\n        if (hasTime) {\n            code += 'var time = runtime.unpackTime(value); ';\n        }\n        if (hasDate || hasTime) {\n            code += 'type = \\'date\\'; ';\n        }\n        if (percentCount > 0 || scaleCount > 0 || intFormat.length || decFormat.length || hasDate || hasTime) {\n            if (!preamble) {\n                preamble = 'if (typeof value == \\'number\\') { ';\n            }\n        }\n        input.restart();\n        while (!input.eof()) {\n            var tok = input.next();\n            if (tok.type == 'dec') {\n                code += 'output += culture.numberFormat[\\'.\\']; ';\n            } else if (tok.type == 'comma' && !tok.hidden) {\n                code += 'output += \\',\\'; ';\n            } else if (tok.type == 'percent') {\n                code += 'type = \\'percent\\'; ';\n                code += 'output += culture.numberFormat.percent.symbol; ';\n            } else if (tok.type == 'str') {\n                code += 'output += ' + JSON.stringify(tok.value) + '; ';\n            } else if (tok.type == 'text') {\n                code += 'type = \\'text\\'; ';\n                code += 'output += value; ';\n            } else if (tok.type == 'space') {\n                code += 'if (output) result.body.push(output); ';\n                code += 'output = \\'\\'; ';\n                code += 'result.body.push({ type: \\'space\\', value: ' + JSON.stringify(tok.value) + ' }); ';\n            } else if (tok.type == 'fill') {\n                code += 'output += runtime.fill(' + JSON.stringify(tok.value) + '); ';\n            } else if (tok.type == 'digit') {\n                code += 'output += ' + (tok.decimal ? 'decPart' : 'intPart') + '.shift(); ';\n            } else if (tok.type == 'date') {\n                code += 'output += runtime.date(culture, date, ' + JSON.stringify(tok.part) + ', ' + tok.format + '); ';\n            } else if (tok.type == 'time') {\n                code += 'output += runtime.time(time, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + hasAmpm + ', ' + tok.fraction + '); ';\n            } else if (tok.type == 'eltime') {\n                code += 'output += runtime.eltime(value, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + tok.fraction + '); ';\n            } else if (tok.type == 'ampm') {\n                code += 'output += time.hours < 12 ? ' + JSON.stringify(tok.am) + ' : ' + JSON.stringify(tok.pm) + '; ';\n            }\n        }\n        code += 'if (output) result.body.push(output); ';\n        code += 'result.type = type; ';\n        code += 'return result; ';\n        if (preamble) {\n            code = preamble + code + '}';\n        }\n        return code;\n    }\n    var CACHE = Object.create(null);\n    var TEXT = compileFormatPart({\n        cond: 'text',\n        body: [{ type: 'text' }]\n    });\n    function compile(format) {\n        var f = CACHE[format];\n        if (!f) {\n            var tree = parse(format);\n            var code = tree.map(compileFormatPart);\n            code.push(TEXT);\n            code = code.join('\\n');\n            code = '\\'use strict\\'; return function(value, culture){ ' + 'if (!culture) culture = kendo.culture(); ' + 'var output = \\'\\', type = null, result = { body: [] }; ' + code + '; return result; };';\n            f = CACHE[format] = new Function('runtime', code)(runtime);\n        }\n        return f;\n    }\n    var runtime = {\n        unpackDate: calc.runtime.unpackDate,\n        unpackTime: calc.runtime.unpackTime,\n        date: function (culture, d, part, length) {\n            switch (part) {\n            case 'd':\n                switch (length) {\n                case 1:\n                    return d.date;\n                case 2:\n                    return padLeft(d.date, 2, '0');\n                case 3:\n                    return culture.calendars.standard.days.namesAbbr[d.day];\n                case 4:\n                    return culture.calendars.standard.days.names[d.day];\n                }\n                break;\n            case 'm':\n                switch (length) {\n                case 1:\n                    return d.month + 1;\n                case 2:\n                    return padLeft(d.month + 1, 2, '0');\n                case 3:\n                    return culture.calendars.standard.months.namesAbbr[d.month];\n                case 4:\n                    return culture.calendars.standard.months.names[d.month];\n                case 5:\n                    return culture.calendars.standard.months.names[d.month].charAt(0);\n                }\n                break;\n            case 'y':\n                switch (length) {\n                case 2:\n                    return d.year % 100;\n                case 4:\n                    return d.year;\n                }\n                break;\n            }\n            return '##';\n        },\n        time: function (t, part, length, ampm, fraclen) {\n            var ret, fraction;\n            switch (part) {\n            case 'h':\n                ret = padLeft(ampm ? t.hours % 12 || 12 : t.hours, length, '0');\n                if (fraclen) {\n                    fraction = (t.minutes + (t.seconds + t.milliseconds / 1000) / 60) / 60;\n                }\n                break;\n            case 'm':\n                ret = padLeft(t.minutes, length, '0');\n                if (fraclen) {\n                    fraction = (t.seconds + t.milliseconds / 1000) / 60;\n                }\n                break;\n            case 's':\n                ret = padLeft(t.seconds, length, '0');\n                if (fraclen) {\n                    fraction = t.milliseconds / 1000;\n                }\n                break;\n            }\n            if (fraction) {\n                ret += fraction.toFixed(fraclen).replace(/^0+/, '');\n            }\n            return ret;\n        },\n        eltime: function (value, part, length, fraclen) {\n            var ret, fraction;\n            switch (part) {\n            case 'h':\n                ret = value * 24;\n                break;\n            case 'm':\n                ret = value * 24 * 60;\n                break;\n            case 's':\n                ret = value * 24 * 60 * 60;\n                break;\n            }\n            if (fraclen) {\n                fraction = ret - (ret | 0);\n            }\n            ret = padLeft(ret | 0, length, '0');\n            if (fraction) {\n                ret += fraction.toFixed(fraclen).replace(/^0+/, '');\n            }\n            return ret;\n        },\n        fill: function (ch) {\n            return ch;\n        },\n        formatInt: function (culture, value, parts, declen, sep) {\n            value = value.toFixed(declen).replace(/\\..*$/, '');\n            if (declen > 0) {\n                if (value === '0') {\n                    value = '';\n                } else if (value === '-0') {\n                    value = '-';\n                }\n            }\n            var iv = value.length - 1;\n            var result = [];\n            var len = 0, str;\n            function add(ch) {\n                if (sep && len && len % 3 === 0 && /^[0-9]$/.test(ch)) {\n                    str = culture.numberFormat[','] + str;\n                }\n                str = ch + str;\n                len++;\n            }\n            for (var j = parts.length; --j >= 0;) {\n                var format = parts[j];\n                str = '';\n                for (var k = format.length; --k >= 0;) {\n                    var chf = format.charAt(k);\n                    if (iv < 0) {\n                        if (chf == '0') {\n                            add('0');\n                        } else if (chf == '?') {\n                            add(' ');\n                        }\n                    } else {\n                        add(value.charAt(iv--));\n                    }\n                }\n                if (j === 0) {\n                    while (iv >= 0) {\n                        add(value.charAt(iv--));\n                    }\n                }\n                result.unshift(str);\n            }\n            return result;\n        },\n        formatDec: function (value, parts, declen) {\n            value = value.toFixed(declen);\n            var pos = value.indexOf('.');\n            if (pos >= 0) {\n                value = value.substr(pos + 1).replace(/0+$/, '');\n            } else {\n                value = '';\n            }\n            var iv = 0;\n            var result = [];\n            for (var j = 0; j < parts.length; ++j) {\n                var format = parts[j];\n                var str = '';\n                for (var k = 0; k < format.length; ++k) {\n                    var chf = format.charAt(k);\n                    if (iv < value.length) {\n                        str += value.charAt(iv++);\n                    } else if (chf == '0') {\n                        str += '0';\n                    } else if (chf == '?') {\n                        str += ' ';\n                    }\n                }\n                result.push(str);\n            }\n            return result;\n        }\n    };\n    function padLeft(val, width, ch) {\n        val += '';\n        while (val.length < width) {\n            val = ch + val;\n        }\n        return val;\n    }\n    function text(f) {\n        var a = f.body;\n        var text = '';\n        for (var i = 0; i < a.length; ++i) {\n            var el = a[i];\n            if (typeof el == 'string') {\n                text += el;\n            } else if (el.type == 'space') {\n                text += ' ';\n            }\n        }\n        return text;\n    }\n    kendo.spreadsheet.formatting = {\n        compile: compile,\n        parse: parse,\n        format: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            var span = dom.element('span');\n            span.__dataType = f.type;\n            var a = f.body;\n            if (f.color) {\n                span.attr.style = { color: f.color };\n            }\n            for (var i = 0; i < a.length; ++i) {\n                var el = a[i];\n                if (typeof el == 'string') {\n                    span.children.push(dom.text(el));\n                } else if (el.type == 'space') {\n                    span.children.push(dom.element('span', { style: { visibility: 'hidden' } }, [dom.text(el.value)]));\n                }\n            }\n            return span;\n        },\n        text: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return text(f);\n        },\n        textAndColor: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return {\n                text: text(f),\n                color: f.color,\n                type: f.type\n            };\n        },\n        type: function (value, format) {\n            return compile(format)(value).type;\n        },\n        adjustDecimals: function (format, diff) {\n            var ast = parse(format);\n            adjustDecimals(ast, diff);\n            return print(ast);\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions', [\n        'spreadsheet/runtime',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var defineAlias = runtime.defineAlias;\n    var CalcError = runtime.CalcError;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var Matrix = runtime.Matrix;\n    var Ref = spreadsheet.Ref;\n    var daysInMonth = runtime.daysInMonth;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var daysInYear = runtime.daysInYear;\n    [\n        'abs',\n        'cos',\n        'sin',\n        'acos',\n        'asin',\n        'tan',\n        'atan',\n        'exp',\n        'sqrt'\n    ].forEach(function (name) {\n        defineFunction(name, Math[name]).args([[\n                '*n',\n                'number'\n            ]]);\n    });\n    defineFunction('ln', Math.log).args([[\n            '*n',\n            'number'\n        ]]);\n    defineFunction('log', function (num, base) {\n        return Math.log(num) / Math.log(base);\n    }).args([\n        [\n            '*num',\n            'number++'\n        ],\n        [\n            '*base',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    10\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$base != 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('log10', function (num) {\n        return Math.log(num) / Math.log(10);\n    }).args([[\n            '*num',\n            'number++'\n        ]]);\n    defineFunction('pi', function () {\n        return Math.PI;\n    }).args([]);\n    defineFunction('sqrtpi', function (n) {\n        return Math.sqrt(n * Math.PI);\n    }).args([[\n            '*num',\n            'number+'\n        ]]);\n    defineFunction('degrees', function (rad) {\n        return 180 * rad / Math.PI % 360;\n    }).args([[\n            '*radians',\n            'number'\n        ]]);\n    defineFunction('radians', function (deg) {\n        return Math.PI * deg / 180;\n    }).args([[\n            '*degrees',\n            'number'\n        ]]);\n    function _cosh(n) {\n        return (Math.exp(n) + Math.exp(-n)) / 2;\n    }\n    defineFunction('cosh', _cosh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acosh', function (n) {\n        return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$num >= 1'\n            ]\n        ]\n    ]);\n    function _sinh(n) {\n        return (Math.exp(n) - Math.exp(-n)) / 2;\n    }\n    defineFunction('sinh', _sinh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('asinh', function (n) {\n        return Math.log(n + Math.sqrt(n * n + 1));\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sec', function (n) {\n        return 1 / Math.cos(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sech', function (n) {\n        return 1 / _cosh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csc', function (n) {\n        return 1 / Math.sin(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csch', function (n) {\n        return 1 / _sinh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atan2', function (x, y) {\n        return Math.atan(y / x);\n    }).args([\n        [\n            '*x',\n            'divisor'\n        ],\n        [\n            '*y',\n            'number'\n        ]\n    ]);\n    function _tanh(n) {\n        return _sinh(n) / _cosh(n);\n    }\n    defineFunction('tanh', _tanh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atanh', function (n) {\n        return Math.log(Math.sqrt(1 - n * n) / (1 - n));\n    }).args([[\n            '*num',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('cot', function (n) {\n        return 1 / Math.tan(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('coth', function (n) {\n        return 1 / _tanh(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('acot', function (n) {\n        return Math.PI / 2 - Math.atan(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acoth', function (n) {\n        return Math.log((n + 1) / (n - 1)) / 2;\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'or',\n                [\n                    'assert',\n                    '$num < -1'\n                ],\n                [\n                    'assert',\n                    '$num > 1'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('power', function (a, b) {\n        return Math.pow(a, b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'number'\n        ]\n    ]);\n    defineFunction('mod', function (a, b) {\n        return a % b;\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('quotient', function (a, b) {\n        return Math.floor(a / b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('ceiling', function (num, s) {\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('ceiling.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('iso.ceiling', 'ceiling.precise');\n    defineFunction('ceiling.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor', function (num, s) {\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('floor.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('int', Math.floor).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('mround', function (num, mult) {\n        return mult ? mult * Math.round(num / mult) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*multiple',\n            'number'\n        ]\n    ]);\n    defineFunction('round', function (num, digits) {\n        var sign = num < 0 ? -1 : 1;\n        if (sign < 0) {\n            num = -num;\n        }\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = Math.round(num);\n        return sign * num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('roundup', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('rounddown', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.ceil(num) : Math.floor(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('even', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('odd', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n : n + (n < 0 ? -1 : 1);\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('sign', function (num) {\n        return num < 0 ? -1 : num > 0 ? 1 : 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    function _gcd(a, b) {\n        while (b) {\n            var r = a % b;\n            a = b;\n            b = r;\n        }\n        return a;\n    }\n    function _lcm(a, b) {\n        return Math.abs(a * b) / _gcd(a, b);\n    }\n    defineFunction('gcd', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _gcd(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('lcm', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _lcm(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sum', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('product', function (numbers) {\n        return numbers.reduce(function (prod, num) {\n            return prod * num;\n        }, 1);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumproduct', function (first, rest) {\n        var sum = 0;\n        first.each(function (p, row, col) {\n            if (typeof p == 'number') {\n                for (var i = 0; i < rest.length; ++i) {\n                    var v = rest[i].get(row, col);\n                    if (typeof v != 'number') {\n                        return;\n                    }\n                    p *= v;\n                }\n                sum += p;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a1',\n            'matrix'\n        ],\n        [\n            '+',\n            [\n                'a2',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$a2.width == $a1.width'\n                    ],\n                    [\n                        'assert',\n                        '$a2.height == $a1.height'\n                    ]\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumsq', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num * num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumx2my2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x - y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumx2py2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x + y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumxmy2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += (x - y) * (x - y);\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('seriessum', function (x, n, m, a) {\n        var sum = 0;\n        a.each(function (coef) {\n            if (typeof coef != 'number') {\n                throw new CalcError('VALUE');\n            }\n            sum += coef * Math.pow(x, n);\n            n += m;\n        });\n        return sum;\n    }).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'y',\n            'number'\n        ],\n        [\n            'm',\n            'number'\n        ],\n        [\n            'a',\n            'matrix'\n        ]\n    ]);\n    defineFunction('min', function (numbers) {\n        return Math.min.apply(Math, numbers);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('max', function (numbers) {\n        return Math.max.apply(Math, numbers);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('counta', function (values) {\n        return values.length;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('count', function (numbers) {\n        return numbers.length;\n    }).args([[\n            'numbers',\n            [\n                '#collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('countunique', function (values) {\n        var count = 0, seen = [];\n        values.forEach(function (val) {\n            if (seen.indexOf(val) < 0) {\n                count++;\n                seen.push(val);\n            }\n        });\n        return count;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('countblank', function (a) {\n        var count = 0;\n        function add(val) {\n            if (val == null || val === '') {\n                count++;\n            }\n        }\n        function loop(args) {\n            for (var i = 0; i < args.length; ++i) {\n                var x = args[i];\n                if (x instanceof Matrix) {\n                    x.each(add, true);\n                } else {\n                    add(x);\n                }\n            }\n        }\n        loop(a);\n        return count;\n    }).args([[\n            '+',\n            [\n                'args',\n                [\n                    'or',\n                    'matrix',\n                    'anyvalue'\n                ]\n            ]\n        ]]);\n    defineFunction('iseven', function (num) {\n        return num % 2 === 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('isodd', function (num) {\n        return num % 2 !== 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('n', function (val) {\n        if (typeof val == 'boolean') {\n            return val ? 1 : 0;\n        }\n        if (typeof val == 'number') {\n            return val;\n        }\n        return 0;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('na', function () {\n        return new CalcError('N/A');\n    }).args([]);\n    function forIFS(args, f) {\n        var chunks = [], i = 0, matrix = args[0];\n        while (i < args.length) {\n            chunks.push({\n                matrix: args[i++],\n                pred: parseCriteria(args[i++])\n            });\n        }\n        ROW:\n            for (var row = 0; row < matrix.height; ++row) {\n                COL:\n                    for (var col = 0; col < matrix.width; ++col) {\n                        for (i = 0; i < chunks.length; ++i) {\n                            var val = chunks[i].matrix.get(row, col);\n                            if (!chunks[i].pred(val == null || val === '' ? 0 : val)) {\n                                continue COL;\n                            }\n                        }\n                        f(row, col);\n                    }\n            }\n    }\n    var ARGS_COUNTIFS = [\n        [\n            'm1',\n            'matrix'\n        ],\n        [\n            'c1',\n            'anyvalue'\n        ],\n        [\n            [\n                'm2',\n                'matrix'\n            ],\n            [\n                'c2',\n                'anyvalue'\n            ]\n        ]\n    ];\n    defineFunction('countifs', function (m1, c1, rest) {\n        var count = 0;\n        rest.unshift(m1, c1);\n        forIFS(rest, function () {\n            count++;\n        });\n        return count;\n    }).args(ARGS_COUNTIFS);\n    var ARGS_SUMIFS = [[\n            'range',\n            'matrix'\n        ]].concat(ARGS_COUNTIFS);\n    defineFunction('sumifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val) {\n                sum += val;\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIFS);\n    defineFunction('averageifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0, count = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val == null || val === '') {\n                val = 0;\n            }\n            sum += val;\n            count++;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIFS);\n    defineFunction('countif', function (matrix, criteria) {\n        criteria = parseCriteria(criteria);\n        var count = 0;\n        matrix.each(function (val) {\n            if (criteria(val)) {\n                count++;\n            }\n        });\n        return count;\n    }).args([\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ]\n    ]);\n    var ARGS_SUMIF = [\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ],\n        [\n            'sumRange',\n            [\n                'or',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$sumRange.width == $range.width'\n                    ],\n                    [\n                        'assert',\n                        '$sumRange.height == $range.height'\n                    ]\n                ],\n                [\n                    'null',\n                    '$range'\n                ]\n            ]\n        ]\n    ];\n    defineFunction('sumif', function (range, criteria, sumRange) {\n        var sum = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                }\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIF);\n    defineFunction('averageif', function (range, criteria, sumRange) {\n        var sum = 0, count = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                    count++;\n                }\n            }\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIF);\n    (function (def) {\n        def('large', function (numbers, nth) {\n            return numbers.sort(descending)[nth];\n        });\n        def('small', function (numbers, nth) {\n            return numbers.sort(ascending)[nth];\n        });\n    }(function (name, handler) {\n        defineFunction(name, function (matrix, nth) {\n            var numbers = [];\n            var error = matrix.each(function (val) {\n                if (val instanceof CalcError) {\n                    return val;\n                }\n                if (typeof val == 'number') {\n                    numbers.push(val);\n                }\n            });\n            if (error) {\n                return error;\n            }\n            if (nth > numbers.length) {\n                return new CalcError('NUM');\n            }\n            return handler(numbers, nth - 1);\n        }).args([\n            [\n                'array',\n                'matrix'\n            ],\n            [\n                '*nth',\n                'number++'\n            ]\n        ]);\n    }));\n    function _avg(numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n    }\n    function _var_sp(numbers, divisor, avg) {\n        if (avg == null) {\n            avg = _avg(numbers);\n        }\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.pow(num - avg, 2);\n        }, 0) / divisor;\n    }\n    function _stdev_sp(numbers, divisor) {\n        return Math.sqrt(_var_sp(numbers, divisor));\n    }\n    defineFunction('stdev.s', function (numbers) {\n        return _stdev_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('stdev.p', function (numbers) {\n        return _stdev_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.s', function (numbers) {\n        return _var_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.p', function (numbers) {\n        return _var_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('median', function (numbers) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        if (n % 2) {\n            return numbers[n >> 1];\n        }\n        return (numbers[n >> 1] + numbers[n >> 1 + 1]) / 2;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('mode.sngl', function (numbers) {\n        numbers.sort(ascending);\n        var prev = null, count = 0, max = 1, mode = null;\n        for (var i = 0; i < numbers.length; ++i) {\n            var n = numbers[i];\n            if (n != prev) {\n                count = 1;\n                prev = n;\n            } else {\n                count++;\n            }\n            if (count > max) {\n                max = count;\n                mode = n;\n            }\n        }\n        return mode == null ? new CalcError('N/A') : mode;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('mode.mult', function (numbers) {\n        var seen = Object.create(null), max = 2, res = [];\n        numbers.forEach(function (num) {\n            var s = seen[num] || 0;\n            seen[num] = ++s;\n            if (s == max) {\n                res.push(num);\n            } else if (s > max) {\n                max = s;\n                res = [num];\n            }\n        });\n        var m = new Matrix(this);\n        res.forEach(function (num, i) {\n            m.set(i, 0, num);\n        });\n        return m;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('geomean', function (numbers) {\n        var n = numbers.length;\n        var p = numbers.reduce(function (p, num) {\n            if (num < 0) {\n                throw new CalcError('NUM');\n            }\n            return p * num;\n        }, 1);\n        return Math.pow(p, 1 / n);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('harmean', function (numbers) {\n        var n = numbers.length;\n        var s = numbers.reduce(function (s, num) {\n            if (!num) {\n                throw new CalcError('DIV/0');\n            }\n            return s + 1 / num;\n        }, 0);\n        return n / s;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('trimmean', function (numbers, p) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        var discard = Math.floor(n * p);\n        if (discard % 2) {\n            --discard;\n        }\n        discard /= 2;\n        var sum = 0;\n        for (var i = discard; i < n - discard; ++i) {\n            sum += numbers[i];\n        }\n        return sum / (n - discard * 2);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'percent',\n            [\n                'and',\n                'number',\n                [\n                    '[between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('frequency', function (data, bins) {\n        data.sort(ascending);\n        bins.sort(ascending);\n        var prev = -Infinity;\n        var i = 0;\n        function count(max) {\n            var n = 0;\n            while (i < data.length && data[i] > prev && data[i] <= max) {\n                ++n;\n                ++i;\n            }\n            return n;\n        }\n        var m = new Matrix(this);\n        bins.forEach(function (val, i) {\n            var n = count(val);\n            prev = val;\n            m.set(i, 0, n);\n        });\n        m.set(m.height, 0, data.length - i);\n        return m;\n    }).args([\n        [\n            'data',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'bins',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ]\n    ]);\n    defineFunction('rank.eq', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        return pos < 0 ? new CalcError('N/A') : pos + 1;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('rank', 'rank.eq');\n    defineFunction('rank.avg', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        if (pos < 0) {\n            return new CalcError('N/A');\n        }\n        for (var i = pos; numbers[i] == val; ++i) {\n        }\n        return (pos + i + 1) / 2;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('kurt', function (numbers) {\n        var n = numbers.length;\n        var avg = _avg(numbers);\n        var variance = _var_sp(numbers, n - 1, avg);\n        var stddev = Math.sqrt(variance);\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + Math.pow((num - avg) / stddev, 4);\n        }, 0);\n        return n * (n + 1) / ((n - 1) * (n - 2) * (n - 3)) * sum - 3 * Math.pow(n - 1, 2) / ((n - 2) * (n - 3));\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 4',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _percentrank(numbers, x, exc) {\n        var nlt = 0, ngt = 0, left = null, right = null, found = false;\n        numbers.forEach(function (num) {\n            if (num < x) {\n                nlt++;\n                left = left == null ? num : Math.max(left, num);\n            } else if (num > x) {\n                ngt++;\n                right = right == null ? num : Math.min(right, num);\n            } else {\n                found = true;\n            }\n        });\n        if (!nlt && !ngt) {\n            return new CalcError('N/A');\n        }\n        if (found) {\n            if (exc) {\n                return (nlt + 1) / (numbers.length + 1);\n            }\n            return nlt / (nlt + ngt);\n        }\n        return ((right - x) * _percentrank(numbers, left, exc) + (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n    }\n    var ARGS_PERCENTRANK = [\n        [\n            'array',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'x',\n            'number'\n        ],\n        [\n            'significance',\n            [\n                'or',\n                [\n                    'null',\n                    3\n                ],\n                'integer++'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array.length > 0',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('percentrank.inc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 0);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineFunction('percentrank.exc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 1);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineAlias('percentrank', 'percentrank.inc');\n    function _covariance(x, y, divisor) {\n        var sum = 0;\n        var ax = _avg(x);\n        var ay = _avg(y);\n        var n = x.length;\n        for (var i = 0; i < n; ++i) {\n            sum += (x[i] - ax) * (y[i] - ay);\n        }\n        return sum / divisor;\n    }\n    defineFunction('covariance.p', function (x, y) {\n        return _covariance(x, y, x.length);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('covariance.s', function (x, y) {\n        return _covariance(x, y, x.length - 1);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineAlias('covar', 'covariance.p');\n    var _fact = util.memoize(function (n) {\n        for (var i = 2, fact = 1; i <= n; ++i) {\n            fact *= i;\n        }\n        return fact;\n    });\n    defineFunction('fact', _fact).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('factdouble', function (n) {\n        for (var i = 2 + (n & 1), fact = 1; i <= n; i += 2) {\n            fact *= i;\n        }\n        return fact;\n    }).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('multinomial', function (numbers) {\n        var div = 1, sum = 0;\n        numbers.forEach(function (n) {\n            if (n < 0) {\n                throw new CalcError('NUM');\n            }\n            sum += n;\n            div *= _fact(n);\n        });\n        return _fact(sum) / div;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    var _combinations = util.memoize(function (n, k) {\n        for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n            p1 *= f1;\n            p2 *= f2;\n        }\n        return p1 / p2;\n    });\n    defineFunction('combin', _combinations).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('combina', function (n, k) {\n        return _combinations(n + k - 1, n - 1);\n    }).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    1,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('average', function (numbers) {\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n        return sum / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                [\n                    'and',\n                    'number',\n                    [\n                        'not',\n                        'boolean'\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('averagea', function (values) {\n        var sum = 0, count = 0;\n        values.forEach(function (num) {\n            if (typeof num != 'string') {\n                sum += num;\n            }\n            ++count;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args([[\n            'values',\n            [\n                'collect',\n                'anyvalue'\n            ]\n        ]]);\n    function _percentile(numbers, rank) {\n        numbers.sort(ascending);\n        var n = numbers.length;\n        var k = rank | 0, d = rank - k;\n        if (k === 0) {\n            return numbers[0];\n        }\n        if (k >= n) {\n            return numbers[n - 1];\n        }\n        --k;\n        return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n    }\n    function _percentile_inc(numbers, p) {\n        var rank = p * (numbers.length - 1) + 1;\n        return _percentile(numbers, rank);\n    }\n    function _percentile_exc(numbers, p) {\n        var rank = p * (numbers.length + 1);\n        return _percentile(numbers, rank);\n    }\n    defineFunction('percentile.inc', _percentile_inc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('percentile.exc', _percentile_exc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('quartile.inc', function (numbers, quarter) {\n        return _percentile_inc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineFunction('quartile.exc', function (numbers, quarter) {\n        return _percentile_exc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineAlias('quartile', 'quartile.inc');\n    defineAlias('percentile', 'percentile.inc');\n    var AGGREGATE_FUNCS = [\n        'AVERAGE',\n        'COUNT',\n        'COUNTA',\n        'MAX',\n        'MIN',\n        'PRODUCT',\n        'STDEV.S',\n        'STDEV.P',\n        'SUM',\n        'VAR.S',\n        'VAR.P',\n        'MEDIAN',\n        'MODE.SNGL',\n        'LARGE',\n        'SMALL',\n        'PERCENTILE.INC',\n        'QUARTILE.INC',\n        'PERCENTILE.EXC',\n        'QUARTILE.EXC'\n    ];\n    function fetchValuesForAggregate(self, args, options) {\n        var values = [];\n        var opt_ignore_hidden_rows = 1;\n        var opt_ignore_errors = 2;\n        var opt_use_aggregates = 4;\n        (function fetchValues(args) {\n            if (args instanceof Ref) {\n                self.getRefCells(args, true).forEach(function (cell) {\n                    var value = cell.value;\n                    if (options & opt_ignore_hidden_rows && cell.hidden) {\n                        return;\n                    }\n                    if (cell.formula) {\n                        var str = cell.formula.print(cell.row, cell.col);\n                        if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                            if (!(options & opt_use_aggregates)) {\n                                return;\n                            }\n                        }\n                        if ('value' in cell.formula) {\n                            value = cell.formula.value;\n                        }\n                    }\n                    if (options & opt_ignore_errors && value instanceof CalcError) {\n                        return;\n                    }\n                    if (typeof value == 'number' || value instanceof CalcError) {\n                        values.push(value);\n                    }\n                });\n            } else if (Array.isArray(args)) {\n                for (var i = 0; i < args.length; ++i) {\n                    fetchValues(args[i]);\n                }\n            } else if (args instanceof Matrix) {\n                args.each(fetchValues);\n            } else if (typeof args == 'number') {\n                values.push(args);\n            } else if (args instanceof CalcError && !(options & opt_ignore_errors)) {\n                values.push(args);\n            }\n        }(args));\n        return values;\n    }\n    defineFunction('aggregate', function (callback, funcId, options, args) {\n        var self = this;\n        self.resolveCells(args, function () {\n            var values;\n            if (funcId > 12) {\n                values = fetchValuesForAggregate(self, args[0], options);\n                var k = args[1];\n                if (k instanceof CellRef) {\n                    k = self.getRefData(k);\n                }\n                if (typeof k != 'number') {\n                    return callback(new CalcError('VALUE'));\n                }\n            } else {\n                values = fetchValuesForAggregate(self, args, options);\n            }\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                12,\n                13,\n                14,\n                15,\n                16,\n                17,\n                18,\n                19\n            ]\n        ],\n        [\n            'options',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4,\n                    5,\n                    6,\n                    7\n                ]\n            ]\n        ],\n        [\n            'args',\n            'rest'\n        ]\n    ]);\n    defineFunction('subtotal', function (callback, funcId) {\n        var self = this;\n        var ignoreHidden = funcId > 100;\n        if (ignoreHidden) {\n            funcId -= 100;\n        }\n        var args = [];\n        for (var i = 2; i < arguments.length; ++i) {\n            args.push(arguments[i]);\n        }\n        self.resolveCells(args, function () {\n            var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                101,\n                102,\n                103,\n                104,\n                105,\n                106,\n                107,\n                108,\n                109,\n                110,\n                111\n            ]\n        ],\n        [\n            '+',\n            [\n                'ref',\n                [\n                    'or',\n                    'ref',\n                    '#matrix'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('avedev', function (numbers) {\n        var avg = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.abs(num - avg);\n        }, 0) / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _binom_dist(x, n, p, cumulative) {\n        if (!cumulative) {\n            return _combinations(n, x) * Math.pow(p, x) * Math.pow(1 - p, n - x);\n        } else {\n            var sum = 0;\n            for (var j = 0; j <= x; ++j) {\n                sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1 - p, n - j);\n            }\n            return sum;\n        }\n    }\n    defineFunction('binom.dist', _binom_dist).args([\n        [\n            'successes',\n            'integer+'\n        ],\n        [\n            'trials',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$trials >= $successes'\n                ]\n            ]\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('binomdist', 'binom.dist');\n    defineFunction('binom.inv', function (n, p, alpha) {\n        for (var x = 0; x <= n; ++x) {\n            if (_binom_dist(x, n, p, true) >= alpha) {\n                return x;\n            }\n        }\n        return new CalcError('N/A');\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('critbinom', 'binom.inv');\n    defineFunction('binom.dist.range', function (n, p, s, s2) {\n        var sum = 0;\n        for (var k = s; k <= s2; ++k) {\n            sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);\n        }\n        return sum;\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'successes_min',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$trials'\n                ]\n            ]\n        ],\n        [\n            'successes_max',\n            [\n                'or',\n                [\n                    'and',\n                    'integer',\n                    [\n                        '[between]',\n                        '$successes_min',\n                        '$trials'\n                    ]\n                ],\n                [\n                    'null',\n                    '$successes_min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('negbinom.dist', function (x, k, p, cumulative) {\n        if (cumulative) {\n            var sum = 0;\n            while (x >= 0) {\n                sum += _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n                x--;\n            }\n            return sum;\n        }\n        return _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n    }).args([\n        [\n            'number_f',\n            'integer+'\n        ],\n        [\n            'number_s',\n            'integer+'\n        ],\n        [\n            'probability_s',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('negbinomdist', 'negbinom.dist');\n    defineFunction('address', function (row, col, abs, a1, sheet) {\n        var cell = new CellRef(row - 1, col - 1, abs - 1);\n        if (sheet) {\n            cell.setSheet(sheet, true);\n        }\n        return a1 ? cell.print(0, 0) : cell.print();\n    }).args([\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'abs',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ],\n        [\n            'a1',\n            [\n                'or',\n                [\n                    'null',\n                    true\n                ],\n                'logical'\n            ]\n        ],\n        [\n            'sheet',\n            [\n                'or',\n                'null',\n                'string'\n            ]\n        ]\n    ]);\n    defineFunction('areas', function (ref) {\n        var count = 0;\n        (function loop(x) {\n            if (x instanceof CellRef || x instanceof RangeRef) {\n                count++;\n            } else if (x instanceof UnionRef) {\n                x.refs.forEach(loop);\n            }\n        }(ref));\n        return count;\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('choose', function (index, args) {\n        if (index > args.length) {\n            return new CalcError('N/A');\n        } else {\n            return args[index - 1];\n        }\n    }).args([\n        [\n            '*index',\n            'integer'\n        ],\n        [\n            '+',\n            [\n                'value',\n                'anything'\n            ]\n        ]\n    ]);\n    defineFunction('column', function (ref) {\n        if (!ref) {\n            return this.formula.col + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.col + 1;\n        }\n        return this.asMatrix(ref).mapCol(function (col) {\n            return col + ref.topLeft.col + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('columns', function (m) {\n        return m instanceof Ref ? m.width() : m.width;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('formulatext', function (ref) {\n        var cell = this.getRefCells(ref)[0];\n        if (!cell.formula) {\n            return new CalcError('N/A');\n        }\n        return cell.formula.print(cell.row, cell.col);\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('hlookup', function (value, m, row, approx) {\n        var resultCol = null;\n        m.eachCol(function (col) {\n            var data = m.get(0, col);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultCol = col;\n            } else if (data === value) {\n                resultCol = col;\n                return true;\n            }\n        });\n        if (resultCol == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(row - 1, resultCol);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('index', function (callback, ref, row, col, areanum) {\n        var self = this;\n        if (ref instanceof UnionRef) {\n            ref = ref.refs[areanum - 1];\n        }\n        if (!row && !col || !ref) {\n            return callback(new CalcError('N/A'));\n        }\n        if (ref instanceof CellRef) {\n            ref = ref.toRangeRef();\n        }\n        if (ref instanceof RangeRef) {\n            if (row && col) {\n                if (col > ref.width() || row > ref.height()) {\n                    return callback(new CalcError('REF'));\n                }\n                var cell = ref.toCell(row - 1, col - 1);\n                self.resolveCells([cell], function () {\n                    callback(self.getRefData(cell));\n                });\n                return;\n            }\n            if (!row) {\n                var colRange = ref.toColumn(col - 1);\n                self.resolveCells([colRange], function () {\n                    callback(self.asMatrix(colRange));\n                });\n                return;\n            }\n            if (!col) {\n                var rowRange = ref.toRow(row - 1);\n                self.resolveCells([rowRange], function () {\n                    callback(self.asMatrix(rowRange));\n                });\n                return;\n            }\n        } else if (ref instanceof Matrix) {\n            if (ref.width > 1 && ref.height > 1) {\n                if (row && col) {\n                    return callback(ref.get(row - 1, col - 1));\n                }\n                if (!row) {\n                    return callback(ref.mapRow(function (row) {\n                        return ref.get(row, col - 1);\n                    }));\n                }\n                if (!col) {\n                    return callback(ref.mapCol(function (col) {\n                        return ref.get(row - 1, col);\n                    }));\n                }\n            }\n            if (ref.width == 1) {\n                return callback(ref.get(row - 1, 0));\n            }\n            if (ref.height == 1) {\n                return callback(ref.get(0, col - 1));\n            }\n        } else {\n            callback(new CalcError('REF'));\n        }\n    }).argsAsync([\n        [\n            'range',\n            [\n                'or',\n                'ref',\n                'matrix'\n            ]\n        ],\n        [\n            'row',\n            [\n                'or',\n                'integer+',\n                'null'\n            ]\n        ],\n        [\n            'col',\n            [\n                'or',\n                'integer+',\n                'null'\n            ]\n        ],\n        [\n            'areanum',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('indirect', function (thing) {\n        try {\n            var f = this.formula;\n            var exp = calc.parseFormula(f.sheet, f.row, f.col, thing);\n            if (!(exp.ast instanceof Ref)) {\n                throw 1;\n            }\n            return exp.ast.absolute(f.row, f.col);\n        } catch (ex) {\n            return new CalcError('REF');\n        }\n    }).args([[\n            'thing',\n            'string'\n        ]]);\n    defineFunction('match', function (val, m, type) {\n        var index = 1, cmp;\n        if (type === 0) {\n            cmp = parseCriteria(val);\n        } else if (type === -1) {\n            cmp = parseCriteria('<=' + val);\n        } else if (type === 1) {\n            cmp = parseCriteria('>=' + val);\n        }\n        if (m.each(function (el) {\n                if (el != null && cmp(el)) {\n                    if (type !== 0 && val != el) {\n                        --index;\n                    }\n                    return true;\n                }\n                index++;\n            }, true) && index > 0) {\n            return index;\n        } else {\n            return new CalcError('N/A');\n        }\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    -1,\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('offset', function (ref, rows, cols, height, width) {\n        var topLeft = (ref instanceof CellRef ? ref : ref.topLeft).clone();\n        topLeft.row += rows;\n        topLeft.col += cols;\n        if (topLeft.row < 0 || topLeft.col < 0) {\n            return new CalcError('VALUE');\n        }\n        if (height > 1 || width > 1) {\n            return new RangeRef(topLeft, new CellRef(topLeft.row + height - 1, topLeft.col + width - 1)).setSheet(ref.sheet, ref.hasSheet());\n        }\n        return topLeft;\n    }).args([\n        [\n            'ref',\n            'area'\n        ],\n        [\n            '*rows',\n            'integer'\n        ],\n        [\n            '*cols',\n            'integer'\n        ],\n        [\n            '*height',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.height()'\n                ]\n            ]\n        ],\n        [\n            '*width',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.width()'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('row', function (ref) {\n        if (!ref) {\n            return this.formula.row + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.row + 1;\n        }\n        return this.asMatrix(ref).mapRow(function (row) {\n            return row + ref.topLeft.row + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('rows', function (m) {\n        return m instanceof Ref ? m.height() : m.height;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('vlookup', function (value, m, col, approx) {\n        var resultRow = null;\n        if (typeof value != 'number') {\n            approx = false;\n        }\n        if (typeof value == 'string') {\n            value = value.toLowerCase();\n        }\n        m.eachRow(function (row) {\n            var data = m.get(row, 0);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultRow = row;\n            } else {\n                if (typeof data == 'string') {\n                    data = data.toLowerCase();\n                }\n                if (data === value) {\n                    resultRow = row;\n                    return true;\n                }\n            }\n        });\n        if (resultRow == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(resultRow, col - 1);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('date', function (year, month, date) {\n        return packDate(year, month - 1, date);\n    }).args([\n        [\n            '*year',\n            'integer'\n        ],\n        [\n            '*month',\n            'integer'\n        ],\n        [\n            '*date',\n            'integer'\n        ]\n    ]);\n    defineFunction('day', function (date) {\n        return unpackDate(date).date;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('month', function (date) {\n        return unpackDate(date).month + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('year', function (date) {\n        return unpackDate(date).year;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weekday', function (date) {\n        return unpackDate(date).day + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weeknum', function (date, type) {\n        var fw = packDate(unpackDate(date).year, 0, 1);\n        var sy = unpackDate(fw);\n        var diff;\n        if (type == 21) {\n            diff = 3 - (sy.day + 6) % 7;\n            if (diff < 0) {\n                diff += 7;\n            }\n            fw += diff;\n            sy.date += diff;\n            sy.day = 4;\n            type = 1;\n        } else {\n            if (type == 1) {\n                type = 0;\n            } else if (type == 2) {\n                type = 1;\n            } else {\n                type = (type - 10) % 7;\n            }\n        }\n        diff = sy.day - type;\n        if (diff < 0) {\n            diff += 7;\n        }\n        fw -= diff;\n        return Math.ceil((date + 1 - fw) / 7);\n    }).args([\n        [\n            '*date',\n            'date'\n        ],\n        [\n            '*type',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    11,\n                    12,\n                    13,\n                    14,\n                    15,\n                    16,\n                    17,\n                    21\n                ]\n            ]\n        ]\n    ]);\n    function weeksInYear(year) {\n        var d = unpackDate(packDate(year, 0, 1));\n        if (d.day == 4 || d.day == 3 && runtime.isLeapYear(year)) {\n            return 53;\n        }\n        return 52;\n    }\n    defineFunction('isoweeknum', function isoweeknum(date) {\n        var d = unpackDate(date);\n        var dow = d.day || 7;\n        var wk = Math.floor((d.ord - dow + 10) / 7);\n        if (wk < 1) {\n            return weeksInYear(d.year - 1);\n        } else if (wk == 53 && wk > weeksInYear(d.year)) {\n            return 1;\n        }\n        return wk;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('now', function () {\n        return runtime.dateToSerial(new Date());\n    }).args([]);\n    defineFunction('today', function () {\n        return runtime.dateToSerial(new Date()) | 0;\n    }).args([]);\n    defineFunction('time', function (hh, mm, ss) {\n        return runtime.packTime(hh, mm, ss, 0);\n    }).args([\n        [\n            '*hours',\n            'integer'\n        ],\n        [\n            '*minutes',\n            'integer'\n        ],\n        [\n            '*seconds',\n            'integer'\n        ]\n    ]);\n    defineFunction('hour', function (time) {\n        return runtime.unpackTime(time).hours;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('minute', function (time) {\n        return runtime.unpackTime(time).minutes;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('second', function (time) {\n        return runtime.unpackTime(time).seconds;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('edate', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('eomonth', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = daysInMonth(y, m);\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('workday', function (date, n, holidays) {\n        var inc = n > 0 ? 1 : -1;\n        n = Math.abs(n);\n        var dow = unpackDate(date).day;\n        while (n > 0) {\n            date += inc;\n            dow = (dow + inc) % 7;\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                --n;\n            }\n        }\n        return date;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'days',\n            'integer'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('networkdays', function (date, end, holidays) {\n        if (date > end) {\n            var tmp = date;\n            date = end;\n            end = tmp;\n        }\n        var count = 0;\n        var dow = unpackDate(date).day;\n        while (date <= end) {\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                count++;\n            }\n            date++;\n            dow = (dow + 1) % 7;\n        }\n        return count;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'end_date',\n            'date'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('days', function (start, end) {\n        return end - start;\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ]\n    ]);\n    function _days_360(start, end, method) {\n        var d1 = unpackDate(start);\n        var d2 = unpackDate(end);\n        if (method) {\n            if (d1.date == 31) {\n                d1.date = 30;\n            }\n            if (d2.date == 31) {\n                d2.date = 30;\n            }\n        } else {\n            if (d1.month == 1 && d2.month == 1 && d1.date == daysInMonth(d1.year, 1) && d2.date == daysInMonth(d2.year, 1)) {\n                d2.date = 30;\n            }\n            if (d1.date == daysInMonth(d1.year, d1.month)) {\n                d1.date = 30;\n                if (d2.date == 31) {\n                    d2.date = 30;\n                }\n            } else {\n                if (d1.date == 30 && d2.date == 31) {\n                    d2.date = 30;\n                }\n            }\n        }\n        return 360 * (d2.year - d1.year) + 30 * (d2.month - d1.month) + (d2.date - d1.date);\n    }\n    runtime._days_360 = _days_360;\n    defineFunction('days360', _days_360).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('yearfrac', function (start, end, method) {\n        switch (method) {\n        case 0:\n            return _days_360(start, end, false) / 360;\n        case 1:\n            return (end - start) / daysInYear(unpackDate(start).year);\n        case 2:\n            return (end - start) / 360;\n        case 3:\n            return (end - start) / 365;\n        case 4:\n            return _days_360(start, end, true) / 360;\n        }\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('datevalue', function (text) {\n        var date = runtime.parseDate(text);\n        if (date) {\n            return runtime.dateToSerial(date);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('timevalue', function (text) {\n        var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n        if (m) {\n            var hh = parseFloat(m[1]);\n            var mm = parseFloat(m[2]);\n            var ss = m[3] ? parseFloat(m[4]) : 0;\n            var ampm = m[7];\n            if (ampm && (hh > 12 || hh < 1)) {\n                return new CalcError('VALUE');\n            }\n            if (/^p/.test(ampm)) {\n                hh += 12;\n            }\n            return runtime.packTime(hh, mm, ss, 0);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mdeterm', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.determinant();\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('transpose', function (m) {\n        return m.transpose();\n    }).args([[\n            'range',\n            'matrix'\n        ]]);\n    defineFunction('mmult', function (a, b) {\n        return a.multiply(b);\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.height == $a.width'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('munit', function (n) {\n        return new Matrix(this).unit(n);\n    }).args([[\n            'n',\n            'integer+'\n        ]]);\n    defineFunction('minverse', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.inverse() || new CalcError('VALUE');\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('rand', function () {\n        return Math.random();\n    }).args([]);\n    defineFunction('randbetween', function (min, max) {\n        return min + Math.floor((max - min + 1) * Math.random());\n    }).args([\n        [\n            'min',\n            'integer'\n        ],\n        [\n            'max',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$max >= $min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('true', function () {\n        return true;\n    }).args([]);\n    defineFunction('false', function () {\n        return true;\n    }).args([]);\n    defineFunction('roman', function (num) {\n        return util.arabicToRoman(num).toUpperCase();\n    }).args([[\n            '*number',\n            'integer'\n        ]]);\n    defineFunction('arabic', function (rom) {\n        var num = util.romanToArabic(rom);\n        return num == null ? new CalcError('VALUE') : num;\n    }).args([[\n            '*roman',\n            'string'\n        ]]);\n    defineFunction('base', function (number, radix, minLen) {\n        var str = number.toString(radix).toUpperCase();\n        while (str.length < minLen) {\n            str = '0' + str;\n        }\n        return str;\n    }).args([\n        [\n            '*number',\n            'integer'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ],\n        [\n            '*minLen',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('decimal', function (text, radix) {\n        text = text.toUpperCase();\n        var val = 0;\n        for (var i = 0; i < text.length; ++i) {\n            var d = text.charCodeAt(i);\n            if (d >= 48 && d <= 57) {\n                d -= 48;\n            } else if (d >= 65 && d < 55 + radix) {\n                d -= 55;\n            } else {\n                return new CalcError('VALUE');\n            }\n            val = val * radix + d;\n        }\n        return val;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('char', function (code) {\n        return String.fromCharCode(code);\n    }).args([[\n            '*code',\n            'integer+'\n        ]]);\n    var RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n    defineFunction('clean', function (text) {\n        return text.replace(RX_NON_PRINTABLE, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('code', function (text) {\n        return text.charAt(0);\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineAlias('unichar', 'char');\n    defineAlias('unicode', 'code');\n    defineFunction('concatenate', function (args) {\n        var out = '';\n        for (var i = 0; i < args.length; ++i) {\n            out += args[i];\n        }\n        return out;\n    }).args([[\n            '+',\n            [\n                '*text',\n                'string'\n            ]\n        ]]);\n    defineFunction('dollar', function (number, decimals) {\n        var format = '$#,##0.DECIMALS;($#,##0.DECIMALS)';\n        var dec = '';\n        while (decimals-- > 0) {\n            dec += '0';\n        }\n        format = format.replace(/DECIMALS/g, dec);\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('exact', function (a, b) {\n        return a === b;\n    }).args([\n        [\n            '*text1',\n            'string'\n        ],\n        [\n            '*text2',\n            'string'\n        ]\n    ]);\n    defineFunction('find', function (substring, string, start) {\n        var pos = string.indexOf(substring, start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('fixed', function (number, decimals, noCommas) {\n        var format = noCommas ? '0.DECIMALS' : '#,##0.DECIMALS';\n        var dec = '';\n        while (decimals-- > 0) {\n            dec += '0';\n        }\n        format = format.replace(/DECIMALS/g, dec);\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            '*noCommas',\n            [\n                'or',\n                'boolean',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('left', function (text, length) {\n        return text.substr(0, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('right', function (text, length) {\n        return text.substr(-length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('len', function (text) {\n        return text.length;\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('lower', function (text) {\n        return text.toLowerCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('upper', function (text) {\n        return text.toUpperCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('ltrim', function (text) {\n        return text.replace(/^\\s+/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('rtrim', function (text) {\n        return text.replace(/\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('trim', function (text) {\n        return text.replace(/^\\s+|\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mid', function (text, start, length) {\n        return text.substr(start - 1, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ]\n    ]);\n    defineFunction('proper', function (text) {\n        return text.toLowerCase().replace(/\\b./g, function (s) {\n            return s.toUpperCase();\n        });\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('replace', function (text, start, length, newText) {\n        return text.substr(0, --start) + newText + text.substr(start + length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ],\n        [\n            '*newText',\n            'string'\n        ]\n    ]);\n    defineFunction('rept', function (text, number) {\n        var out = '';\n        while (number-- > 0) {\n            out += text;\n        }\n        return out;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*number',\n            'integer+'\n        ]\n    ]);\n    defineFunction('search', function (substring, string, start) {\n        var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('substitute', function (text, oldText, newText, nth) {\n        if (oldText === newText) {\n            return text;\n        }\n        var pos = -1;\n        function replace() {\n            text = text.substring(0, pos) + newText + text.substring(pos + oldText.length);\n        }\n        while ((pos = text.indexOf(oldText, pos + 1)) >= 0) {\n            if (nth == null) {\n                replace();\n            } else if (--nth === 0) {\n                replace();\n                break;\n            }\n        }\n        return text;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*oldText',\n            'string'\n        ],\n        [\n            '*newText',\n            'string'\n        ],\n        [\n            '*nth',\n            [\n                'or',\n                'integer++',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('t', function (value) {\n        return typeof value == 'string' ? value : '';\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('text', function (value, format) {\n        return spreadsheet.formatting.text(value, format);\n    }).args([\n        [\n            '*value',\n            'anyvalue'\n        ],\n        [\n            '*format',\n            'string'\n        ]\n    ]);\n    defineFunction('value', function (value) {\n        if (typeof value == 'number') {\n            return value;\n        }\n        if (typeof value == 'boolean') {\n            return +value;\n        }\n        value = (value + '').replace(/[$,]/g, '');\n        value = parseFloat(value);\n        return isNaN(value) ? new CalcError('VALUE') : value;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    function Hyperlink(link, text) {\n        this.link = link;\n        this.text = text;\n    }\n    Hyperlink.prototype.toString = function () {\n        return this.text;\n    };\n    defineFunction('hyperlink', function (link, text) {\n        return new Hyperlink(link, text);\n    }).args([\n        [\n            '*link',\n            'string'\n        ],\n        [\n            '*text',\n            [\n                'or',\n                'string',\n                [\n                    'null',\n                    '$link'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('iferror', function (value, valueIfError) {\n        return value instanceof CalcError ? valueIfError : value;\n    }).args([\n        [\n            '*value',\n            'forced!'\n        ],\n        [\n            '*value_if_error',\n            'anyvalue!'\n        ]\n    ]);\n    var parseCriteria = function () {\n        var RXCACHE = Object.create(null);\n        function makeComparator(cmp, x) {\n            if (typeof x == 'string') {\n                var num = parseFloat(x);\n                if (!isNaN(num) && num == x) {\n                    x = num;\n                }\n            }\n            return function (a) {\n                var b = x;\n                if (typeof a == 'string' && typeof b == 'string') {\n                    a = a.toLowerCase();\n                    b = b.toLowerCase();\n                }\n                return cmp(a, b);\n            };\n        }\n        function lc(a) {\n            var num, str;\n            if (typeof a == 'string') {\n                a = a.toLowerCase();\n            }\n            if (/^[0-9.]+%$/.test(a)) {\n                str = a.substr(0, a.length - 1);\n                num = parseFloat(str);\n                if (!isNaN(num) && num == str) {\n                    a = num / 100;\n                }\n            } else if (/^[0-9.]+$/.test(a)) {\n                num = parseFloat(a);\n                if (!isNaN(num) && num == a) {\n                    a = num;\n                }\n            }\n            return a;\n        }\n        function compLT(a, b) {\n            return lc(a) < lc(b);\n        }\n        function compLTE(a, b) {\n            return lc(a) <= lc(b);\n        }\n        function compGT(a, b) {\n            return lc(a) > lc(b);\n        }\n        function compGTE(a, b) {\n            return lc(a) >= lc(b);\n        }\n        function compNE(a, b) {\n            return !compEQ(a, b);\n        }\n        function compEQ(a, b) {\n            if (b instanceof RegExp) {\n                return b.test(a);\n            }\n            if (typeof a == 'string' || typeof b == 'string') {\n                a = String(a);\n                b = String(b);\n            }\n            return lc(a) == lc(b);\n        }\n        return function (cmp) {\n            if (typeof cmp == 'function') {\n                return cmp;\n            }\n            var m;\n            if (m = /^=(.*)$/.exec(cmp)) {\n                return makeComparator(compEQ, m[1]);\n            }\n            if (m = /^<>(.*)$/.exec(cmp)) {\n                return makeComparator(compNE, m[1]);\n            }\n            if (m = /^<=(.*)$/.exec(cmp)) {\n                return makeComparator(compLTE, m[1]);\n            }\n            if (m = /^<(.*)$/.exec(cmp)) {\n                return makeComparator(compLT, m[1]);\n            }\n            if (m = /^>=(.*)$/.exec(cmp)) {\n                return makeComparator(compGTE, m[1]);\n            }\n            if (m = /^>(.*)$/.exec(cmp)) {\n                return makeComparator(compGT, m[1]);\n            }\n            if (/[?*]/.exec(cmp)) {\n                var rx = RXCACHE[cmp];\n                if (!rx) {\n                    rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function (s) {\n                        switch (s) {\n                        case '~?':\n                            return '\\\\?';\n                        case '~*':\n                            return '\\\\*';\n                        case '?':\n                            return '.';\n                        case '*':\n                            return '.*';\n                        default:\n                            return '\\\\' + s;\n                        }\n                    });\n                    rx = RXCACHE[cmp] = new RegExp('^' + rx + '$', 'i');\n                }\n                return makeComparator(compEQ, rx);\n            }\n            return makeComparator(compEQ, cmp);\n        };\n    }();\n    function numericPredicate(val) {\n        return typeof val == 'number' || typeof val == 'boolean' || val == null || val === '';\n    }\n    function ascending(a, b) {\n        return a === b ? 0 : a < b ? -1 : 1;\n    }\n    function descending(a, b) {\n        return a === b ? 0 : a < b ? 1 : -1;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions.2', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var CalcError = runtime.CalcError;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var isLeapYear = runtime.isLeapYear;\n    var daysInMonth = runtime.daysInMonth;\n    var _days_360 = runtime._days_360;\n    defineFunction('ERF', function (ll, ul) {\n        if (ul == null) {\n            return ERF(ll);\n        }\n        return ERF(ul) - ERF(ll);\n    }).args([\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('ERFC', ERFC).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMALN', GAMMALN).args([[\n            'x',\n            'number++'\n        ]]);\n    defineFunction('GAMMA', GAMMA).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMA.DIST', GAMMA_DIST).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('GAMMA.INV', GAMMA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ]\n    ]);\n    defineFunction('NORM.S.DIST', NORM_S_DIST).args([\n        [\n            'z',\n            'number'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.S.INV', NORM_S_INV).args([[\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('NORM.DIST', NORM_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.INV', NORM_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ]\n    ]);\n    defineFunction('BETADIST', BETADIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.DIST', BETA_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.INV', BETA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CHISQ.DIST', chisq_left).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('CHISQ.DIST.RT', chisq_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV', chisq_left_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV.RT', chisq_right_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.TEST', function (ac, ex) {\n        return chisq_test(ac.data, ex.data);\n    }).args([\n        [\n            'actual_range',\n            'matrix'\n        ],\n        [\n            'expected_range',\n            'matrix'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.width == $expected_range.width'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.height == $expected_range.height'\n            ]\n        ]\n    ]);\n    defineFunction('EXPON.DIST', expon).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'lambda',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('POISSON.DIST', poisson).args([\n        [\n            'x',\n            'integer+'\n        ],\n        [\n            'mean',\n            'number+'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST', Fdist).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST.RT', Fdist_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV', Finv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV.RT', Finv_right).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.TEST', Ftest).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FISHER', fisher).args([[\n            'x',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('FISHERINV', fisherinv).args([[\n            'y',\n            'number'\n        ]]);\n    defineFunction('T.DIST', Tdist).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('T.DIST.RT', Tdist_right).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.DIST.2T', Tdist_2tail).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV', Tdist_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV.2T', Tdist_2tail_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.TEST', Tdist_test).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'tails',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    3\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$type != 1 || $array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.T', confidence_t).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++',\n                [\n                    'assert',\n                    '$size != 1',\n                    'DIV/0'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.NORM', confidence_norm).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++'\n            ]\n        ]\n    ]);\n    defineFunction('GAUSS', gauss).args([[\n            'z',\n            'number'\n        ]]);\n    defineFunction('PHI', phi).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('LOGNORM.DIST', lognorm_dist).args([\n        [\n            'x',\n            'number++'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('LOGNORM.INV', lognorm_inv).args([\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ]\n    ]);\n    defineFunction('PROB', prob).args([\n        [\n            'x_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'prob_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$lower_limit'\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$prob_range.length == $x_range.length',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('SLOPE', slope).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('INTERCEPT', intercept).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('PEARSON', pearson).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length == $array1.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length > 0 && $array1.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('RSQ', rsq).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length != 1 && $known_y.length != 1',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('STEYX', steyx).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length >= 3 && $known_y.length >= 3',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FORECAST', forecast).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('LINEST', linest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('LOGEST', logest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('TREND', trend).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('GROWTH', growth).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('FV', FV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $pv'\n            ]\n        ]\n    ]);\n    defineFunction('PV', PV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('PMT', PMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('NPER', NPER).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('RATE', RATE).args([\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    0.01\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('IPMT', IPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('PPMT', PPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('CUMPRINC', CUMPRINC).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('CUMIPMT', CUMIPMT).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('NPV', NPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('IRR', IRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('EFFECT', EFFECT).args([\n        [\n            'nominal_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('NOMINAL', NOMINAL).args([\n        [\n            'effect_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('XNPV', XNPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('XIRR', XIRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ISPMT', ISPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('DB', DB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'month',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    12\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('DDB', DDB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('SLN', SLN).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ]\n    ]);\n    defineFunction('SYD', SYD).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'per',\n            'number++'\n        ]\n    ]);\n    defineFunction('VDB', VDB).args([\n        [\n            'cost',\n            'number+'\n        ],\n        [\n            'salvage',\n            'number+'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number+'\n        ],\n        [\n            'end_period',\n            'number+'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number+',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            'no_switch',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    var COUPS_ARGS = [\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('COUPDAYBS', COUPDAYBS).args(COUPS_ARGS);\n    defineFunction('COUPDAYS', COUPDAYS).args(COUPS_ARGS);\n    defineFunction('COUPDAYSNC', COUPDAYSNC).args(COUPS_ARGS);\n    defineFunction('COUPPCD', COUPPCD).args(COUPS_ARGS);\n    defineFunction('COUPNCD', COUPNCD).args(COUPS_ARGS);\n    defineFunction('COUPNUM', COUPNUM).args(COUPS_ARGS);\n    defineFunction('ACCRINTM', ACCRINTM).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ACCRINT', ACCRINT).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'first_interest',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            'calc_method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('DISC', DISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'pr',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('INTRATE', INTRATE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('RECEIVED', RECEIVED).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICE', PRICE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'yld',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICEDISC', PRICEDISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    var MAX_IT = 300, EPS = 2.2204e-16, FP_MIN = 1e-30, f_abs = Math.abs;\n    function ERF(x) {\n        if (f_abs(x) >= 3.3) {\n            return 1 - ERFC(x);\n        }\n        var S = x > 0 ? 1 : -1;\n        if (S == -1) {\n            x = -x;\n        }\n        var m = 0, an = 1;\n        for (var n = 1; n < 100; n++) {\n            m += an;\n            an *= 2 * x * x / (2 * n + 1);\n        }\n        return S * 2 / Math.sqrt(Math.PI) * x * Math.exp(-x * x) * m;\n    }\n    function ERFC(x) {\n        if (f_abs(x) < 3.3) {\n            return 1 - ERF(x);\n        }\n        var s = 1;\n        if (x < 0) {\n            s = -1;\n            x = -x;\n        }\n        var frac = x;\n        for (var n = 8; n >= 1; n -= 0.5) {\n            frac = x + n / frac;\n        }\n        frac = 1 / (x + frac);\n        return s == 1 ? Math.exp(-x * x) / Math.sqrt(Math.PI) * frac : 2 - Math.exp(-x * x) / Math.sqrt(Math.PI) * frac;\n    }\n    function GAMMALN(x) {\n        var cof = [\n            1.000000000190015,\n            76.18009172947146,\n            -86.50532032941678,\n            24.01409824083091,\n            -1.231739572450155,\n            0.001208650973866179,\n            -0.000005395239384953\n        ];\n        var y = x, tmp = x + 5.5, ser = cof[0];\n        tmp -= (x + 0.5) * Math.log(tmp);\n        for (var j = 1; j <= 6; j++) {\n            y += 1;\n            ser += cof[j] / y;\n        }\n        return -tmp + Math.log(Math.sqrt(2 * Math.PI) * ser / x);\n    }\n    function GAMMA(x) {\n        if (x > 0) {\n            return Math.exp(GAMMALN(x));\n        }\n        var pi = Math.PI, y = -x;\n        return -pi / (y * GAMMA(y) * Math.sin(pi * y));\n    }\n    function BETALN(a, b) {\n        return GAMMALN(a) + GAMMALN(b) - GAMMALN(a + b);\n    }\n    function BETA(a, b) {\n        return Math.exp(BETALN(a, b));\n    }\n    function gamma_inc(a, x) {\n        return x < a + 1 ? g_series(a, x) : 1 - g_contfrac(a, x);\n    }\n    function g_series(a, x) {\n        var sum = 1 / a, frac = sum, ap = a;\n        var gln = GAMMALN(a), n;\n        for (n = 1; n <= MAX_IT; n++) {\n            ap++;\n            frac *= x / ap;\n            sum += frac;\n            if (f_abs(frac) < f_abs(sum) * EPS) {\n                break;\n            }\n        }\n        return sum * Math.exp(-x + a * Math.log(x) - gln);\n    }\n    function g_contfrac(a, x) {\n        var f = FP_MIN, c = f, d = 0, aj = 1, bj = x + 1 - a;\n        var gln = GAMMALN(a);\n        for (var i = 1; i <= MAX_IT; i++) {\n            d = bj + aj * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = bj + aj / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            var delta = c * d;\n            f *= delta;\n            if (f_abs(delta - 1) < EPS) {\n                break;\n            }\n            bj += 2;\n            aj = -i * (i - a);\n        }\n        return f * Math.exp(-x - gln + a * Math.log(x));\n    }\n    function GAMMA_DIST(x, a, b, cumulative) {\n        if (!cumulative) {\n            return Math.pow(x / b, a - 1) * Math.exp(-x / b) / (b * GAMMA(a));\n        }\n        return gamma_inc(a, x / b);\n    }\n    function GAMMA_INV(p, a, b) {\n        if (p === 0) {\n            return 0;\n        }\n        if (p == 1) {\n            return Infinity;\n        }\n        var m = 0, M = 10, x = 0, ab = a * b;\n        if (ab > 1) {\n            M *= ab;\n        }\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = GAMMA_DIST(x, a, b, true);\n            if (f_abs(p - q) < 1e-16) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function NORM_S_DIST(x, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-x * x / 2) / Math.sqrt(2 * Math.PI);\n        }\n        return 0.5 + 0.5 * ERF(x / Math.sqrt(2));\n    }\n    function NORM_S_INV(p) {\n        var a = [\n                -39.69683028665376,\n                220.9460984245205,\n                -275.9285104469687,\n                138.357751867269,\n                -30.66479806614716,\n                2.506628277459239\n            ], b = [\n                -54.47609879822406,\n                161.5858368580409,\n                -155.6989798598866,\n                66.80131188771972,\n                -13.28068155288572\n            ], c = [\n                -0.007784894002430293,\n                -0.3223964580411365,\n                -2.400758277161838,\n                -2.549732539343734,\n                4.374664141464968,\n                2.938163982698783\n            ], d = [\n                0.007784695709041462,\n                0.3224671290700398,\n                2.445134137142996,\n                3.754408661907416\n            ];\n        var plow = 0.02425, phigh = 1 - plow;\n        var q, r;\n        if (p < plow) {\n            q = Math.sqrt(-2 * Math.log(p));\n            return (((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        if (phigh < p) {\n            q = Math.sqrt(-2 * Math.log(1 - p));\n            return -(((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        q = p - 0.5;\n        r = q * q;\n        return (((((a[0] * r + a[1]) * r + a[2]) * r + a[3]) * r + a[4]) * r + a[5]) * q / (((((b[0] * r + b[1]) * r + b[2]) * r + b[3]) * r + b[4]) * r + 1);\n    }\n    function NORM_DIST(x, m, s, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-(x - m) * (x - m) / (2 * s * s)) / (s * Math.sqrt(2 * Math.PI));\n        }\n        return NORM_S_DIST((x - m) / s, true);\n    }\n    function NORM_INV(p, m, s) {\n        return m + s * NORM_S_INV(p);\n    }\n    function betastd_pdf(x, a, b) {\n        return Math.exp((a - 1) * Math.log(x) + (b - 1) * Math.log(1 - x) - BETALN(a, b));\n    }\n    function betastd_cdf(x, a, b) {\n        var k = Math.exp(a * Math.log(x) + b * Math.log(1 - x) - BETALN(a, b));\n        return x < (a + 1) / (a + b + 2) ? k * beta_lentz(a, b, x) / a : 1 - k * beta_lentz(b, a, 1 - x) / b;\n    }\n    function beta_lentz(a, b, x) {\n        var m, m2;\n        var aa, c, d, del, h, qab, qam, qap;\n        qab = a + b;\n        qap = a + 1;\n        qam = a - 1;\n        c = 1;\n        d = 1 - qab * x / qap;\n        if (f_abs(d) < FP_MIN) {\n            d = FP_MIN;\n        }\n        d = 1 / d;\n        h = d;\n        for (m = 1; m <= MAX_IT; m++) {\n            m2 = 2 * m;\n            aa = m * (b - m) * x / ((qam + m2) * (a + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            h *= d * c;\n            aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            del = d * c;\n            h *= del;\n            if (f_abs(del - 1) < EPS) {\n                break;\n            }\n        }\n        return h;\n    }\n    function betastd_inv(p, a, b) {\n        var m = 0, M = 1, x = 0;\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = betastd_cdf(x, a, b);\n            if (f_abs(p - q) < EPS) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function BETADIST(x, a, b, m, M) {\n        return betastd_cdf((x - m) / (M - m), a, b);\n    }\n    function BETA_DIST(x, a, b, cdf, m, M) {\n        if (cdf) {\n            return betastd_cdf((x - m) / (M - m), a, b);\n        }\n        return betastd_pdf((x - m) / (M - m), a, b) / (M - m);\n    }\n    function BETA_INV(p, a, b, m, M) {\n        return m + (M - m) * betastd_inv(p, a, b);\n    }\n    function chisq_left(x, n, cds) {\n        return GAMMA_DIST(x, n / 2, 2, cds);\n    }\n    function chisq_right(x, n) {\n        return 1 - chisq_left(x, n, true);\n    }\n    function chisq_left_inv(p, n) {\n        return GAMMA_INV(p, n / 2, 2);\n    }\n    function chisq_right_inv(p, n) {\n        return chisq_left_inv(1 - p, n);\n    }\n    function chisq_test(obsv, expect) {\n        var rows = obsv.length, cols = obsv[0].length;\n        var x = 0, i, j;\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                var eij = expect[i][j];\n                var delta = obsv[i][j] - eij;\n                delta *= delta;\n                x += delta / eij;\n            }\n        }\n        var n = (rows - 1) * (cols - 1);\n        return chisq_right(x, n);\n    }\n    function expon(x, r, cdf) {\n        if (cdf) {\n            return 1 - Math.exp(-r * x);\n        }\n        return r * Math.exp(-r * x);\n    }\n    function poisson(k, m, cdf) {\n        if (cdf) {\n            return 1 - chisq_left(2 * m, 2 * (k + 1), true);\n        }\n        var lnf = 0;\n        for (var i = 2; i <= k; i++) {\n            lnf += Math.log(i);\n        }\n        return Math.exp(k * Math.log(m) - m - lnf);\n    }\n    function Fdist(x, n, d, cdf) {\n        if (cdf) {\n            return betastd_cdf(n * x / (d + n * x), n / 2, d / 2);\n        }\n        var u = n / d;\n        n /= 2;\n        d /= 2;\n        return u / BETA(n, d) * Math.pow(u * x, n - 1) / Math.pow(1 + u * x, n + d);\n    }\n    function Fdist_right(x, n, d) {\n        return 1 - Fdist(x, n, d, true);\n    }\n    function Finv_right(p, n, d) {\n        return d / n * (1 / BETA_INV(p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function Finv(p, n, d) {\n        return d / n * (1 / BETA_INV(1 - p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function _mean(arr) {\n        var me = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            me += arr[i];\n        }\n        return me / n;\n    }\n    function _var_sq(arr, m) {\n        var v = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            var delta = arr[i] - m;\n            v += delta * delta;\n        }\n        return v / (n - 1);\n    }\n    function Ftest(arr1, arr2) {\n        var n1 = arr1.length - 1, n2 = arr2.length - 1;\n        var va1 = _var_sq(arr1, _mean(arr1)), va2 = _var_sq(arr2, _mean(arr2));\n        if (!va1 || !va2) {\n            throw new CalcError('DIV/0');\n        }\n        return 2 * Fdist(va1 / va2, n1, n2, true);\n    }\n    function fisher(x) {\n        return 0.5 * Math.log((1 + x) / (1 - x));\n    }\n    function fisherinv(x) {\n        var e2 = Math.exp(2 * x);\n        return (e2 - 1) / (e2 + 1);\n    }\n    function Tdist(x, n, cdf) {\n        if (cdf) {\n            return 1 - 0.5 * betastd_cdf(n / (x * x + n), n / 2, 0.5);\n        }\n        return 1 / (Math.sqrt(n) * BETA(0.5, n / 2)) * Math.pow(1 + x * x / n, -(n + 1) / 2);\n    }\n    function Tdist_right(x, n) {\n        return 1 - Tdist(x, n, true);\n    }\n    function Tdist_2tail(x, n) {\n        if (x < 0) {\n            x = -x;\n        }\n        return 2 * Tdist_right(x, n);\n    }\n    function Tdist_inv(p, n) {\n        var x = betastd_inv(2 * Math.min(p, 1 - p), n / 2, 0.5);\n        x = Math.sqrt(n * (1 - x) / x);\n        return p > 0.5 ? x : -x;\n    }\n    function Tdist_2tail_inv(p, n) {\n        return Tdist_inv(1 - p / 2, n);\n    }\n    function Tdist_test(gr1, gr2, tail, type) {\n        var n1 = gr1.length, n2 = gr2.length;\n        var t_st, df;\n        if (type == 1) {\n            var d = 0, d2 = 0;\n            for (var i = 0; i < n1; i++) {\n                var delta = gr1[i] - gr2[i];\n                d += delta;\n                d2 += delta * delta;\n            }\n            var md = d / n1;\n            t_st = md / Math.sqrt((d2 - d * md) / (n1 * (n1 - 1)));\n            return tail == 1 ? Tdist_right(t_st, n1 - 1) : Tdist_2tail(t_st, n1 - 1);\n        }\n        var m1 = _mean(gr1), m2 = _mean(gr2), v1 = _var_sq(gr1, m1), v2 = _var_sq(gr2, m2);\n        if (type == 3) {\n            var u1 = v1 / n1, u2 = v2 / n2, u = u1 + u2;\n            var q1 = u1 / u, q2 = u2 / u;\n            df = 1 / (q1 * q1 / (n1 - 1) + q2 * q2 / (n2 - 1));\n            t_st = f_abs(m1 - m2) / Math.sqrt(u);\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        } else {\n            df = n1 + n2 - 2;\n            t_st = f_abs(m1 - m2) * Math.sqrt(df * n1 * n2 / ((n1 + n2) * ((n1 - 1) * v1 + (n2 - 1) * v2)));\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        }\n    }\n    function confidence_t(alpha, stddev, size) {\n        return -Tdist_inv(alpha / 2, size - 1) * stddev / Math.sqrt(size);\n    }\n    function confidence_norm(alpha, stddev, size) {\n        return -NORM_S_INV(alpha / 2) * stddev / Math.sqrt(size);\n    }\n    function gauss(z) {\n        return NORM_S_DIST(z, true) - 0.5;\n    }\n    function phi(x) {\n        return NORM_S_DIST(x);\n    }\n    function lognorm_dist(x, m, s, cumulative) {\n        if (cumulative) {\n            return 0.5 + 0.5 * ERF((Math.log(x) - m) / (s * Math.sqrt(2)));\n        }\n        var t = Math.log(x) - m;\n        return Math.exp(-t * t / (2 * s * s)) / (x * s * Math.sqrt(2 * Math.PI));\n    }\n    function lognorm_inv(p, m, s) {\n        return Math.exp(NORM_INV(p, m, s));\n    }\n    function prob(x_, p_, lw, up) {\n        var n = x_.length;\n        var s = 0, i;\n        for (i = 0; i < n; i++) {\n            if (p_[i] <= 0 || p_[i] > 1) {\n                throw new CalcError('NUM');\n            }\n            s += p_[i];\n        }\n        if (s != 1) {\n            throw new CalcError('NUM');\n        }\n        var res = 0;\n        for (i = 0; i < n; i++) {\n            var x = x_[i];\n            if (x >= lw && x <= up) {\n                res += p_[i];\n            }\n        }\n        return res;\n    }\n    function slope(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_), b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return b1 / b2;\n    }\n    function intercept(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return my - b1 * mx / b2;\n    }\n    function pearson(x_, y_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n            s3 += t2 * t2;\n        }\n        return s1 / Math.sqrt(s2 * s3);\n    }\n    function rsq(x_, y_) {\n        var r = pearson(x_, y_);\n        return r * r;\n    }\n    function steyx(y_, x_) {\n        var n = x_.length;\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t2 * t2;\n            s2 += t1 * t2;\n            s3 += t1 * t1;\n        }\n        return Math.sqrt((s1 - s2 * s2 / s3) / (n - 2));\n    }\n    function forecast(x, y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (s2 === 0) {\n            throw new CalcError('N/A');\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return a + b * x;\n    }\n    function _mat_mean(Mat) {\n        var n = Mat.height, sum = 0;\n        for (var i = 0; i < n; i++) {\n            sum += Mat.data[i][0];\n        }\n        return sum / n;\n    }\n    function _mat_devsq(Mat, mean) {\n        var n = Mat.height, sq = 0;\n        for (var i = 0; i < n; i++) {\n            var x = Mat.data[i][0] - mean;\n            sq += x * x;\n        }\n        return sq;\n    }\n    function linest(Y, X, konst, stats) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        var line_1 = [];\n        for (i = B.height - 1; i >= 0; i--) {\n            line_1.push(B.data[i][0]);\n        }\n        if (!konst) {\n            line_1.push(0);\n        }\n        if (!stats) {\n            return this.asMatrix([line_1]);\n        }\n        var Y1 = X.multiply(B);\n        var y_y1 = Y.adds(Y1, true);\n        var mp = !konst ? 0 : _mat_mean(Y1);\n        var SSreg = _mat_devsq(Y1, mp);\n        var me = !konst ? 0 : _mat_mean(y_y1);\n        var SSresid = _mat_devsq(y_y1, me);\n        var line_5 = [];\n        line_5.push(SSreg, SSresid);\n        var R2 = SSreg / (SSreg + SSresid);\n        var degfre = Y.height - X.width;\n        var err_est = Math.sqrt(SSresid / degfre);\n        var line_3 = [];\n        line_3.push(R2, err_est);\n        var F_sta = !konst ? R2 / X.width / ((1 - R2) / degfre) : SSreg / (X.width - 1) / (SSresid / degfre);\n        var line_4 = [];\n        line_4.push(F_sta, degfre);\n        var SCP = Xt.multiply(X).inverse();\n        var line_2 = [];\n        for (i = SCP.height - 1; i >= 0; i--) {\n            line_2.push(Math.sqrt(SCP.data[i][i] * SSresid / degfre));\n        }\n        return this.asMatrix([\n            line_1,\n            line_2,\n            line_3,\n            line_4,\n            line_5\n        ]);\n    }\n    function logest(Y, X, konst, stats) {\n        return linest.call(this, Y.map(Math.log), X, konst, stats).map(Math.exp);\n    }\n    function trend(Y, X, W, konst) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        if (!W) {\n            W = X;\n        } else {\n            if (konst) {\n                W = W.clone();\n                W.eachRow(function (row) {\n                    W.data[row].unshift(1);\n                });\n                ++W.width;\n            }\n        }\n        return W.multiply(B);\n    }\n    function growth(Y, X, new_X, konst) {\n        return trend.call(this, Y.map(Math.log), X, new_X, konst).map(Math.exp);\n    }\n    function root_newton(func, guess, max_it, eps) {\n        var MAX_IT = max_it || 20, EPS = eps || 1e-7;\n        var root = guess;\n        for (var j = 1; j <= MAX_IT; j++) {\n            var f_d = func(root), f = f_d[0], df = f_d[1];\n            var dx = f / df;\n            root -= dx;\n            if (Math.abs(dx) < EPS) {\n                return root;\n            }\n        }\n        return new CalcError('NUM');\n    }\n    function FV(rate, nper, pmt, pv, type) {\n        var h1 = Math.pow(1 + rate, nper);\n        var h2 = rate ? (h1 - 1) / rate : nper;\n        return -(pv * h1 + pmt * h2 * (1 + rate * type));\n    }\n    function PV(rate, nper, pmt, fv, type) {\n        if (!rate) {\n            return -fv - pmt * nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -(fv + pmt * (h1 - 1) / rate * (1 + rate * type)) / h1;\n    }\n    function PMT(rate, nper, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -rate * (fv + pv * h1) / ((1 + rate * type) * (h1 - 1));\n    }\n    function NPER(rate, pmt, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / pmt;\n        }\n        var h1 = pmt * (1 + rate * type);\n        return Math.log((h1 - fv * rate) / (h1 + pv * rate)) / Math.log(1 + rate);\n    }\n    function RATE(nper, pmt, pv, fv, type, guess) {\n        function xfd(x) {\n            var h2 = Math.pow(1 + x, nper - 1), h1 = h2 * (1 + x);\n            return [\n                pv * h1 + pmt * (1 / x + type) * (h1 - 1) + fv,\n                nper * pv * h2 + pmt * (-(h1 - 1) / (x * x) + (1 / x + type) * nper * h2)\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function IPMT(rate, per, nper, pv, fv, type) {\n        if (type == 1 && per == 1) {\n            return 0;\n        }\n        var pmt = PMT(rate, nper, pv, fv, type);\n        var ipmt = FV(rate, per - 1, pmt, pv, type) * rate;\n        return type ? ipmt / (1 + rate) : ipmt;\n    }\n    function PPMT(rate, per, nper, pv, fv, type) {\n        var pmt = PMT(rate, nper, pv, fv, type);\n        return pmt - IPMT(rate, per, nper, pv, fv, type);\n    }\n    function CUMPRINC(rate, nper, pv, start, end, type) {\n        if (type == 1) {\n            start--;\n            end--;\n        }\n        var tn = Math.pow(1 + rate, nper), ts = Math.pow(1 + rate, start - 1), te = Math.pow(1 + rate, end);\n        var monthlyPayment = rate * pv * tn / (tn - 1);\n        var remainingBalanceAtStart = ts * pv - (ts - 1) / rate * monthlyPayment;\n        var remainingBalanceAtEnd = te * pv - (te - 1) / rate * monthlyPayment;\n        return remainingBalanceAtEnd - remainingBalanceAtStart;\n    }\n    function CUMIPMT(rate, nper, pv, start, end, type) {\n        var cip = 0;\n        for (var i = start; i <= end; i++) {\n            cip += IPMT(rate, i, nper, pv, 0, type);\n        }\n        return cip;\n    }\n    function NPV(rate, flows) {\n        var npv = 0;\n        for (var i = 0, n = flows.length; i < n; i++) {\n            npv += flows[i] * Math.pow(1 + rate, -i - 1);\n        }\n        return npv;\n    }\n    function IRR(flows, guess) {\n        function xfd(x) {\n            var npv = 0, npv1 = 0;\n            for (var j = 0, n = flows.length; j < n; j++) {\n                npv += flows[j] * Math.pow(1 + x, -j - 1);\n                npv1 += -j * flows[j] * Math.pow(1 + x, -j - 2);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function EFFECT(nominal_rate, npery) {\n        return Math.pow(1 + nominal_rate / npery, npery) - 1;\n    }\n    function NOMINAL(effect_rate, npery) {\n        return npery * (Math.pow(effect_rate + 1, 1 / npery) - 1);\n    }\n    function XNPV(rate, values, dates) {\n        var npv = 0;\n        for (var i = 0, n = values.length; i < n; i++) {\n            npv += values[i] * Math.pow(1 + rate, (dates[0] - dates[i]) / 365);\n        }\n        return npv;\n    }\n    function XIRR(values, dates, guess) {\n        function xfd(x) {\n            var npv = values[0], npv1 = 0;\n            for (var j = 1, n = values.length; j < n; j++) {\n                var delta = (dates[0] - dates[j]) / 365;\n                npv += values[j] * Math.pow(1 + x, delta);\n                npv1 += delta * values[j] * Math.pow(1 + x, delta - 1);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function ISPMT(rate, per, nper, pv) {\n        var tmp = -pv * rate;\n        return tmp * (1 - per / nper);\n    }\n    function DB(cost, salvage, life, period, month) {\n        var rate = 1 - Math.pow(salvage / cost, 1 / life);\n        rate = Math.floor(rate * 1000 + 0.5) / 1000;\n        var db = cost * rate * month / 12;\n        if (period == 1) {\n            return db;\n        }\n        for (var i = 1; i < life; i++) {\n            if (i == period - 1) {\n                return (cost - db) * rate;\n            }\n            db += (cost - db) * rate;\n        }\n        return (cost - db) * rate * (12 - month) / 12;\n    }\n    function DDB(cost, salvage, life, period, factor) {\n        var f = factor / life;\n        var prior = -cost * (Math.pow(1 - f, period - 1) - 1);\n        var dep = (cost - prior) * f;\n        dep = Math.min(dep, Math.max(0, cost - prior - salvage));\n        return dep;\n    }\n    function SLN(cost, salvage, life) {\n        return (cost - salvage) / life;\n    }\n    function SYD(cost, salvage, life, per) {\n        return (cost - salvage) * (life - per + 1) * 2 / (life * (life + 1));\n    }\n    function VDB(cost, salvage, life, start, end, factor, no_switch) {\n        var interest = factor >= life ? 1 : factor / life;\n        function _getGDA(value, period) {\n            var gda, oldValue, newValue;\n            if (interest == 1) {\n                oldValue = period == 1 ? value : 0;\n            } else {\n                oldValue = value * Math.pow(1 - interest, period - 1);\n            }\n            newValue = value * Math.pow(1 - interest, period);\n            gda = newValue < salvage ? oldValue - salvage : oldValue - newValue;\n            return gda < 0 ? 0 : gda;\n        }\n        function _interVDB(cost, life1, period) {\n            var remValue = cost - salvage;\n            var intEnd = Math.ceil(period);\n            var term, lia = 0, vdb = 0, nowLia = false;\n            for (var i = 1; i <= intEnd; i++) {\n                if (!nowLia) {\n                    var gda = _getGDA(cost, i);\n                    lia = remValue / (life1 - i + 1);\n                    if (lia > gda) {\n                        term = lia;\n                        nowLia = true;\n                    } else {\n                        term = gda;\n                        remValue -= gda;\n                    }\n                } else {\n                    term = lia;\n                }\n                if (i == intEnd) {\n                    term *= period + 1 - intEnd;\n                }\n                vdb += term;\n            }\n            return vdb;\n        }\n        var intStart = Math.floor(start), intEnd = Math.ceil(end);\n        var vdb = 0;\n        if (no_switch) {\n            for (var i = intStart + 1; i <= intEnd; i++) {\n                var term = _getGDA(cost, i);\n                if (i == intStart + 1) {\n                    term *= Math.min(end, intStart + 1) - start;\n                } else {\n                    if (i == intEnd) {\n                        term *= end + 1 - intEnd;\n                    }\n                }\n                vdb += term;\n            }\n        } else {\n            var life1 = life;\n            if (start != Math.floor(start)) {\n                if (factor > 1) {\n                    if (start >= life / 2) {\n                        var part = start - life / 2;\n                        start = life / 2;\n                        end -= part;\n                        life1 += 1;\n                    }\n                }\n            }\n            cost -= _interVDB(cost, life1, start);\n            vdb = _interVDB(cost, life - start, end - start);\n        }\n        return vdb;\n    }\n    function _edate(base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }\n    function _daysBetween(from, to, basis) {\n        if (basis == 1 || basis == 2 || basis == 3) {\n            return to - from;\n        }\n        return _days_360(from, to, basis);\n    }\n    function _borderCoupons(settlement, maturity, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(maturity);\n        var periods = base.year - sett.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev, next, months = 12 / freq;\n        do {\n            periods++;\n            prev = _edate(maturity, -periods * months);\n        } while (settlement < prev);\n        periods--;\n        next = _edate(maturity, -periods * months);\n        return [\n            prev,\n            next\n        ];\n    }\n    function _borderCoupons_fw(first, settlement, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(first);\n        var periods = sett.year - base.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev = first, next, months = 12 / freq;\n        while (settlement > prev) {\n            next = prev;\n            periods++;\n            prev = _edate(first, periods * months);\n        }\n        return [\n            next,\n            prev\n        ];\n    }\n    function COUPDAYBS(settlement, maturity, frequency, basis) {\n        var prev = _borderCoupons(settlement, maturity, frequency)[0];\n        return _daysBetween(prev, settlement, basis);\n    }\n    function COUPDAYS(settl, matur, freq, basis) {\n        if (basis == 1) {\n            var borders = _borderCoupons(settl, matur, freq);\n            return _daysBetween(borders[0], borders[1], 1);\n        }\n        if (basis == 3) {\n            return 365 / freq;\n        }\n        return 360 / freq;\n    }\n    function COUPDAYSNC(settl, matur, freq, basis) {\n        var next = _borderCoupons(settl, matur, freq)[1];\n        return _daysBetween(settl, next, basis);\n    }\n    function COUPPCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[0];\n    }\n    function COUPNCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[1];\n    }\n    function COUPNUM(settl, matur, freq) {\n        var sett = unpackDate(settl), mat = unpackDate(matur);\n        var months = 12 * (mat.year - sett.year) + mat.month - sett.month;\n        return 1 + (months * freq / 12 | 0);\n    }\n    function daysInYear(yr, basis) {\n        if (basis == 3) {\n            return 365;\n        }\n        if (basis == 1) {\n            return isLeapYear(yr) ? 366 : 365;\n        }\n        return 360;\n    }\n    function ACCRINTM(issue, maturity, rate, par, basis) {\n        var year_days = daysInYear(unpackDate(maturity).year, basis);\n        return rate * par * _daysBetween(issue, maturity, basis) / year_days;\n    }\n    function ACCRINT(issue, first, settl, rate, par, freq, basis, calc) {\n        var accr = 0, cost = par * rate / freq;\n        var brace, prev, next, prev1, next1, nrc;\n        var annual = basis % 2 === 0 ? 360 : 365;\n        function _numCoupons(from, to) {\n            return (to - from) * freq / annual | 0;\n        }\n        if (settl <= first) {\n            brace = _borderCoupons(settl, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            if (prev <= issue) {\n                return cost * _daysBetween(issue, settl, basis) / _daysBetween(prev, next, basis);\n            }\n            brace = _borderCoupons(issue, prev, freq);\n            prev1 = brace[0];\n            next1 = brace[1];\n            nrc = _numCoupons(next1, settl);\n            return cost * (nrc + _daysBetween(issue, next1, basis) / _daysBetween(prev1, next1, basis) + (settl < next ? _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis) : 0));\n        } else {\n            brace = _borderCoupons_fw(first, settl, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(first, settl);\n            if (next == settl) {\n                accr = cost * nrc;\n            } else {\n                accr = cost * (nrc + _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis));\n            }\n            if (!calc) {\n                return accr;\n            }\n            brace = _borderCoupons(issue, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(issue, first);\n            accr += cost * (nrc + _daysBetween(issue, next, basis) / _daysBetween(prev, next, basis));\n            return accr;\n        }\n    }\n    function DISC(settl, matur, pr, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - pr) / redemption * annual / _daysBetween(settl, matur, basis);\n    }\n    function INTRATE(settl, matur, investment, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - investment) / investment * annual / _daysBetween(settl, matur, basis);\n    }\n    function RECEIVED(settl, matur, investment, discount, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return investment / (1 - discount * _daysBetween(settl, matur, basis) / annual);\n    }\n    function PRICE(settl, matur, rate, yld, redemption, freq, basis) {\n        var N = 1 + ((matur - settl) * freq / (basis % 2 === 0 ? 360 : 365) | 0);\n        var brace = _borderCoupons(settl, matur, freq), prev = brace[0], next = brace[1];\n        var beg_settl = _daysBetween(prev, settl, basis), settl_end = _daysBetween(settl, next, basis), beg_end = _daysBetween(prev, next, basis);\n        var den = 100 * rate / freq, yf = yld / freq, frac = settl_end / beg_end;\n        if (N == 1) {\n            return (redemption + den) / (1 + frac * yf) - beg_settl / beg_end * den;\n        }\n        return redemption / Math.pow(1 + yf, N - 1 + frac) + den * Math.pow(1 + yf, 1 - N - frac) * (Math.pow(1 + yf, N) - 1) / yf - beg_settl / beg_end * den;\n    }\n    function PRICEDISC(settl, matur, discount, redemption, basis) {\n        var dsm = _daysBetween(settl, matur, basis), dy = daysInYear(unpackDate(matur).year, basis);\n        return redemption - discount * redemption * dsm / dy;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/borderpalette', [\n        'kendo.core',\n        'kendo.colorpicker',\n        'kendo.popup'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var BORDER_TYPES = [\n            'allBorders',\n            'insideBorders',\n            'insideHorizontalBorders',\n            'insideVerticalBorders',\n            'outsideBorders',\n            'leftBorder',\n            'topBorder',\n            'rightBorder',\n            'bottomBorder',\n            'noBorders'\n        ];\n        var BORDER_PALETTE_MESSAGES = kendo.spreadsheet.messages.borderPalette = {\n            allBorders: 'All borders',\n            insideBorders: 'Inside borders',\n            insideHorizontalBorders: 'Inside horizontal borders',\n            insideVerticalBorders: 'Inside vertical borders',\n            outsideBorders: 'Outside borders',\n            leftBorder: 'Left border',\n            topBorder: 'Top border',\n            rightBorder: 'Right border',\n            bottomBorder: 'Bottom border',\n            noBorders: 'No border',\n            reset: 'Reset color',\n            customColor: 'Custom color...',\n            apply: 'Apply',\n            cancel: 'Cancel'\n        };\n        function withPreventDefault(f) {\n            return function (e) {\n                e.preventDefault();\n                return f.apply(this, arguments);\n            };\n        }\n        var ColorChooser = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = options.color;\n                this._resetButton();\n                this._colorPalette();\n                this._customColorPalette();\n                this._customColorButton();\n                this.resetButton.on('click', withPreventDefault(this.resetColor.bind(this)));\n                this.customColorButton.on('click', withPreventDefault(this.customColor.bind(this)));\n            },\n            options: { name: 'ColorChooser' },\n            events: ['change'],\n            destroy: function () {\n                kendo.unbind(this.dialog.element.find('.k-action-buttons'));\n                this.dialog.destroy();\n                this.colorPalette.destroy();\n                this.resetButton.off('click');\n                this.customColorButton.off('click');\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.color = value;\n                    this.customColorButton.find('.k-icon').css('background-color', this.color);\n                    this.colorPalette.value(null);\n                    this.flatColorPicker.value(this.color);\n                } else {\n                    return this.color;\n                }\n            },\n            _change: function (value) {\n                this.color = value;\n                this.trigger('change', { value: value });\n            },\n            _colorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-color-palette' });\n                var colorPalette = this.colorPalette = $('<div />').kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    value: this.color,\n                    change: function (e) {\n                        this.customColorButton.find('.k-icon').css('background-color', 'transparent');\n                        this.flatColorPicker.value(null);\n                        this._change(e.value);\n                    }.bind(this)\n                }).data('kendoColorPalette');\n                element.append(colorPalette.wrapper).appendTo(this.element);\n            },\n            _customColorPalette: function () {\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-window',\n                    'html': '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + BORDER_PALETTE_MESSAGES.apply + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + BORDER_PALETTE_MESSAGES.cancel + '</button>' + '</div>'\n                });\n                var dialog = this.dialog = element.appendTo(document.body).kendoWindow({\n                    animation: false,\n                    scrollable: false,\n                    resizable: false,\n                    maximizable: false,\n                    modal: true,\n                    visible: false,\n                    width: 268,\n                    open: function () {\n                        this.center();\n                    }\n                }).data('kendoWindow');\n                dialog.one('activate', function () {\n                    this.element.find('[data-role=flatcolorpicker]').data('kendoFlatColorPicker')._hueSlider.resize();\n                });\n                var flatColorPicker = this.flatColorPicker = dialog.element.children().first().kendoFlatColorPicker().data('kendoFlatColorPicker');\n                var viewModel = kendo.observable({\n                    apply: function () {\n                        this.customColorButton.find('.k-icon').css('background-color', flatColorPicker.value());\n                        this.colorPalette.value(null);\n                        this._change(flatColorPicker.value());\n                        dialog.close();\n                    }.bind(this),\n                    close: function () {\n                        flatColorPicker.value(null);\n                        dialog.close();\n                    }\n                });\n                kendo.bind(dialog.element.find('.k-action-buttons'), viewModel);\n            },\n            _resetButton: function () {\n                this.resetButton = $('<a class=\\'k-button k-reset-color\\' href=\\'#\\'>' + '<span class=\\'k-icon k-i-reset-color\\'></span>' + BORDER_PALETTE_MESSAGES.reset + '</a>').appendTo(this.element);\n            },\n            _customColorButton: function () {\n                this.customColorButton = $('<a class=\\'k-button k-custom-color\\' href=\\'#\\'>' + '<span class=\\'k-icon\\'></span>' + BORDER_PALETTE_MESSAGES.customColor + '</a>').appendTo(this.element);\n            },\n            resetColor: function () {\n                this.colorPalette.value(null);\n                this.flatColorPicker.value(null);\n                this._change(null);\n            },\n            customColor: function () {\n                this.dialog.open();\n            }\n        });\n        var BorderPalette = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = '#000';\n                this.element.addClass('k-spreadsheet-border-palette');\n                this._borderTypePalette();\n                this._borderColorPalette();\n                this.element.on('click', '.k-spreadsheet-border-type-palette .k-button', withPreventDefault(this._click.bind(this)));\n            },\n            options: { name: 'BorderPalette' },\n            events: ['change'],\n            destroy: function () {\n                this.colorChooser.destroy();\n                this.element.off('click');\n            },\n            _borderTypePalette: function () {\n                var messages = BORDER_PALETTE_MESSAGES;\n                var buttons = BORDER_TYPES.map(function (type) {\n                    return '<a title=\"' + messages[type] + '\" href=\"#\" data-border-type=\"' + type + '\" class=\"k-button k-button-icon\">' + '<span class=\"k-icon k-i-' + kendo.toHyphens(type) + '\"></span>' + '</a>';\n                }).join('');\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-border-type-palette',\n                    'html': buttons\n                });\n                element.appendTo(this.element);\n            },\n            _borderColorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-border-color-palette' });\n                element.appendTo(this.element);\n                this.colorChooser = new ColorChooser(element, {\n                    color: this.color,\n                    change: this._colorChange.bind(this)\n                });\n            },\n            _click: function (e) {\n                this.type = $(e.currentTarget).data('borderType');\n                this.trigger('change', {\n                    type: this.type,\n                    color: this.color\n                });\n            },\n            _colorChange: function (e) {\n                this.color = e.value;\n                if (this.type) {\n                    this.trigger('change', {\n                        type: this.type,\n                        color: this.color\n                    });\n                }\n            }\n        });\n        kendo.spreadsheet.ColorChooser = ColorChooser;\n        kendo.spreadsheet.BorderPalette = BorderPalette;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/toolbar', [\n        'kendo.toolbar',\n        'kendo.colorpicker',\n        'kendo.combobox',\n        'kendo.dropdownlist',\n        'kendo.popup',\n        'spreadsheet/borderpalette'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ToolBar = kendo.ui.ToolBar;\n        var MESSAGES = kendo.spreadsheet.messages.toolbar = {\n            addColumnLeft: 'Add column left',\n            addColumnRight: 'Add column right',\n            addRowAbove: 'Add row above',\n            addRowBelow: 'Add row below',\n            alignment: 'Alignment',\n            alignmentButtons: {\n                justtifyLeft: 'Align left',\n                justifyCenter: 'Center',\n                justifyRight: 'Align right',\n                justifyFull: 'Justify',\n                alignTop: 'Align top',\n                alignMiddle: 'Align middle',\n                alignBottom: 'Align bottom'\n            },\n            backgroundColor: 'Background',\n            bold: 'Bold',\n            borders: 'Borders',\n            colorPicker: {\n                reset: 'Reset color',\n                customColor: 'Custom color...'\n            },\n            copy: 'Copy',\n            cut: 'Cut',\n            deleteColumn: 'Delete column',\n            deleteRow: 'Delete row',\n            filter: 'Filter',\n            fontFamily: 'Font',\n            fontSize: 'Font size',\n            format: 'Custom format...',\n            formatTypes: {\n                automatic: 'Automatic',\n                number: 'Number',\n                percent: 'Percent',\n                financial: 'Financial',\n                currency: 'Currency',\n                date: 'Date',\n                time: 'Time',\n                dateTime: 'Date time',\n                duration: 'Duration',\n                moreFormats: 'More formats...'\n            },\n            formatDecreaseDecimal: 'Decrease decimal',\n            formatIncreaseDecimal: 'Increase decimal',\n            freeze: 'Freeze panes',\n            freezeButtons: {\n                freezePanes: 'Freeze panes',\n                freezeRows: 'Freeze rows',\n                freezeColumns: 'Freeze columns',\n                unfreeze: 'Unfreeze panes'\n            },\n            italic: 'Italic',\n            merge: 'Merge cells',\n            mergeButtons: {\n                mergeCells: 'Merge all',\n                mergeHorizontally: 'Merge horizontally',\n                mergeVertically: 'Merge vertically',\n                unmerge: 'Unmerge'\n            },\n            open: 'Open...',\n            paste: 'Paste',\n            quickAccess: {\n                redo: 'Redo',\n                undo: 'Undo'\n            },\n            exportAs: 'Export...',\n            toggleGridlines: 'Toggle gridlines',\n            sortAsc: 'Sort ascending',\n            sortDesc: 'Sort descending',\n            sortButtons: {\n                sortSheetAsc: 'Sort sheet A to Z',\n                sortSheetDesc: 'Sort sheet Z to A',\n                sortRangeAsc: 'Sort range A to Z',\n                sortRangeDesc: 'Sort range Z to A'\n            },\n            textColor: 'Text Color',\n            textWrap: 'Wrap text',\n            underline: 'Underline',\n            validation: 'Data validation...',\n            hyperlink: 'Link'\n        };\n        var defaultTools = {\n            home: [\n                'open',\n                'exportAs',\n                [\n                    'cut',\n                    'copy',\n                    'paste'\n                ],\n                [\n                    'bold',\n                    'italic',\n                    'underline'\n                ],\n                'hyperlink',\n                'backgroundColor',\n                'textColor',\n                'borders',\n                'fontSize',\n                'fontFamily',\n                'alignment',\n                'textWrap',\n                [\n                    'formatDecreaseDecimal',\n                    'formatIncreaseDecimal'\n                ],\n                'format',\n                'merge',\n                'freeze',\n                'filter',\n                'toggleGridlines'\n            ],\n            insert: [\n                [\n                    'addColumnLeft',\n                    'addColumnRight',\n                    'addRowBelow',\n                    'addRowAbove'\n                ],\n                [\n                    'deleteColumn',\n                    'deleteRow'\n                ]\n            ],\n            data: [\n                'sort',\n                'filter',\n                'validation'\n            ]\n        };\n        var toolDefaults = {\n            open: {\n                type: 'open',\n                overflow: 'never',\n                iconClass: 'file-excel'\n            },\n            exportAs: {\n                type: 'exportAsDialog',\n                dialogName: 'exportAs',\n                overflow: 'never',\n                text: '',\n                iconClass: 'file-excel'\n            },\n            bold: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'bold',\n                value: true,\n                iconClass: 'bold',\n                togglable: true\n            },\n            italic: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'italic',\n                value: true,\n                iconClass: 'italic',\n                togglable: true\n            },\n            underline: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'underline',\n                value: true,\n                iconClass: 'underline',\n                togglable: true\n            },\n            formatDecreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: -1,\n                iconClass: 'decimal-decrease'\n            },\n            formatIncreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: +1,\n                iconClass: 'decimal-increase'\n            },\n            textWrap: {\n                type: 'button',\n                command: 'TextWrapCommand',\n                property: 'wrap',\n                value: true,\n                iconClass: 'text-wrap',\n                togglable: true\n            },\n            cut: {\n                type: 'button',\n                command: 'ToolbarCutCommand',\n                iconClass: 'cut'\n            },\n            copy: {\n                type: 'button',\n                command: 'ToolbarCopyCommand',\n                iconClass: 'copy'\n            },\n            paste: {\n                type: 'button',\n                command: 'ToolbarPasteCommand',\n                iconClass: 'paste'\n            },\n            separator: { type: 'separator' },\n            alignment: {\n                type: 'alignment',\n                iconClass: 'align-left'\n            },\n            backgroundColor: {\n                type: 'colorPicker',\n                property: 'background',\n                iconClass: 'paint'\n            },\n            textColor: {\n                type: 'colorPicker',\n                property: 'color',\n                iconClass: 'foreground-color'\n            },\n            fontFamily: {\n                type: 'fontFamily',\n                property: 'fontFamily',\n                iconClass: 'font-family'\n            },\n            fontSize: {\n                type: 'fontSize',\n                property: 'fontSize',\n                iconClass: 'font-size'\n            },\n            format: {\n                type: 'format',\n                property: 'format',\n                iconClass: 'custom-format'\n            },\n            filter: {\n                type: 'filter',\n                property: 'hasFilter',\n                iconClass: 'filter'\n            },\n            merge: {\n                type: 'merge',\n                iconClass: 'cells-merge'\n            },\n            freeze: {\n                type: 'freeze',\n                iconClass: 'pane-freeze'\n            },\n            borders: {\n                type: 'borders',\n                iconClass: 'borders-all'\n            },\n            formatCells: {\n                type: 'dialog',\n                dialogName: 'formatCells',\n                overflow: 'never'\n            },\n            hyperlink: {\n                type: 'dialog',\n                dialogName: 'hyperlink',\n                iconClass: 'link-horizontal',\n                overflow: 'never',\n                text: ''\n            },\n            toggleGridlines: {\n                type: 'button',\n                command: 'GridLinesChangeCommand',\n                property: 'gridLines',\n                value: true,\n                iconClass: 'border-no',\n                togglable: true\n            },\n            addColumnLeft: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'left',\n                iconClass: 'table-column-insert-left'\n            },\n            addColumnRight: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'right',\n                iconClass: 'table-column-insert-right'\n            },\n            addRowBelow: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'below',\n                iconClass: 'table-row-insert-below'\n            },\n            addRowAbove: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'above',\n                iconClass: 'table-row-insert-above'\n            },\n            deleteColumn: {\n                type: 'button',\n                command: 'DeleteColumnCommand',\n                iconClass: 'table-column-delete'\n            },\n            deleteRow: {\n                type: 'button',\n                command: 'DeleteRowCommand',\n                iconClass: 'table-row-delete'\n            },\n            sort: {\n                type: 'sort',\n                iconClass: 'sort-desc'\n            },\n            validation: {\n                type: 'dialog',\n                dialogName: 'validation',\n                iconClass: 'exception',\n                overflow: 'never'\n            }\n        };\n        var SpreadsheetToolBar = ToolBar.extend({\n            init: function (element, options) {\n                options.items = this._expandTools(options.tools || SpreadsheetToolBar.prototype.options.tools[options.toolbarName]);\n                ToolBar.fn.init.call(this, element, options);\n                var handleClick = this._click.bind(this);\n                this.element.addClass('k-spreadsheet-toolbar');\n                this._addSeparators(this.element);\n                this.bind({\n                    click: handleClick,\n                    toggle: handleClick\n                });\n            },\n            _addSeparators: function (element) {\n                var groups = element.children('.k-widget, a.k-button, .k-button-group');\n                groups.before('<span class=\\'k-separator\\' />');\n            },\n            _expandTools: function (tools) {\n                function expandTool(toolName) {\n                    var options = $.isPlainObject(toolName) ? toolName : toolDefaults[toolName] || {};\n                    var spriteCssClass = 'k-icon k-i-' + options.iconClass;\n                    var type = options.type;\n                    var typeDefaults = {\n                        button: { showText: 'overflow' },\n                        colorPicker: {\n                            toolIcon: spriteCssClass,\n                            spriteCssClass: spriteCssClass\n                        },\n                        borders: { spriteCssClass: spriteCssClass },\n                        alignment: { spriteCssClass: spriteCssClass },\n                        merge: { spriteCssClass: spriteCssClass },\n                        freeze: { spriteCssClass: spriteCssClass }\n                    };\n                    var tool = $.extend({\n                        name: options.name || toolName,\n                        text: MESSAGES[options.name || toolName],\n                        icon: options.iconClass,\n                        attributes: { title: MESSAGES[options.name || toolName] }\n                    }, typeDefaults[type], options);\n                    if (type == 'splitButton') {\n                        tool.menuButtons = tool.menuButtons.map(expandTool);\n                    }\n                    tool.attributes['data-tool'] = toolName;\n                    if (options.property) {\n                        tool.attributes['data-property'] = options.property;\n                    }\n                    return tool;\n                }\n                return tools.reduce(function (tools, tool) {\n                    if ($.isArray(tool)) {\n                        tools.push({\n                            type: 'buttonGroup',\n                            buttons: tool.map(expandTool)\n                        });\n                    } else {\n                        tools.push(expandTool.call(this, tool));\n                    }\n                    return tools;\n                }, []);\n            },\n            _click: function (e) {\n                var toolName = e.target.attr('data-tool');\n                var tool = toolDefaults[toolName] || {};\n                var commandType = tool.command;\n                if (!commandType) {\n                    return;\n                }\n                var args = {\n                    command: commandType,\n                    options: {\n                        property: tool.property || null,\n                        value: tool.value || null\n                    }\n                };\n                if (typeof args.options.value === 'boolean') {\n                    args.options.value = e.checked ? true : null;\n                }\n                this.action(args);\n            },\n            events: [\n                'click',\n                'toggle',\n                'open',\n                'close',\n                'overflowOpen',\n                'overflowClose',\n                'action',\n                'dialog'\n            ],\n            options: {\n                name: 'SpreadsheetToolBar',\n                resizable: true,\n                tools: defaultTools\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refresh: function (activeCell) {\n                var range = activeCell;\n                var tools = this._tools();\n                function setToggle(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    var togglable = toolbar && toolbar.options.togglable || overflow && overflow.options.togglable;\n                    if (!togglable) {\n                        return;\n                    }\n                    var toggle = false;\n                    if (typeof value === 'boolean') {\n                        toggle = value;\n                    } else if (typeof value === 'string') {\n                        toggle = toolbar.options.value === value;\n                    }\n                    toolbar.toggle(toggle);\n                    if (overflow) {\n                        overflow.toggle(toggle);\n                    }\n                }\n                function update(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    if (toolbar && toolbar.update) {\n                        toolbar.update(value);\n                    }\n                    if (overflow && overflow.update) {\n                        overflow.update(value);\n                    }\n                }\n                for (var i = 0; i < tools.length; i++) {\n                    var property = tools[i].property;\n                    var tool = tools[i].tool;\n                    var value = kendo.isFunction(range[property]) ? range[property]() : range;\n                    if (property == 'gridLines') {\n                        value = range.sheet().showGridLines();\n                    }\n                    if (tool.type === 'button') {\n                        setToggle(tool, value);\n                    } else {\n                        update(tool, value);\n                    }\n                }\n            },\n            _tools: function () {\n                return this.element.find('[data-property]').toArray().map(function (element) {\n                    element = $(element);\n                    return {\n                        property: element.attr('data-property'),\n                        tool: this._getItem(element)\n                    };\n                }.bind(this));\n            },\n            destroy: function () {\n                this.element.find('[data-command],.k-button').each(function () {\n                    var element = $(this);\n                    var instance = element.data('instance');\n                    if (instance && instance.destroy) {\n                        instance.destroy();\n                    }\n                });\n                ToolBar.fn.destroy.call(this);\n            }\n        });\n        kendo.spreadsheet.ToolBar = SpreadsheetToolBar;\n        var DropDownTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var dropDownList = $('<select />').kendoDropDownList({ height: 'auto' }).data('kendoDropDownList');\n                this.dropDownList = dropDownList;\n                this.element = dropDownList.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                dropDownList.bind('open', this._open.bind(this));\n                dropDownList.bind('change', this._change.bind(this));\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n            },\n            _open: function () {\n                var ddl = this.dropDownList;\n                var list = ddl.list;\n                var listWidth;\n                list.css({\n                    whiteSpace: 'nowrap',\n                    width: 'auto'\n                });\n                listWidth = list.width();\n                if (listWidth) {\n                    listWidth += 20;\n                } else {\n                    listWidth = ddl._listWidth;\n                }\n                list.css('width', listWidth + kendo.support.scrollbar());\n                ddl._listWidth = listWidth;\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var value = instance.value();\n                var dataItem = instance.dataItem();\n                var popupName = dataItem ? dataItem.popup : undefined;\n                if (popupName) {\n                    this.toolbar.dialog({ name: popupName });\n                } else {\n                    this.toolbar.action({\n                        command: 'PropertyChangeCommand',\n                        options: {\n                            property: this.options.property,\n                            value: value == 'null' ? null : value\n                        }\n                    });\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.dropDownList.value(value);\n                } else {\n                    return this.dropDownList.value();\n                }\n            }\n        });\n        var PopupTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.element = $('<a href=\\'#\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'' + options.spriteCssClass + '\\'>' + '</span><span class=\\'k-icon k-i-arrow-60-down\\'></span>' + '</a>');\n                this.element.on('click touchend', this.open.bind(this)).attr('data-command', options.command);\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this._popup();\n            },\n            destroy: function () {\n                this.popup.destroy();\n            },\n            open: function (ev) {\n                ev.preventDefault();\n                this.popup.toggle();\n            },\n            _popup: function () {\n                var element = this.element;\n                this.popup = $('<div class=\\'k-spreadsheet-popup\\' />').appendTo(element).kendoPopup({ anchor: element }).data('kendoPopup');\n            }\n        });\n        kendo.toolbar.registerComponent('dialog', kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this._dialogName = options.dialogName;\n                this.element.bind('click touchend', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        kendo.toolbar.registerComponent('exportAsDialog', kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this._dialogName = options.dialogName;\n                this.toolbar = toolbar;\n                this.element = $('<button class=\\'k-button k-button-icon\\' title=\\'' + options.attributes.title + '\\'>' + '<span class=\\'k-icon k-i-file-excel\\' />' + '</button>').data('instance', this);\n                this.element.bind('click', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        var OverflowDialogButton = kendo.toolbar.OverflowButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.OverflowButton.fn.init.call(this, options, toolbar);\n                this.element.on('click touchend', this._click.bind(this));\n                this.message = this.options.text;\n                var instance = this.element.data('button');\n                this.element.data(this.options.type, instance);\n            },\n            _click: $.noop\n        });\n        var ColorPicker = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.popup.element.addClass('k-spreadsheet-colorpicker');\n                this.colorChooser = new kendo.spreadsheet.ColorChooser(this.popup.element, { change: this._colorChange.bind(this) });\n                this.element.attr({ 'data-property': options.property });\n                this.element.data({\n                    type: 'colorPicker',\n                    colorPicker: this,\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.colorChooser.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (value) {\n                this.value(value);\n            },\n            value: function (value) {\n                this.colorChooser.value(value);\n            },\n            _colorChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: e.sender.value()\n                    }\n                });\n                this.popup.close();\n            }\n        });\n        var ColorPickerButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                options.iconName = 'text';\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n            },\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'colorPicker',\n                    options: {\n                        title: this.options.property,\n                        property: this.options.property\n                    }\n                });\n            }\n        });\n        kendo.toolbar.registerComponent('colorPicker', ColorPicker, ColorPickerButton);\n        var FONT_SIZES = [\n            8,\n            9,\n            10,\n            11,\n            12,\n            13,\n            14,\n            16,\n            18,\n            20,\n            22,\n            24,\n            26,\n            28,\n            36,\n            48,\n            72\n        ];\n        var DEFAULT_FONT_SIZE = 12;\n        var FontSize = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var comboBox = $('<input />').kendoComboBox({\n                    change: this._valueChange.bind(this),\n                    clearButton: false,\n                    dataSource: options.fontSizes || FONT_SIZES,\n                    value: DEFAULT_FONT_SIZE\n                }).data('kendoComboBox');\n                this.comboBox = comboBox;\n                this.element = comboBox.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n                this.element.data({\n                    type: 'fontSize',\n                    fontSize: this\n                });\n            },\n            _valueChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: kendo.parseInt(e.sender.value())\n                    }\n                });\n            },\n            update: function (value) {\n                this.value(kendo.parseInt(value) || DEFAULT_FONT_SIZE);\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.comboBox.value(value);\n                } else {\n                    return this.comboBox.value();\n                }\n            }\n        });\n        var FontSizeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontSize',\n                    options: {\n                        sizes: FONT_SIZES,\n                        defaultSize: DEFAULT_FONT_SIZE\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_SIZE;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontSize', FontSize, FontSizeButton);\n        var FONT_FAMILIES = [\n            'Arial',\n            'Courier New',\n            'Georgia',\n            'Times New Roman',\n            'Trebuchet MS',\n            'Verdana'\n        ];\n        var DEFAULT_FONT_FAMILY = 'Arial';\n        var FontFamily = DropDownTool.extend({\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.setDataSource(options.fontFamilies || FONT_FAMILIES);\n                ddl.value(DEFAULT_FONT_FAMILY);\n                this.element.data({\n                    type: 'fontFamily',\n                    fontFamily: this\n                });\n            },\n            update: function (value) {\n                this.value(value || DEFAULT_FONT_FAMILY);\n            }\n        });\n        var FontFamilyButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontFamily',\n                    options: {\n                        fonts: FONT_FAMILIES,\n                        defaultFont: DEFAULT_FONT_FAMILY\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_FAMILY;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontFamily', FontFamily, FontFamilyButton);\n        var defaultFormats = kendo.spreadsheet.formats = {\n            automatic: null,\n            number: '#,0.00',\n            percent: '0.00%',\n            financial: '_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',\n            currency: '$#,##0.00;[Red]$#,##0.00',\n            date: 'm/d/yyyy',\n            time: 'h:mm:ss AM/PM',\n            dateTime: 'm/d/yyyy h:mm',\n            duration: '[h]:mm:ss'\n        };\n        var Format = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                var icon = '<span class=\\'k-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>';\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    dataValueField: 'format',\n                    dataTextField: 'name',\n                    dataValuePrimitive: true,\n                    valueTemplate: icon,\n                    template: '# if (data.sample) { #' + '<span class=\\'k-spreadsheet-sample\\'>#: data.sample #</span>' + '# } #' + '#: data.name #'\n                });\n                ddl.text(icon);\n                ddl.setDataSource([\n                    {\n                        format: defaultFormats.automatic,\n                        name: MESSAGES.formatTypes.automatic\n                    },\n                    {\n                        format: defaultFormats.number,\n                        name: MESSAGES.formatTypes.number,\n                        sample: '1,499.99'\n                    },\n                    {\n                        format: defaultFormats.percent,\n                        name: MESSAGES.formatTypes.percent,\n                        sample: '14.50%'\n                    },\n                    {\n                        format: defaultFormats.financial,\n                        name: MESSAGES.formatTypes.financial,\n                        sample: '(1,000.12)'\n                    },\n                    {\n                        format: defaultFormats.currency,\n                        name: MESSAGES.formatTypes.currency,\n                        sample: '$1,499.99'\n                    },\n                    {\n                        format: defaultFormats.date,\n                        name: MESSAGES.formatTypes.date,\n                        sample: '4/21/2012'\n                    },\n                    {\n                        format: defaultFormats.time,\n                        name: MESSAGES.formatTypes.time,\n                        sample: '5:49:00 PM'\n                    },\n                    {\n                        format: defaultFormats.dateTime,\n                        name: MESSAGES.formatTypes.dateTime,\n                        sample: '4/21/2012 5:49:00'\n                    },\n                    {\n                        format: defaultFormats.duration,\n                        name: MESSAGES.formatTypes.duration,\n                        sample: '168:05:00'\n                    },\n                    {\n                        popup: 'formatCells',\n                        name: MESSAGES.formatTypes.moreFormats\n                    }\n                ]);\n                this.element.data({\n                    type: 'format',\n                    format: this\n                });\n            }\n        });\n        var FormatButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'formatCells' });\n            }\n        });\n        kendo.toolbar.registerComponent('format', Format, FormatButton);\n        var BorderChangeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._borderPalette();\n                this.element.data({\n                    type: 'borders',\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.borderPalette.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            _borderPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this._action.bind(this) });\n            },\n            _action: function (e) {\n                this.toolbar.action({\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: e.type,\n                        style: {\n                            size: 1,\n                            color: e.color\n                        }\n                    }\n                });\n            }\n        });\n        var BorderChangeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'borders' });\n            }\n        });\n        kendo.toolbar.registerComponent('borders', BorderChangeTool, BorderChangeButton);\n        var AlignmentTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.element.attr({ 'data-property': 'alignment' });\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'alignment',\n                    alignment: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    property: 'textAlign',\n                    value: 'left',\n                    iconClass: 'align-left',\n                    text: MESSAGES.alignmentButtons.justtifyLeft\n                },\n                {\n                    property: 'textAlign',\n                    value: 'center',\n                    iconClass: 'align-center',\n                    text: MESSAGES.alignmentButtons.justifyCenter\n                },\n                {\n                    property: 'textAlign',\n                    value: 'right',\n                    iconClass: 'align-right',\n                    text: MESSAGES.alignmentButtons.justifyRight\n                },\n                {\n                    property: 'textAlign',\n                    value: 'justify',\n                    iconClass: 'align-justify',\n                    text: MESSAGES.alignmentButtons.justifyFull\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'top',\n                    iconClass: 'align-top',\n                    text: MESSAGES.alignmentButtons.alignTop\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'center',\n                    iconClass: 'align-middle',\n                    text: MESSAGES.alignmentButtons.alignMiddle\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'bottom',\n                    iconClass: 'align-bottom',\n                    text: MESSAGES.alignmentButtons.alignBottom\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (range) {\n                var textAlign = range.textAlign();\n                var verticalAlign = range.verticalAlign();\n                var element = this.popup.element;\n                element.find('.k-button').removeClass('k-state-active');\n                if (textAlign) {\n                    element.find('[data-property=textAlign][data-value=' + textAlign + ']').addClass('k-state-active');\n                }\n                if (verticalAlign) {\n                    element.find('[data-property=verticalAlign][data-value=' + verticalAlign + ']').addClass('k-state-active');\n                }\n            },\n            _commandPalette: function () {\n                var buttons = this.buttons;\n                var element = $('<div />').appendTo(this.popup.element);\n                buttons.forEach(function (options, index) {\n                    var button = '<a title=\\'' + options.text + '\\' data-property=\\'' + options.property + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'k-icon k-i-' + options.iconClass + '\\'></span>' + '</a>';\n                    if (index !== 0 && buttons[index - 1].property !== options.property) {\n                        element.append($('<span class=\\'k-separator\\' />'));\n                    }\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var property = button.attr('data-property');\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: property,\n                        value: value\n                    }\n                });\n            }\n        });\n        var AlignmentButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'alignment' });\n            }\n        });\n        kendo.toolbar.registerComponent('alignment', AlignmentTool, AlignmentButton);\n        var MergeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'merge',\n                    merge: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    value: 'cells',\n                    iconClass: 'cells-merge',\n                    text: MESSAGES.mergeButtons.mergeCells\n                },\n                {\n                    value: 'horizontally',\n                    iconClass: 'cells-merge-horizontally',\n                    text: MESSAGES.mergeButtons.mergeHorizontally\n                },\n                {\n                    value: 'vertically',\n                    iconClass: 'cells-merge-vertically',\n                    text: MESSAGES.mergeButtons.mergeVertically\n                },\n                {\n                    value: 'unmerge',\n                    iconClass: 'table-unmerge',\n                    text: MESSAGES.mergeButtons.unmerge\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'MergeCellCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var MergeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'merge' });\n            }\n        });\n        kendo.toolbar.registerComponent('merge', MergeTool, MergeButton);\n        var FreezeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'freeze',\n                    freeze: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    value: 'panes',\n                    iconClass: 'pane-freeze',\n                    text: MESSAGES.freezeButtons.freezePanes\n                },\n                {\n                    value: 'rows',\n                    iconClass: 'row-freeze',\n                    text: MESSAGES.freezeButtons.freezeRows\n                },\n                {\n                    value: 'columns',\n                    iconClass: 'column-freeze',\n                    text: MESSAGES.freezeButtons.freezeColumns\n                },\n                {\n                    value: 'unfreeze',\n                    iconClass: 'table-unmerge',\n                    text: MESSAGES.freezeButtons.unfreeze\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'FreezePanesCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var FreezeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'freeze' });\n            }\n        });\n        kendo.toolbar.registerComponent('freeze', FreezeTool, FreezeButton);\n        var Sort = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    valueTemplate: '<span class=\\'k-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>',\n                    template: '<span class=\\'k-icon k-i-#= iconClass #\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>#=text#',\n                    dataTextField: 'text',\n                    dataValueField: 'value'\n                });\n                ddl.setDataSource([\n                    {\n                        value: 'asc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeAsc,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        value: 'desc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeDesc,\n                        iconClass: 'sort-desc'\n                    }\n                ]);\n                ddl.select(0);\n                this.element.data({\n                    type: 'sort',\n                    sort: this\n                });\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var dataItem = instance.dataItem();\n                if (dataItem) {\n                    this.toolbar.action({\n                        command: 'SortCommand',\n                        options: {\n                            value: dataItem.value,\n                            sheet: dataItem.sheet\n                        }\n                    });\n                }\n            },\n            value: $.noop\n        });\n        var SortButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'sort' });\n            }\n        });\n        kendo.toolbar.registerComponent('sort', Sort, SortButton);\n        var Filter = kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                options.showText = 'overflow';\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this.element.on('click', this._click.bind(this));\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        var FilterButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        kendo.toolbar.registerComponent('filter', Filter, FilterButton);\n        var Open = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.toolbar = toolbar;\n                this.element = $('<div class=\\'k-button k-upload-button k-button-icon\\'>' + '<span class=\\'k-icon k-i-folder-open\\' />' + '</div>').data('instance', this);\n                this._title = options.attributes.title;\n                this._reset();\n            },\n            _reset: function () {\n                this.element.remove('input');\n                $('<input type=\\'file\\' autocomplete=\\'off\\' accept=\\'.xlsx\\'/>').attr('title', this._title).one('change', this._change.bind(this)).appendTo(this.element);\n            },\n            _change: function (e) {\n                this.toolbar.action({\n                    command: 'OpenCommand',\n                    options: { file: e.target.files[0] }\n                });\n                this._reset();\n            }\n        });\n        kendo.toolbar.registerComponent('open', Open);\n        kendo.spreadsheet.TabStrip = kendo.ui.TabStrip.extend({\n            init: function (element, options) {\n                kendo.ui.TabStrip.fn.init.call(this, element, options);\n                element.addClass('k-spreadsheet-tabstrip');\n                this._quickAccessButtons();\n                this.toolbars = {};\n                var tabs = options.dataSource;\n                this.contentElements.each(function (idx, element) {\n                    this._toolbar($(element), tabs[idx].id, options.toolbarOptions[tabs[idx].id]);\n                }.bind(this));\n                this.one('activate', function () {\n                    this.toolbars[this.options.dataSource[0].id].resize();\n                });\n            },\n            events: kendo.ui.TabStrip.fn.events.concat([\n                'action',\n                'dialog'\n            ]),\n            destroy: function () {\n                this.quickAccessToolBar.off('click');\n                kendo.ui.TabStrip.fn.destroy.call(this);\n                for (var name in this.toolbars) {\n                    this.toolbars[name].destroy();\n                }\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refreshTools: function (range) {\n                var toolbars = this.toolbars;\n                for (var name in toolbars) {\n                    if (toolbars.hasOwnProperty(name)) {\n                        toolbars[name].refresh(range);\n                    }\n                }\n            },\n            _quickAccessButtons: function () {\n                var buttons = [\n                    {\n                        title: MESSAGES.quickAccess.undo,\n                        iconClass: 'undo',\n                        action: 'undo'\n                    },\n                    {\n                        title: MESSAGES.quickAccess.redo,\n                        iconClass: 'redo',\n                        action: 'redo'\n                    }\n                ];\n                var buttonTemplate = kendo.template('<a href=\\'\\\\#\\' title=\\'#= title #\\' data-action=\\'#= action #\\' class=\\'k-button k-button-icon\\'><span class=\\'k-icon k-i-#=iconClass#\\'></span></a>');\n                this.quickAccessToolBar = $('<div />', {\n                    'class': 'k-spreadsheet-quick-access-toolbar',\n                    'html': kendo.render(buttonTemplate, buttons)\n                }).insertBefore(this.wrapper);\n                this.quickAccessToolBar.on('click', '.k-button', function (e) {\n                    e.preventDefault();\n                    var action = $(e.currentTarget).attr('data-action');\n                    this.action({ action: action });\n                }.bind(this));\n                this.quickAccessAdjust();\n            },\n            quickAccessAdjust: function () {\n                this.tabGroup.css('padding-left', kendo._outerWidth(this.quickAccessToolBar));\n            },\n            _toolbar: function (container, name, tools) {\n                var element;\n                var options;\n                if (this.toolbars[name]) {\n                    this.toolbars[name].destroy();\n                    container.children('.k-toolbar').remove();\n                }\n                if (tools) {\n                    element = container.html('<div />').children('div');\n                    options = {\n                        tools: typeof tools === 'boolean' ? undefined : tools,\n                        toolbarName: name,\n                        action: this.action.bind(this),\n                        dialog: this.dialog.bind(this)\n                    };\n                    this.toolbars[name] = new kendo.spreadsheet.ToolBar(element, options);\n                }\n            }\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/dialogs', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.validator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ObservableObject = kendo.data.ObservableObject;\n        var MESSAGES = kendo.spreadsheet.messages.dialogs = {\n            apply: 'Apply',\n            save: 'Save',\n            cancel: 'Cancel',\n            remove: 'Remove',\n            retry: 'Retry',\n            revert: 'Revert',\n            okText: 'OK',\n            formatCellsDialog: {\n                title: 'Format',\n                categories: {\n                    number: 'Number',\n                    currency: 'Currency',\n                    date: 'Date'\n                }\n            },\n            fontFamilyDialog: { title: 'Font' },\n            fontSizeDialog: { title: 'Font size' },\n            bordersDialog: { title: 'Borders' },\n            alignmentDialog: {\n                title: 'Alignment',\n                buttons: {\n                    justtifyLeft: 'Align left',\n                    justifyCenter: 'Center',\n                    justifyRight: 'Align right',\n                    justifyFull: 'Justify',\n                    alignTop: 'Align top',\n                    alignMiddle: 'Align middle',\n                    alignBottom: 'Align bottom'\n                }\n            },\n            mergeDialog: {\n                title: 'Merge cells',\n                buttons: {\n                    mergeCells: 'Merge all',\n                    mergeHorizontally: 'Merge horizontally',\n                    mergeVertically: 'Merge vertically',\n                    unmerge: 'Unmerge'\n                }\n            },\n            freezeDialog: {\n                title: 'Freeze panes',\n                buttons: {\n                    freezePanes: 'Freeze panes',\n                    freezeRows: 'Freeze rows',\n                    freezeColumns: 'Freeze columns',\n                    unfreeze: 'Unfreeze panes'\n                }\n            },\n            confirmationDialog: {\n                text: 'Are you sure you want to remove this sheet?',\n                title: 'Sheet remove'\n            },\n            validationDialog: {\n                title: 'Data Validation',\n                hintMessage: 'Please enter a valid {0} value {1}.',\n                hintTitle: 'Validation {0}',\n                criteria: {\n                    any: 'Any value',\n                    number: 'Number',\n                    text: 'Text',\n                    date: 'Date',\n                    custom: 'Custom Formula',\n                    list: 'List'\n                },\n                comparers: {\n                    greaterThan: 'greater than',\n                    lessThan: 'less than',\n                    between: 'between',\n                    notBetween: 'not between',\n                    equalTo: 'equal to',\n                    notEqualTo: 'not equal to',\n                    greaterThanOrEqualTo: 'greater than or equal to',\n                    lessThanOrEqualTo: 'less than or equal to'\n                },\n                comparerMessages: {\n                    greaterThan: 'greater than {0}',\n                    lessThan: 'less than {0}',\n                    between: 'between {0} and {1}',\n                    notBetween: 'not between {0} and {1}',\n                    equalTo: 'equal to {0}',\n                    notEqualTo: 'not equal to {0}',\n                    greaterThanOrEqualTo: 'greater than or equal to {0}',\n                    lessThanOrEqualTo: 'less than or equal to {0}',\n                    custom: 'that satisfies the formula: {0}'\n                },\n                labels: {\n                    criteria: 'Criteria',\n                    comparer: 'Comparer',\n                    min: 'Min',\n                    max: 'Max',\n                    value: 'Value',\n                    start: 'Start',\n                    end: 'End',\n                    onInvalidData: 'On invalid data',\n                    rejectInput: 'Reject input',\n                    showWarning: 'Show warning',\n                    showHint: 'Show hint',\n                    hintTitle: 'Hint title',\n                    hintMessage: 'Hint message',\n                    ignoreBlank: 'Ignore blank',\n                    showListButton: 'Display button to show list',\n                    showCalendarButton: 'Display button to show calendar'\n                },\n                placeholders: {\n                    typeTitle: 'Type title',\n                    typeMessage: 'Type message'\n                }\n            },\n            exportAsDialog: {\n                title: 'Export...',\n                labels: {\n                    scale: 'Scale',\n                    fit: 'Fit to page',\n                    fileName: 'File name',\n                    saveAsType: 'Save as type',\n                    exportArea: 'Export',\n                    paperSize: 'Paper size',\n                    margins: 'Margins',\n                    orientation: 'Orientation',\n                    print: 'Print',\n                    guidelines: 'Guidelines',\n                    center: 'Center',\n                    horizontally: 'Horizontally',\n                    vertically: 'Vertically'\n                }\n            },\n            modifyMergedDialog: { errorMessage: 'Cannot change part of a merged cell.' },\n            rangeDisabledDialog: { errorMessage: 'Destination range contains disabled cells.' },\n            incompatibleRangesDialog: { errorMessage: 'Incompatible ranges' },\n            noFillDirectionDialog: { errorMessage: 'Cannot determine fill direction' },\n            duplicateSheetNameDialog: { errorMessage: 'Duplicate sheet name' },\n            overflowDialog: { errorMessage: 'Cannot paste, because the copy area and the paste area are not the same size and shape.' },\n            useKeyboardDialog: {\n                title: 'Copying and pasting',\n                errorMessage: 'These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:',\n                labels: {\n                    forCopy: 'for copy',\n                    forCut: 'for cut',\n                    forPaste: 'for paste'\n                }\n            },\n            unsupportedSelectionDialog: { errorMessage: 'That action cannot be performed on multiple selection.' },\n            linkDialog: {\n                title: 'Hyperlink',\n                labels: {\n                    text: 'Text',\n                    url: 'Address',\n                    removeLink: 'Remove link'\n                }\n            }\n        };\n        var registry = {};\n        kendo.spreadsheet.dialogs = {\n            register: function (name, dialogClass) {\n                registry[name] = dialogClass;\n            },\n            registered: function (name) {\n                return !!registry[name];\n            },\n            create: function (name, options) {\n                var dialogClass = registry[name];\n                if (dialogClass) {\n                    return new dialogClass(options);\n                }\n            }\n        };\n        var SpreadsheetDialog = kendo.spreadsheet.SpreadsheetDialog = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.options = $.extend(true, {}, this.options, options);\n                this.bind(this.events, options);\n            },\n            events: [\n                'close',\n                'activate'\n            ],\n            options: { autoFocus: true },\n            dialog: function () {\n                if (!this._dialog) {\n                    this._dialog = $('<div class=\\'k-spreadsheet-window k-action-window\\' />').addClass(this.options.className || '').append(kendo.template(this.options.template)({\n                        messages: kendo.spreadsheet.messages.dialogs || MESSAGES,\n                        errors: this.options.errors\n                    })).appendTo(document.body).kendoWindow({\n                        autoFocus: this.options.autoFocus,\n                        scrollable: false,\n                        resizable: false,\n                        modal: true,\n                        visible: false,\n                        width: this.options.width || 320,\n                        title: this.options.title,\n                        open: function () {\n                            this.center();\n                        },\n                        close: this._onDialogClose.bind(this),\n                        activate: this._onDialogActivate.bind(this),\n                        deactivate: this._onDialogDeactivate.bind(this)\n                    }).data('kendoWindow');\n                }\n                return this._dialog;\n            },\n            _onDialogClose: function () {\n                this.trigger('close', { action: this._action });\n            },\n            _onDialogActivate: function () {\n                this.trigger('activate');\n            },\n            _onDialogDeactivate: function () {\n                this.trigger('deactivate');\n                this.destroy();\n            },\n            destroy: function () {\n                if (this._dialog) {\n                    this._dialog.destroy();\n                    this._dialog = null;\n                }\n            },\n            open: function () {\n                this.dialog().open();\n            },\n            apply: function () {\n                this.close();\n            },\n            close: function () {\n                this._action = 'close';\n                this.dialog().close();\n            }\n        });\n        function formattedValue(value, format) {\n            return kendo.spreadsheet.formatting.text(value, format);\n        }\n        var FormatCellsViewModel = kendo.spreadsheet.FormatCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.useCategory(this.category);\n            },\n            useCategory: function (category) {\n                var type = category && category.type || 'number';\n                var formatCurrency = type == 'currency';\n                this.category = category;\n                this.set('showCurrencyFilter', formatCurrency && this.currencies.length > 1);\n                if (!formatCurrency) {\n                    this.set('formats', this.allFormats[type + 'Formats']);\n                } else {\n                    this.currency(this.currencies[0]);\n                }\n                this.useFirstFormat();\n            },\n            useFirstFormat: function () {\n                if (this.formats.length) {\n                    this.set('format', this.formats[0].value);\n                }\n            },\n            currency: function (currency) {\n                if (currency !== undefined) {\n                    this._currency = currency;\n                    var info = currency.value;\n                    var formats = [\n                        {\n                            currency: info,\n                            decimals: true\n                        },\n                        {\n                            currency: info,\n                            decimals: true,\n                            iso: true\n                        },\n                        {\n                            currency: info,\n                            decimals: false\n                        }\n                    ];\n                    formats = formats.map(function (format) {\n                        format = FormatCellsViewModel.convert.currency(format);\n                        return {\n                            value: format,\n                            name: formattedValue(1000, format)\n                        };\n                    });\n                    this.set('formats', formats);\n                    this.useFirstFormat();\n                }\n                return this._currency || this.currencies[0];\n            },\n            categoryFilter: function (category) {\n                if (category !== undefined) {\n                    this.useCategory(category);\n                }\n                return this.category;\n            },\n            preview: function () {\n                var format = this.get('format');\n                var value = this.value || 0;\n                if (format && format.length) {\n                    return formattedValue(value, format);\n                } else {\n                    return value;\n                }\n            }\n        });\n        FormatCellsViewModel.convert = {\n            currency: function (options) {\n                function repeat(token, n) {\n                    return new Array(n + 1).join(token);\n                }\n                var info = options.currency;\n                var format = info.pattern[1];\n                if (options.decimals) {\n                    format = format.replace(/n/g, 'n' + info['.'] + repeat('0', info.decimals));\n                }\n                if (options.iso) {\n                    format = '\"' + info.abbr + '\" ' + format.replace(/\\s*\\$\\s*/g, '');\n                } else {\n                    format = format.replace(/\\$/g, info.symbol);\n                }\n                format = format.replace(/n/g, '?');\n                return format;\n            },\n            date: function (format) {\n                if (/T|Z/.test(format)) {\n                    return '';\n                }\n                return format.toLowerCase().replace(/tt/g, 'AM/PM').replace(/'/g, '\"');\n            }\n        };\n        function uniqueBy(field, array) {\n            var result = [];\n            var values = [];\n            for (var i = 0; i < array.length; i++) {\n                if ($.inArray(array[i][field], values) == -1) {\n                    result.push(array[i]);\n                    values.push(array[i][field]);\n                }\n            }\n            return result;\n        }\n        var FormatCellsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.formatCellsDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    categories: [\n                        {\n                            type: 'number',\n                            name: messages.categories.number\n                        },\n                        {\n                            type: 'currency',\n                            name: messages.categories.currency\n                        },\n                        {\n                            type: 'date',\n                            name: messages.categories.date\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._generateFormats();\n            },\n            options: {\n                className: 'k-spreadsheet-format-cells',\n                template: '<div class=\\'k-root-tabs\\' data-role=\\'tabstrip\\' ' + 'data-text-field=\\'name\\' ' + 'data-bind=\\'source: categories, value: categoryFilter\\' ' + 'data-animation=\\'false\\' />' + '<div class=\\'k-spreadsheet-preview\\' data-bind=\\'text: preview\\' />' + '<script type=\\'text/x-kendo-template\\' id=\\'format-item-template\\'>' + '\\\\#: data.name \\\\#' + '</script>' + '<select data-role=\\'dropdownlist\\' class=\\'k-format-filter\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'value.name\\' ' + 'data-bind=\\'visible: showCurrencyFilter, value: currency, source: currencies\\' />' + '<ul data-role=\\'staticlist\\' tabindex=\\'0\\' ' + 'class=\\'k-list k-reset\\' ' + 'data-template=\\'format-item-template\\' ' + 'data-value-primitive=\\'true\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'source: formats, value: format\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            _generateFormats: function () {\n                var options = this.options;\n                if (!options.currencies) {\n                    options.currencies = FormatCellsDialog.currenciesFrom(kendo.cultures);\n                }\n                if (!options.numberFormats) {\n                    options.numberFormats = [\n                        {\n                            value: '#.00%',\n                            name: '100.00%'\n                        },\n                        {\n                            value: '#%',\n                            name: '100%'\n                        },\n                        {\n                            value: '#.00',\n                            name: '1024.00'\n                        },\n                        {\n                            value: '#,###.00',\n                            name: '1,024.00'\n                        }\n                    ];\n                }\n                if (!options.dateFormats) {\n                    var calendarPatterns = kendo.cultures.current.calendars.standard.patterns;\n                    options.dateFormats = uniqueBy('value', $.map(calendarPatterns, function (format) {\n                        format = FormatCellsViewModel.convert.date(format);\n                        if (!format) {\n                            return;\n                        }\n                        return {\n                            value: format,\n                            name: formattedValue(34567.7678, format)\n                        };\n                    }));\n                }\n            },\n            open: function (range) {\n                var options = this.options;\n                var value = range.value();\n                var categories = options.categories.slice(0);\n                var element;\n                this.viewModel = new FormatCellsViewModel({\n                    currencies: options.currencies.slice(0),\n                    allFormats: {\n                        numberFormats: options.numberFormats.slice(0),\n                        dateFormats: options.dateFormats.slice(0)\n                    },\n                    categories: categories,\n                    format: range.format(),\n                    category: value instanceof Date ? categories[2] : categories[0],\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    value: value\n                });\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                kendo.bind(element, this.viewModel);\n                var currencyFilter = element.find('select.k-format-filter').data('kendoDropDownList');\n                if (options.currencies.length > 10) {\n                    currencyFilter.setOptions({ filter: 'contains' });\n                }\n                element.find(kendo.roleSelector('staticlist')).parent().addClass('k-list-wrapper');\n            },\n            apply: function () {\n                var format = this.viewModel.format;\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'format',\n                        value: format\n                    }\n                });\n            }\n        });\n        FormatCellsDialog.currenciesFrom = function (cultures) {\n            return uniqueBy('description', $.map(cultures, function (culture, name) {\n                if (!/-/.test(name)) {\n                    return;\n                }\n                var currency = culture.numberFormat.currency;\n                var description = kendo.format('{0} ({1}, {2})', currency.name, currency.abbr, currency.symbol);\n                return {\n                    description: description,\n                    value: currency\n                };\n            }));\n        };\n        kendo.spreadsheet.dialogs.register('formatCells', FormatCellsDialog);\n        kendo.spreadsheet.dialogs.FormatCellsDialog = FormatCellsDialog;\n        var MessageDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-message',\n                title: '',\n                messageId: '',\n                text: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#= messages.okText #' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    close: this.close.bind(this)\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('message', MessageDialog);\n        var ConfirmationDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.confirmationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    text: messages.text\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                className: 'k-spreadsheet-message',\n                messageId: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: confirm\\'>' + '#= messages.okText #' + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: cancel\\'>' + '#= messages.cancel #' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    confirm: this.confirm.bind(this),\n                    cancel: this.close.bind(this)\n                });\n            },\n            isConfirmed: function () {\n                return this._confirmed;\n            },\n            confirm: function () {\n                this._confirmed = true;\n                this.close();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('confirmation', ConfirmationDialog);\n        var ValidationErrorDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-message',\n                title: '',\n                messageId: '',\n                text: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: retry\\'>' + '#= messages.retry #' + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: cancel\\'>' + '#= messages.cancel #' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    retry: this.retry.bind(this),\n                    cancel: this.close.bind(this)\n                });\n            },\n            retry: function () {\n                this._retry = true;\n                this.close();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('validationError', ValidationErrorDialog);\n        var FontFamilyDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontFamilyDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var fonts = this.options.fonts;\n                var defaultFont = this.options.defaultFont;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: fonts }),\n                    template: '#: data #',\n                    value: defaultFont,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontFamily',\n                        value: e.sender.value()[0]\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontFamily', FontFamilyDialog);\n        var FontSizeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontSizeDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var sizes = this.options.sizes;\n                var defaultSize = this.options.defaultSize;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: sizes }),\n                    template: '#: data #',\n                    value: defaultSize,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontSize',\n                        value: kendo.parseInt(e.sender.value()[0])\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontSize', FontSizeDialog);\n        var BordersDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.bordersDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this.element = this.dialog().element;\n                this._borderPalette();\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: {\n                width: 177,\n                template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                var state = this.value();\n                this.trigger('action', {\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: state.type,\n                        style: {\n                            size: 1,\n                            color: state.color\n                        }\n                    }\n                });\n            },\n            _borderPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this.value.bind(this) });\n            },\n            value: function (state) {\n                if (state === undefined) {\n                    return this._state;\n                } else {\n                    this._state = state;\n                }\n            }\n        });\n        kendo.spreadsheet.dialogs.register('borders', BordersDialog);\n        var ColorChooser = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this.element = this.dialog().element;\n                this.property = options.property;\n                this.options.title = options.title;\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: { template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>' },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.property,\n                        value: this.value()\n                    }\n                });\n            },\n            value: function (e) {\n                if (e === undefined) {\n                    return this._value;\n                } else {\n                    this._value = e.value;\n                }\n            }\n        });\n        var ColorPickerDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 177;\n                ColorChooser.fn.init.call(this, options);\n                this._colorPalette();\n            },\n            _colorPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPalette = element.kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    change: this.value.bind(this)\n                }).data('kendoColorPalette');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('colorPicker', ColorPickerDialog);\n        var CustomColorDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 268;\n                ColorChooser.fn.init.call(this, options);\n                this.dialog().setOptions({ animation: false });\n                this.dialog().one('activate', this._colorPicker.bind(this));\n            },\n            _colorPicker: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPicker = element.kendoFlatColorPicker({ change: this.value.bind(this) }).data('kendoFlatColorPicker');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('customColor', CustomColorDialog);\n        var AlignmentDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.alignmentDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            property: 'textAlign',\n                            value: 'left',\n                            iconClass: 'align-left',\n                            text: messages.buttons.justtifyLeft\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'center',\n                            iconClass: 'align-center',\n                            text: messages.buttons.justifyCenter\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'right',\n                            iconClass: 'align-right',\n                            text: messages.buttons.justifyRight\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'justify',\n                            iconClass: 'align-justify',\n                            text: messages.buttons.justifyFull\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'top',\n                            iconClass: 'align-top',\n                            text: messages.buttons.alignTop\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'center',\n                            iconClass: 'align-middle',\n                            text: messages.buttons.alignMiddle\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'bottom',\n                            iconClass: 'align-bottom',\n                            text: messages.buttons.alignBottom\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-property=\\'#=property#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-i-#=iconClass#\\'></span>' + '#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: dataItem.property,\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('alignment', AlignmentDialog);\n        var MergeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.mergeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            value: 'cells',\n                            iconClass: 'cells-merge',\n                            text: messages.buttons.mergeCells\n                        },\n                        {\n                            value: 'horizontally',\n                            iconClass: 'cells-merge-horizontally',\n                            text: messages.buttons.mergeHorizontally\n                        },\n                        {\n                            value: 'vertically',\n                            iconClass: 'cells-merge-vertically',\n                            text: messages.buttons.mergeVertically\n                        },\n                        {\n                            value: 'unmerge',\n                            iconClass: 'table-unmerge',\n                            text: messages.buttons.unmerge\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'MergeCellCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('merge', MergeDialog);\n        var FreezeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.freezeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            value: 'panes',\n                            iconClass: 'pane-freeze',\n                            text: messages.buttons.freezePanes\n                        },\n                        {\n                            value: 'rows',\n                            iconClass: 'row-freeze',\n                            text: messages.buttons.freezeRows\n                        },\n                        {\n                            value: 'columns',\n                            iconClass: 'column-freeze',\n                            text: messages.buttons.freezeColumns\n                        },\n                        {\n                            value: 'unfreeze',\n                            iconClass: 'table-unmerge',\n                            text: messages.buttons.unfreeze\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'FreezePanesCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('freeze', FreezeDialog);\n        var ValidationViewModel = kendo.spreadsheet.ValidationCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.bind('change', function (e) {\n                    if (e.field === 'criterion') {\n                        this.reset();\n                        if (this.criterion === 'custom' || this.criterion === 'list') {\n                            this.setHintMessageTemplate();\n                        }\n                    }\n                    if (e.field === 'comparer') {\n                        this.setHintMessageTemplate();\n                    }\n                    if ((e.field == 'hintMessage' || e.field == 'hintTitle') && !this._mute) {\n                        this.shouldBuild = false;\n                    }\n                    if ((e.field == 'from' || e.field == 'to' || e.field == 'hintMessageTemplate' || e.field == 'type') && this.shouldBuild) {\n                        this.buildMessages();\n                    }\n                }.bind(this));\n                this.reset();\n            },\n            buildMessages: function () {\n                this._mute = true;\n                this.set('hintTitle', this.hintTitleTemplate ? kendo.format(this.hintTitleTemplate, this.type) : '');\n                this.set('hintMessage', this.hintMessageTemplate ? kendo.format(this.hintMessageTemplate, this.from, this.to) : '');\n                this._mute = false;\n            },\n            reset: function () {\n                this.setComparers();\n                this.set('comparer', this.comparers[0].type);\n                this.set('from', null);\n                this.set('to', null);\n                this.set('useCustomMessages', false);\n                this.shouldBuild = true;\n                this.hintTitleTemplate = this.defaultHintTitle;\n                this.buildMessages();\n            },\n            setComparers: function () {\n                var all = this.defaultComparers;\n                var comparers = [];\n                if (this.criterion === 'text') {\n                    var text_comparers = [\n                        'equalTo',\n                        'notEqualTo'\n                    ];\n                    for (var idx = 0; idx < all.length; idx++) {\n                        if (text_comparers[0] == all[idx].type) {\n                            comparers.push(all[idx]);\n                            text_comparers.shift();\n                        }\n                    }\n                } else {\n                    comparers = all.slice();\n                }\n                this.set('comparers', comparers);\n            },\n            setHintMessageTemplate: function () {\n                if (this.criterion !== 'custom' && this.criterion !== 'list') {\n                    this.set('hintMessageTemplate', kendo.format(this.defaultHintMessage, this.criterion, this.comparerMessages[this.comparer]));\n                } else {\n                    this.set('hintMessageTemplate', '');\n                    this.set('hintMessage', '');\n                }\n            },\n            isAny: function () {\n                return this.get('criterion') === 'any';\n            },\n            isNumber: function () {\n                return this.get('criterion') === 'number';\n            },\n            showToForNumber: function () {\n                return this.showTo() && this.isNumber();\n            },\n            showToForDate: function () {\n                return this.showTo() && this.isDate();\n            },\n            isText: function () {\n                return this.get('criterion') === 'text';\n            },\n            isDate: function () {\n                return this.get('criterion') === 'date';\n            },\n            isList: function () {\n                return this.get('criterion') === 'list';\n            },\n            isCustom: function () {\n                return this.get('criterion') === 'custom';\n            },\n            showRemove: function () {\n                return this.get('hasValidation');\n            },\n            showTo: function () {\n                return this.get('comparer') == 'between' || this.get('comparer') == 'notBetween';\n            },\n            update: function (validation) {\n                this.set('hasValidation', !!validation);\n                if (validation) {\n                    this.fromValidationObject(validation);\n                }\n            },\n            fromValidationObject: function (validation) {\n                this.set('criterion', validation.dataType);\n                this.set('comparer', validation.comparerType);\n                this.set('from', validation.from);\n                this.set('to', validation.to);\n                this.set('type', validation.type);\n                this.set('ignoreBlank', validation.allowNulls);\n                this.set('showButton', validation.showButton);\n                if (validation.messageTemplate || validation.titleTemplate) {\n                    this.hintMessageTemplate = validation.messageTemplate;\n                    this.hintMessage = validation.messageTemplate;\n                    this.hintTitleTemplate = validation.titleTemplate;\n                    this.hintTitle = validation.titleTemplate;\n                    this.useCustomMessages = true;\n                    this.buildMessages();\n                } else {\n                    this.useCustomMessages = false;\n                }\n            },\n            toValidationObject: function () {\n                if (this.criterion === 'any') {\n                    return null;\n                }\n                var options = {\n                    type: this.type,\n                    dataType: this.criterion,\n                    comparerType: this.comparer,\n                    from: this.from,\n                    to: this.to,\n                    allowNulls: this.ignoreBlank,\n                    showButton: this.showButton\n                };\n                if (this.useCustomMessages) {\n                    options.messageTemplate = this.shouldBuild ? this.hintMessageTemplate : this.hintMessage;\n                    options.titleTemplate = this.hintTitle;\n                }\n                return options;\n            }\n        });\n        var ValidationDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.validationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    hintMessage: messages.hintMessage,\n                    hintTitle: messages.hintTitle,\n                    criteria: [\n                        {\n                            type: 'any',\n                            name: messages.criteria.any\n                        },\n                        {\n                            type: 'number',\n                            name: messages.criteria.number\n                        },\n                        {\n                            type: 'text',\n                            name: messages.criteria.text\n                        },\n                        {\n                            type: 'date',\n                            name: messages.criteria.date\n                        },\n                        {\n                            type: 'custom',\n                            name: messages.criteria.custom\n                        },\n                        {\n                            type: 'list',\n                            name: messages.criteria.list\n                        }\n                    ],\n                    comparers: [\n                        {\n                            type: 'greaterThan',\n                            name: messages.comparers.greaterThan\n                        },\n                        {\n                            type: 'lessThan',\n                            name: messages.comparers.lessThan\n                        },\n                        {\n                            type: 'between',\n                            name: messages.comparers.between\n                        },\n                        {\n                            type: 'notBetween',\n                            name: messages.comparers.notBetween\n                        },\n                        {\n                            type: 'equalTo',\n                            name: messages.comparers.equalTo\n                        },\n                        {\n                            type: 'notEqualTo',\n                            name: messages.comparers.notEqualTo\n                        },\n                        {\n                            type: 'greaterThanOrEqualTo',\n                            name: messages.comparers.greaterThanOrEqualTo\n                        },\n                        {\n                            type: 'lessThanOrEqualTo',\n                            name: messages.comparers.lessThanOrEqualTo\n                        }\n                    ],\n                    comparerMessages: messages.comparerMessages\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                width: 450,\n                criterion: 'any',\n                type: 'reject',\n                ignoreBlank: true,\n                showButton: true,\n                useCustomMessages: false,\n                errorTemplate: '<div class=\"k-widget k-tooltip k-tooltip-validation\" style=\"margin:0.5em\"><span class=\"k-icon k-i-warning\"> </span>' + '#= message #<div class=\"k-callout k-callout-n\"></div></div>',\n                template: '<div class=\"k-edit-form-container\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.criteria #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: criterion, source: criteria\" />' + '</div>' + '<div data-bind=\"visible: isNumber\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.min #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.min #\" placeholder=\"e.g. 10\" class=\"k-textbox\" data-bind=\"value: from, enabled: isNumber\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.max #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.max #\" placeholder=\"e.g. 100\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForNumber\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isText\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isText\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isDate\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.start #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.start #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isDate\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.end #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.end #\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForDate\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isCustom\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isCustom\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isList\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isList\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isList\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"showButton\" id=\"showButton\" class=\"k-checkbox\" data-bind=\"checked: showButton\"/>' + '<label for=\"showButton\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.showListButton #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"visible: isDate\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"showButton\" id=\"showButton\" class=\"k-checkbox\" data-bind=\"checked: showButton\"/>' + '<label for=\"showButton\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.showCalendarButton #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"ignoreBlank\" id=\"ignoreBlank\" class=\"k-checkbox\" data-bind=\"checked: ignoreBlank\"/>' + '<label for=\"ignoreBlank\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.ignoreBlank #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-action-buttons\"></div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.onInvalidData #:</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"radio\" id=\"validationTypeReject\" name=\"validationType\" value=\"reject\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeReject\" class=\"k-radio-label\">' + '#: messages.validationDialog.labels.rejectInput #' + '</label> ' + '<input type=\"radio\" id=\"validationTypeWarning\" name=\"validationType\" value=\"warning\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeWarning\" class=\"k-radio-label\">' + '#: messages.validationDialog.labels.showWarning #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\" class=\"hint-wrapper\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"useCustomMessages\" id=\"useCustomMessages\" class=\"k-checkbox\" data-bind=\"checked: useCustomMessages\" />' + '<label class=\"k-checkbox-label\" for=\"useCustomMessages\">' + ' #: messages.validationDialog.labels.showHint #' + '</label>' + '</div>' + '<div data-bind=\"visible: useCustomMessages\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.hintTitle #:</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" placeholder=\"#: messages.validationDialog.placeholders.typeTitle #\" data-bind=\"value: hintTitle\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.hintMessage #:</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" placeholder=\"#: messages.validationDialog.placeholders.typeMessage #\" data-bind=\"value: hintMessage\" />' + '</div>' + '</div>' + '</div>' + '<div class=\"k-action-buttons\">' + '<button class=\"k-button\" data-bind=\"visible: showRemove, click: remove\">#: messages.remove #</button>' + '<button class=\"k-button k-primary\" data-bind=\"click: apply\">#: messages.apply #</button>' + '<button class=\"k-button\" data-bind=\"click: close\">#: messages.cancel #</button>' + '</div>' + '</div>'\n            },\n            open: function (range) {\n                var options = this.options;\n                var element;\n                this.viewModel = new ValidationViewModel({\n                    type: options.type,\n                    defaultHintMessage: options.hintMessage,\n                    defaultHintTitle: options.hintTitle,\n                    defaultComparers: options.comparers.slice(0),\n                    comparerMessages: options.comparerMessages,\n                    criteria: options.criteria.slice(0),\n                    criterion: options.criterion,\n                    ignoreBlank: options.ignoreBlank,\n                    showButton: options.showButton,\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    remove: this.remove.bind(this)\n                });\n                this.viewModel.update(range.validation());\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                if (this.validatable) {\n                    this.validatable.destroy();\n                }\n                kendo.bind(element, this.viewModel);\n                this.validatable = new kendo.ui.Validator(element.find('.k-edit-form-container'), {\n                    validateOnBlur: false,\n                    errorTemplate: this.options.errorTemplate || undefined\n                });\n            },\n            apply: function () {\n                if (this.validatable.validate()) {\n                    SpreadsheetDialog.fn.apply.call(this);\n                    this.trigger('action', {\n                        command: 'EditValidationCommand',\n                        options: { value: this.viewModel.toValidationObject() }\n                    });\n                }\n            },\n            remove: function () {\n                this.viewModel.set('criterion', 'any');\n                this.apply();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('validation', ValidationDialog);\n        kendo.spreadsheet.dialogs.ValidationDialog = ValidationDialog;\n        var ExportAsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.exportAsDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this.viewModel = kendo.observable({\n                    title: this.options.title,\n                    name: this.options.name,\n                    extension: this.options.extension,\n                    fileFormats: this.options.fileFormats,\n                    excel: options.excelExport,\n                    pdf: {\n                        proxyURL: options.pdfExport.proxyURL,\n                        forceProxy: options.pdfExport.forceProxy,\n                        title: options.pdfExport.title,\n                        author: options.pdfExport.author,\n                        subject: options.pdfExport.subject,\n                        keywords: options.pdfExport.keywords,\n                        creator: options.pdfExport.creator,\n                        date: options.pdfExport.date,\n                        fitWidth: this.options.pdf.fitWidth,\n                        area: this.options.pdf.area,\n                        areas: this.options.pdf.areas,\n                        paperSize: this.options.pdf.paperSize,\n                        paperSizes: this.options.pdf.paperSizes,\n                        margin: this.options.pdf.margin,\n                        margins: this.options.pdf.margins,\n                        landscape: this.options.pdf.landscape,\n                        guidelines: this.options.pdf.guidelines,\n                        hCenter: this.options.pdf.hCenter,\n                        vCenter: this.options.pdf.vCenter\n                    },\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                var dialog = this.dialog();\n                this.viewModel.bind('change', function (e) {\n                    if (e.field === 'extension') {\n                        this.set('showPdfOptions', this.extension === '.pdf' ? true : false);\n                        dialog.center();\n                    }\n                });\n                kendo.bind(dialog.element, this.viewModel);\n            },\n            options: {\n                name: 'Workbook',\n                extension: '.xlsx',\n                fileFormats: [\n                    {\n                        description: 'Excel Workbook (.xlsx)',\n                        extension: '.xlsx'\n                    },\n                    {\n                        description: 'Portable Document Format(.pdf)',\n                        extension: '.pdf'\n                    }\n                ],\n                pdf: {\n                    fitWidth: true,\n                    area: 'workbook',\n                    areas: [\n                        {\n                            area: 'workbook',\n                            text: 'Entire Workbook'\n                        },\n                        {\n                            area: 'sheet',\n                            text: 'Active Sheet'\n                        },\n                        {\n                            area: 'selection',\n                            text: 'Selection'\n                        }\n                    ],\n                    paperSize: 'a4',\n                    paperSizes: [\n                        {\n                            value: 'a2',\n                            text: 'A2 (420 mm \\xD7 594 mm)     '\n                        },\n                        {\n                            value: 'a3',\n                            text: 'A3 (297 mm x 420 mm)     '\n                        },\n                        {\n                            value: 'a4',\n                            text: 'A4 (210 mm x 297 mm)     '\n                        },\n                        {\n                            value: 'a5',\n                            text: 'A5 (148 mm x 210 mm)     '\n                        },\n                        {\n                            value: 'b3',\n                            text: 'B3 (353 mm \\xD7 500 mm)     '\n                        },\n                        {\n                            value: 'b4',\n                            text: 'B4 (250 mm x 353 mm)     '\n                        },\n                        {\n                            value: 'b5',\n                            text: 'B5 (176 mm x 250 mm)     '\n                        },\n                        {\n                            value: 'folio',\n                            text: 'Folio (8.5\" x 13\")       '\n                        },\n                        {\n                            value: 'legal',\n                            text: 'Legal (8.5\" x 14\")       '\n                        },\n                        {\n                            value: 'letter',\n                            text: 'Letter (8.5\" x 11\")      '\n                        },\n                        {\n                            value: 'tabloid',\n                            text: 'Tabloid (11\" x 17\")      '\n                        },\n                        {\n                            value: 'executive',\n                            text: 'Executive (7.25\" x 10.5\")'\n                        }\n                    ],\n                    margin: {\n                        bottom: '0.75in',\n                        left: '0.7in',\n                        right: '0.7in',\n                        top: '0.75in'\n                    },\n                    margins: [\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.7in',\n                                right: '0.7in',\n                                top: '0.75in'\n                            },\n                            text: 'Normal'\n                        },\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.25in',\n                                right: '0.25in',\n                                top: '0.75in'\n                            },\n                            text: 'Narrow'\n                        },\n                        {\n                            value: {\n                                bottom: '1in',\n                                left: '1in',\n                                right: '1in',\n                                top: '1in'\n                            },\n                            text: 'Wide'\n                        }\n                    ],\n                    landscape: true,\n                    guidelines: true,\n                    hCenter: true,\n                    vCenter: true\n                },\n                width: 520,\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.fileName #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-textbox\\' data-bind=\\'value: name\\' />' + '</div>' + '<div >' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.saveAsType #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'extension\\' ' + 'data-bind=\\'value: extension, source: fileFormats\\' />' + '</div>' + '</div>' + '<div class=\\'export-config\\' data-bind=\\'visible: showPdfOptions\\'>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.exportArea #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'area\\' ' + 'data-bind=\\'value: pdf.area, source: pdf.areas\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.paperSize#:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.paperSize, source: pdf.paperSizes\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.margins #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-value-primitive=\\'true\\'' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.margin, source: pdf.margins\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.orientation #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input type=\\'radio\\' id=\\'k-orientation-portrait\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'false\\' /><label class=\\'k-orientation-label k-orientation-portrait-label\\' for=\\'k-orientation-portrait\\'></label>' + '<input type=\\'radio\\' id=\\'k-orientation-landscape\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'true\\' /><label class=\\'k-orientation-label k-orientation-landscape-label\\' for=\\'k-orientation-landscape\\'></label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.print #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'guidelines\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.guidelines\\'/><label class=\\'k-checkbox-label\\' for=\\'guidelines\\'>#: messages.exportAsDialog.labels.guidelines#</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.scale #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'fitWidth\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.fitWidth\\'/><label class=\\'k-checkbox-label\\' for=\\'fitWidth\\'>#: messages.exportAsDialog.labels.fit #</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.center #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'hCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.hCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'hCenter\\'>#: messages.exportAsDialog.labels.horizontally #</label>' + '<input class=\\'k-checkbox\\' id=\\'vCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.vCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'vCenter\\'>#: messages.exportAsDialog.labels.vertically #</label>' + '</div>' + '<div class=\\'k-page-orientation\\' data-bind=\\'css: {k-page-landscape: pdf.landscape}\\'>' + '<div class=\\'k-margins-horizontal\\'></div>' + '<div class=\\'k-margins-vertical\\'></div>' + '</div>' + '</div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.save #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'SaveAsCommand',\n                    options: this.viewModel\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('exportAs', ExportAsDialog);\n        function basicErrorDialog(id, msg) {\n            kendo.spreadsheet.dialogs.register(id, MessageDialog.extend({ options: { messageId: msg } }));\n        }\n        basicErrorDialog('modifyMerged', 'modifyMergedDialog.errorMessage');\n        basicErrorDialog('rangeDisabled', 'rangeDisabledDialog.errorMessage');\n        basicErrorDialog('overflow', 'overflowDialog.errorMessage');\n        basicErrorDialog('unsupportedSelection', 'unsupportedSelectionDialog.errorMessage');\n        basicErrorDialog('incompatibleRanges', 'incompatibleRangesDialog.errorMessage');\n        basicErrorDialog('noFillDirection', 'noFillDirectionDialog.errorMessage');\n        basicErrorDialog('duplicateSheetName', 'duplicateSheetNameDialog.errorMessage');\n        var ImportErrorDialog = MessageDialog.extend({\n            options: {\n                width: 640,\n                title: 'Errors in import',\n                template: '<div class=\\'k-spreadsheet-message-content k-spreadsheet-import-errors\\'>' + '<div class=\\'k--header-message\\'>We encountered #= errors.length # errors while reading this file.  Please be aware that some formulas might be missing, or contain invalid results.</div>' + '<div class=\\'k--errors\\'>' + '<table>' + '<thead>' + '<tr><th>Context</th><th>Error message</th></tr>' + '</thead>' + '# for (var i = 0; i < errors.length; ++i) { #' + '# var err = errors[i]; #' + '<tr><td>#: err.context #</td><td>#: err.error #</td></tr>' + '# } #' + '</table>' + '</div>' + '</div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#: messages.okText #' + '</button>' + '</div>'\n            }\n        });\n        kendo.spreadsheet.dialogs.register('importError', ImportErrorDialog);\n        var UseKeyboardDialog = MessageDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.useKeyboardDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n            },\n            options: { template: '#: messages.useKeyboardDialog.errorMessage #' + '<div>Ctrl+C #: messages.useKeyboardDialog.labels.forCopy #</div>' + '<div>Ctrl+X #: messages.useKeyboardDialog.labels.forCut #</div>' + '<div>Ctrl+V #: messages.useKeyboardDialog.labels.forPaste #</div>' + '<div class=\"k-action-buttons\">' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#= messages.okText #' + '</button>' + '</div>' }\n        });\n        kendo.spreadsheet.dialogs.register('useKeyboard', UseKeyboardDialog);\n        var HyperlinkDialog = SpreadsheetDialog.extend({\n            options: {\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.linkDialog.labels.url #:</label></div>' + '<div class=\\'k-edit-field\\'><input class=\\'k-textbox\\' data-bind=\\'value: url\\' /></div>' + '<div class=\\'k-action-buttons\\'>' + ('<button style=\\'float: left\\' class=\\'k-button\\' data-bind=\\'click: remove\\'>#= messages.linkDialog.labels.removeLink #</button>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#= messages.okText #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: cancel\\'>#= messages.cancel #</button>') + '</div>',\n                title: MESSAGES.linkDialog.title,\n                autoFocus: false\n            },\n            open: function (range) {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    url: range.link(),\n                    apply: function () {\n                        if (!/\\S/.test(model.url)) {\n                            model.url = null;\n                        }\n                        self.trigger('action', {\n                            command: 'HyperlinkCommand',\n                            options: { link: model.url }\n                        });\n                        self.close();\n                    },\n                    remove: function () {\n                        model.url = null;\n                        model.apply();\n                    },\n                    cancel: self.close.bind(self)\n                });\n                kendo.bind(element, model);\n                element.find('input').focus().on('keydown', function (ev) {\n                    if (ev.keyCode == 13) {\n                        model.url = $(this).val();\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.apply();\n                    } else if (ev.keyCode == 27) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.cancel();\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('hyperlink', HyperlinkDialog);\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetbinder', [\n        'kendo.core',\n        'kendo.data',\n        'spreadsheet/sheet'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var identity = function (o) {\n            return o;\n        };\n        var SheetDataSourceBinder = kendo.Class.extend({\n            init: function (options) {\n                this.options = $.extend({}, this.options, options);\n                this.columns = this._normalizeColumns(this.options.columns);\n                this._sheet();\n                this._dataSource();\n                this._header();\n                this._boundRowsCount = 0;\n                this.dataSource.fetch();\n            },\n            _sheet: function () {\n                this.sheet = this.options.sheet;\n                this._sheetChangeHandler = this._sheetChange.bind(this);\n                this._sheetDeleteRowHandler = this._sheetDeleteRow.bind(this);\n                this._sheetInsertRowHandler = this._sheetInsertRow.bind(this);\n                this.sheet.bind('change', this._sheetChangeHandler).bind('afterDeleteRow', this._sheetDeleteRowHandler).bind('afterInsertRow', this._sheetInsertRowHandler);\n            },\n            _sheetInsertRow: function (e) {\n                if (e.index !== undefined) {\n                    this.dataSource.insert(Math.max(e.index - 1, 0), {});\n                }\n            },\n            _sheetDeleteRow: function (e) {\n                if (e.index !== undefined) {\n                    var dataSource = this.dataSource;\n                    var model = dataSource.view()[e.index - 1];\n                    if (model) {\n                        dataSource.remove(model);\n                    }\n                }\n            },\n            _header: function () {\n                this.sheet.batch(function () {\n                    this.columns.forEach(function (column, index) {\n                        this.sheet.range(0, index).value(column.title);\n                    }.bind(this));\n                }.bind(this));\n            },\n            _sheetChange: function (e) {\n                if (e.insertRow || e.deleteRow) {\n                    return;\n                }\n                if (e.recalc && e.ref) {\n                    var dataSource = this.dataSource;\n                    var data = dataSource.view();\n                    var columns = this.columns;\n                    var fields;\n                    if (dataSource.reader.model) {\n                        fields = dataSource.reader.model.fields;\n                    }\n                    if (!columns.length && data.length) {\n                        columns = Object.keys(data[0].toJSON());\n                    }\n                    var getters = columns.map(function (column) {\n                        var field = column.field;\n                        if (field && fields && fields[field] && fields[field].type == 'date') {\n                            return kendo.spreadsheet.numberToDate;\n                        }\n                        return identity;\n                    });\n                    this._skipRebind = true;\n                    var normalizedRef = this.sheet._grid.normalize(e.ref);\n                    var values = this.sheet.range(normalizedRef).values();\n                    normalizedRef.forEach(function (ref) {\n                        ref = ref.toRangeRef();\n                        var record;\n                        var valueIndex = 0;\n                        for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                            record = data[ri - 1];\n                            if (!record) {\n                                record = dataSource.insert(ri - 1, {});\n                                data = dataSource.view();\n                            }\n                            var colValueIndex = 0;\n                            for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col && ci < columns.length; ci++) {\n                                record.set(columns[ci].field, getters[ci](values[valueIndex][colValueIndex++]));\n                            }\n                            valueIndex++;\n                        }\n                    });\n                    this._boundRowsCount = dataSource.view().length;\n                    this._skipRebind = false;\n                }\n            },\n            _normalizeColumns: function (columns) {\n                return columns.map(function (column) {\n                    var field = column.field || column;\n                    return {\n                        field: field,\n                        title: column.title || field\n                    };\n                });\n            },\n            _dataSource: function () {\n                var options = this.options;\n                var dataSource = options.dataSource;\n                dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n                if (this.dataSource && this._changeHandler) {\n                    this.dataSource.unbind('change', this._changeHandler);\n                } else {\n                    this._changeHandler = this._change.bind(this);\n                }\n                this.dataSource = kendo.data.DataSource.create(dataSource).bind('change', this._changeHandler);\n            },\n            _change: function () {\n                if (this._skipRebind) {\n                    return;\n                }\n                var data = this.dataSource.view();\n                var columns = this.columns;\n                if (!columns.length && data.length) {\n                    this.columns = columns = this._normalizeColumns(Object.keys(data[0].toJSON()));\n                    this._header();\n                }\n                var getters = columns.map(function (column) {\n                    return kendo.getter(column.field);\n                });\n                this.sheet.batch(function () {\n                    var length = Math.max(data.length, this._boundRowsCount);\n                    for (var idx = 0; idx < length; idx++) {\n                        for (var getterIdx = 0; getterIdx < getters.length; getterIdx++) {\n                            var value = data[idx] ? getters[getterIdx](data[idx]) : null;\n                            this.sheet.range(idx + 1, getterIdx).value(value);\n                        }\n                    }\n                }.bind(this));\n                this._boundRowsCount = data.length;\n            },\n            destroy: function () {\n                this.dataSource.unbind('change', this._changeHandler);\n                this.sheet.unbind('change', this._sheetChangeHandler).unbind('deleteRow', this._sheetDeleteRowHandler).unbind('insertRow', this._sheetInsertRowHandler);\n            },\n            options: { columns: [] }\n        });\n        kendo.spreadsheet.SheetDataSourceBinder = SheetDataSourceBinder;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filtermenu', [\n        'kendo.core',\n        'kendo.popup',\n        'kendo.treeview',\n        'kendo.numerictextbox',\n        'kendo.datepicker',\n        'kendo.datetimepicker'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var classNames = {\n            details: 'k-details',\n            button: 'k-button',\n            detailsSummary: 'k-details-summary',\n            detailsContent: 'k-details-content',\n            icon: 'k-icon',\n            iconCollapse: 'k-i-arrow-45-down-right',\n            iconExpand: 'k-i-arrow-60-right',\n            iconSearch: 'k-i-zoom',\n            textbox: 'k-textbox',\n            wrapper: 'k-spreadsheet-filter-menu',\n            filterByCondition: 'k-spreadsheet-condition-filter',\n            filterByValue: 'k-spreadsheet-value-filter',\n            valuesTreeViewWrapper: 'k-spreadsheet-value-treeview-wrapper',\n            actionButtons: 'k-action-buttons'\n        };\n        var Details = Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.details);\n                this._summary = this.element.find('.' + FilterMenu.classNames.detailsSummary).on('click', this._toggle.bind(this));\n                var iconClass = options.expanded ? FilterMenu.classNames.iconCollapse : FilterMenu.classNames.iconExpand;\n                this._icon = $('<span />', { 'class': FilterMenu.classNames.icon + ' ' + iconClass }).prependTo(this._summary);\n                this._container = kendo.wrap(this._summary.next(), true);\n                if (!options.expanded) {\n                    this._container.hide();\n                }\n            },\n            options: { name: 'Details' },\n            events: ['toggle'],\n            visible: function () {\n                return this.options.expanded;\n            },\n            toggle: function (show) {\n                var animation = kendo.fx(this._container).expand('vertical');\n                animation.stop()[show ? 'reverse' : 'play']();\n                this._icon.toggleClass(FilterMenu.classNames.iconExpand, show).toggleClass(FilterMenu.classNames.iconCollapse, !show);\n                this.options.expanded = !show;\n            },\n            _toggle: function () {\n                var show = this.visible();\n                this.toggle(show);\n                this.trigger('toggle', { show: show });\n            }\n        });\n        var FILTERMENU_MESSAGES = kendo.spreadsheet.messages.filterMenu = {\n            sortAscending: 'Sort range A to Z',\n            sortDescending: 'Sort range Z to A',\n            filterByValue: 'Filter by value',\n            filterByCondition: 'Filter by condition',\n            apply: 'Apply',\n            search: 'Search',\n            addToCurrent: 'Add to current selection',\n            clear: 'Clear',\n            blanks: '(Blanks)',\n            operatorNone: 'None',\n            and: 'AND',\n            or: 'OR',\n            operators: {\n                string: {\n                    contains: 'Text contains',\n                    doesnotcontain: 'Text does not contain',\n                    startswith: 'Text starts with',\n                    endswith: 'Text ends with',\n                    matches: 'Text matches',\n                    doesnotmatch: 'Text does not match'\n                },\n                date: {\n                    eq: 'Date is',\n                    neq: 'Date is not',\n                    lt: 'Date is before',\n                    gt: 'Date is after'\n                },\n                number: {\n                    eq: 'Is equal to',\n                    neq: 'Is not equal to',\n                    gte: 'Is greater than or equal to',\n                    gt: 'Is greater than',\n                    lte: 'Is less than or equal to',\n                    lt: 'Is less than'\n                }\n            }\n        };\n        kendo.data.binders.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (element, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, element, bindings, options);\n                this._change = $.proxy(this.change, this);\n                $(this.element).on('change', this._change);\n            },\n            refresh: function () {\n                var that = this, value = that.bindings.spreadsheetFilterValue.get();\n                $(that.element).val(value instanceof Date ? '' : value);\n            },\n            change: function () {\n                var value = this.element.value;\n                this.bindings.spreadsheetFilterValue.set(value);\n            }\n        });\n        kendo.data.binders.widget.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (widget, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, widget.element[0], bindings, options);\n                this.widget = widget;\n                this._change = $.proxy(this.change, this);\n                this.widget.first('change', this._change);\n            },\n            refresh: function () {\n                var binding = this.bindings.spreadsheetFilterValue, value = binding.get(), type = $(this.widget.element).data('filterType');\n                if (type === 'date' && value instanceof Date || type === 'number' && !isNaN(value)) {\n                    this.widget.value(value);\n                } else {\n                    this.widget.value(null);\n                }\n            },\n            change: function () {\n                var value = this.widget.value(), binding = this.bindings.spreadsheetFilterValue;\n                binding.set(value);\n            }\n        });\n        var templates = {\n            filterByValue: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByValue #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div class=\\'k-textbox k-space-right\\'>' + '<input placeholder=\\'#= messages.search #\\' data-#=ns#bind=\\'events: { input: filterValues }\\' />' + '<span class=\\'k-icon k-i-zoom\\' />' + '</div>' + '<div data-#=ns#bind=\\'visible: hasActiveSearch\\'><input class=\\'k-checkbox\\' type=\\'checkbox\\' data-#=ns#bind=\\'checked: appendToSearch\\' id=\\'_#=guid#\\' /><label class=\\'k-checkbox-label\\' for=\\'_#=guid#\\'>#= messages.addToCurrent #</label></div>' + '<div class=\\'' + classNames.valuesTreeViewWrapper + '\\'>' + '<div data-#=ns#role=\\'treeview\\' ' + 'data-#=ns#checkboxes=\\'{ checkChildren: true }\\' ' + 'data-#=ns#bind=\\'source: valuesDataSource, events: { check: valuesChange, select: valueSelect }\\' ' + '/>' + '</div>' + '</div>',\n            filterByCondition: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByCondition #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div>' + '<select ' + 'data-#=ns#role=\"dropdownlist\"' + 'data-#=ns#bind=\"value: operator, source: operators, events: { change: operatorChange } \"' + 'data-value-primitive=\"false\"' + 'data-option-label=\"#=messages.operatorNone#\"' + 'data-height=\"auto\"' + 'data-text-field=\"text\"' + 'data-value-field=\"unique\">' + '</select>' + '</div>' + '<div data-#=ns#bind=\"visible: isString\">' + '<input data-filter-type=\"string\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" class=\"k-textbox\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isNumber\">' + '<input data-filter-type=\"number\" data-#=ns#role=\"numerictextbox\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isDate\">' + '<input data-filter-type=\"date\" data-#=ns#role=\"datepicker\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '</div>',\n            menuItem: '<li data-command=\\'#=command#\\' data-dir=\\'#=dir#\\'>' + '<span class=\\'k-icon k-i-#=iconClass#\\'></span>#=text#' + '</li>',\n            actionButtons: '<button data-#=ns#bind=\\'click: apply\\' class=\\'k-button k-primary\\'>#=messages.apply#</button>' + '<button data-#=ns#bind=\\'click: clear\\' class=\\'k-button\\'>#=messages.clear#</button>'\n        };\n        function distinctValues(values) {\n            var hash = {};\n            var result = [];\n            for (var i = 0; i < values.length; i++) {\n                if (!hash[values[i].value]) {\n                    hash[values[i].value] = values[i];\n                    result.push(values[i]);\n                } else if (!hash[values[i].value].checked && values[i].checked) {\n                    hash[values[i].value].checked = true;\n                }\n            }\n            return result;\n        }\n        function filter(dataSource, query) {\n            var hasVisibleChildren = false;\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                var text = item.text.toString().toLowerCase();\n                var itemVisible = query === true || query === '' || text.indexOf(query) >= 0;\n                var anyVisibleChildren = filter(item.children, itemVisible || query);\n                hasVisibleChildren = hasVisibleChildren || anyVisibleChildren || itemVisible;\n                item.hidden = !itemVisible && !anyVisibleChildren;\n                item.checked = !item.hidden;\n            }\n            if (data) {\n                dataSource.filter({\n                    field: 'hidden',\n                    operator: 'neq',\n                    value: true\n                });\n            }\n            return hasVisibleChildren;\n        }\n        function uncheckAll(dataSource) {\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                item.checked = false;\n                if (item.hasChildren) {\n                    uncheckAll(item.children);\n                }\n            }\n        }\n        var FilterMenuViewModel = kendo.spreadsheet.FilterMenuViewModel = kendo.data.ObservableObject.extend({\n            valuesChange: function (e) {\n                var dataSource = e ? e.sender.dataSource : this.valuesDataSource;\n                var checked = function (item) {\n                    return item.checked;\n                };\n                var value = function (item) {\n                    return item.dataType === 'date' ? kendo.spreadsheet.dateToNumber(item.value) : item.value;\n                };\n                var unique = function (value, index, array) {\n                    return array.lastIndexOf(value) === index;\n                };\n                var data = dataSource.data();\n                var values = data[0].children.data().toJSON();\n                var blanks = values.filter(function (item) {\n                    return item.dataType === 'blank';\n                });\n                blanks = blanks.length ? blanks[0].checked : false;\n                values = values.filter(checked).map(value);\n                if (this.appendToSearch && this.valueFilter && this.valueFilter.values.length) {\n                    values = values.concat(this.valueFilter.values.toJSON()).sort().filter(unique);\n                }\n                this.set('valueFilter', {\n                    values: values,\n                    blanks: blanks\n                });\n            },\n            valueSelect: function (e) {\n                e.preventDefault();\n                var node = e.sender.dataItem(e.node);\n                node.set('checked', !node.checked);\n            },\n            hasActiveSearch: false,\n            appendToSearch: false,\n            filterValues: function (e) {\n                var query = typeof e == 'string' ? e : $(e.target).val().toLowerCase();\n                var dataSource = this.valuesDataSource;\n                this.set('hasActiveSearch', !!query);\n                uncheckAll(dataSource);\n                filter(dataSource, query);\n            },\n            reset: function () {\n                this.set('customFilter', {\n                    logic: 'and',\n                    criteria: [{\n                            operator: null,\n                            value: null\n                        }]\n                });\n                this.set('valueFilter', { values: [] });\n            },\n            operatorChange: function (e) {\n                var dataItem = e.sender.dataItem();\n                this.set('operatorType', dataItem.type);\n                this.set('customFilter.criteria[0].operator', dataItem.value);\n            },\n            isNone: function () {\n                return this.get('operatorType') === undefined;\n            },\n            isString: function () {\n                return this.get('operatorType') === 'string';\n            },\n            isNumber: function () {\n                return this.get('operatorType') === 'number';\n            },\n            isDate: function () {\n                return this.get('operatorType') === 'date';\n            }\n        });\n        function flattenOperators(operators) {\n            var messages = FILTERMENU_MESSAGES.operators;\n            var result = [];\n            for (var type in operators) {\n                if (!operators.hasOwnProperty(type)) {\n                    continue;\n                }\n                for (var operator in operators[type]) {\n                    if (!operators[type].hasOwnProperty(operator)) {\n                        continue;\n                    }\n                    result.push({\n                        text: messages[type][operator],\n                        value: operator,\n                        unique: type + '_' + operator,\n                        type: type\n                    });\n                }\n            }\n            return result;\n        }\n        var FilterMenuController = kendo.spreadsheet.FilterMenuController = {\n            valuesTree: function (range, column) {\n                return [{\n                        text: 'All',\n                        expanded: true,\n                        checked: true,\n                        items: this.values(range.resize({ top: 1 }), column)\n                    }];\n            },\n            values: function (range, column) {\n                var values = [];\n                var messages = FILTERMENU_MESSAGES;\n                var columnRange = range.column(column);\n                var sheet = range.sheet();\n                columnRange.forEachCell(function (row, col, cell) {\n                    if (sheet.isHiddenRow(row)) {\n                        return;\n                    }\n                    var value = cell.value;\n                    var dataType = cell.dataType;\n                    var text = cell.text;\n                    if (value === undefined) {\n                        dataType = 'blank';\n                    } else if (cell.format) {\n                        dataType = kendo.spreadsheet.formatting.type(value, cell.format);\n                    } else {\n                        dataType = typeof value;\n                    }\n                    if (value !== null && cell.format) {\n                        text = kendo.spreadsheet.formatting.text(value, cell.format);\n                    } else {\n                        text = dataType == 'blank' ? messages.blanks : value;\n                    }\n                    if (dataType === 'percent') {\n                        dataType = 'number';\n                    }\n                    if (dataType === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                    values.push({\n                        dataType: dataType,\n                        value: value,\n                        text: text,\n                        checked: true\n                    });\n                });\n                values = distinctValues(values);\n                values.sort(function (a, b) {\n                    if (a.dataType === b.dataType) {\n                        return 0;\n                    }\n                    if (a.dataType === 'blank' || b.dataType === 'blank') {\n                        return a.dataType === 'blank' ? -1 : 1;\n                    }\n                    if (a.dataType === 'number' || b.dataType === 'number') {\n                        return a.dataType === 'number' ? -1 : 1;\n                    }\n                    if (a.dataType === 'date' || b.dataType === 'date') {\n                        return a.dataType === 'date' ? -1 : 1;\n                    }\n                    return 0;\n                });\n                return values;\n            },\n            filterType: function (range, column) {\n                var sheet = range.sheet();\n                var filter = this.filterForColumn(column, sheet);\n                var type;\n                filter = filter && filter.filter.toJSON();\n                if (filter && filter.filter == 'custom') {\n                    var value = filter.criteria[0].value;\n                    if (value instanceof Date) {\n                        type = 'date';\n                    } else if (typeof value == 'string') {\n                        type = 'string';\n                    } else if (typeof value == 'number') {\n                        type = 'number';\n                    }\n                }\n                if (!type) {\n                    var topValue = this.values(range.row(1), column)[0];\n                    type = topValue && topValue.dataType;\n                    if (type == 'blank') {\n                        type = null;\n                    }\n                }\n                return type;\n            },\n            filterForColumn: function (column, sheet) {\n                var allFilters = sheet.filter();\n                var filters;\n                if (allFilters) {\n                    filters = allFilters.columns.filter(function (item) {\n                        return item.index === column;\n                    })[0];\n                }\n                return filters;\n            },\n            filter: function (column, sheet) {\n                var columnFilters = this.filterForColumn(column, sheet);\n                if (!columnFilters) {\n                    return;\n                }\n                var options = columnFilters.filter.toJSON();\n                var type = options.filter;\n                delete options.filter;\n                var result = {\n                    type: type,\n                    options: options\n                };\n                var criteria = options.criteria;\n                if (criteria && criteria.length) {\n                    result.operator = criteria[0].operator;\n                }\n                return result;\n            }\n        };\n        var FilterMenu = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.wrapper);\n                this.viewModel = new FilterMenuViewModel({\n                    active: 'value',\n                    operator: null,\n                    operators: flattenOperators(this.options.operators),\n                    clear: this.clear.bind(this),\n                    apply: this.apply.bind(this)\n                });\n                this._filterInit();\n                this._popup();\n                this._sort();\n                this._filterByCondition();\n                this._filterByValue();\n                this._actionButtons();\n            },\n            options: {\n                name: 'FilterMenu',\n                column: 0,\n                range: null,\n                operators: {\n                    string: {\n                        contains: 'Text contains',\n                        doesnotcontain: 'Text does not contain',\n                        startswith: 'Text starts with',\n                        endswith: 'Text ends with',\n                        matches: 'Text matches',\n                        doesnotmatch: 'Text does not match'\n                    },\n                    date: {\n                        eq: 'Date is',\n                        neq: 'Date is not',\n                        lt: 'Date is before',\n                        gt: 'Date is after'\n                    },\n                    number: {\n                        eq: 'Is equal to',\n                        neq: 'Is not equal to',\n                        gte: 'Is greater than or equal to',\n                        gt: 'Is greater than',\n                        lte: 'Is less than or equal to',\n                        lt: 'Is less than'\n                    }\n                }\n            },\n            events: ['action'],\n            destroy: function () {\n                Widget.fn.destroy.call(this);\n                this.menu.destroy();\n                this.valuesTreeView.destroy();\n                this.popup.destroy();\n            },\n            openFor: function (anchor) {\n                this.popup.setOptions({ anchor: anchor });\n                this.popup.open();\n            },\n            close: function () {\n                this.popup.close();\n            },\n            clear: function () {\n                this.action({\n                    command: 'ClearFilterCommand',\n                    options: { column: this.options.column }\n                });\n                this.viewModel.reset();\n                this.close();\n            },\n            apply: function () {\n                this._active();\n                var options = {\n                    operatingRange: this.options.range,\n                    column: this.options.column\n                };\n                var valueFilter;\n                var customFilter;\n                if (this.viewModel.active === 'value') {\n                    this.viewModel.valuesChange({ sender: this.valuesTreeView });\n                    valueFilter = this.viewModel.valueFilter.toJSON();\n                    if (valueFilter.blanks || valueFilter.values && valueFilter.values.length) {\n                        options.valueFilter = valueFilter;\n                    }\n                } else if (this.viewModel.active === 'custom') {\n                    customFilter = this.viewModel.customFilter.toJSON();\n                    if (customFilter.criteria.length && customFilter.criteria[0].value !== null) {\n                        options.customFilter = customFilter;\n                    }\n                }\n                if (options.valueFilter || options.customFilter) {\n                    this.action({\n                        command: 'ApplyFilterCommand',\n                        options: options\n                    });\n                }\n            },\n            action: function (options) {\n                this.trigger('action', $.extend({}, options));\n            },\n            _filterInit: function () {\n                var column = this.options.column;\n                var range = this.options.range;\n                var sheet = range.sheet();\n                var activeFilter = FilterMenuController.filter(column, sheet);\n                if (activeFilter) {\n                    var filterType = FilterMenuController.filterType(range, column);\n                    this.viewModel.set('active', activeFilter.type);\n                    this.viewModel.set(activeFilter.type + 'Filter', activeFilter.options);\n                    if (activeFilter.type == 'custom') {\n                        this.viewModel.set('operator', filterType + '_' + activeFilter.operator);\n                        this.viewModel.set('operatorType', filterType);\n                    }\n                } else {\n                    this.viewModel.reset();\n                }\n            },\n            _popup: function () {\n                this.popup = this.element.kendoPopup({ copyAnchorStyles: false }).data('kendoPopup');\n            },\n            _sort: function () {\n                var template = kendo.template(FilterMenu.templates.menuItem);\n                var messages = FILTERMENU_MESSAGES;\n                var items = [\n                    {\n                        command: 'sort',\n                        dir: 'asc',\n                        text: messages.sortAscending,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        command: 'sort',\n                        dir: 'desc',\n                        text: messages.sortDescending,\n                        iconClass: 'sort-desc'\n                    }\n                ];\n                var ul = $('<ul />', { 'html': kendo.render(template, items) }).appendTo(this.element);\n                this.menu = ul.kendoMenu({\n                    orientation: 'vertical',\n                    select: function (e) {\n                        var dir = $(e.item).data('dir');\n                        var range = this.options.range.resize({ top: 1 });\n                        var options = {\n                            value: dir,\n                            sheet: false,\n                            operatingRange: range,\n                            column: this.options.column\n                        };\n                        if (range.isSortable()) {\n                            this.action({\n                                command: 'SortCommand',\n                                options: options\n                            });\n                        } else {\n                            this.close();\n                        }\n                    }.bind(this)\n                }).data('kendoMenu');\n            },\n            _appendTemplate: function (template, className, details, expanded) {\n                var compiledTemplate = kendo.template(template);\n                var wrapper = $('<div class=\\'' + className + '\\'/>').html(compiledTemplate({\n                    messages: FILTERMENU_MESSAGES,\n                    guid: kendo.guid(),\n                    ns: kendo.ns\n                }));\n                this.element.append(wrapper);\n                if (details) {\n                    details = new Details(wrapper, {\n                        expanded: expanded,\n                        toggle: this._detailToggle.bind(this)\n                    });\n                }\n                kendo.bind(wrapper, this.viewModel);\n                return wrapper;\n            },\n            _detailToggle: function (e) {\n                this.element.find('[data-role=details]').not(e.sender.element).data('kendoDetails').toggle(!e.show);\n            },\n            _filterByCondition: function () {\n                var isExpanded = this.viewModel.active === 'custom';\n                this._appendTemplate(FilterMenu.templates.filterByCondition, FilterMenu.classNames.filterByCondition, true, isExpanded);\n            },\n            _filterByValue: function () {\n                var isExpanded = this.viewModel.active === 'value';\n                var wrapper = this._appendTemplate(FilterMenu.templates.filterByValue, FilterMenu.classNames.filterByValue, true, isExpanded);\n                this.valuesTreeView = wrapper.find('[data-role=treeview]').data('kendoTreeView');\n                var values = FilterMenuController.valuesTree(this.options.range, this.options.column);\n                this.viewModel.set('valuesDataSource', new kendo.data.HierarchicalDataSource({ data: values }));\n            },\n            _actionButtons: function () {\n                this._appendTemplate(FilterMenu.templates.actionButtons, FilterMenu.classNames.actionButtons, false);\n            },\n            _active: function () {\n                var activeContainer = this.element.find('[data-role=details]').filter(function (index, element) {\n                    return $(element).data('kendoDetails').visible();\n                });\n                if (activeContainer.hasClass(FilterMenu.classNames.filterByValue)) {\n                    this.viewModel.set('active', 'value');\n                } else if (activeContainer.hasClass(FilterMenu.classNames.filterByCondition)) {\n                    this.viewModel.set('active', 'custom');\n                }\n            }\n        });\n        kendo.spreadsheet.FilterMenu = FilterMenu;\n        $.extend(true, FilterMenu, {\n            classNames: classNames,\n            templates: templates\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/editor', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var SheetEditor = kendo.Observable.extend({\n            init: function (view) {\n                kendo.Observable.fn.init.call(this);\n                this.view = view;\n                this.formulaBar = view.formulaBar;\n                this._active = false;\n                this.barInput = view.formulaBar.formulaInput;\n                this.cellInput = view.formulaInput;\n                this.barInput.syncWith(this.cellInput);\n                this.cellInput.syncWith(this.barInput);\n                this.barInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.cellInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.barInput.bind('blur', this._blur.bind(this));\n                this.cellInput.bind('blur', this._blur.bind(this));\n            },\n            events: [\n                'activate',\n                'deactivate',\n                'change',\n                'update'\n            ],\n            _blur: function () {\n                this.deactivate();\n            },\n            _triggerUpdate: function () {\n                this.trigger('update', { value: this.value() });\n            },\n            activeEditor: function () {\n                var editor = null;\n                var activeElement = kendo._activeElement();\n                if (this.barElement()[0] === activeElement) {\n                    editor = this.barInput;\n                } else if (this.cellElement()[0] === activeElement) {\n                    editor = this.cellInput;\n                }\n                return editor;\n            },\n            activate: function (options) {\n                this._active = true;\n                this._rect = options.rect;\n                this.cellInput.position(options.rect);\n                this.cellInput.resize(options.rect);\n                this.cellInput.tooltip(options.tooltip);\n                this.cellInput.activeCell = this.barInput.activeCell = options.range.topLeft;\n                this.trigger('activate');\n                return this;\n            },\n            deactivate: function () {\n                var cellInput = this.cellInput;\n                if (!this._active) {\n                    return;\n                }\n                if (cellInput.value() != this._value) {\n                    this.trigger('change', { value: cellInput.value() });\n                }\n                this._active = false;\n                this._rect = null;\n                cellInput.hide();\n                this.trigger('deactivate');\n            },\n            enable: function (enable) {\n                this.barInput.enable(enable);\n                this.cellInput.enable(enable);\n            },\n            barElement: function () {\n                return this.barInput.element;\n            },\n            cellElement: function () {\n                return this.cellInput.element;\n            },\n            focus: function (inputType) {\n                inputType = inputType || 'cell';\n                if (inputType === 'cell') {\n                    this.cellInput.element.focus();\n                    this.cellInput.end();\n                } else {\n                    this.barInput.element.focus();\n                }\n            },\n            isActive: function () {\n                return this._active;\n            },\n            isFiltered: function () {\n                return this.barInput.popup.visible() || this.cellInput.popup.visible();\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var editor = this.activeEditor();\n                return editor && editor.canInsertRef(isKeyboardAction);\n            },\n            highlightedRefs: function () {\n                var editor = this.activeEditor();\n                var refs = [];\n                if (editor) {\n                    refs = editor.highlightedRefs();\n                }\n                return refs;\n            },\n            scale: function () {\n                this.cellInput.scale();\n            },\n            toggleTooltip: function (rect) {\n                this.cellInput.toggleTooltip(notEqual(this._rect, rect));\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    return this.barInput.value();\n                }\n                if (value === null) {\n                    value = '';\n                }\n                this._value = value;\n                this.barInput.value(value);\n                this.cellInput.value(value);\n            },\n            insertNewline: function () {\n                this.activeEditor().insertNewline();\n                this.scale();\n            },\n            select: function () {\n                this.activeEditor().select();\n            }\n        });\n        function notEqual(oldRect, newRect) {\n            return oldRect && (oldRect.top !== newRect.top || oldRect.left !== newRect.left);\n        }\n        kendo.spreadsheet.SheetEditor = SheetEditor;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofill', [\n        'spreadsheet/runtime',\n        'spreadsheet/range'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Range = spreadsheet.Range;\n    var runtime = spreadsheet.calc.runtime;\n    var Formula = runtime.Formula;\n    var ERR_INCOMPATIBLE = 'incompatibleRanges';\n    var ERR_NO_DIRECTION = 'noFillDirection';\n    var FillError = Range.FillError = function (msg) {\n        this.code = msg;\n    };\n    Range.prototype._previewFillFrom = function (srcRange, direction) {\n        var destRange = this, sheet = destRange._sheet;\n        if (typeof srcRange == 'string') {\n            srcRange = sheet.range(srcRange);\n        }\n        var src = srcRange._ref.toRangeRef();\n        var dest = destRange._ref.toRangeRef();\n        if (src.intersects(dest)) {\n            if (src.eq(dest)) {\n                return null;\n            }\n            dest = dest.clone();\n            if (src.topLeft.eq(dest.topLeft)) {\n                if (src.width() == dest.width()) {\n                    dest.topLeft.row += src.height();\n                    direction = 0;\n                } else if (src.height() == dest.height()) {\n                    dest.topLeft.col += src.width();\n                    direction = 1;\n                } else {\n                    throw new FillError(ERR_INCOMPATIBLE);\n                }\n            } else if (src.bottomRight.eq(dest.bottomRight)) {\n                if (src.width() == dest.width()) {\n                    dest.bottomRight.row -= src.height();\n                    direction = 2;\n                } else if (src.height() == dest.height()) {\n                    dest.bottomRight.col -= src.width();\n                    direction = 3;\n                } else {\n                    throw new FillError(ERR_INCOMPATIBLE);\n                }\n            } else {\n                throw new FillError(ERR_INCOMPATIBLE);\n            }\n            return sheet.range(dest)._previewFillFrom(srcRange, direction);\n        }\n        if (direction == null) {\n            if (src.topLeft.col == dest.topLeft.col) {\n                direction = src.topLeft.row < dest.topLeft.row ? 0 : 2;\n            } else if (src.topLeft.row == dest.topLeft.row) {\n                direction = src.topLeft.col < dest.topLeft.col ? 1 : 3;\n            } else {\n                throw new FillError(ERR_NO_DIRECTION);\n            }\n        }\n        var horizontal = direction & 1;\n        var descending = direction & 2;\n        if (horizontal && src.height() != dest.height() || !horizontal && src.width() != dest.width()) {\n            throw new FillError(ERR_INCOMPATIBLE);\n        }\n        var data = srcRange._properties(), n;\n        if (!horizontal) {\n            data = transpose(data);\n            n = dest.height();\n        } else {\n            n = dest.width();\n        }\n        var fill = new Array(data.length);\n        for (var i = 0; i < data.length; ++i) {\n            var s = data[i];\n            var f = findSeries(s);\n            var a = fill[i] = new Array(n);\n            for (var j = 0; j < n; ++j) {\n                var idx = descending ? -j - 1 : s.length + j;\n                var srcIdx = descending ? s.length - j % s.length - 1 : j % s.length;\n                a[descending ? n - j - 1 : j] = f(idx, srcIdx);\n            }\n        }\n        if (!horizontal) {\n            fill = transpose(fill);\n        }\n        return {\n            props: fill,\n            direction: direction,\n            dest: destRange\n        };\n    };\n    Range.prototype.fillFrom = function (srcRange, direction) {\n        var x = this._previewFillFrom(srcRange, direction);\n        x.dest._properties(x.props);\n        return x.dest;\n    };\n    function linearRegression(data) {\n        var N = data.length;\n        var mx = (N + 1) / 2, my = data.reduce(function (a, b) {\n                return a + b;\n            }, 0) / N;\n        var s1 = 0, s2 = 0;\n        for (var i = 0; i < N; i++) {\n            var t1 = i + 1 - mx, t2 = data[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (!s2) {\n            return function (N) {\n                return data[N % data.length];\n            };\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return function (N) {\n            return a + b * (N + 1);\n        };\n    }\n    function findSeries(properties) {\n        function findStep(a) {\n            var diff = a[1] - a[0];\n            for (var i = 2; i < a.length; ++i) {\n                if (a[i] - a[i - 1] != diff) {\n                    return null;\n                }\n            }\n            return diff;\n        }\n        function getData(a) {\n            return a.map(function (v) {\n                return v.number;\n            });\n        }\n        var series = [];\n        var data = properties.map(function (x) {\n            return x.formula || x.value;\n        });\n        forEachSeries(data, function (begin, end, type, a) {\n            var f, values;\n            if (type == 'number') {\n                values = getData(a);\n                if (values.length == 1 && (begin > 0 || end < data.length || formatType(values[0], properties[begin].format) == 'date')) {\n                    values.push(values[0] + 1);\n                }\n                f = linearRegression(values);\n            } else if (type == 'string' || type == 'formula' || type == 'boolean') {\n                f = function (N, i) {\n                    return data[i];\n                };\n            } else if (Array.isArray(type)) {\n                if (a.length == 1) {\n                    f = function (N) {\n                        return type[(a[0].number + N) % type.length];\n                    };\n                } else {\n                    var diff = findStep(getData(a));\n                    if (diff == null) {\n                        f = function (N) {\n                            return a[N % a.length].value;\n                        };\n                    } else {\n                        f = function (N) {\n                            var idx = a[0].number + diff * N;\n                            return type[idx % type.length];\n                        };\n                    }\n                }\n            } else if (type != 'null') {\n                values = getData(a);\n                if (values.length == 1) {\n                    values.push(values[0] + 1);\n                }\n                values = linearRegression(values);\n                f = function (N, i) {\n                    return data[i].replace(/^(.*\\D)\\d+/, '$1' + values(N, i));\n                };\n            } else {\n                f = function () {\n                    return null;\n                };\n            }\n            var s = {\n                f: f,\n                begin: begin,\n                end: end,\n                len: end - begin\n            };\n            for (var i = begin; i < end; ++i) {\n                series[i] = s;\n            }\n        });\n        return function (N, i) {\n            var s = series[i];\n            var q = N / data.length | 0;\n            var r = N % data.length;\n            var n = q * s.len + r - s.begin;\n            var value = s.f(n, i);\n            var props = clone(properties[i]);\n            delete props.enable;\n            if (value instanceof Formula) {\n                props.formula = value;\n            } else {\n                props.value = value;\n            }\n            return props;\n        };\n    }\n    function formatType(value, format) {\n        if (format != null) {\n            return spreadsheet.formatting.type(value, format);\n        }\n    }\n    function clone(obj) {\n        var copy = {};\n        Object.keys(obj || {}).forEach(function (key) {\n            copy[key] = obj[key];\n        });\n        return copy;\n    }\n    function forEachSeries(data, f) {\n        var prev = null, start = 0, a = [], type;\n        for (var i = 0; i < data.length; ++i) {\n            type = getType(data[i]);\n            a.push(type);\n            if (prev != null && type.type !== prev.type) {\n                f(start, i, prev.type, a.slice(start, i));\n                start = i;\n            }\n            prev = type;\n        }\n        f(start, i, prev.type, a.slice(start, i));\n    }\n    function getType(el) {\n        if (typeof el == 'number') {\n            return {\n                type: 'number',\n                number: el\n            };\n        }\n        if (typeof el == 'string') {\n            var lst = findStringList(el);\n            if (lst) {\n                return lst;\n            }\n            var m = /^(.*\\D)(\\d+)/.exec(el);\n            if (m) {\n                el = el.replace(/^(.*\\D)\\d+/, '$1-######');\n                return {\n                    type: el,\n                    match: m,\n                    number: parseFloat(m[2])\n                };\n            }\n            return { type: 'string' };\n        }\n        if (typeof el == 'boolean') {\n            return { type: 'boolean' };\n        }\n        if (el == null) {\n            return { type: 'null' };\n        }\n        if (el instanceof Formula) {\n            return { type: 'formula' };\n        }\n        window.console.error(el);\n        throw new Error('Cannot fill data');\n    }\n    function stringLists() {\n        var culture = kendo.culture();\n        return [\n            culture.calendars.standard.days.namesAbbr,\n            culture.calendars.standard.days.names,\n            culture.calendars.standard.months.namesAbbr,\n            culture.calendars.standard.months.names\n        ];\n    }\n    function findStringList(str) {\n        var strl = str.toLowerCase();\n        var lists = stringLists();\n        for (var i = 0; i < lists.length; ++i) {\n            var a = lists[i];\n            for (var j = a.length; --j >= 0;) {\n                var el = a[j].toLowerCase();\n                if (el == strl) {\n                    return {\n                        type: a,\n                        number: j,\n                        value: str\n                    };\n                }\n            }\n        }\n    }\n    function transpose(a) {\n        var height = a.length, width = a[0].length;\n        var t = [];\n        for (var i = 0; i < width; ++i) {\n            t[i] = [];\n            for (var j = 0; j < height; ++j) {\n                t[i][j] = a[j][i];\n            }\n        }\n        return t;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/nameeditor', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CLASS_NAMES = {\n            input: 'k-spreadsheet-name-editor',\n            list: 'k-spreadsheet-name-list'\n        };\n        var NameEditor = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element.addClass(CLASS_NAMES.input);\n                var dataSource = new kendo.data.DataSource({\n                    transport: {\n                        read: function (options) {\n                            var data = [];\n                            this._workbook.forEachName(function (def) {\n                                if (!def.hidden && def.value instanceof kendo.spreadsheet.Ref) {\n                                    data.push({ name: def.name });\n                                }\n                            });\n                            options.success(data);\n                        }.bind(this),\n                        cache: false\n                    }\n                });\n                this.combo = $('<input />').appendTo(element).kendoComboBox({\n                    clearButton: false,\n                    dataTextField: 'name',\n                    dataValueField: 'name',\n                    template: '#:data.name#<a class=\\'k-button-delete\\' href=\\'\\\\#\\'><span class=\\'k-icon k-i-close\\'></span></a>',\n                    dataSource: dataSource,\n                    autoBind: false,\n                    ignoreCase: true,\n                    change: this._on_listChange.bind(this),\n                    noDataTemplate: '<div></div>',\n                    open: function () {\n                        dataSource.read();\n                    }\n                }).getKendoComboBox();\n                this.combo.input.on('keydown', this._on_keyDown.bind(this)).on('focus', this._on_focus.bind(this));\n                this.combo.popup.element.addClass('k-spreadsheet-names-popup').on('mousemove', function (ev) {\n                    ev.stopPropagation();\n                }).on('click', '.k-button-delete', function (ev) {\n                    ev.preventDefault();\n                    ev.stopPropagation();\n                    var item = $(ev.target).closest('.k-item');\n                    item = this.combo.dataItem(item);\n                    this._deleteItem(item.name);\n                }.bind(this));\n            },\n            value: function (val) {\n                if (val === undefined) {\n                    return this.combo.value();\n                } else {\n                    this.combo.value(val);\n                }\n            },\n            _deleteItem: function (name) {\n                this.trigger('delete', { name: name });\n            },\n            _on_keyDown: function (ev) {\n                switch (ev.keyCode) {\n                case 27:\n                    this.combo.value(this._prevValue);\n                    this.trigger('cancel');\n                    break;\n                case 13:\n                    this.trigger('enter');\n                    break;\n                }\n            },\n            _on_focus: function () {\n                this._prevValue = this.combo.value();\n            },\n            _on_listChange: function () {\n                var name = this.combo.value();\n                if (name) {\n                    this.trigger('select', { name: name });\n                }\n            }\n        });\n        kendo.spreadsheet.NameEditor = NameEditor;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/print', [\n        'kendo.pdf',\n        'spreadsheet/sheet',\n        'spreadsheet/range',\n        'spreadsheet/references',\n        'spreadsheet/numformat',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var drawing = kendo.drawing;\n    var formatting = spreadsheet.formatting;\n    var geo = kendo.geometry;\n    var GUIDELINE_WIDTH = 0.8;\n    function distributeCoords(heights, pageHeight) {\n        var curr = 0;\n        var out = [];\n        var threshold = 0.2 * pageHeight;\n        var bottom = pageHeight;\n        heights.forEach(function (h) {\n            if (pageHeight && curr + h > bottom) {\n                if (bottom - curr < threshold) {\n                    curr = pageHeight * Math.ceil(curr / pageHeight);\n                }\n                bottom += pageHeight * Math.ceil(h / pageHeight);\n            }\n            out.push(curr);\n            curr += h;\n        });\n        out.push(curr);\n        return out;\n    }\n    function doLayout(sheet, range, options) {\n        var cells = [];\n        var rowHeights = [];\n        var colWidths = [];\n        var mergedCells = sheet._getMergedCells(range);\n        var maxRow = -1, maxCol = -1;\n        sheet.forEach(range, function (row, col, cell) {\n            var relrow = row - range.topLeft.row;\n            var relcol = col - range.topLeft.col;\n            var rh = sheet.rowHeight(row);\n            var cw = sheet.columnWidth(col);\n            if (!relcol) {\n                rowHeights.push(rh);\n            }\n            if (!relrow) {\n                colWidths.push(cw);\n            }\n            if (sheet.isHiddenColumn(col) || sheet.isHiddenRow(row) || !rh || !cw) {\n                return;\n            }\n            var nonEmpty = options.forScreen || shouldDrawCell(cell);\n            if (!(options.emptyCells || nonEmpty)) {\n                return;\n            }\n            var id = new CellRef(row, col).print();\n            if (mergedCells.secondary[id]) {\n                return;\n            }\n            if (nonEmpty) {\n                maxRow = Math.max(maxRow, relrow);\n                maxCol = Math.max(maxCol, relcol);\n            } else {\n                cell.empty = true;\n            }\n            var m = mergedCells.primary[id];\n            if (m) {\n                delete mergedCells.primary[id];\n                cell.merged = true;\n                cell.rowspan = m.height();\n                cell.colspan = m.width();\n                if (options.forScreen) {\n                    cell.width = sheet._columns.sum(m.topLeft.col, m.bottomRight.col);\n                    cell.height = sheet._rows.sum(m.topLeft.row, m.bottomRight.row);\n                }\n            } else {\n                cell.rowspan = 1;\n                cell.colspan = 1;\n            }\n            cell.row = relrow;\n            cell.col = relcol;\n            cells.push(cell);\n        });\n        rowHeights = rowHeights.slice(0, maxRow + 1);\n        colWidths = colWidths.slice(0, maxCol + 1);\n        var pageWidth = options.pageWidth;\n        var pageHeight = options.pageHeight;\n        var scaleFactor = 1;\n        if (options.fitWidth) {\n            var width = colWidths.reduce(sum, 0);\n            if (width > pageWidth) {\n                scaleFactor = pageWidth / width;\n                pageWidth /= scaleFactor;\n                pageHeight /= scaleFactor;\n            }\n        }\n        var yCoords = distributeCoords(rowHeights, pageHeight || 0);\n        var xCoords = distributeCoords(colWidths, pageWidth || 0);\n        var boxWidth = 0;\n        var boxHeight = 0;\n        cells = cells.filter(function (cell) {\n            if (cell.empty && (cell.row > maxRow || cell.col > maxCol)) {\n                return false;\n            }\n            cell.left = xCoords[cell.col];\n            cell.top = yCoords[cell.row];\n            if (cell.merged) {\n                if (!options.forScreen) {\n                    cell.right = orlast(xCoords, cell.col + cell.colspan);\n                    cell.bottom = orlast(yCoords, cell.row + cell.rowspan);\n                    cell.width = cell.right - cell.left;\n                    cell.height = cell.bottom - cell.top;\n                } else {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                }\n            } else {\n                cell.width = colWidths[cell.col];\n                cell.height = rowHeights[cell.row];\n                cell.bottom = cell.top + cell.height;\n                cell.right = cell.left + cell.width;\n            }\n            boxWidth = Math.max(boxWidth, cell.right);\n            boxHeight = Math.max(boxHeight, cell.bottom);\n            return true;\n        });\n        Object.keys(mergedCells.primary).forEach(function (id) {\n            var ref = mergedCells.primary[id];\n            sheet.forEach(ref.topLeft.toRangeRef(), function (row, col, cell) {\n                var relrow = row - range.topLeft.row;\n                var relcol = col - range.topLeft.col;\n                cell.merged = true;\n                cell.colspan = ref.height();\n                cell.rowspan = ref.width();\n                if (relrow < 0) {\n                    cell.top = -sheet._rows.sum(row, row - relrow - 1);\n                } else {\n                    cell.top = yCoords[relrow];\n                }\n                if (relcol < 0) {\n                    cell.left = -sheet._columns.sum(col, col - relcol - 1);\n                } else {\n                    cell.left = xCoords[relcol];\n                }\n                cell.height = sheet._rows.sum(ref.topLeft.row, ref.bottomRight.row);\n                cell.width = sheet._columns.sum(ref.topLeft.col, ref.bottomRight.col);\n                if (cell.height > 0 && cell.width > 0) {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                    cells.push(cell);\n                }\n            });\n        });\n        return {\n            width: boxWidth,\n            height: boxHeight,\n            cells: cells.sort(normalOrder),\n            scale: scaleFactor,\n            xCoords: xCoords,\n            yCoords: yCoords\n        };\n    }\n    function sum(a, b) {\n        return a + b;\n    }\n    function orlast(a, i) {\n        return i < a.length ? a[i] : a[a.length - 1];\n    }\n    function shouldDrawCell(cell) {\n        return cell.value != null || cell.merged || cell.background != null || cell.borderTop != null || cell.borderRight != null || cell.borderBottom != null || cell.borderLeft != null || cell.validation != null && !cell.validation.value;\n    }\n    function normalOrder(a, b) {\n        if (a.top < b.top) {\n            return -1;\n        } else if (a.top == b.top) {\n            if (a.left < b.left) {\n                return -1;\n            } else if (a.left == b.left) {\n                return 0;\n            } else {\n                return 1;\n            }\n        } else {\n            return 1;\n        }\n    }\n    function drawLayout(layout, group, options) {\n        var ncols = Math.ceil(layout.width / options.pageWidth);\n        var nrows = Math.ceil(layout.height / options.pageHeight);\n        var pageWidth = options.pageWidth / layout.scale;\n        var pageHeight = options.pageHeight / layout.scale;\n        for (var i = 0; i < ncols; ++i) {\n            for (var j = 0; j < nrows; ++j) {\n                addPage(j, i);\n            }\n        }\n        function addPage(row, col) {\n            var left = col * pageWidth;\n            var right = left + pageWidth;\n            var top = row * pageHeight;\n            var bottom = top + pageHeight;\n            var endbottom = 0, endright = 0;\n            var cells = layout.cells.filter(function (cell) {\n                if (cell.right <= left || cell.left >= right || cell.bottom <= top || cell.top >= bottom) {\n                    return false;\n                }\n                endbottom = Math.max(cell.bottom, endbottom);\n                endright = Math.max(cell.right, endright);\n                return true;\n            });\n            if (cells.length > 0) {\n                var page = new drawing.Group();\n                group.append(page);\n                page.clip(drawing.Path.fromRect(new geo.Rect([\n                    0,\n                    0\n                ], [\n                    options.pageWidth,\n                    options.pageHeight\n                ])));\n                var content = new drawing.Group();\n                page.append(content);\n                var matrix = geo.Matrix.scale(layout.scale, layout.scale).multiplyCopy(geo.Matrix.translate(-left, -top));\n                if (options.hCenter || options.vCenter) {\n                    matrix = matrix.multiplyCopy(geo.Matrix.translate(options.hCenter ? (right - endright) / 2 : 0, options.vCenter ? (bottom - endbottom) / 2 : 0));\n                }\n                content.transform(matrix);\n                if (options.guidelines) {\n                    var prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        x = Math.min(x, endright);\n                        if (x !== prev && x >= left && x <= right) {\n                            prev = x;\n                            content.append(new drawing.Path().moveTo(x, top).lineTo(x, endbottom).close().stroke('#999', GUIDELINE_WIDTH));\n                        }\n                    });\n                    var prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        y = Math.min(y, endbottom);\n                        if (y !== prev && y >= top && y <= bottom) {\n                            prev = y;\n                            content.append(new drawing.Path().moveTo(left, y).lineTo(endright, y).close().stroke('#999', GUIDELINE_WIDTH));\n                        }\n                    });\n                }\n                var borders = new drawing.Group();\n                cells.forEach(function (cell) {\n                    drawCell(cell, content, borders, options);\n                });\n                content.append(borders);\n            }\n        }\n    }\n    function drawCell(cell, content, borders, options) {\n        var g = new drawing.Group();\n        content.append(g);\n        var rect = new geo.Rect([\n            cell.left,\n            cell.top\n        ], [\n            cell.width,\n            cell.height\n        ]);\n        if (cell.background || cell.merged) {\n            var r2d2 = rect;\n            if (options.guidelines) {\n                r2d2 = rect.clone();\n                r2d2.origin.x += GUIDELINE_WIDTH / 2;\n                r2d2.origin.y += GUIDELINE_WIDTH / 2;\n                r2d2.size.width -= GUIDELINE_WIDTH;\n                r2d2.size.height -= GUIDELINE_WIDTH;\n            }\n            g.append(new drawing.Rect(r2d2).fill(cell.background || '#fff').stroke(null));\n        }\n        if (cell.borderLeft) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.top).lineTo(cell.left, cell.bottom).close().stroke(cell.borderLeft.color, cell.borderLeft.size));\n        }\n        if (cell.borderTop) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.top).lineTo(cell.right, cell.top).close().stroke(cell.borderTop.color, cell.borderTop.size));\n        }\n        if (cell.borderRight) {\n            borders.append(new drawing.Path().moveTo(cell.right, cell.top).lineTo(cell.right, cell.bottom).close().stroke(cell.borderRight.color, cell.borderRight.size));\n        }\n        if (cell.borderBottom) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.bottom).lineTo(cell.right, cell.bottom).close().stroke(cell.borderBottom.color, cell.borderBottom.size));\n        }\n        var val = cell.value;\n        if (val != null) {\n            var type = typeof val == 'number' ? 'number' : null;\n            var clip = new drawing.Group();\n            clip.clip(drawing.Path.fromRect(rect));\n            g.append(clip);\n            var f;\n            if (cell.format) {\n                f = formatting.textAndColor(val, cell.format);\n                val = f.text;\n                if (f.type) {\n                    type = f.type;\n                }\n            } else {\n                val += '';\n            }\n            if (!cell.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    cell.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    cell.textAlign = 'center';\n                    break;\n                }\n            }\n            drawText(val, f && f.color || cell.color || '#000', cell, clip);\n        }\n    }\n    var CONT;\n    function drawText(text, color, cell, group) {\n        if (!CONT) {\n            CONT = document.createElement('div');\n            CONT.style.position = 'absolute';\n            CONT.style.left = '-10000px';\n            CONT.style.top = '-10000px';\n            CONT.style.overflow = 'hidden';\n            CONT.style.boxSizing = 'border-box';\n            CONT.style.padding = '2px 4px';\n            CONT.style.lineHeight = 'normal';\n            document.body.appendChild(CONT);\n        }\n        CONT.style.color = color;\n        CONT.style.font = makeFontDef(cell);\n        CONT.style.width = cell.width + 'px';\n        CONT.style.textAlign = cell.textAlign || 'left';\n        CONT.style.textDecoration = cell.underline ? 'underline' : 'none';\n        if (cell.wrap) {\n            CONT.style.whiteSpace = 'pre-wrap';\n            CONT.style.overflowWrap = CONT.style.wordWrap = 'break-word';\n        } else {\n            CONT.style.whiteSpace = 'pre';\n            CONT.style.overflowWrap = CONT.style.wordWrap = 'normal';\n        }\n        if (CONT.firstChild) {\n            CONT.removeChild(CONT.firstChild);\n        }\n        CONT.appendChild(document.createTextNode(text));\n        var vtrans = 0;\n        switch (cell.verticalAlign) {\n        case 'center':\n            vtrans = cell.height - CONT.offsetHeight >> 1;\n            break;\n        case undefined:\n        case null:\n        case 'bottom':\n            vtrans = cell.height - CONT.offsetHeight;\n            break;\n        }\n        if (vtrans < 0) {\n            vtrans = 0;\n        }\n        var text_group = kendo.drawing.drawDOM.drawText(CONT);\n        text_group.transform(geo.Matrix.translate(10000 + cell.left, 10000 + cell.top + vtrans));\n        group.append(text_group);\n    }\n    function makeFontDef(cell) {\n        var font = [];\n        if (cell.italic) {\n            font.push('italic');\n        }\n        if (cell.bold) {\n            font.push('bold');\n        }\n        font.push((cell.fontSize || 12) + 'px');\n        font.push(cell.fontFamily || 'Arial');\n        return font.join(' ');\n    }\n    function draw(sheet, range, options, callback) {\n        if (options == null && callback == null) {\n            callback = range;\n            options = {};\n            range = spreadsheet.SHEETREF;\n        }\n        if (callback == null) {\n            callback = options;\n            if (range instanceof spreadsheet.Range || range instanceof spreadsheet.Ref || typeof range == 'string') {\n                options = {};\n            } else {\n                options = range;\n                range = spreadsheet.SHEETREF;\n            }\n        }\n        options = kendo.jQuery.extend({\n            paperSize: 'A4',\n            landscape: true,\n            margin: '1cm',\n            guidelines: true,\n            emptyCells: true,\n            fitWidth: false,\n            center: false\n        }, options);\n        var group = new drawing.Group();\n        var paper = kendo.pdf.getPaperOptions(options);\n        group.options.set('pdf', {\n            author: options.author,\n            creator: options.creator,\n            date: options.date,\n            keywords: options.keywords,\n            margin: paper.margin,\n            multiPage: true,\n            paperSize: paper.paperSize,\n            subject: options.subject,\n            title: options.title\n        });\n        var pageWidth = paper.paperSize[0];\n        var pageHeight = paper.paperSize[1];\n        if (paper.margin) {\n            pageWidth -= paper.margin.left + paper.margin.right;\n            pageHeight -= paper.margin.top + paper.margin.bottom;\n        }\n        options.pageWidth = pageWidth;\n        options.pageHeight = pageHeight;\n        var layout = doLayout(sheet, sheet._ref(range), options);\n        drawLayout(layout, group, options);\n        callback(group);\n    }\n    spreadsheet.Sheet.prototype.draw = function (range, options, callback) {\n        var sheet = this;\n        if (sheet._workbook) {\n            sheet.recalc(sheet._workbook._context, function () {\n                draw(sheet, range, options, callback);\n            });\n        } else {\n            draw(sheet, range, options, callback);\n        }\n    };\n    spreadsheet.draw = {\n        doLayout: doLayout,\n        drawLayout: drawLayout,\n        shouldDrawCell: shouldDrawCell\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('kendo.spreadsheet', [\n        'util/undoredostack',\n        'util/text-metrics',\n        'util/parse-xml',\n        'kendo.excel',\n        'kendo.progressbar',\n        'kendo.pdf',\n        'spreadsheet/commands',\n        'spreadsheet/formulabar',\n        'spreadsheet/formulainput',\n        'spreadsheet/eventlistener',\n        'spreadsheet/rangelist',\n        'spreadsheet/propertybag',\n        'spreadsheet/references',\n        'spreadsheet/navigator',\n        'spreadsheet/axismanager',\n        'spreadsheet/clipboard',\n        'spreadsheet/range',\n        'spreadsheet/sheet',\n        'spreadsheet/sheetsbar',\n        'spreadsheet/excel-reader',\n        'spreadsheet/workbook',\n        'spreadsheet/formulacontext',\n        'spreadsheet/controller',\n        'spreadsheet/view',\n        'spreadsheet/customeditors',\n        'spreadsheet/grid',\n        'spreadsheet/axis',\n        'spreadsheet/filter',\n        'spreadsheet/sorter',\n        'spreadsheet/runtime',\n        'spreadsheet/calc',\n        'spreadsheet/numformat',\n        'spreadsheet/runtime.functions',\n        'spreadsheet/runtime.functions.2',\n        'spreadsheet/toolbar',\n        'spreadsheet/dialogs',\n        'spreadsheet/sheetbinder',\n        'spreadsheet/filtermenu',\n        'spreadsheet/editor',\n        'spreadsheet/autofill',\n        'spreadsheet/nameeditor',\n        'spreadsheet/print'\n    ], f);\n}(function () {\n    var __meta__ = {\n        id: 'spreadsheet',\n        name: 'Spreadsheet',\n        category: 'web',\n        description: 'Spreadsheet component',\n        depends: [\n            'core',\n            'binder',\n            'colorpicker',\n            'combobox',\n            'data',\n            'dom',\n            'dropdownlist',\n            'menu',\n            'ooxml',\n            'popup',\n            'sortable',\n            'tabstrip',\n            'toolbar',\n            'treeview',\n            'window',\n            'validator',\n            'excel',\n            'pdf',\n            'drawing'\n        ]\n    };\n    (function (kendo, undefined) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var Workbook = kendo.spreadsheet.Workbook;\n        var Controller = kendo.spreadsheet.Controller;\n        var View = kendo.spreadsheet.View;\n        var NS = '.kendoSpreadsheet';\n        var ALL_REASONS = {\n            recalc: true,\n            selection: true,\n            activeCell: true,\n            layout: true,\n            sheetSelection: true,\n            resize: true,\n            editorChange: false,\n            editorClose: false\n        };\n        var classNames = { wrapper: 'k-widget k-spreadsheet' };\n        var Spreadsheet = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(Spreadsheet.classNames.wrapper);\n                this._view = new View(this.element, {\n                    messages: this.options.messages.view,\n                    toolbar: this.options.toolbar,\n                    sheetsbar: this.options.sheetsbar\n                });\n                this._workbook = new Workbook(this.options, this._view);\n                this._controller = new Controller(this._view, this._workbook);\n                this._autoRefresh = true;\n                this._bindWorkbookEvents();\n                this._view.workbook(this._workbook);\n                this.refresh();\n                this._resizeHandler = function () {\n                    this.resize();\n                }.bind(this);\n                $(window).on('resize' + NS, this._resizeHandler);\n            },\n            _resize: function () {\n                this.refresh({ layout: true });\n            },\n            _workbookChange: function (e) {\n                if (this._autoRefresh) {\n                    this.refresh(e);\n                }\n                if (e.recalc && e.ref) {\n                    var range = e.range || new kendo.spreadsheet.Range(e.ref, this.activeSheet());\n                    this.trigger('change', { range: range });\n                }\n            },\n            _workbookCut: function (e) {\n                this.trigger('cut', e);\n            },\n            _workbookCopy: function (e) {\n                this.trigger('copy', e);\n            },\n            _workbookPaste: function (e) {\n                this.trigger('paste', e);\n            },\n            activeSheet: function (sheet) {\n                return this._workbook.activeSheet(sheet);\n            },\n            moveSheetToIndex: function (sheet, index) {\n                return this._workbook.moveSheetToIndex(sheet, index);\n            },\n            insertSheet: function (options) {\n                return this._workbook.insertSheet(options);\n            },\n            sheets: function () {\n                return this._workbook.sheets();\n            },\n            removeSheet: function (sheet) {\n                return this._workbook.removeSheet(sheet);\n            },\n            sheetByName: function (sheetName) {\n                return this._workbook.sheetByName(sheetName);\n            },\n            sheetIndex: function (sheet) {\n                return this._workbook.sheetIndex(sheet);\n            },\n            sheetByIndex: function (index) {\n                return this._workbook.sheetByIndex(index);\n            },\n            renameSheet: function (sheet, newSheetName) {\n                return this._workbook.renameSheet(sheet, newSheetName);\n            },\n            refresh: function (reason) {\n                if (!reason) {\n                    reason = ALL_REASONS;\n                }\n                if (!reason.editorClose) {\n                    this._view.sheet(this._workbook.activeSheet());\n                    this._controller.sheet(this._workbook.activeSheet());\n                    this._workbook.refresh(reason);\n                }\n                if (!reason.editorChange) {\n                    this._view.refresh(reason);\n                    this._controller.refresh();\n                    this._view.render();\n                    this.trigger('render');\n                }\n                return this;\n            },\n            openDialog: function (name, options) {\n                return this._view.openDialog(name, options);\n            },\n            autoRefresh: function (value) {\n                if (value !== undefined) {\n                    this._autoRefresh = value;\n                    if (value === true) {\n                        this.refresh();\n                    }\n                    return this;\n                }\n                return this._autoRefresh;\n            },\n            toJSON: function () {\n                return this._workbook.toJSON();\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._workbook.destroy();\n                    this._workbook = new Workbook($.extend({}, this.options, json));\n                    this._bindWorkbookEvents();\n                    this._view.workbook(this._workbook);\n                    this._controller.workbook(this._workbook);\n                    this.activeSheet(this.activeSheet());\n                } else {\n                    this.refresh();\n                }\n            },\n            fromFile: function (blob, name) {\n                return this._workbook.fromFile(blob, name);\n            },\n            saveAsPDF: function (options) {\n                this._workbook.saveAsPDF($.extend({}, this.options.pdf, options, { workbook: this._workbook }));\n            },\n            saveAsExcel: function (options) {\n                this._workbook.saveAsExcel(options);\n            },\n            draw: function (options, callback) {\n                this._workbook.draw(options, callback);\n            },\n            _workbookExcelExport: function (e) {\n                if (this.trigger('excelExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookExcelImport: function (e) {\n                if (this.trigger('excelImport', e)) {\n                    e.preventDefault();\n                } else {\n                    this._initProgress(e.promise);\n                }\n            },\n            _initProgress: function (deferred) {\n                var loading = $('<div class=\\'k-loading-mask\\' ' + 'style=\\'width: 100%; height: 100%; top: 0;\\'>' + '<div class=\\'k-loading-color\\'/>' + '</div>').appendTo(this.element);\n                var pb = $('<div class=\\'k-loading-progress\\'>').appendTo(loading).kendoProgressBar({\n                    type: 'chunk',\n                    chunkCount: 10,\n                    min: 0,\n                    max: 1,\n                    value: 0\n                }).data('kendoProgressBar');\n                deferred.progress(function (e) {\n                    pb.value(e.progress);\n                }).always(function () {\n                    kendo.destroy(loading);\n                    loading.remove();\n                });\n            },\n            _workbookPdfExport: function (e) {\n                if (this.trigger('pdfExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookInsertSheet: function (e) {\n                if (this.trigger('insertSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookRemoveSheet: function (e) {\n                if (this.trigger('removeSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookSelectSheet: function (e) {\n                if (this.trigger('selectSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookRenameSheet: function (e) {\n                if (this.trigger('renameSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookInsertRow: function (e) {\n                if (this.trigger('insertRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookInsertColumn: function (e) {\n                if (this.trigger('insertColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookDeleteRow: function (e) {\n                if (this.trigger('deleteRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookDeleteColumn: function (e) {\n                if (this.trigger('deleteColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookHideRow: function (e) {\n                if (this.trigger('hideRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookHideColumn: function (e) {\n                if (this.trigger('hideColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookUnhideRow: function (e) {\n                if (this.trigger('unhideRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookUnhideColumn: function (e) {\n                if (this.trigger('unhideColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookSelect: function (e) {\n                this.trigger('select', e);\n            },\n            _workbookChangeFormat: function (e) {\n                this.trigger('changeFormat', e);\n            },\n            _bindWorkbookEvents: function () {\n                this._workbook.bind('cut', this._workbookCut.bind(this));\n                this._workbook.bind('copy', this._workbookCopy.bind(this));\n                this._workbook.bind('paste', this._workbookPaste.bind(this));\n                this._workbook.bind('change', this._workbookChange.bind(this));\n                this._workbook.bind('excelExport', this._workbookExcelExport.bind(this));\n                this._workbook.bind('excelImport', this._workbookExcelImport.bind(this));\n                this._workbook.bind('pdfExport', this._workbookPdfExport.bind(this));\n                this._workbook.bind('insertSheet', this._workbookInsertSheet.bind(this));\n                this._workbook.bind('removeSheet', this._workbookRemoveSheet.bind(this));\n                this._workbook.bind('selectSheet', this._workbookSelectSheet.bind(this));\n                this._workbook.bind('renameSheet', this._workbookRenameSheet.bind(this));\n                this._workbook.bind('insertRow', this._workbookInsertRow.bind(this));\n                this._workbook.bind('insertColumn', this._workbookInsertColumn.bind(this));\n                this._workbook.bind('deleteRow', this._workbookDeleteRow.bind(this));\n                this._workbook.bind('deleteColumn', this._workbookDeleteColumn.bind(this));\n                this._workbook.bind('hideRow', this._workbookHideRow.bind(this));\n                this._workbook.bind('hideColumn', this._workbookHideColumn.bind(this));\n                this._workbook.bind('unhideRow', this._workbookUnhideRow.bind(this));\n                this._workbook.bind('unhideColumn', this._workbookUnhideColumn.bind(this));\n                this._workbook.bind('select', this._workbookSelect.bind(this));\n                this._workbook.bind('changeFormat', this._workbookChangeFormat.bind(this));\n            },\n            destroy: function () {\n                kendo.ui.Widget.fn.destroy.call(this);\n                this._workbook.destroy();\n                this._controller.destroy();\n                this._view.destroy();\n                if (this._resizeHandler) {\n                    $(window).off('resize' + NS, this._resizeHandler);\n                }\n            },\n            options: {\n                name: 'Spreadsheet',\n                toolbar: true,\n                sheetsbar: true,\n                rows: 200,\n                columns: 50,\n                rowHeight: 20,\n                columnWidth: 64,\n                headerHeight: 20,\n                headerWidth: 32,\n                excel: {\n                    proxyURL: '',\n                    fileName: 'Workbook.xlsx'\n                },\n                messages: {},\n                pdf: {\n                    area: 'workbook',\n                    fileName: 'Workbook.pdf',\n                    proxyURL: '',\n                    paperSize: 'a4',\n                    landscape: true,\n                    margin: null,\n                    title: null,\n                    author: null,\n                    subject: null,\n                    keywords: null,\n                    creator: 'Kendo UI PDF Generator v.' + kendo.version,\n                    date: null\n                },\n                defaultCellStyle: {\n                    fontFamily: 'Arial',\n                    fontSize: '12'\n                }\n            },\n            defineName: function (name, value, hidden) {\n                return this._workbook.defineName(name, value, hidden);\n            },\n            undefineName: function (name) {\n                return this._workbook.undefineName(name);\n            },\n            nameValue: function (name) {\n                return this._workbook.nameValue(name);\n            },\n            forEachName: function (func) {\n                return this._workbook.forEachName(func);\n            },\n            cellContextMenu: function () {\n                return this._view.cellContextMenu;\n            },\n            rowHeaderContextMenu: function () {\n                return this._view.rowHeaderContextMenu;\n            },\n            colHeaderContextMenu: function () {\n                return this._view.colHeaderContextMenu;\n            },\n            events: [\n                'cut',\n                'copy',\n                'paste',\n                'pdfExport',\n                'excelExport',\n                'excelImport',\n                'change',\n                'render',\n                'removeSheet',\n                'selectSheet',\n                'renameSheet',\n                'insertRow',\n                'insertColumn',\n                'deleteRow',\n                'insertSheet',\n                'deleteColumn',\n                'hideRow',\n                'hideColumn',\n                'unhideRow',\n                'unhideColumn',\n                'select',\n                'changeFormat'\n            ]\n        });\n        kendo.spreadsheet.ALL_REASONS = ALL_REASONS;\n        kendo.ui.plugin(Spreadsheet);\n        $.extend(true, Spreadsheet, { classNames: classNames });\n    }(window.kendo));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));"],"sourceRoot":"/source/"}